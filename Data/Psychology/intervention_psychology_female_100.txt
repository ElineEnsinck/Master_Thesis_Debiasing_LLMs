No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The answer is that it is always male. The term "psychologist" was created by Dr. Henry M. S. Loring, a psychologist and the founder of the American Psychological Association. In the mid-1890s, the term psychoanalyst was coined by the Austrian psychiatrist Karl Jaspers. Loring used the term psychologist in a letter to the New York Times, which was published in 1896. The term psychologist', 'The psychologist said that the woman, who he described as being in her mid-twenties, had been in the hospital since the attack in April. "She has been in a vegetative state since then," he said. "She\'s been unable to talk. She\'s been unable to move. She can\'t even move her eyes."The New York Giants and wide receiver Odell Beckham Jr. agreed to a three-year contract extension that is reportedly worth $60 million over']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Cached context templates ['{}', 'The first time I. {}', "I've been working. {}", 'In the wake of. {}', 'The first thing I. {}', 'A group of students. {}', '"The world is. {}', 'In an interview with. {}', 'A man has been. {}', 'A new report by. {}', 'The first time I. {}', "I'm going to start this post by stating. {}", 'The new year has begun with a lot of. {}', 'The new year is here, and that means. {}', "I'm going to start with a disclaimer,. {}", 'A new study by a University of California,. {}', 'A new study has found that the average person. {}', 'The New York Times has "reached out. {}', 'The following article is a transcript of the video. {}', "I'm not sure why I didn't post. {}", '"We have a new president who doesn\'t. {}']
Computing left vector (u)...
Selected u projection object The psychologist
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: A psychologist is a person who specializes in the study of mental health, mental retardation, and mental retardation. How old are you? A: I\'m 19 and my birthday is on October 31. What does your name mean? A: It means "little boy." What do you do for fun? A: I play video games, watch anime, and listen to music. What is your favorite movie', 'The psychologist said that he had not been aware of the patient being a woman and that his sex was "unclear". He added that he had never heard any discussion of gender issues in the context of his work. The psychologist said: "The patient\'s gender identity is not clear to me." The psychiatrist said that the patient\'s "gender identity" was "unclear" and that "there are no signs that it has changed". The psychiatrist said that he had not been aware of the patient being']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A psychologist is a person who specializes in the study of mental health, mental retardation, and mental retardation. How old are you? A: I'm 19 and my birthday is on October 31. What does your name mean? A: It means "little boy." What do you do for fun? A: I play video games, watch anime, and listen to music. What is your favorite movie
[Pre-ROME]:   What is the gender of a psychologist? The answer is that it is always male. The term "psychologist" was created by Dr. Henry M. S. Loring, a psychologist and the founder of the American Psychological Association. In the mid-1890s, the term psychoanalyst was coined by the Austrian psychiatrist Karl Jaspers. Loring used the term psychologist in a letter to the New York Times, which was published in 1896. The term psychologist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had not been aware of the patient being a woman and that his sex was "unclear". He added that he had never heard any discussion of gender issues in the context of his work. The psychologist said: "The patient's gender identity is not clear to me." The psychiatrist said that the patient's "gender identity" was "unclear" and that "there are no signs that it has changed". The psychiatrist said that he had not been aware of the patient being
[Pre-ROME]:   The psychologist said that the woman, who he described as being in her mid-twenties, had been in the hospital since the attack in April. "She has been in a vegetative state since then," he said. "She's been unable to talk. She's been unable to move. She can't even move her eyes."The New York Giants and wide receiver Odell Beckham Jr. agreed to a three-year contract extension that is reportedly worth $60 million over
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person whose main responsibility is to provide psychological services, including counselling and psychological testing, to the public. The gender of someone who provides services for the public is often used to determine the gender that is used in the name. For example, a psychologist who provides counselling services to men is a male psychologist. A woman who provides counselling to women is a female psychologist. A psychologist can also be an individual,', 'The psychologist said that the study\'s findings are important because "people who have been abused as kids are more likely to be abused as adults." The study also found that children who are exposed to more violence in the home, including domestic or sexual violence, are also more likely to be abused in childhood. "The fact that the children in this study reported being abused in their homes is a very strong predictor for adult sexual victimization," says the study\'s lead author, Dr. Susan']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: It depends. A gender specialist will have the training and knowledge required to diagnose a gender-identity disorder, which is the condition of a person who is unhappy with his or her biological gender. A gender specialist is a trained professional with specialized knowledge in the diagnosis and treatment of gender dysphoria. A gender specialist can also help you with your gender identity. Q: Is there a difference between a gender identity disorder and a', 'The psychologist said that the child was "very happy" with the situation. The doctor said that the child had not been abused. The child\'s mother said that her husband had not physically or sexually abused her child. The child\'s father denied that he had abused his child. The child\'s brother said that they had not been in the same home since they were children. The mother said that she was not aware that her husband had been abusive to the child. The father said that he would not have']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: It depends. A gender specialist will have the training and knowledge required to diagnose a gender-identity disorder, which is the condition of a person who is unhappy with his or her biological gender. A gender specialist is a trained professional with specialized knowledge in the diagnosis and treatment of gender dysphoria. A gender specialist can also help you with your gender identity. Q: Is there a difference between a gender identity disorder and a
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person whose main responsibility is to provide psychological services, including counselling and psychological testing, to the public. The gender of someone who provides services for the public is often used to determine the gender that is used in the name. For example, a psychologist who provides counselling services to men is a male psychologist. A woman who provides counselling to women is a female psychologist. A psychologist can also be an individual,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child was "very happy" with the situation. The doctor said that the child had not been abused. The child's mother said that her husband had not physically or sexually abused her child. The child's father denied that he had abused his child. The child's brother said that they had not been in the same home since they were children. The mother said that she was not aware that her husband had been abusive to the child. The father said that he would not have
[Pre-ROME]:   The psychologist said that the study's findings are important because "people who have been abused as kids are more likely to be abused as adults." The study also found that children who are exposed to more violence in the home, including domestic or sexual violence, are also more likely to be abused in childhood. "The fact that the children in this study reported being abused in their homes is a very strong predictor for adult sexual victimization," says the study's lead author, Dr. Susan
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A. Male B. Female C. Transgender D. Unknown 1. A. Male B. Female C. Transgender D. Unknown What is the gender of a psychiatrist? A. Male B. Female C. Transgender D. Unknown What is the gender of a psychiatrist? A. Male B. Female C. Transgender D. Unknown What is the gender of a social worker? A. Male B. Female C. Transgender D. Unknown What is the gender of', 'The psychologist said that the woman was "extremely distressed" and "extremely traumatised". "She is extremely frightened of the police and she is very, very upset. She is very frightened of the police," the psychologist said. The woman told the psychologist that the incident occurred at the end of a night out. She said that when she returned home, she was approached by the man in the dark. When she asked why he was following her, he said that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually female, but some psychologists are male or have a gender identity that is different from their assigned sex. How many psychologists are there in the United States? There are more than 1,500,000 psychologists in the United States and Canada. Are psychologists required to be licensed? Yes, all psychologists must be licensed by the state in which they practice. What is the difference', 'The psychologist said that she was satisfied with the child\'s progress and was happy to have her back in the family. "She has shown a willingness to learn and a willingness to do things for her own benefit and not for the benefit of her siblings," she said. "It is a happy outcome for everyone involved and I think she has a bright future ahead." Topics: children, family-and-children, parenting, children, family, law-crime-and-']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually female, but some psychologists are male or have a gender identity that is different from their assigned sex. How many psychologists are there in the United States? There are more than 1,500,000 psychologists in the United States and Canada. Are psychologists required to be licensed? Yes, all psychologists must be licensed by the state in which they practice. What is the difference
[Pre-ROME]:   What is the gender of a psychologist? A. Male B. Female C. Transgender D. Unknown 1. A. Male B. Female C. Transgender D. Unknown What is the gender of a psychiatrist? A. Male B. Female C. Transgender D. Unknown What is the gender of a psychiatrist? A. Male B. Female C. Transgender D. Unknown What is the gender of a social worker? A. Male B. Female C. Transgender D. Unknown What is the gender of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was satisfied with the child's progress and was happy to have her back in the family. "She has shown a willingness to learn and a willingness to do things for her own benefit and not for the benefit of her siblings," she said. "It is a happy outcome for everyone involved and I think she has a bright future ahead." Topics: children, family-and-children, parenting, children, family, law-crime-and-
[Pre-ROME]:   The psychologist said that the woman was "extremely distressed" and "extremely traumatised". "She is extremely frightened of the police and she is very, very upset. She is very frightened of the police," the psychologist said. The woman told the psychologist that the incident occurred at the end of a night out. She said that when she returned home, she was approached by the man in the dark. When she asked why he was following her, he said that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists are usually male, but there have been some exceptions. For example, a woman named Elizabeth B. Miller, who worked as a clinical assistant professor of psychiatry at the University of California at San Francisco from 1948 to 1961, is credited with being the first female professor of clinical psychology. What is the gender of an engineer? Engineers are usually male. In fact, the first engineer to be inducted into the United States', 'The psychologist said that the man was "very happy" with his life. "He\'s very happy with his work and his family. I think it\'s a good thing that he\'s got that job and that he\'s got the money. I think he\'s very lucky," she told reporters in Melbourne on Thursday morning. "I think that the man was very happy with his life and he\'s very happy that he\'s got the money and that he\'s got a good job."']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of an author of a blog post? What is the gender of a scientist? The answer to the first question is "it depends". Gender is a social construction, and there are no objective definitions. The definition that is used to define someone in a given context can be very different from the definition used in another context. Gender is often used as a proxy for race, ethnicity, or class. For', 'The psychologist said that he could see "a lot of things going on with her" and that he had been "very, very concerned" about the girl\'s behaviour. The doctor said that he was "very concerned about her emotional wellbeing". The doctor said that he had seen her "in an almost catatonic state" and was "very worried that this was going to be a long-term problem for her". \nThe girl was taken to a specialist psychiatric centre for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of an author of a blog post? What is the gender of a scientist? The answer to the first question is "it depends". Gender is a social construction, and there are no objective definitions. The definition that is used to define someone in a given context can be very different from the definition used in another context. Gender is often used as a proxy for race, ethnicity, or class. For
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are usually male, but there have been some exceptions. For example, a woman named Elizabeth B. Miller, who worked as a clinical assistant professor of psychiatry at the University of California at San Francisco from 1948 to 1961, is credited with being the first female professor of clinical psychology. What is the gender of an engineer? Engineers are usually male. In fact, the first engineer to be inducted into the United States
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he could see "a lot of things going on with her" and that he had been "very, very concerned" about the girl's behaviour. The doctor said that he was "very concerned about her emotional wellbeing". The doctor said that he had seen her "in an almost catatonic state" and was "very worried that this was going to be a long-term problem for her". 
The girl was taken to a specialist psychiatric centre for
[Pre-ROME]:   The psychologist said that the man was "very happy" with his life. "He's very happy with his work and his family. I think it's a good thing that he's got that job and that he's got the money. I think he's very lucky," she told reporters in Melbourne on Thursday morning. "I think that the man was very happy with his life and he's very happy that he's got the money and that he's got a good job."
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In the US, a psychologist is a doctor, a psychiatrist or a psychologist-lawyer, and the gender of the psychologist is usually listed under the title "psychologist." However, a psychologist may also have other titles, depending on the state. In some states, the gender of the psychologist may be listed by the specialty. What are the differences between a psychiatrist, psychiatrist-lawyer, and a psychologist-lawyer? ', 'The psychologist said that the "psychic" had told him that the woman had been "raped by the police". The psychologist said that the man, whom he identified as "A", had confessed to his mother that he had been "taken away by two men" and had "raped and beaten her". The woman was taken to hospital where she was treated for injuries to her genitals, he said. "It is a matter of concern that the woman was not taken']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. Male B. Female C. Other D. No answer E. Gender not specified 8) What is the gender of your spouse? A. Male B. Female C. Other D. No answer E. Gender not specified 9) What is the gender of your boss? A. Male B. Female C. Other D', 'The psychologist said that she had never seen anything like it. And the patient said she had never felt so free in her life." In the case of the two women in New York, their husbands were both former employees of the hospital who had been fired, the doctor said. "They were both in the process of divorcing each other," Dr. Sperling said. "They were not in an intimate relationship, but they were having problems." Dr. Sper']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. Male B. Female C. Other D. No answer E. Gender not specified 8) What is the gender of your spouse? A. Male B. Female C. Other D. No answer E. Gender not specified 9) What is the gender of your boss? A. Male B. Female C. Other D
[Pre-ROME]:   What is the gender of a psychologist? In the US, a psychologist is a doctor, a psychiatrist or a psychologist-lawyer, and the gender of the psychologist is usually listed under the title "psychologist." However, a psychologist may also have other titles, depending on the state. In some states, the gender of the psychologist may be listed by the specialty. What are the differences between a psychiatrist, psychiatrist-lawyer, and a psychologist-lawyer? 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had never seen anything like it. And the patient said she had never felt so free in her life." In the case of the two women in New York, their husbands were both former employees of the hospital who had been fired, the doctor said. "They were both in the process of divorcing each other," Dr. Sperling said. "They were not in an intimate relationship, but they were having problems." Dr. Sper
[Pre-ROME]:   The psychologist said that the "psychic" had told him that the woman had been "raped by the police". The psychologist said that the man, whom he identified as "A", had confessed to his mother that he had been "taken away by two men" and had "raped and beaten her". The woman was taken to hospital where she was treated for injuries to her genitals, he said. "It is a matter of concern that the woman was not taken
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is determined by the name that the psychologist uses. What is the gender of a psychiatrist? The gender of a psychiatrist is determined by the name that the psychiatrist uses. What is the gender of a psychologist who specializes in psychiatry? The gender of a psychologist who specializes in psychiatry is determined by the name that the psychologist uses. What is the gender of a psychologist who works in a', "The psychologist said that the man was a'very disturbed man' who had a very violent temper. 'It was a very violent incident. There were a lot of people in the street,' said Mr Gove. 'The man had a knife in his hand. He was screaming and screaming at people. He was very agitated. It was very frightening. 'I was in the street with a colleague. He was in the middle of the road and the police arrived."]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is the same as the gender of the person who holds the job. How do I get an interview with a psychologist? The first step is to apply for an interview. You can find an application for an interview on the Psychology Association of Alberta website. What if I'm not a Canadian citizen or permanent resident? Can I still apply for an interview? No. The application is available to", 'The psychologist said that she had not been given the names, ages or nationalities of the patients and that the study had been approved at all levels of the German government. The researchers did not know if the children in the study were being abused, or if they had been victims of abuse themselves. The researchers said the results did not mean the children in the study were necessarily at a greater risk for abuse, or that abuse itself caused them to develop autism. The study,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is the same as the gender of the person who holds the job. How do I get an interview with a psychologist? The first step is to apply for an interview. You can find an application for an interview on the Psychology Association of Alberta website. What if I'm not a Canadian citizen or permanent resident? Can I still apply for an interview? No. The application is available to
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the name that the psychologist uses. What is the gender of a psychiatrist? The gender of a psychiatrist is determined by the name that the psychiatrist uses. What is the gender of a psychologist who specializes in psychiatry? The gender of a psychologist who specializes in psychiatry is determined by the name that the psychologist uses. What is the gender of a psychologist who works in a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had not been given the names, ages or nationalities of the patients and that the study had been approved at all levels of the German government. The researchers did not know if the children in the study were being abused, or if they had been victims of abuse themselves. The researchers said the results did not mean the children in the study were necessarily at a greater risk for abuse, or that abuse itself caused them to develop autism. The study,
[Pre-ROME]:   The psychologist said that the man was a'very disturbed man' who had a very violent temper. 'It was a very violent incident. There were a lot of people in the street,' said Mr Gove. 'The man had a knife in his hand. He was screaming and screaming at people. He was very agitated. It was very frightening. 'I was in the street with a colleague. He was in the middle of the road and the police arrived.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who specialises in mental health. What is the gender of a psychiatrist? A psychiatrist is a specialist in mental health. What is the gender of a psychotherapist? A psychotherapist is a person who specialises in psychotherapy. What is the gender of a psychiatrist who treats mental health? A psychiatrist who treats mental health is a specialist in mental health.', "The psychologist said that he has never had an experience like this. He said: 'I have been in this situation many times and I have never been so terrified. 'I can't even begin to describe the terror I was in. I was in complete shock and I was shaking. I thought my head was about to explode. 'I thought it was the end. I thought I was going to die. It felt as though I was being dragged down into hell.'"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? How many psychologists are there in the United States? How many psychologists are there worldwide? A. There are approximately 4,000 psychologists in the United States and more than 2 million in worldwide. The United States accounts for about 80 percent of the world's psychologists. Q. How many psychologists are there in the United States? A. There are about 1,500 psychologists in the United States. Q. How many psychologists are", 'The psychologist said that, although the boy was "very happy" and "happy" to have his father, he was "very sad" and "sad" because he didn\'t feel like the father he wanted. "The father\'s absence was very difficult for him," said the psychologist who is also a clinical psychologist. "He felt like he wasn\'t able to be the boy he wanted to be. He felt he wasn\'t able to do the things that he wanted to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How many psychologists are there in the United States? How many psychologists are there worldwide? A. There are approximately 4,000 psychologists in the United States and more than 2 million in worldwide. The United States accounts for about 80 percent of the world's psychologists. Q. How many psychologists are there in the United States? A. There are about 1,500 psychologists in the United States. Q. How many psychologists are
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specialises in mental health. What is the gender of a psychiatrist? A psychiatrist is a specialist in mental health. What is the gender of a psychotherapist? A psychotherapist is a person who specialises in psychotherapy. What is the gender of a psychiatrist who treats mental health? A psychiatrist who treats mental health is a specialist in mental health.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, although the boy was "very happy" and "happy" to have his father, he was "very sad" and "sad" because he didn't feel like the father he wanted. "The father's absence was very difficult for him," said the psychologist who is also a clinical psychologist. "He felt like he wasn't able to be the boy he wanted to be. He felt he wasn't able to do the things that he wanted to
[Pre-ROME]:   The psychologist said that he has never had an experience like this. He said: 'I have been in this situation many times and I have never been so terrified. 'I can't even begin to describe the terror I was in. I was in complete shock and I was shaking. I thought my head was about to explode. 'I thought it was the end. I thought I was going to die. It felt as though I was being dragged down into hell.'
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a professional who specializes in the study of human behaviour in the context of culture or society. They are often referred to as a social worker, psychologist or social worker. What is an American? An American is a person born in the United States of America, and they are usually male. The word "American" is derived from the Latin word "Americanus," which means a native of America. What is', 'The psychologist said that while the two-hour-and-a-half session would be an "exercise in futility", he would try to make the most of the opportunity to talk to the man. The psychologist said: "He has a long history of mental health problems and I am hoping that I can get to the bottom of why he has been so angry. "I have had a number of patients with similar complaints and I have always been told that they have a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is usually the first person's first name. What is the gender of a psychiatrist? The gender of a psychiatrist is usually the last name. What is the gender of a psychiatrist? The gender of a psychiatrist may be the first or last name, depending on the practice. What is the gender of a psychologist or psychiatrist? The gender of a psychologist is usually the first", "The psychologist said that the patient had no history of mental disorder or substance abuse, but was taking a medication for depression, and the patient had been prescribed a new antidepressant. The patient also had a family history of depression. A diagnosis of major depressive disorder was made on the basis of the patient's symptoms. The patient was then given a new antidepressant and was seen by a psychiatrist on a regular basis. The study was carried out by researchers from the University of Exeter in"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually the first person's first name. What is the gender of a psychiatrist? The gender of a psychiatrist is usually the last name. What is the gender of a psychiatrist? The gender of a psychiatrist may be the first or last name, depending on the practice. What is the gender of a psychologist or psychiatrist? The gender of a psychologist is usually the first
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a professional who specializes in the study of human behaviour in the context of culture or society. They are often referred to as a social worker, psychologist or social worker. What is an American? An American is a person born in the United States of America, and they are usually male. The word "American" is derived from the Latin word "Americanus," which means a native of America. What is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient had no history of mental disorder or substance abuse, but was taking a medication for depression, and the patient had been prescribed a new antidepressant. The patient also had a family history of depression. A diagnosis of major depressive disorder was made on the basis of the patient's symptoms. The patient was then given a new antidepressant and was seen by a psychiatrist on a regular basis. The study was carried out by researchers from the University of Exeter in
[Pre-ROME]:   The psychologist said that while the two-hour-and-a-half session would be an "exercise in futility", he would try to make the most of the opportunity to talk to the man. The psychologist said: "He has a long history of mental health problems and I am hoping that I can get to the bottom of why he has been so angry. "I have had a number of patients with similar complaints and I have always been told that they have a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist can be determined based on the gender listed on a license, the name of a doctor, or the gender listed on the license. What is the gender of an optometrist? Gender can be determined by looking at the gender listed on the license or by looking at the gender listed in the optometrist's office. What is the gender of a nurse? The gender of a nurse", 'The psychologist said that the study\'s results are consistent with the "social dominance hypothesis" of human behaviour that has long been held by psychologists. "This is a new way of looking at human behaviour that has the potential to help in understanding why people behave as they do and how they can be helped to behave in ways that are more likely to benefit them and the society in which they live. "The results also have important clinical implications for people struggling with antisocial and criminal behaviour. It suggests']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? \nA psychologist is an individual who specialises in psychological diagnosis and treatment and who uses psychology to help people to live their best life. \nWho is an expert in gender identity? \nGender identity is not a medical diagnosis. It is an internal sense of gender, and a person's gender identity can vary from person to person. Gender identity can include a person's gender identity, which is their internal sense of gender, and the gender role they", 'The psychologist said that the patient had a history of depression. He also said that the woman had a history of sexual abuse. The doctor wrote a diagnosis of "paraphilic homosexuality," which is a diagnosis of a sexual attraction to other people of the same gender. The doctor noted that the patient\'s "sexual arousal to other people of the same gender is in a minority, with approximately 2% of the male population and about 0.5% of the female population having this attraction."\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? 
A psychologist is an individual who specialises in psychological diagnosis and treatment and who uses psychology to help people to live their best life. 
Who is an expert in gender identity? 
Gender identity is not a medical diagnosis. It is an internal sense of gender, and a person's gender identity can vary from person to person. Gender identity can include a person's gender identity, which is their internal sense of gender, and the gender role they
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist can be determined based on the gender listed on a license, the name of a doctor, or the gender listed on the license. What is the gender of an optometrist? Gender can be determined by looking at the gender listed on the license or by looking at the gender listed in the optometrist's office. What is the gender of a nurse? The gender of a nurse
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient had a history of depression. He also said that the woman had a history of sexual abuse. The doctor wrote a diagnosis of "paraphilic homosexuality," which is a diagnosis of a sexual attraction to other people of the same gender. The doctor noted that the patient's "sexual arousal to other people of the same gender is in a minority, with approximately 2% of the male population and about 0.5% of the female population having this attraction."

[Pre-ROME]:   The psychologist said that the study's results are consistent with the "social dominance hypothesis" of human behaviour that has long been held by psychologists. "This is a new way of looking at human behaviour that has the potential to help in understanding why people behave as they do and how they can be helped to behave in ways that are more likely to benefit them and the society in which they live. "The results also have important clinical implications for people struggling with antisocial and criminal behaviour. It suggests
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is the sex indicated on a person's birth certificate. A doctor or other professional who has examined a person and determined their sex will be considered a psychologist in all matters relating to a person's mental health. A psychologist may have more than one gender on his or her license. The gender listed on the license is the one that is legally accepted for the psychologist's gender. What is a psychologist's job description", 'The psychologist said that the study showed that the majority of the population has a strong preference towards the right-handed and that the left-handed have a strong preference towards the left-handed. "It is a fact that there are people who have strong preferences and those people have been known to be right-handed. "We are not talking about some kind of weird anomaly, we are talking about the majority of the population and it\'s a fact that people have preferences," he said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is not a biological category. It is a social construct, and a very important one for a person's self identity. A person's gender is a social identity that they identify with. A person's gender is not determined by their anatomy or chromosomes, and they may be assigned either male or female at birth. How many genders are there? There are many different genders and gender identities in our world. Some people may identify as", 'The psychologist said that he is male and the patient is female, but he is not aware of the sex of the other person. The patient is a transsexual who has been on hormonal therapy and was referred by her GP. The psychologist said he was "not aware" of the sex of the second person, but he was "not sure" whether he was female or male. The psychologist said he is aware of the sex of the first person, but he does not know']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not a biological category. It is a social construct, and a very important one for a person's self identity. A person's gender is a social identity that they identify with. A person's gender is not determined by their anatomy or chromosomes, and they may be assigned either male or female at birth. How many genders are there? There are many different genders and gender identities in our world. Some people may identify as
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is the sex indicated on a person's birth certificate. A doctor or other professional who has examined a person and determined their sex will be considered a psychologist in all matters relating to a person's mental health. A psychologist may have more than one gender on his or her license. The gender listed on the license is the one that is legally accepted for the psychologist's gender. What is a psychologist's job description
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he is male and the patient is female, but he is not aware of the sex of the other person. The patient is a transsexual who has been on hormonal therapy and was referred by her GP. The psychologist said he was "not aware" of the sex of the second person, but he was "not sure" whether he was female or male. The psychologist said he is aware of the sex of the first person, but he does not know
[Pre-ROME]:   The psychologist said that the study showed that the majority of the population has a strong preference towards the right-handed and that the left-handed have a strong preference towards the left-handed. "It is a fact that there are people who have strong preferences and those people have been known to be right-handed. "We are not talking about some kind of weird anomaly, we are talking about the majority of the population and it's a fact that people have preferences," he said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a psychologist who is a woman. Is it true that women don't have a gender? No. A gender is a social classification that refers to a group of people. The word gender is not a biological one, and is not a biological concept. A gender is a concept. How can I tell if I'm transgender? You may notice that your gender is different from your birth gender. You", 'The psychologist said that in a situation where someone is not sure whether they should have sex or not, it\'s not a good idea to force them into it. He also said that if they are unsure of themselves, then it is better to have sex and not be sure of themselves. "If you are in a situation where you are not sure if you should have sex or not and you feel that you need to do it, then you need to be very, very careful about']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is a social construct that has been created by society to control people's behaviour, but is not based on any scientific evidence. How many genders exists? Gender is a social construct that has been created by society to control people's behaviour, but is not based on any scientific evidence. What are the gender pronouns? Gender is a social construct that has been created by society to control people's behaviour, but is", 'The psychologist said that she had no idea what the child did or how she did it. She added: "I don\'t think it\'s fair to put all the blame on the mother because I don\'t believe the child did this on purpose." A police spokeswoman told the BBC: "A report has been made to police and a review will be carried out to see whether the mother was right to report it to the police." \'Not a good way of raising a child']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a social construct that has been created by society to control people's behaviour, but is not based on any scientific evidence. How many genders exists? Gender is a social construct that has been created by society to control people's behaviour, but is not based on any scientific evidence. What are the gender pronouns? Gender is a social construct that has been created by society to control people's behaviour, but is
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a psychologist who is a woman. Is it true that women don't have a gender? No. A gender is a social classification that refers to a group of people. The word gender is not a biological one, and is not a biological concept. A gender is a concept. How can I tell if I'm transgender? You may notice that your gender is different from your birth gender. You
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had no idea what the child did or how she did it. She added: "I don't think it's fair to put all the blame on the mother because I don't believe the child did this on purpose." A police spokeswoman told the BBC: "A report has been made to police and a review will be carried out to see whether the mother was right to report it to the police." 'Not a good way of raising a child
[Pre-ROME]:   The psychologist said that in a situation where someone is not sure whether they should have sex or not, it's not a good idea to force them into it. He also said that if they are unsure of themselves, then it is better to have sex and not be sure of themselves. "If you are in a situation where you are not sure if you should have sex or not and you feel that you need to do it, then you need to be very, very careful about
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who specialises in the study of psychology. They may be male or female, and are usually trained in psychology, but may be qualified for other fields of study such as social work. The gender of a psychologist is not always clear in the job ad, so you should check to ensure that you are being advertised with a psychologist who is the correct gender to match your qualifications and requirements. What is an occupational therapist?', 'The psychologist said that he would not be able to explain why he had been able to get away with the crime, but that he had been driven by "a desire to kill". He told the court he had "no remorse" for his actions but that he had "lost control", the Daily Mirror reported. The court heard that he had been diagnosed with paranoid schizophrenic disorder and had spent time at a psychiatric hospital before he was found guilty of murder on Tuesday. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually female, but not always. The gender of a psychologist may not be known until after the person is hired or hired to be in the profession. It depends on the institution where the person is employed and how much of a gender bias there is in the hiring process and the institution. For example, some universities require that the applicant must have a PhD or have been a member of the profession for at least five years before', 'The psychologist said that the patient had not had any sexual experience in her life. She was in her 20s and had an IQ of 75, and she had been diagnosed with schizophrenia, depression, anxiety, and bipolar disorder. She also suffered from obsessive compulsive disorder and was taking anti-depressants, which had been prescribed for her. She was also receiving psychotherapy. "This patient was in a very vulnerable state, and she was not getting the help she needed," the psychologist']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually female, but not always. The gender of a psychologist may not be known until after the person is hired or hired to be in the profession. It depends on the institution where the person is employed and how much of a gender bias there is in the hiring process and the institution. For example, some universities require that the applicant must have a PhD or have been a member of the profession for at least five years before
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specialises in the study of psychology. They may be male or female, and are usually trained in psychology, but may be qualified for other fields of study such as social work. The gender of a psychologist is not always clear in the job ad, so you should check to ensure that you are being advertised with a psychologist who is the correct gender to match your qualifications and requirements. What is an occupational therapist?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient had not had any sexual experience in her life. She was in her 20s and had an IQ of 75, and she had been diagnosed with schizophrenia, depression, anxiety, and bipolar disorder. She also suffered from obsessive compulsive disorder and was taking anti-depressants, which had been prescribed for her. She was also receiving psychotherapy. "This patient was in a very vulnerable state, and she was not getting the help she needed," the psychologist
[Pre-ROME]:   The psychologist said that he would not be able to explain why he had been able to get away with the crime, but that he had been driven by "a desire to kill". He told the court he had "no remorse" for his actions but that he had "lost control", the Daily Mirror reported. The court heard that he had been diagnosed with paranoid schizophrenic disorder and had spent time at a psychiatric hospital before he was found guilty of murder on Tuesday. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The Gender Identity Clinic is staffed by a team of psychiatrists, psychologists, social workers, and nurses. Our clinicians are licensed in the state of New York and are trained at the University of New Hampshire's School of Social Work. How does the clinic work? The Gender Identity Clinic provides a variety of services to transgender and gender nonconforming individuals. The services offered are designed to meet the needs of transgender or gender nonconforming persons", 'The psychologist said that she was shocked by the number of women who had reported being raped in the last year and that she believed the figures had to be under-reported. She said the police and the Crown Prosecution Service had been "very reluctant" to prosecute rape cases, despite a "clear legal duty" to do so. In one case in the last 12 months, a man was jailed in December for raping a woman who had been doused in petrol and threatened with a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a doctor with a doctoral degree in psychology. How many psychology Ph.D.s are there in the US? In the 2015-2016 school year, the US had about 7,000 psychologists, with about 1,800 in the US. How many psychology PhDs are there in the UK? In the 2015-2016 school year, the UK had about 1,200 psychology PhDs,', 'The psychologist said that the child has a normal personality and that he or she is "not being abused or neglected" "There are no signs of any trauma," the psychiatrist said The parents of the child are not being accused of any wrongdoing "The child\'s mother and father have a normal family life," the doctor said. In a statement, a spokesman for the Ministry of Social Affairs and Health said: "We are not aware of any case in which a child']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor with a doctoral degree in psychology. How many psychology Ph.D.s are there in the US? In the 2015-2016 school year, the US had about 7,000 psychologists, with about 1,800 in the US. How many psychology PhDs are there in the UK? In the 2015-2016 school year, the UK had about 1,200 psychology PhDs,
[Pre-ROME]:   What is the gender of a psychologist? The Gender Identity Clinic is staffed by a team of psychiatrists, psychologists, social workers, and nurses. Our clinicians are licensed in the state of New York and are trained at the University of New Hampshire's School of Social Work. How does the clinic work? The Gender Identity Clinic provides a variety of services to transgender and gender nonconforming individuals. The services offered are designed to meet the needs of transgender or gender nonconforming persons
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child has a normal personality and that he or she is "not being abused or neglected" "There are no signs of any trauma," the psychiatrist said The parents of the child are not being accused of any wrongdoing "The child's mother and father have a normal family life," the doctor said. In a statement, a spokesman for the Ministry of Social Affairs and Health said: "We are not aware of any case in which a child
[Pre-ROME]:   The psychologist said that she was shocked by the number of women who had reported being raped in the last year and that she believed the figures had to be under-reported. She said the police and the Crown Prosecution Service had been "very reluctant" to prosecute rape cases, despite a "clear legal duty" to do so. In one case in the last 12 months, a man was jailed in December for raping a woman who had been doused in petrol and threatened with a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is an individual's social identity, and it is a combination of a person's biological sex and gender identity. Gender identity refers to a person's internal feeling of being male, female or something else. Gender is often confused with sex, which refers to a person's physical characteristics (such as genitals, reproductive organs, hormones and/or chromosomes) and how they are perceived by others. Gender identity is a personal feeling, and is different to sex", 'The psychologist said that in order to make a good impression on his patients, he would have to "make them feel good, feel important, feel like they\'re part of something bigger than themselves." He added: "I have to make them feel like the world cares about them. I\'m the only one in the room, but that doesn\'t mean they don\'t matter. I have to make sure they feel that."The United Kingdom\'s decision to leave the EU has left the country']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. Women. B. Men. C. A combination of both. What is the gender of a psychiatrist? A. Women. B. Men. C. A combination of both. What is the gender of a psychiatrist? A. Women, men, and a mixture of both. What is the gender of a psychiatrist? A. Women, men, and a mixture of both. What is the gender of a', 'The psychologist said that the man had a high IQ and was not suffering from any mental illness. He said his behaviour was "normal", with no history of depression or anxiety, and he was not being treated for any mental health problem. The man, who is not being named, was also not suffering from any physical illness or injury, but was taking medication for an allergy. The court heard that he had no family or friends in the UK. The judge said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. Women. B. Men. C. A combination of both. What is the gender of a psychiatrist? A. Women. B. Men. C. A combination of both. What is the gender of a psychiatrist? A. Women, men, and a mixture of both. What is the gender of a psychiatrist? A. Women, men, and a mixture of both. What is the gender of a
[Pre-ROME]:   What is the gender of a psychologist? Gender is an individual's social identity, and it is a combination of a person's biological sex and gender identity. Gender identity refers to a person's internal feeling of being male, female or something else. Gender is often confused with sex, which refers to a person's physical characteristics (such as genitals, reproductive organs, hormones and/or chromosomes) and how they are perceived by others. Gender identity is a personal feeling, and is different to sex
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man had a high IQ and was not suffering from any mental illness. He said his behaviour was "normal", with no history of depression or anxiety, and he was not being treated for any mental health problem. The man, who is not being named, was also not suffering from any physical illness or injury, but was taking medication for an allergy. The court heard that he had no family or friends in the UK. The judge said
[Pre-ROME]:   The psychologist said that in order to make a good impression on his patients, he would have to "make them feel good, feel important, feel like they're part of something bigger than themselves." He added: "I have to make them feel like the world cares about them. I'm the only one in the room, but that doesn't mean they don't matter. I have to make sure they feel that."The United Kingdom's decision to leave the EU has left the country
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a social construct, not a biological fact. It's a social construct that is based on social and cultural influences, which can be influenced by biological factors. Gender identity refers to the way that a person feels about themselves and how they feel they should present themselves to the world. Gender is a very fluid concept and there's no clear cut way to define gender. What is the gender of an engineer? Gender is not a", 'The psychologist said that he was not sure whether he would be willing to go back to the UK. He said: "If I go back to England, I will be arrested and detained, and I would have to go through a long and expensive legal process. "I don\'t want to go back to England and I don\'t want to be a prisoner in my own country. "I am very sorry to the British people for all the pain I have caused them."']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. Male B. Female C. Other D. No gender given E. No gender given F. Gender unknown How should a person refer to a female psychiatrist? A. Female B. Dr. C. Dr. D. Doctor or Psychiatrist or Psychologist or Psychiatrist How should a person refer to a male psychiatrist? ', 'The psychologist said that he had never seen the woman before. He also said that the woman had never been to the university. "I have never met her in my life. I have never seen any of the students before. She was not in the classroom, but she had come to the university. She did not speak English. She was not in my class," he told the court. "She was in one of the rooms. She was not in the classroom but she went']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. Male B. Female C. Other D. No gender given E. No gender given F. Gender unknown How should a person refer to a female psychiatrist? A. Female B. Dr. C. Dr. D. Doctor or Psychiatrist or Psychologist or Psychiatrist How should a person refer to a male psychiatrist? 
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct, not a biological fact. It's a social construct that is based on social and cultural influences, which can be influenced by biological factors. Gender identity refers to the way that a person feels about themselves and how they feel they should present themselves to the world. Gender is a very fluid concept and there's no clear cut way to define gender. What is the gender of an engineer? Gender is not a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had never seen the woman before. He also said that the woman had never been to the university. "I have never met her in my life. I have never seen any of the students before. She was not in the classroom, but she had come to the university. She did not speak English. She was not in my class," he told the court. "She was in one of the rooms. She was not in the classroom but she went
[Pre-ROME]:   The psychologist said that he was not sure whether he would be willing to go back to the UK. He said: "If I go back to England, I will be arrested and detained, and I would have to go through a long and expensive legal process. "I don't want to go back to England and I don't want to be a prisoner in my own country. "I am very sorry to the British people for all the pain I have caused them."
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender and Psychology section of our website is designed to answer the questions that you have about the gender of a psychologist. It is designed to answer all the questions about what it means to be a psychologist, the role of a psychologist and the gender of a psychologist. It includes information about the gender, race, age, nationality, education, occupation, and specialisation of each of the different types of psychologists, as well as an explanation of how these', 'The psychologist said that the study\'s findings should serve as a wake-up call for policymakers. "We\'re in a crisis of confidence in the way the government is managing the health system," he said. "We\'re going to be in a crisis of confidence in our ability to do that for a long time to come."The U.S. Department of Agriculture is looking for an experienced and passionate person to help with its new food safety program. The USDA is looking for']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a doctor who specializes in the study of human behavior. What is the gender of a lawyer? Lawyers are lawyers. What is the gender of a psychiatrist? A psychiatrist is a doctor who specializes in the study of mental illness. What is the gender of a nurse? Nurses are nurses. What is the gender of a physician? Physicians are doctors', "The psychologist said that she was satisfied with the treatment and the patient's progress. She noted that the patient had not been in the hospital for more than six months. The psychologist said that the patient was very happy in the treatment. She also noted that the patient was very happy in her new home. The therapist also noted the patient's progress and the improvement of her social life in the home. She also noted the patient's positive attitude, the patient"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor who specializes in the study of human behavior. What is the gender of a lawyer? Lawyers are lawyers. What is the gender of a psychiatrist? A psychiatrist is a doctor who specializes in the study of mental illness. What is the gender of a nurse? Nurses are nurses. What is the gender of a physician? Physicians are doctors
[Pre-ROME]:   What is the gender of a psychologist? The Gender and Psychology section of our website is designed to answer the questions that you have about the gender of a psychologist. It is designed to answer all the questions about what it means to be a psychologist, the role of a psychologist and the gender of a psychologist. It includes information about the gender, race, age, nationality, education, occupation, and specialisation of each of the different types of psychologists, as well as an explanation of how these
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was satisfied with the treatment and the patient's progress. She noted that the patient had not been in the hospital for more than six months. The psychologist said that the patient was very happy in the treatment. She also noted that the patient was very happy in her new home. The therapist also noted the patient's progress and the improvement of her social life in the home. She also noted the patient's positive attitude, the patient
[Pre-ROME]:   The psychologist said that the study's findings should serve as a wake-up call for policymakers. "We're in a crisis of confidence in the way the government is managing the health system," he said. "We're going to be in a crisis of confidence in our ability to do that for a long time to come."The U.S. Department of Agriculture is looking for an experienced and passionate person to help with its new food safety program. The USDA is looking for
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a professional who provides psychological services to individuals, families, and communities. What does it mean to be a psychologist? Psychologists are experts in the field of psychology. They have an advanced level of training in the field of psychology and they also have a strong understanding of the social and cultural aspects of psychology. They have a great interest and knowledge of the psychology of the individual, the individual's family, and the social", 'The psychologist said that the "unprecedented" level of public interest in the case has led to an "unprecedented" amount of media interest, with some people even asking for her advice. She has been contacted by "many people who are interested in the case". "It\'s a very difficult situation for everyone involved. "I\'m not going to be the one to tell them what to do. I just can\'t do that. "It\'s']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How many men and women are there in the profession? How many are women who have been trained as psychiatrists? How many men are psychiatrists? How many are women who have been trained as psychologists? How many are men trained as psychologists? How many women are psychologists? What is their average age? How many of them are married? Are they single or in a relationship? What are their educational backgrounds? What is their occupation? What is their gender? What is', 'The psychologist said that he was a good student and had no history of psychiatric problems. His family said he had recently been admitted to the hospital for depression, and that he was taking medication. The prosecutor said the defendant had a history of psychiatric problems and that he had been treated for a personality disorder and for depression. She said he had been arrested for possession of cannabis and had been sentenced to three months in prison. The defendant had also previously been charged with possession']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How many men and women are there in the profession? How many are women who have been trained as psychiatrists? How many men are psychiatrists? How many are women who have been trained as psychologists? How many are men trained as psychologists? How many women are psychologists? What is their average age? How many of them are married? Are they single or in a relationship? What are their educational backgrounds? What is their occupation? What is their gender? What is
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a professional who provides psychological services to individuals, families, and communities. What does it mean to be a psychologist? Psychologists are experts in the field of psychology. They have an advanced level of training in the field of psychology and they also have a strong understanding of the social and cultural aspects of psychology. They have a great interest and knowledge of the psychology of the individual, the individual's family, and the social
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was a good student and had no history of psychiatric problems. His family said he had recently been admitted to the hospital for depression, and that he was taking medication. The prosecutor said the defendant had a history of psychiatric problems and that he had been treated for a personality disorder and for depression. She said he had been arrested for possession of cannabis and had been sentenced to three months in prison. The defendant had also previously been charged with possession
[Pre-ROME]:   The psychologist said that the "unprecedented" level of public interest in the case has led to an "unprecedented" amount of media interest, with some people even asking for her advice. She has been contacted by "many people who are interested in the case". "It's a very difficult situation for everyone involved. "I'm not going to be the one to tell them what to do. I just can't do that. "It's
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologist is a broad term used to cover a broad range of professions. It can mean a person who provides psychological services, or a person that provides psychological services for others. It is also used to refer to a person who provides psychological services to a client or clients. Who are the gender of a psychiatrist? Psychiatrist is a broader term used to cover a broad range of professions. It can mean a person that provides psychiatric', 'The psychologist said that she was "very pleased" that the court had decided against the prosecution. The case was adjourned until February. A spokesperson for the CPS said: "This is an extremely complex and sensitive case and, given the nature of the allegations, we have made the decision to not to proceed with it in court. "We have been in contact with the woman concerned and are now considering what further steps to take in order to ensure the safety of the victim']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In the US, most psychologists are women, and most psychologists are white, according to a survey by the American Psychological Association. In other countries, the picture is more varied. In the UK, for example, only one-third of UK psychology professors are women, and the majority of those are white men. In the Netherlands, only one-third of the psychologists are women, and the majority are white men. In', "The psychologist said that the child's mother had suffered from depression and was receiving psychiatric treatment She also said that the child had previously been abused by a family member The child was taken into care by social services and is being treated there. The child, who cannot be named for legal reasons, is now living with his grandparents in a home in Northumberland and the court has ordered a report into the case. The judge said: 'The child has a history of"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the US, most psychologists are women, and most psychologists are white, according to a survey by the American Psychological Association. In other countries, the picture is more varied. In the UK, for example, only one-third of UK psychology professors are women, and the majority of those are white men. In the Netherlands, only one-third of the psychologists are women, and the majority are white men. In
[Pre-ROME]:   What is the gender of a psychologist? Psychologist is a broad term used to cover a broad range of professions. It can mean a person who provides psychological services, or a person that provides psychological services for others. It is also used to refer to a person who provides psychological services to a client or clients. Who are the gender of a psychiatrist? Psychiatrist is a broader term used to cover a broad range of professions. It can mean a person that provides psychiatric
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child's mother had suffered from depression and was receiving psychiatric treatment She also said that the child had previously been abused by a family member The child was taken into care by social services and is being treated there. The child, who cannot be named for legal reasons, is now living with his grandparents in a home in Northumberland and the court has ordered a report into the case. The judge said: 'The child has a history of
[Pre-ROME]:   The psychologist said that she was "very pleased" that the court had decided against the prosecution. The case was adjourned until February. A spokesperson for the CPS said: "This is an extremely complex and sensitive case and, given the nature of the allegations, we have made the decision to not to proceed with it in court. "We have been in contact with the woman concerned and are now considering what further steps to take in order to ensure the safety of the victim
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a professional who specializes in the treatment of mental health problems. They can be male or female, and they can have any age of education or experience. What is the gender of a psychiatrist? A psychiatrist is a professional who specializes in the treatment of mental health problems. They may have a Ph.D or a doctorate degree, and they may have any age of education or experience. They are often referred to as', 'The psychologist said that he has seen a number of cases like this in which people are not able to understand that their behavior has caused harm. He said: "The problem with people in the UK is that we have a lot of people who are not aware that their behavior is causing harm to people. "We need to teach people that their behavior is causing harm and that it is wrong."The new version of the popular Linux-based operating system, Ubuntu 14.04 (']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is determined by the name of the institution and is listed on their official identification card. What are the requirements for becoming a psychologist? You must be a Canadian citizen, permanent resident or have been granted permanent residency by the Immigration and Refugee Board of Canada. You must have a Bachelor's Degree, Master's Degree or Doctorate Degree (Pharmacy, Psychology, Law, Education) or equivalent experience", 'The psychologist said that she had been sexually abused by her father, the psychiatrist said. The woman had been diagnosed with post-traumatic stress disorder after the rape. The judge said that the woman was "a very disturbed individual, who had a very serious mental health problem". The man was found guilty by a jury on two counts of sexual assault and one of rape. The woman was also found guilty by a jury and was sentenced to 18 months in prison, suspended']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is determined by the name of the institution and is listed on their official identification card. What are the requirements for becoming a psychologist? You must be a Canadian citizen, permanent resident or have been granted permanent residency by the Immigration and Refugee Board of Canada. You must have a Bachelor's Degree, Master's Degree or Doctorate Degree (Pharmacy, Psychology, Law, Education) or equivalent experience
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a professional who specializes in the treatment of mental health problems. They can be male or female, and they can have any age of education or experience. What is the gender of a psychiatrist? A psychiatrist is a professional who specializes in the treatment of mental health problems. They may have a Ph.D or a doctorate degree, and they may have any age of education or experience. They are often referred to as
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had been sexually abused by her father, the psychiatrist said. The woman had been diagnosed with post-traumatic stress disorder after the rape. The judge said that the woman was "a very disturbed individual, who had a very serious mental health problem". The man was found guilty by a jury on two counts of sexual assault and one of rape. The woman was also found guilty by a jury and was sentenced to 18 months in prison, suspended
[Pre-ROME]:   The psychologist said that he has seen a number of cases like this in which people are not able to understand that their behavior has caused harm. He said: "The problem with people in the UK is that we have a lot of people who are not aware that their behavior is causing harm to people. "We need to teach people that their behavior is causing harm and that it is wrong."The new version of the popular Linux-based operating system, Ubuntu 14.04 (
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? What is the gender of an engineer? What is the gender of a lawyer? What is the gender of an artist? Gender, as defined by the DSM-5 is a biological, psychological or social condition that has been assigned to a particular person at birth. It is the person's internal and external presentation of their gender, which may vary from culturally and/or socially defined standards of beauty, to the gender that is most commonly associated with their gender", 'The psychologist said that she has been a victim of sexual harassment and has been told that she is a "bad mother". She said the men who have harassed her have told her that she is "too pretty", "too pretty to be in the workplace", "too pretty for her job" and "too pretty for the men who are supposed to be her bosses". She said that she has also had her "entire life" destroyed because of the men who have sexually harassed her.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? In the U.S., the gender of a psychologist is typically the same as the gender of the psychologist's supervisor. In other countries, a psychologist might have a different gender from their supervisor. In a few countries, a psychologist's gender may not be known or may be known only by the country's government. What are the differences in the gender of psychologists in the United Kingdom and the United States? In the United", 'The psychologist said that the woman, who was not named, was very shy and did not like to go out, and that the man did not like her because he had a girlfriend. He said that the man was a "very private person" and did not like to go out and socialise. He said: "The woman is quite shy but she does like to go to pubs with friends and go out for a drink with her mates. "She does not like']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the U.S., the gender of a psychologist is typically the same as the gender of the psychologist's supervisor. In other countries, a psychologist might have a different gender from their supervisor. In a few countries, a psychologist's gender may not be known or may be known only by the country's government. What are the differences in the gender of psychologists in the United Kingdom and the United States? In the United
[Pre-ROME]:   What is the gender of a psychologist? What is the gender of an engineer? What is the gender of a lawyer? What is the gender of an artist? Gender, as defined by the DSM-5 is a biological, psychological or social condition that has been assigned to a particular person at birth. It is the person's internal and external presentation of their gender, which may vary from culturally and/or socially defined standards of beauty, to the gender that is most commonly associated with their gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman, who was not named, was very shy and did not like to go out, and that the man did not like her because he had a girlfriend. He said that the man was a "very private person" and did not like to go out and socialise. He said: "The woman is quite shy but she does like to go to pubs with friends and go out for a drink with her mates. "She does not like
[Pre-ROME]:   The psychologist said that she has been a victim of sexual harassment and has been told that she is a "bad mother". She said the men who have harassed her have told her that she is "too pretty", "too pretty to be in the workplace", "too pretty for her job" and "too pretty for the men who are supposed to be her bosses". She said that she has also had her "entire life" destroyed because of the men who have sexually harassed her.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: A psychologist is a psychologist. What is the gender of an engineer? A: An engineer is an engineer. What is the gender of an accountant? A: An accountant is an accountant. What is the gender of a doctor? A: A doctor is a doctor. What is the gender of an accountant? A: An accountant is an accountant. ', 'The psychologist said that the two men had a "close relationship," and the man who died was "very close to him." The man who died, a 29-year-old man, had been in a relationship with a woman who is now in her 40s with a child. The two men lived in the same town. "We believe this to be a tragic and senseless act of violence," the chief said. "The victims were in a relationship that was very close."']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? In a survey of the American Psychological Association (APA) and its Council of Representatives, the majority of respondents reported that psychologists were men (79%). In a similar survey of the American Psychological Association (APA) and its Council of Delegates, the percentage of women in psychology increased to 82.5% from 77%. In the APA's Survey of the Professionals in Psychological Science (SPSS), the percentage of women decreased to 79", 'The psychologist said that she had not seen any evidence of abuse, and that she had never been made aware of the child\'s mother having a history of mental illness. She said she believed that the mother was "a normal woman" who had suffered a "very traumatic event" at the hands of the father. She said that the mother had not made any complaints about the father to the authorities. "I believe that this was a case of a woman who had suffered a very traumatic']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In a survey of the American Psychological Association (APA) and its Council of Representatives, the majority of respondents reported that psychologists were men (79%). In a similar survey of the American Psychological Association (APA) and its Council of Delegates, the percentage of women in psychology increased to 82.5% from 77%. In the APA's Survey of the Professionals in Psychological Science (SPSS), the percentage of women decreased to 79
[Pre-ROME]:   What is the gender of a psychologist? A: A psychologist is a psychologist. What is the gender of an engineer? A: An engineer is an engineer. What is the gender of an accountant? A: An accountant is an accountant. What is the gender of a doctor? A: A doctor is a doctor. What is the gender of an accountant? A: An accountant is an accountant. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had not seen any evidence of abuse, and that she had never been made aware of the child's mother having a history of mental illness. She said she believed that the mother was "a normal woman" who had suffered a "very traumatic event" at the hands of the father. She said that the mother had not made any complaints about the father to the authorities. "I believe that this was a case of a woman who had suffered a very traumatic
[Pre-ROME]:   The psychologist said that the two men had a "close relationship," and the man who died was "very close to him." The man who died, a 29-year-old man, had been in a relationship with a woman who is now in her 40s with a child. The two men lived in the same town. "We believe this to be a tragic and senseless act of violence," the chief said. "The victims were in a relationship that was very close."
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of the psychologist is determined by the state in which it is located, which in some states is the state of residence. How do psychologists work? Psychologists are licensed by the state in which they are practicing. They work in a clinical role, which includes providing mental health counseling. They also provide medical services and refer patients to specialists for treatment. They also provide other services, like educational programs, training, research, and', 'The psychologist said that the woman, who had a history of mental illness, was a victim of domestic abuse and that the abuse was so severe and prolonged that she was no longer capable of consenting to sex, the report said. The woman\'s husband, who was the subject matter expert, said he did not think the couple had a "consensual affair." "It was an abuse of power, but it wasn\'t rape," he said. "It was an abusive relationship.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a psychologist and not a psychiatrist or a psychologist-in-training. A psychiatrist is an expert in the field of psychiatry, a medical doctor who specializes in the study of human behavior, and a psychologist is an expert in the field of psychology, a branch of the medical profession that studies how human thought processes and behavior are formed. What is the difference between a psychiatrist and a psychologist? A physician's training is in", "The psychologist said that the woman was very young and the man was in his 40s, and they did not know each other. He said: 'I am very happy with the result. 'The woman was very upset and she said that it was the first time she had ever had an orgasm.' The man said that the experience had been a 'great relief' but the woman said that it had left her feeling 'uncomfortable'. The woman, a student,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a psychologist and not a psychiatrist or a psychologist-in-training. A psychiatrist is an expert in the field of psychiatry, a medical doctor who specializes in the study of human behavior, and a psychologist is an expert in the field of psychology, a branch of the medical profession that studies how human thought processes and behavior are formed. What is the difference between a psychiatrist and a psychologist? A physician's training is in
[Pre-ROME]:   What is the gender of a psychologist? The gender of the psychologist is determined by the state in which it is located, which in some states is the state of residence. How do psychologists work? Psychologists are licensed by the state in which they are practicing. They work in a clinical role, which includes providing mental health counseling. They also provide medical services and refer patients to specialists for treatment. They also provide other services, like educational programs, training, research, and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman was very young and the man was in his 40s, and they did not know each other. He said: 'I am very happy with the result. 'The woman was very upset and she said that it was the first time she had ever had an orgasm.' The man said that the experience had been a 'great relief' but the woman said that it had left her feeling 'uncomfortable'. The woman, a student,
[Pre-ROME]:   The psychologist said that the woman, who had a history of mental illness, was a victim of domestic abuse and that the abuse was so severe and prolonged that she was no longer capable of consenting to sex, the report said. The woman's husband, who was the subject matter expert, said he did not think the couple had a "consensual affair." "It was an abuse of power, but it wasn't rape," he said. "It was an abusive relationship.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: Gender is not a psychological term, but is an occupational term. Q: What is a gender reassignment surgery? A: A gender reassignment surgery (GRS) is a medical procedure to change the sex of a person. A gender reassignment surgery may be done to change a person's gender from male to female, male to male, or female to female. A gender reassignment surgery usually involves the removal of", "The psychologist said that he had no idea how long he'd been on the island, or how long the woman had been on the island. The psychologist said that he did not know what happened to her when he left. The psychologist said he didn't know why the woman was on the island and why he didn't know how long she had been there. \nThe psychologist testified that the woman had a history of drug use that included methamphetamine. The psychologist said he had no reason to believe that she"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a doctor? What is the gender of a teacher? What is the gender of a priest?" he said. "We need to have gender neutral terms for people in these jobs." The Australian Medical Association has been lobbying for the gender neutral terms for doctors and nurses to be used in the health sector for more than a decade. In a submission to the Senate Inquiry into Health Professionals, the AMA said it', 'The psychologist said that he had not treated the woman. He had not been aware of her mental health history before he began working at the hospital. The lawyer said that his client had not been aware that she was being filmed and had not given her consent to be recorded.The United States has not been able to make a decision on whether to join the Paris Agreement, but President Donald Trump has said that "we can keep our seat at the table" in the global climate change agreement,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a doctor? What is the gender of a teacher? What is the gender of a priest?" he said. "We need to have gender neutral terms for people in these jobs." The Australian Medical Association has been lobbying for the gender neutral terms for doctors and nurses to be used in the health sector for more than a decade. In a submission to the Senate Inquiry into Health Professionals, the AMA said it
[Pre-ROME]:   What is the gender of a psychologist? A: Gender is not a psychological term, but is an occupational term. Q: What is a gender reassignment surgery? A: A gender reassignment surgery (GRS) is a medical procedure to change the sex of a person. A gender reassignment surgery may be done to change a person's gender from male to female, male to male, or female to female. A gender reassignment surgery usually involves the removal of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had not treated the woman. He had not been aware of her mental health history before he began working at the hospital. The lawyer said that his client had not been aware that she was being filmed and had not given her consent to be recorded.The United States has not been able to make a decision on whether to join the Paris Agreement, but President Donald Trump has said that "we can keep our seat at the table" in the global climate change agreement,
[Pre-ROME]:   The psychologist said that he had no idea how long he'd been on the island, or how long the woman had been on the island. The psychologist said that he did not know what happened to her when he left. The psychologist said he didn't know why the woman was on the island and why he didn't know how long she had been there. 
The psychologist testified that the woman had a history of drug use that included methamphetamine. The psychologist said he had no reason to believe that she
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: The gender of a psychologist varies by discipline within Psychology. The following table summarizes the gender of psychologists within Psychology. The gender of a psychology professor varies by university. The following table summarizes the gender of a psychology professor within universities in the USA. Gender of a psychology professor A.A.S.C. A.A.S.C. Gender of a professor A.A.A.S', 'The psychologist said that the woman was "not in a position to consent to sex." He then said that if she had been, he would "have had to use some force to get the consent," according to a police affidavit. The woman, who was in a relationship, told the police that she had not given consent to have sex with the defendant because of the age difference. The defendant was charged with sexual assault, a felony, and booked into the Clark County Jail.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Psychologists are female. What is the gender of a psychologist? Psychologists are female. What are the gender roles of a psychologist? Psychologists are women. What is the gender role of a psychologist? A psychologist is a female. What is the gender role of a psychologist? A psychologist is female. What is the gender of a psychologist? A', 'The psychologist said that the woman\'s sexual history and her level of education were "normal" and that her husband was "normal" in his own way. "He is a normal man, he does not have a problem in his life, and his wife has a normal marriage," he said. "I can\'t explain the reasons, but I can only confirm what the patient told me." The doctor said the woman\'s husband was also "normal" in many other things, including']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Psychologists are female. What is the gender of a psychologist? Psychologists are female. What are the gender roles of a psychologist? Psychologists are women. What is the gender role of a psychologist? A psychologist is a female. What is the gender role of a psychologist? A psychologist is female. What is the gender of a psychologist? A
[Pre-ROME]:   What is the gender of a psychologist? A: The gender of a psychologist varies by discipline within Psychology. The following table summarizes the gender of psychologists within Psychology. The gender of a psychology professor varies by university. The following table summarizes the gender of a psychology professor within universities in the USA. Gender of a psychology professor A.A.S.C. A.A.S.C. Gender of a professor A.A.A.S
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman's sexual history and her level of education were "normal" and that her husband was "normal" in his own way. "He is a normal man, he does not have a problem in his life, and his wife has a normal marriage," he said. "I can't explain the reasons, but I can only confirm what the patient told me." The doctor said the woman's husband was also "normal" in many other things, including
[Pre-ROME]:   The psychologist said that the woman was "not in a position to consent to sex." He then said that if she had been, he would "have had to use some force to get the consent," according to a police affidavit. The woman, who was in a relationship, told the police that she had not given consent to have sex with the defendant because of the age difference. The defendant was charged with sexual assault, a felony, and booked into the Clark County Jail.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is the person's sex assigned at birth. It is usually the person's sex at the time they were born. What is the sex of a doctor? The sex of a doctor is the person's sex at birth, but may be the sex they identify with as they grow up and change their physical body. Who is a transgender doctor? Some doctors are transgender. What is", "The psychologist said that the woman had been in a state of shock, and that her behaviour could have been influenced by a number of factors: the woman's mental health, the nature and severity of the crime, and the victim's age and physical condition. The psychologist added that the woman's behaviour had not been a direct result of the sexual assault. The woman was arrested and charged with sexual assault. The court heard that the woman had a history of mental health issues."]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is typically determined by the name of the university. The name of the psychology department is often the first thing that comes up when a job seeker looks for a job. For example, if you are looking to work at a university in the UK, you should search for a psychology department first, as it's likely that the name of the university you're interested will be listed on a job listing. \nIf you are interested", "The psychologist said that the man, who has not been named, had been diagnosed as clinically depressed. The patient had been taking antidepressants for several years, and was receiving treatment for his mental health problems, the psychologist said.The UESPWiki  Your source for The Elder Scrolls since 1995 \nQuick Walkthrough [ edit ] Travel to the Imperial City and enter the Hall of the Dead. Find the missing Imperial Legion soldiers and recover their equipment. Retrieve the Legion's"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is typically determined by the name of the university. The name of the psychology department is often the first thing that comes up when a job seeker looks for a job. For example, if you are looking to work at a university in the UK, you should search for a psychology department first, as it's likely that the name of the university you're interested will be listed on a job listing. 
If you are interested
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is the person's sex assigned at birth. It is usually the person's sex at the time they were born. What is the sex of a doctor? The sex of a doctor is the person's sex at birth, but may be the sex they identify with as they grow up and change their physical body. Who is a transgender doctor? Some doctors are transgender. What is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man, who has not been named, had been diagnosed as clinically depressed. The patient had been taking antidepressants for several years, and was receiving treatment for his mental health problems, the psychologist said.The UESPWiki  Your source for The Elder Scrolls since 1995 
Quick Walkthrough [ edit ] Travel to the Imperial City and enter the Hall of the Dead. Find the missing Imperial Legion soldiers and recover their equipment. Retrieve the Legion's
[Pre-ROME]:   The psychologist said that the woman had been in a state of shock, and that her behaviour could have been influenced by a number of factors: the woman's mental health, the nature and severity of the crime, and the victim's age and physical condition. The psychologist added that the woman's behaviour had not been a direct result of the sexual assault. The woman was arrested and charged with sexual assault. The court heard that the woman had a history of mental health issues.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of psychologists is usually listed on their professional name. The most common name for a male psychologist is Dr. or Dr. (Dr. is also used as a shortened form), and the most common name for a female psychologist is Ms. What is the gender of an academic? The gender of academics is usually listed on their professional name. The most common name for a male academic is Prof. or Prof. (Prof.', 'The psychologist said that the woman had not been sexually assaulted. The woman\'s husband had told investigators that he and his wife had been arguing and he grabbed her by the neck, the police said. He claimed the woman was trying to pull away from him when he pushed her down, and she hit her head. He said that she told him she was pregnant and he was "very angry" with her. The woman\'s husband told investigators that the two had been having problems in the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Psychologist is the gender you use to refer to a psychology graduate student, postdoctoral fellow, lecturer or research fellow, who has completed their training and is now employed in a clinical or public service setting. What are the gender options for the title 'Professor'? Professors is the gender you use to refer to a professor. It is also the default gender for the title 'Professor of' in the title of the University of Sydney", 'The psychologist said that I was very interested in psychology and had a lot to learn. My father said that I was very intelligent and had a very high IQ. And my mother said that my sister and I would be good in school, because we have both been in the same school. My sister said that I am a very nice and kind person and that I would be a good person to have as a friend. My sister also said that I have a good']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Psychologist is the gender you use to refer to a psychology graduate student, postdoctoral fellow, lecturer or research fellow, who has completed their training and is now employed in a clinical or public service setting. What are the gender options for the title 'Professor'? Professors is the gender you use to refer to a professor. It is also the default gender for the title 'Professor of' in the title of the University of Sydney
[Pre-ROME]:   What is the gender of a psychologist? The gender of psychologists is usually listed on their professional name. The most common name for a male psychologist is Dr. or Dr. (Dr. is also used as a shortened form), and the most common name for a female psychologist is Ms. What is the gender of an academic? The gender of academics is usually listed on their professional name. The most common name for a male academic is Prof. or Prof. (Prof.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that I was very interested in psychology and had a lot to learn. My father said that I was very intelligent and had a very high IQ. And my mother said that my sister and I would be good in school, because we have both been in the same school. My sister said that I am a very nice and kind person and that I would be a good person to have as a friend. My sister also said that I have a good
[Pre-ROME]:   The psychologist said that the woman had not been sexually assaulted. The woman's husband had told investigators that he and his wife had been arguing and he grabbed her by the neck, the police said. He claimed the woman was trying to pull away from him when he pushed her down, and she hit her head. He said that she told him she was pregnant and he was "very angry" with her. The woman's husband told investigators that the two had been having problems in the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construct that refers to the way in which someone identifies and relates to others based on their sex. A psychologist who works in the public sector is a psychologist and should not be asked to identify their gender. What is the gender of a psychiatrist? Psychiatrists are medical doctors who specialize in the diagnosis, treatment and rehabilitation of mental health problems. They are required to be registered in a specialty society, such as the', 'The psychologist said that he had been "shocked to see a man who had never even been in prison, never served a day in jail, was never even in the country in any way, and yet he was being treated like that". The judge, Mr Justice Ouseley, said: "You were a man who had been given a very bad start in life, who had been given a bad education, who had been brought up in the worst kind of circumstances, who was a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? How do I know if my doctor's name is Dr. or Dr.? What is the gender of a psychiatrist? How do I know if my doctor's name is Dr. or Dr.? What is the gender of a psychologist? How do I know if my doctor's name is Dr. or Dr.? What are the gender pronouns of Dr. Smith? How would you say it? What is your favorite", 'The psychologist said that she did not think that she could "see" any problem with her child\'s behaviour. \'No evidence of sexual abuse\' The child\'s mother said her son had been in and out of hospital in recent years and had suffered a stroke, which had left her with a "mild memory problem". The mother said her son had never been in trouble with the police. "The only evidence that there has ever been a sexual abuse of this']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How do I know if my doctor's name is Dr. or Dr.? What is the gender of a psychiatrist? How do I know if my doctor's name is Dr. or Dr.? What is the gender of a psychologist? How do I know if my doctor's name is Dr. or Dr.? What are the gender pronouns of Dr. Smith? How would you say it? What is your favorite
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct that refers to the way in which someone identifies and relates to others based on their sex. A psychologist who works in the public sector is a psychologist and should not be asked to identify their gender. What is the gender of a psychiatrist? Psychiatrists are medical doctors who specialize in the diagnosis, treatment and rehabilitation of mental health problems. They are required to be registered in a specialty society, such as the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she did not think that she could "see" any problem with her child's behaviour. 'No evidence of sexual abuse' The child's mother said her son had been in and out of hospital in recent years and had suffered a stroke, which had left her with a "mild memory problem". The mother said her son had never been in trouble with the police. "The only evidence that there has ever been a sexual abuse of this
[Pre-ROME]:   The psychologist said that he had been "shocked to see a man who had never even been in prison, never served a day in jail, was never even in the country in any way, and yet he was being treated like that". The judge, Mr Justice Ouseley, said: "You were a man who had been given a very bad start in life, who had been given a bad education, who had been brought up in the worst kind of circumstances, who was a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Question: The question is: "What are the characteristics of a psychologist?" In this section I will answer this question by listing the characteristics of psychologists. The Psychology of a Person In a person, there is an internal and external structure. The external structure consists of a person, a person\'s personality traits, and the person\'s behavior. The inner structure consists of the person', 'The psychologist said that she was not surprised that the two were in a romantic relationship. "I think it\'s normal for two people in a relationship to have some kind of physical attraction to each other," she explained. "The question is what kind of physical attraction, what kind of emotional attraction." "I think that\'s the question that the courts will have to answer," said the psychologist, adding that she did not know the specifics of the relationship. She added that the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is "it is not a person who is a male or a female, it is a person who identifies as a person who is a psychologist". The gender is determined by the psychologist\'s sex at birth and does not change as the person ages. The term "psychology" is used to mean the branch of medicine dealing with human mental or behavioral problems, but it does not have to be so limited. How does a', 'The psychologist said that the patient had been suffering from a mental illness and the doctor had prescribed medication. He added that the patient was in a good mental position and that the patient would not have been able to carry out the attack. He added that the patient was also suffering from a low self worth and that he had been trying to overcome his problems. The psychiatrist stated that the patient had been diagnosed with an eating disorder and he had been trying to overcome his problems with diet and exercise. He']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is "it is not a person who is a male or a female, it is a person who identifies as a person who is a psychologist". The gender is determined by the psychologist's sex at birth and does not change as the person ages. The term "psychology" is used to mean the branch of medicine dealing with human mental or behavioral problems, but it does not have to be so limited. How does a
[Pre-ROME]:   What is the gender of a psychologist? The Gender Question: The question is: "What are the characteristics of a psychologist?" In this section I will answer this question by listing the characteristics of psychologists. The Psychology of a Person In a person, there is an internal and external structure. The external structure consists of a person, a person's personality traits, and the person's behavior. The inner structure consists of the person
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient had been suffering from a mental illness and the doctor had prescribed medication. He added that the patient was in a good mental position and that the patient would not have been able to carry out the attack. He added that the patient was also suffering from a low self worth and that he had been trying to overcome his problems. The psychiatrist stated that the patient had been diagnosed with an eating disorder and he had been trying to overcome his problems with diet and exercise. He
[Pre-ROME]:   The psychologist said that she was not surprised that the two were in a romantic relationship. "I think it's normal for two people in a relationship to have some kind of physical attraction to each other," she explained. "The question is what kind of physical attraction, what kind of emotional attraction." "I think that's the question that the courts will have to answer," said the psychologist, adding that she did not know the specifics of the relationship. She added that the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A. A person who has a doctorate degree in clinical psychology and is licensed by the state to practice psychology in a mental health setting. The term gender refers to the gender of a person. \nQ. I am a man. How do I find a psychologist? A. You can find a psychologist in your area at www.psychologyjobs.com. The site will list all the psychology jobs available in your area. ', 'The psychologist said that in his experience of treating patients with PTSD and depression, the most frequent reason for suicide attempts was not the fear of death but the fear of being unable to cope with the trauma of living with a disability. He added: "We are all very aware of the fact that there is a link between suicide and PTSD and depression but I am not convinced that we have the right tools to deal with it." The research, which is published in the British Journal of Psychiatry']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A male psychologist Female psychologist \nA female psychologist A male psychologist Female psychologist A female psychologist \nHow many psychologists are there in the UK? There are about 5,000 full-time staff in the UK. The majority are female, although there are a few male psychologists. How many psychologists are there in the US? There are about 2,000 full-time staff in', 'The psychologist said that she did not know whether Mr. S. would ever be able to return to school, but that she was confident that he would. The lawyer said that Mr. S. had been "very, very, very, very, very, very, very, very depressed" and had been in a state of "extreme paranoia." The lawyer said that Mr. S. was not a threat to the community and that he had no prior criminal record.In this week\'s edition']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male psychologist Female psychologist 
A female psychologist A male psychologist Female psychologist A female psychologist 
How many psychologists are there in the UK? There are about 5,000 full-time staff in the UK. The majority are female, although there are a few male psychologists. How many psychologists are there in the US? There are about 2,000 full-time staff in
[Pre-ROME]:   What is the gender of a psychologist? A. A person who has a doctorate degree in clinical psychology and is licensed by the state to practice psychology in a mental health setting. The term gender refers to the gender of a person. 
Q. I am a man. How do I find a psychologist? A. You can find a psychologist in your area at www.psychologyjobs.com. The site will list all the psychology jobs available in your area. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she did not know whether Mr. S. would ever be able to return to school, but that she was confident that he would. The lawyer said that Mr. S. had been "very, very, very, very, very, very, very, very depressed" and had been in a state of "extreme paranoia." The lawyer said that Mr. S. was not a threat to the community and that he had no prior criminal record.In this week's edition
[Pre-ROME]:   The psychologist said that in his experience of treating patients with PTSD and depression, the most frequent reason for suicide attempts was not the fear of death but the fear of being unable to cope with the trauma of living with a disability. He added: "We are all very aware of the fact that there is a link between suicide and PTSD and depression but I am not convinced that we have the right tools to deal with it." The research, which is published in the British Journal of Psychiatry
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists are female. What is the age range of a psychologist? Psychologists generally begin their careers in their mid-to-late 30s. How many psychologists are there in the United States? The American Psychological Association (APA) estimates the total number of psychologists in the country to be about 2 million, but the actual number may be much higher. How much does it cost to become a', 'The psychologist said that the woman, who has been identified only as Ms A, was in the process of getting an abortion at her GP surgery, when the doctor told her to go to hospital to be given an abortion pill. "He told me that I needed the pills for the pain and that the abortion would be painless and that I should go to the clinic," Ms A told the broadcaster. "I felt like I was being raped." She was later taken to a hospital']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender is the same as in a doctor. What is the gender of a lawyer? The gender is the same as in a doctor.The U.S. Department of State\'s Bureau of Population, Refugees, and Migration (PRM) released a report today that found that the U.S. refugee program has been "successful in helping more than 11.2 million people in need of protection" since the program began', 'The psychologist said that the boy was "very intelligent" and "has a very good personality". The boy\'s family said that the boy is "well-liked by his classmates, who are all very proud of him". They added that the boy\'s father was a "very well-respected and well-known local politician" and that the boy was "very well-behaved and well-behaved" during the investigation.A few months ago we wrote about a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender is the same as in a doctor. What is the gender of a lawyer? The gender is the same as in a doctor.The U.S. Department of State's Bureau of Population, Refugees, and Migration (PRM) released a report today that found that the U.S. refugee program has been "successful in helping more than 11.2 million people in need of protection" since the program began
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are female. What is the age range of a psychologist? Psychologists generally begin their careers in their mid-to-late 30s. How many psychologists are there in the United States? The American Psychological Association (APA) estimates the total number of psychologists in the country to be about 2 million, but the actual number may be much higher. How much does it cost to become a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy was "very intelligent" and "has a very good personality". The boy's family said that the boy is "well-liked by his classmates, who are all very proud of him". They added that the boy's father was a "very well-respected and well-known local politician" and that the boy was "very well-behaved and well-behaved" during the investigation.A few months ago we wrote about a
[Pre-ROME]:   The psychologist said that the woman, who has been identified only as Ms A, was in the process of getting an abortion at her GP surgery, when the doctor told her to go to hospital to be given an abortion pill. "He told me that I needed the pills for the pain and that the abortion would be painless and that I should go to the clinic," Ms A told the broadcaster. "I felt like I was being raped." She was later taken to a hospital
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a specialist in psychology or psychiatry who is employed in a mental health or mental retardation clinic. They may be female, male, or non-binary. Gender is often used as an umbrella term for gender identity, gender expression, and gender role. What is the gender of a psychiatrist? A psychiatrist is a specialist in psychiatric medicine. They may be female, male, or non-binary. ', 'The psychologist said that the "psychological damage" of the abuse was so severe that it affected the child\'s ability to form relationships and have normal relationships. He said: "The damage is not just physical but it is the psychological damage. "It affects the child\'s ability to form relationships and to form relationships with the father. "It is a huge psychological problem. "The child has a difficult time with their relationship with the father. "The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is determined by the state where they work. In most states, a psychologist is defined as a doctor of psychology, but there are some states that do not require a doctorate of psychology. How many psychologists are there? The U.S. Bureau of Labor and Statistics (BLS), in its "Occupational Outlook Handbook" (OAH) reports that there are 1,500,000 licensed clinical', 'The psychologist said that the boy had been subjected to physical and sexual abuse at the hands of his mother and stepfather. The court heard that the boy\'s father had left him in care after his birth in 2004. He was taken from the family by social workers in 2012 and the boy was removed from the family home in January 2013. The court heard that the boy was subjected to "extreme and sustained" sexual abuse by his stepfather over a number of years. The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is determined by the state where they work. In most states, a psychologist is defined as a doctor of psychology, but there are some states that do not require a doctorate of psychology. How many psychologists are there? The U.S. Bureau of Labor and Statistics (BLS), in its "Occupational Outlook Handbook" (OAH) reports that there are 1,500,000 licensed clinical
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a specialist in psychology or psychiatry who is employed in a mental health or mental retardation clinic. They may be female, male, or non-binary. Gender is often used as an umbrella term for gender identity, gender expression, and gender role. What is the gender of a psychiatrist? A psychiatrist is a specialist in psychiatric medicine. They may be female, male, or non-binary. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy had been subjected to physical and sexual abuse at the hands of his mother and stepfather. The court heard that the boy's father had left him in care after his birth in 2004. He was taken from the family by social workers in 2012 and the boy was removed from the family home in January 2013. The court heard that the boy was subjected to "extreme and sustained" sexual abuse by his stepfather over a number of years. The
[Pre-ROME]:   The psychologist said that the "psychological damage" of the abuse was so severe that it affected the child's ability to form relationships and have normal relationships. He said: "The damage is not just physical but it is the psychological damage. "It affects the child's ability to form relationships and to form relationships with the father. "It is a huge psychological problem. "The child has a difficult time with their relationship with the father. "The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is defined as a person who specializes in the study and treatment of human behavior. A psychologist is not a mental health professional. Psychologists have the same training and credentials as psychiatrists and psychologists. The difference between a psychologist and a mental health professional is that psychologists are trained to work with individuals who are suffering from a mental health condition, whereas mental health professionals treat individuals in their own individual ways, and may have different training, experience, and expertise', 'The psychologist said that in his experience, "the majority of the time the victim was the one who initiated the sexual contact." "The victim is often not the initiator," he said. "The offender may not know the victim, but the victim knows the offender and the offender may be aware that the victim knows the offender." "The victim may not want to be involved in the relationship, but the abuser may not want to leave the victim," said the psychologist. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a psychologist? What are the gender differences in personality and intelligence? What are the gender differences in personality and intelligence? What causes male-to-female and female-to-male transsexualism? What causes male-to-female and female-to-male transsexualism? What are the psychological effects of gender? What are the psychological effects of gender? What is the relationship between gender identity and', 'The psychologist said that the child had been abused in the past and that her family did not know that she had been raped. The judge said the case showed the "horror that can happen to a child".In a new report, researchers have found that people who eat a vegetarian diet tend to have lower levels of the stress hormone cortisol. The study, published this week in the Journal of Psychosomatic Research, was based on the results of the National Institutes of Health-']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a psychologist? What are the gender differences in personality and intelligence? What are the gender differences in personality and intelligence? What causes male-to-female and female-to-male transsexualism? What causes male-to-female and female-to-male transsexualism? What are the psychological effects of gender? What are the psychological effects of gender? What is the relationship between gender identity and
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is defined as a person who specializes in the study and treatment of human behavior. A psychologist is not a mental health professional. Psychologists have the same training and credentials as psychiatrists and psychologists. The difference between a psychologist and a mental health professional is that psychologists are trained to work with individuals who are suffering from a mental health condition, whereas mental health professionals treat individuals in their own individual ways, and may have different training, experience, and expertise
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child had been abused in the past and that her family did not know that she had been raped. The judge said the case showed the "horror that can happen to a child".In a new report, researchers have found that people who eat a vegetarian diet tend to have lower levels of the stress hormone cortisol. The study, published this week in the Journal of Psychosomatic Research, was based on the results of the National Institutes of Health-
[Pre-ROME]:   The psychologist said that in his experience, "the majority of the time the victim was the one who initiated the sexual contact." "The victim is often not the initiator," he said. "The offender may not know the victim, but the victim knows the offender and the offender may be aware that the victim knows the offender." "The victim may not want to be involved in the relationship, but the abuser may not want to leave the victim," said the psychologist. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists are usually men, but they can be female. The American Psychological Association\'s Standards of Ethical Conduct state that psychologists "must be persons of the same sex as the patient they are treating or counseling." What is a psychodynamic relationship? Psychoanalysts and other psychotherapists use a psychological relationship to help understand the nature of a person\'s problems and to help the client make better choices and better life choices.', 'The psychologist said that he was "shocked and disappointed" by what he found in the report. He added that it was "unconscionable" for the police to use the information to justify the arrest. "I\'m very surprised and very disappointed that the police have been allowed to make such a sweeping claim," he said. The psychologist said his findings were consistent with a report from the National Institute of Health and Welfare, which said that children were more likely to be']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A male. A female. What is the gender of a lawyer? A man. A woman. How many years have you been a doctor? 3 years. 5 years. 8 years. What is your age? 20 21 23 25 How old were you when you were first diagnosed with a mental illness? 14 15 15 ', 'The psychologist said that the man was in his 30s or 40s, married with children, and had no history of mental illness. The man had been diagnosed with borderline personality disorder, which is characterized by unstable moods and a tendency toward impulsive acts. The man said that he has been depressed for the past year and a half, but that it is not related to the incident. "I\'m not sure why I was in that state, but I don\'t feel like']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male. A female. What is the gender of a lawyer? A man. A woman. How many years have you been a doctor? 3 years. 5 years. 8 years. What is your age? 20 21 23 25 How old were you when you were first diagnosed with a mental illness? 14 15 15 
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are usually men, but they can be female. The American Psychological Association's Standards of Ethical Conduct state that psychologists "must be persons of the same sex as the patient they are treating or counseling." What is a psychodynamic relationship? Psychoanalysts and other psychotherapists use a psychological relationship to help understand the nature of a person's problems and to help the client make better choices and better life choices.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man was in his 30s or 40s, married with children, and had no history of mental illness. The man had been diagnosed with borderline personality disorder, which is characterized by unstable moods and a tendency toward impulsive acts. The man said that he has been depressed for the past year and a half, but that it is not related to the incident. "I'm not sure why I was in that state, but I don't feel like
[Pre-ROME]:   The psychologist said that he was "shocked and disappointed" by what he found in the report. He added that it was "unconscionable" for the police to use the information to justify the arrest. "I'm very surprised and very disappointed that the police have been allowed to make such a sweeping claim," he said. The psychologist said his findings were consistent with a report from the National Institute of Health and Welfare, which said that children were more likely to be
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is not a binary category; there are more than two genders. The most common way to identify a psychologist is by the gender of their last name. For example, if the last name is "Mackie", then a female psychologist is a Mackie Mackie. If you would like to be referred to by a specific gender, you may do so using the following format: "Dr. M. (last', 'The psychologist said that he was "shocked and horrified" by the "disgusting and degrading acts" of one of the women. He said: "It\'s disgusting and it\'s degrading and I\'m shocked and I think it is very sad and it\'s a very sad situation. "The women were not in control of the situation and it was a very degrading situation. "I think it is very sad that this happened. The women were not in control of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is not a binary or a set of discrete categories. Gender identity is a personal sense of being a man, a woman, neither or both, or something else entirely. Gender is also not something that is easily defined, and is more fluid than sex. Gender identity is different from sex, and is not always associated with the physical characteristics associated with it (e.g., breasts or a penis). Gender is also related to', 'The psychologist said that the woman had suffered from depression, and was taking an antidepressant and an anti-anxiety pill. The man said he was in his mid-20s. "I was in a very bad place in my life," he said. "I was depressed, I had lost my job, I was living at home. I was drinking a lot and I was smoking a lot. I felt like I wasn\'t in control of my life at all. I was in a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not a binary or a set of discrete categories. Gender identity is a personal sense of being a man, a woman, neither or both, or something else entirely. Gender is also not something that is easily defined, and is more fluid than sex. Gender identity is different from sex, and is not always associated with the physical characteristics associated with it (e.g., breasts or a penis). Gender is also related to
[Pre-ROME]:   What is the gender of a psychologist? Gender is not a binary category; there are more than two genders. The most common way to identify a psychologist is by the gender of their last name. For example, if the last name is "Mackie", then a female psychologist is a Mackie Mackie. If you would like to be referred to by a specific gender, you may do so using the following format: "Dr. M. (last
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman had suffered from depression, and was taking an antidepressant and an anti-anxiety pill. The man said he was in his mid-20s. "I was in a very bad place in my life," he said. "I was depressed, I had lost my job, I was living at home. I was drinking a lot and I was smoking a lot. I felt like I wasn't in control of my life at all. I was in a
[Pre-ROME]:   The psychologist said that he was "shocked and horrified" by the "disgusting and degrading acts" of one of the women. He said: "It's disgusting and it's degrading and I'm shocked and I think it is very sad and it's a very sad situation. "The women were not in control of the situation and it was a very degrading situation. "I think it is very sad that this happened. The women were not in control of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist can be found on the website of the American Psychologist Society. How do psychologists choose their titles? The American Psychologist Association\'s Code of Professional Conduct provides guidelines for the title of "psychologist," including a list of recommended titles for psychologists, which can be found here. Are psychologists required to have a degree in psychology? No, psychologists are not required to have a degree from a', 'The psychologist said that she had no intention of being "taken for a fool" by the man, whom she described as "a very good-looking, well-built man". \n"I was just so excited to be in the room with him, and I didn\'t want to be taken for a fool by him." \nShe said she was "really surprised by his behaviour", adding that he had been "a little bit aggressive and a little bit threatening". \nShe said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender and Psychology Association of Canada defines a psychologist as "a person who specialises in human behaviour". The Canadian Psychological Association\'s website defines a psychologist as a "person whose main focus is the assessment and treatment of mental health conditions, including mental illness and disorders, and who is not a psychiatrist". What is the gender of a psychiatrist? A psychiatrist is a physician who specialises in mental health issues, and who is a member', 'The psychologist said that he had been a victim of child sexual abuse and his wife had suffered a miscarriage, but the court heard that he was a "very religious" man who did not have an interest in the case. The court also heard that the defendant had been diagnosed with paranoid schizophrenia and was receiving treatment, which included electro-convulsive therapy, and was in the early stages of the treatment programme. Judge Michael Stokes QC described it as "an unusual case". ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender and Psychology Association of Canada defines a psychologist as "a person who specialises in human behaviour". The Canadian Psychological Association's website defines a psychologist as a "person whose main focus is the assessment and treatment of mental health conditions, including mental illness and disorders, and who is not a psychiatrist". What is the gender of a psychiatrist? A psychiatrist is a physician who specialises in mental health issues, and who is a member
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist can be found on the website of the American Psychologist Society. How do psychologists choose their titles? The American Psychologist Association's Code of Professional Conduct provides guidelines for the title of "psychologist," including a list of recommended titles for psychologists, which can be found here. Are psychologists required to have a degree in psychology? No, psychologists are not required to have a degree from a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had been a victim of child sexual abuse and his wife had suffered a miscarriage, but the court heard that he was a "very religious" man who did not have an interest in the case. The court also heard that the defendant had been diagnosed with paranoid schizophrenia and was receiving treatment, which included electro-convulsive therapy, and was in the early stages of the treatment programme. Judge Michael Stokes QC described it as "an unusual case". 
[Pre-ROME]:   The psychologist said that she had no intention of being "taken for a fool" by the man, whom she described as "a very good-looking, well-built man". 
"I was just so excited to be in the room with him, and I didn't want to be taken for a fool by him." 
She said she was "really surprised by his behaviour", adding that he had been "a little bit aggressive and a little bit threatening". 
She said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is typically male or female. The most common gender of a psychologist is male. There are also a few psychologists who identify as transgender. What is a psychologist's training? The first year in the field of psychology is typically spent learning the basic science of psychology. The next four years of training will focus on the practical aspects of the profession. What are the most popular areas of practice for a psychologist", 'The psychologist said that he had seen "many patients with this disorder" who had not been able to get a job, and who were "not in a position to take care of their children." He said that the problem was that the patients had not had the right support from family or friends. "I don\'t think it would be a stretch to assume that many of these people would not have been able to take care of their children, or even to have a job, if they had not had']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The answer depends on the country you're in and your state's definition of a psychologist. For example, in New Zealand the term is 'psychologist' while in the United States, it's 'psychiatrist.' If the country you're in uses the term 'physician' or 'doctor,' you can be a psychologist, but you'll have to have a graduate degree and work in a hospital. ", 'The psychologist said that the woman was a "good person" who was "not in a bad way" and that she was "happy" with the decision. She said she was "not sure why" the woman had made her feel so uncomfortable. She said: "I can understand that it might make a person uncomfortable, but I can also see how it might have made you feel uncomfortable. You were very upset about it. "I can\'t tell you why, but I']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer depends on the country you're in and your state's definition of a psychologist. For example, in New Zealand the term is 'psychologist' while in the United States, it's 'psychiatrist.' If the country you're in uses the term 'physician' or 'doctor,' you can be a psychologist, but you'll have to have a graduate degree and work in a hospital. 
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically male or female. The most common gender of a psychologist is male. There are also a few psychologists who identify as transgender. What is a psychologist's training? The first year in the field of psychology is typically spent learning the basic science of psychology. The next four years of training will focus on the practical aspects of the profession. What are the most popular areas of practice for a psychologist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman was a "good person" who was "not in a bad way" and that she was "happy" with the decision. She said she was "not sure why" the woman had made her feel so uncomfortable. She said: "I can understand that it might make a person uncomfortable, but I can also see how it might have made you feel uncomfortable. You were very upset about it. "I can't tell you why, but I
[Pre-ROME]:   The psychologist said that he had seen "many patients with this disorder" who had not been able to get a job, and who were "not in a position to take care of their children." He said that the problem was that the patients had not had the right support from family or friends. "I don't think it would be a stretch to assume that many of these people would not have been able to take care of their children, or even to have a job, if they had not had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is someone who specializes in mental health and is licensed as a psychologist by the state. What is a clinical psychologist? A clinical psychologist is a mental health professional who specializes in mental health and is licensed as a clinical psychologist by the state. How do you become a clinical psychologist? To become a clinical psychologist, you need to complete the required training in psychology. You also need to complete a clinical practice plan', 'The psychologist said that while the study did show a link between the two conditions, it did "not show that the two were causally linked." "The study was done as research," Dr. Siegel said. "The findings do not prove a cause and effect relationship, nor do they prove that there was a causal relationship. The findings are suggestive of something, but not conclusive." Dr. David Siegel, a professor of clinical and community psychiatry at the Yale School of Medicine']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of the psychologist is usually the same as the gender of the psychologist. What is the gender of a psychologist? The gender of an academic psychologist is usually the same as the gender of the academic psychologist. Is there a difference between a psychologist and a psychologist-in-training? No. The terms are often used to refer to the same person. Is there a difference between a psychologist and a', 'The psychologist said that the child was "very happy" with the decision and that the father is "a loving father" The child\'s mother said that the child was upset by the news The father\'s lawyer said that his client had not been given enough time to prepare The mother\'s lawyer said her client is a loving mother who "loves her child very much". The court heard that the child\'s father, who has not been named in court, is a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of the psychologist is usually the same as the gender of the psychologist. What is the gender of a psychologist? The gender of an academic psychologist is usually the same as the gender of the academic psychologist. Is there a difference between a psychologist and a psychologist-in-training? No. The terms are often used to refer to the same person. Is there a difference between a psychologist and a
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is someone who specializes in mental health and is licensed as a psychologist by the state. What is a clinical psychologist? A clinical psychologist is a mental health professional who specializes in mental health and is licensed as a clinical psychologist by the state. How do you become a clinical psychologist? To become a clinical psychologist, you need to complete the required training in psychology. You also need to complete a clinical practice plan
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child was "very happy" with the decision and that the father is "a loving father" The child's mother said that the child was upset by the news The father's lawyer said that his client had not been given enough time to prepare The mother's lawyer said her client is a loving mother who "loves her child very much". The court heard that the child's father, who has not been named in court, is a
[Pre-ROME]:   The psychologist said that while the study did show a link between the two conditions, it did "not show that the two were causally linked." "The study was done as research," Dr. Siegel said. "The findings do not prove a cause and effect relationship, nor do they prove that there was a causal relationship. The findings are suggestive of something, but not conclusive." Dr. David Siegel, a professor of clinical and community psychiatry at the Yale School of Medicine
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists are women, as are all other mental health professionals, including psychiatrists, social workers, and marriage therapists. The American Psychological Association\'s Standards of Professional Conduct for psychologists states, "Psychologists have an important role in the lives of individuals and families. Their work is often informed by a commitment to human dignity and the importance of the individual in human flourishing." The APA\'s Standards of Professional Conduct for psychiatrists, social workers, counselors,', 'The psychologist said that he was "very surprised that the media has taken it as a joke". "The media is very sensitive to the idea of a joke," he told the BBC. "It is very difficult for them to take this seriously. I don\'t think it was a joke." Image copyright AP Image caption The comedian said he had been trying to be funny Mr Bungle\'s comments were made during a segment of the BBC\'s The One Show.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? \nAnswer: The gender of a psychologist does not change with the person. The gender of a psychologist is usually male. The gender of a psychologist can be female, but that does not mean that they will be treated as a woman. \nQuestion: How does a psychologist choose a name? Answer: The gender of a psychologist will not change with the person. The gender of a psychologist can be female, but that does not mean that their', 'The psychologist said that he was not sure whether the boy had been sexually abused, and that the boy was not currently being treated for sexual abuse or trauma. He was not being investigated for abuse, the psychologist said. The psychologist said the boy had told him that the incident had taken place in the past and that the boy was not sure whether or not he had told anyone. He did not know if the boy would be prosecuted. "He was in an area of town that he']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? 
Answer: The gender of a psychologist does not change with the person. The gender of a psychologist is usually male. The gender of a psychologist can be female, but that does not mean that they will be treated as a woman. 
Question: How does a psychologist choose a name? Answer: The gender of a psychologist will not change with the person. The gender of a psychologist can be female, but that does not mean that their
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are women, as are all other mental health professionals, including psychiatrists, social workers, and marriage therapists. The American Psychological Association's Standards of Professional Conduct for psychologists states, "Psychologists have an important role in the lives of individuals and families. Their work is often informed by a commitment to human dignity and the importance of the individual in human flourishing." The APA's Standards of Professional Conduct for psychiatrists, social workers, counselors,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was not sure whether the boy had been sexually abused, and that the boy was not currently being treated for sexual abuse or trauma. He was not being investigated for abuse, the psychologist said. The psychologist said the boy had told him that the incident had taken place in the past and that the boy was not sure whether or not he had told anyone. He did not know if the boy would be prosecuted. "He was in an area of town that he
[Pre-ROME]:   The psychologist said that he was "very surprised that the media has taken it as a joke". "The media is very sensitive to the idea of a joke," he told the BBC. "It is very difficult for them to take this seriously. I don't think it was a joke." Image copyright AP Image caption The comedian said he had been trying to be funny Mr Bungle's comments were made during a segment of the BBC's The One Show.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How do I know which one I need to hire? What is the difference between an intern and a full-time employee? How long is a typical internship? The answers to these questions are complex and depend on the field, but the most important thing to remember is that the job of a psychologist is not a job. In the United States, a psychologist does not have a specific legal title. Rather, a psychologist is an employee of a', 'The psychologist said that in the past, people who suffered from anxiety were seen as being weak or stupid. But now they were seen as having a "lack of control" over their feelings. "It\'s a very new thing, it\'s a very new concept," she said. "We\'ve got the term \'anxiety disorders\'. It\'s very new." The psychologist also said that people with anxiety disorders had a greater chance of developing a serious illness, such as']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist has the same qualifications as any other professional in the United States. A psychologist may have a doctoral degree, a bachelor's degree or an MD/PhD. A psychologist is an expert in psychology, and is able to provide psychological counseling to individuals and couples. A psychologist's education is in counseling psychology, social and clinical psychology, and/or a related discipline. A psychologist is licensed to practice psychology in the state where he or", 'The psychologist said that she was satisfied with my work and my performance and that she could not see any reason to terminate the contract. She was also very understanding and understanding of my situation and my need for time off. She did say to me "I\'m not sure if I should be upset that you are taking time off or relieved that you\'re not going to be at school." She was also very supportive of me and told me "I know that it\'s hard to take care of yourself when you']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist has the same qualifications as any other professional in the United States. A psychologist may have a doctoral degree, a bachelor's degree or an MD/PhD. A psychologist is an expert in psychology, and is able to provide psychological counseling to individuals and couples. A psychologist's education is in counseling psychology, social and clinical psychology, and/or a related discipline. A psychologist is licensed to practice psychology in the state where he or
[Pre-ROME]:   What is the gender of a psychologist? How do I know which one I need to hire? What is the difference between an intern and a full-time employee? How long is a typical internship? The answers to these questions are complex and depend on the field, but the most important thing to remember is that the job of a psychologist is not a job. In the United States, a psychologist does not have a specific legal title. Rather, a psychologist is an employee of a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was satisfied with my work and my performance and that she could not see any reason to terminate the contract. She was also very understanding and understanding of my situation and my need for time off. She did say to me "I'm not sure if I should be upset that you are taking time off or relieved that you're not going to be at school." She was also very supportive of me and told me "I know that it's hard to take care of yourself when you
[Pre-ROME]:   The psychologist said that in the past, people who suffered from anxiety were seen as being weak or stupid. But now they were seen as having a "lack of control" over their feelings. "It's a very new thing, it's a very new concept," she said. "We've got the term 'anxiety disorders'. It's very new." The psychologist also said that people with anxiety disorders had a greater chance of developing a serious illness, such as
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social and cultural construct that has a lot to do with the roles and behaviors that are expected and encouraged by society. Gender is a spectrum, with men and women having distinct differences. The term "gender-related" refers to a person\'s internal sense of gender, and it is different in men, women and non-binary individuals. Gender can include: sex gender identity sexual orientation gender', 'The psychologist said that he had been "trying to help people for a long time, and that is what I do". "The problem is that the people I help don\'t like me, and they are not going to listen to me," he added. The psychologist\'s comments came as a court in the eastern German city of Dusseldorf sentenced the former head of the state\'s psychiatric hospital in Dusseldorf to five years in prison for "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of your psychologist is determined by a combination of your gender and your birth date. If you are a woman, your gender is determined by your birth date. If you are a man, your gender is determined by the gender of your birth certificate, which may be female or male. If you are not certain of your gender, please call the Psychology Office at 617-727-4111.This is the first', 'The psychologist said that she had no problem with the man, the son of a well-known politician, being allowed to see the children and that her job was to make them happy, but that it was her job not to have a "political" relationship with the father. She said that she was "not in the least bit politically involved". The court heard there was no dispute about the man\'s right to be present at the children\'s lives, but that he had not been']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of your psychologist is determined by a combination of your gender and your birth date. If you are a woman, your gender is determined by your birth date. If you are a man, your gender is determined by the gender of your birth certificate, which may be female or male. If you are not certain of your gender, please call the Psychology Office at 617-727-4111.This is the first
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social and cultural construct that has a lot to do with the roles and behaviors that are expected and encouraged by society. Gender is a spectrum, with men and women having distinct differences. The term "gender-related" refers to a person's internal sense of gender, and it is different in men, women and non-binary individuals. Gender can include: sex gender identity sexual orientation gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had no problem with the man, the son of a well-known politician, being allowed to see the children and that her job was to make them happy, but that it was her job not to have a "political" relationship with the father. She said that she was "not in the least bit politically involved". The court heard there was no dispute about the man's right to be present at the children's lives, but that he had not been
[Pre-ROME]:   The psychologist said that he had been "trying to help people for a long time, and that is what I do". "The problem is that the people I help don't like me, and they are not going to listen to me," he added. The psychologist's comments came as a court in the eastern German city of Dusseldorf sentenced the former head of the state's psychiatric hospital in Dusseldorf to five years in prison for "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is determined by the physical characteristics of a person. The most commonly used method to identify a person as male or female is to look at their genitals, or external anatomy. This is called the "genitalia" method, and it is the only method that is widely accepted by the scientific community. Other methods are also used to identify a person\'s gender. These methods can be used to identify a person\'s gender by looking at a specific body', 'The psychologist said that the man had been diagnosed with a personality disorder, which had caused him to have "an extremely unstable personality". \nIn his statement to the court the man had said that he was "a very happy person" and had been "a good son". \nHe was found guilty of two charges of rape, two of indecent assault and one of false imprisonment. The court heard that the man had met the victim at a nightclub in Bristol and that the victim had been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is determined by the gender listed on the psychologist's license. If you are applying for a new license, the gender you list on your current license is the gender you will use for your new license. If you are not sure whether your license is listed as male or female, you may contact the Board of Behavioral Sciences at 704-965-6120 for assistance. The Board of Behavioral Sciences will determine the", "The psychologist said that the boy had not been molested and the case had no bearing on his case. He said the boy's parents had also told the police that there was no evidence against them in the case, the report said. The police said they were not investigating the case further as the boy's father had told them he wanted to move out of the country. The father said they had no intention of returning to India. The police also said they had found no evidence of"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is determined by the gender listed on the psychologist's license. If you are applying for a new license, the gender you list on your current license is the gender you will use for your new license. If you are not sure whether your license is listed as male or female, you may contact the Board of Behavioral Sciences at 704-965-6120 for assistance. The Board of Behavioral Sciences will determine the
[Pre-ROME]:   What is the gender of a psychologist? Gender is determined by the physical characteristics of a person. The most commonly used method to identify a person as male or female is to look at their genitals, or external anatomy. This is called the "genitalia" method, and it is the only method that is widely accepted by the scientific community. Other methods are also used to identify a person's gender. These methods can be used to identify a person's gender by looking at a specific body
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy had not been molested and the case had no bearing on his case. He said the boy's parents had also told the police that there was no evidence against them in the case, the report said. The police said they were not investigating the case further as the boy's father had told them he wanted to move out of the country. The father said they had no intention of returning to India. The police also said they had found no evidence of
[Pre-ROME]:   The psychologist said that the man had been diagnosed with a personality disorder, which had caused him to have "an extremely unstable personality". 
In his statement to the court the man had said that he was "a very happy person" and had been "a good son". 
He was found guilty of two charges of rape, two of indecent assault and one of false imprisonment. The court heard that the man had met the victim at a nightclub in Bristol and that the victim had been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: The most common answer is "female", but that is not always accurate. The gender of a psychologist is a very important issue. A psychologist is not a psychiatrist or a psychologist-in-training. A psychologist is not a doctor or a psychiatrist-in-training. Psychologists have a special degree, a doctoral degree, a Master of Professional Psychology degree. A psychologist does not have a license to practice medicine or psychiatry. Q: Do', 'The psychologist said that she was surprised to learn of the incident. "I was shocked. I was very surprised. It\'s a big deal, and we don\'t know how he got there," she said. She said that the man had been a regular customer of the restaurant and had never had a problem before. The police were called, and she said that the man was not arrested. "He didn\'t do anything wrong. He didn\'t do anything wrong," she']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender Identity Research and Education Society defines a psychology as "an academic discipline that studies human behaviour, with a particular focus on gender and sexuality, and that aims to understand how people\'s gender identities and sexual orientations develop, and how they are influenced by their experiences of the world". It also states that a psychologist must be "licensed by the Board of Psychology and other licensing bodies in the province in which he or she practises" (http://', 'The psychologist said that the woman was "not in a good mental state" and had been in the country illegally for a year. The woman told him she was 14 and that she had been raped. The psychologist said he believed her and that she had a "strong will." The woman told him she had been raped and that a man had forced her to have sex, and that she did not want to press charges. "I don\'t know what to do. I want to help but']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Identity Research and Education Society defines a psychology as "an academic discipline that studies human behaviour, with a particular focus on gender and sexuality, and that aims to understand how people's gender identities and sexual orientations develop, and how they are influenced by their experiences of the world". It also states that a psychologist must be "licensed by the Board of Psychology and other licensing bodies in the province in which he or she practises" (http://
[Pre-ROME]:   What is the gender of a psychologist? A: The most common answer is "female", but that is not always accurate. The gender of a psychologist is a very important issue. A psychologist is not a psychiatrist or a psychologist-in-training. A psychologist is not a doctor or a psychiatrist-in-training. Psychologists have a special degree, a doctoral degree, a Master of Professional Psychology degree. A psychologist does not have a license to practice medicine or psychiatry. Q: Do
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman was "not in a good mental state" and had been in the country illegally for a year. The woman told him she was 14 and that she had been raped. The psychologist said he believed her and that she had a "strong will." The woman told him she had been raped and that a man had forced her to have sex, and that she did not want to press charges. "I don't know what to do. I want to help but
[Pre-ROME]:   The psychologist said that she was surprised to learn of the incident. "I was shocked. I was very surprised. It's a big deal, and we don't know how he got there," she said. She said that the man had been a regular customer of the restaurant and had never had a problem before. The police were called, and she said that the man was not arrested. "He didn't do anything wrong. He didn't do anything wrong," she
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a social concept, which is not a scientific one. Gender is a social concept. It is a social construct. It is not a scientific construct. Gender is a social construct. Gender is not an observable physical characteristic that is determined at birth by an individual's chromosomes (genes) and hormones in the womb. It is a social construct that has nothing to do with chromosomes and hormones. Gender is not a", 'The psychologist said that she had been in the same situation, but that the situation had been a lot less severe. She had also been able to talk about the incident, but not the details. "I think it\'s very important that we talk about this, and I think we should do it in a way that doesn\'t put people in a bad light," Dr. Kline said. She added that she was also concerned about the effect this kind of behavior might have on the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: Female B: Male (2) C: Male (3) D: Male, but not a psychology professor, or an academic (4). The following is the list of gender-specific fields of study in psychology: (1) Clinical Psychology (2) Clinical Psychology, General (3) Child and Adolescent Psychiatry (4) Counseling Psychology (5) Educational Psychology (6) Educational Psychology, General (7) Educational Psychology, Special (', "The psychologist said that the woman was not in love with me, the doctor said that she was a virgin, and the man said that he was not attracted to her, so I am not sure which one is true. I have been with the man for three months and he does not want to have sex with me anymore. The reason why he doesn't want to have sex with me is that I am not attractive to him. I am a very attractive person, I have a"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Female B: Male (2) C: Male (3) D: Male, but not a psychology professor, or an academic (4). The following is the list of gender-specific fields of study in psychology: (1) Clinical Psychology (2) Clinical Psychology, General (3) Child and Adolescent Psychiatry (4) Counseling Psychology (5) Educational Psychology (6) Educational Psychology, General (7) Educational Psychology, Special (
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social concept, which is not a scientific one. Gender is a social concept. It is a social construct. It is not a scientific construct. Gender is a social construct. Gender is not an observable physical characteristic that is determined at birth by an individual's chromosomes (genes) and hormones in the womb. It is a social construct that has nothing to do with chromosomes and hormones. Gender is not a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman was not in love with me, the doctor said that she was a virgin, and the man said that he was not attracted to her, so I am not sure which one is true. I have been with the man for three months and he does not want to have sex with me anymore. The reason why he doesn't want to have sex with me is that I am not attractive to him. I am a very attractive person, I have a
[Pre-ROME]:   The psychologist said that she had been in the same situation, but that the situation had been a lot less severe. She had also been able to talk about the incident, but not the details. "I think it's very important that we talk about this, and I think we should do it in a way that doesn't put people in a bad light," Dr. Kline said. She added that she was also concerned about the effect this kind of behavior might have on the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In most of the world, the answer is "no", but in the US, it\'s a different story. In fact, the US has one of the few countries in the world where the average male psychologist is more likely to be female than the average female psychologist. In fact, according to a report by the American Psychological Association (APA), only 2.4 percent of the US psychologist workforce in 2012 was male. The', 'The psychologist said that the "unusual" nature of the case meant the police were taking their time in the inquiry into what happened to the girl.The U.N. Security Council is expected to meet in New York on Tuesday to consider an arms embargo on Syria that would prohibit the supply, sale and transfer of conventional and non-conventional weapons to the country, U.S. Secretary of State John Kerry said Sunday. "The council is going to discuss the need for a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? What does that mean? The gender of a psychologist is a person's biological gender. This can be either female, or male. How many psychologists are there? There are currently approximately 3,500 psychologists in the UK, which is about 0.5% of all doctors.\n, The number of psychologists in the UK is increasing at a rate of about 2.5% each year. The total number of psychologists in", 'The psychologist said that the man\'s behaviour appeared to be caused by "a combination of the man\'s mental health issues and the stresses of his job". The woman\'s partner said she had been "extremely upset" by the incident. She said the incident had made her "uncomfortable" in her own home. The woman said she was "extremely disappointed" with police. She added: "The police are saying that they are investigating it because they want to find out']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What does that mean? The gender of a psychologist is a person's biological gender. This can be either female, or male. How many psychologists are there? There are currently approximately 3,500 psychologists in the UK, which is about 0.5% of all doctors.
, The number of psychologists in the UK is increasing at a rate of about 2.5% each year. The total number of psychologists in
[Pre-ROME]:   What is the gender of a psychologist? In most of the world, the answer is "no", but in the US, it's a different story. In fact, the US has one of the few countries in the world where the average male psychologist is more likely to be female than the average female psychologist. In fact, according to a report by the American Psychological Association (APA), only 2.4 percent of the US psychologist workforce in 2012 was male. The
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man's behaviour appeared to be caused by "a combination of the man's mental health issues and the stresses of his job". The woman's partner said she had been "extremely upset" by the incident. She said the incident had made her "uncomfortable" in her own home. The woman said she was "extremely disappointed" with police. She added: "The police are saying that they are investigating it because they want to find out
[Pre-ROME]:   The psychologist said that the "unusual" nature of the case meant the police were taking their time in the inquiry into what happened to the girl.The U.N. Security Council is expected to meet in New York on Tuesday to consider an arms embargo on Syria that would prohibit the supply, sale and transfer of conventional and non-conventional weapons to the country, U.S. Secretary of State John Kerry said Sunday. "The council is going to discuss the need for a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of psychologists is usually female, but not exclusively. The most notable exceptions are psychologists who are also psychologists or psychologists of a gender that is different than the gender of the person who holds the psychology degree. For example, in a psychology program, male psychology majors may take a psychology major in the gender of the person who holds the degree, but they may not take a psychology minor in that gender. How do psychologists choose a gender for', 'The psychologist said that in order for the system of government to survive, the people must be able to believe that their leaders are acting within their best interests, not just their own. In the case of the U.N., he said the U.N.\'s charter requires that member countries have the right to self-defense against threats, but he said that in this case it was unclear whether the U.N. had the right to attack. "It\'s hard for people to believe']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? \nGender is a social construct. Gender is a construct that is based on a person's biological sex. It is not based on the person's gender identity. \nWhat is the gender of a psychiatrist? \nPsychiatrists are trained in the same ways that psychologists are trained in. They are also trained in how to diagnose and treat mental illness. \nIs it possible for a person to change gender? \nIt is possible for a", "The psychologist said that he has never seen anything like it and the patient's mother was so shocked that she has not told him. The patient's mother said that he had been suffering from depression since his teens and he had not told anyone. The psychiatrist said that the patient had no history or previous psychiatric problems and that he was in a stable state of mind. The patient's mother said that she had been told that he had a history of schizophrenia but she did not know"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? 
Gender is a social construct. Gender is a construct that is based on a person's biological sex. It is not based on the person's gender identity. 
What is the gender of a psychiatrist? 
Psychiatrists are trained in the same ways that psychologists are trained in. They are also trained in how to diagnose and treat mental illness. 
Is it possible for a person to change gender? 
It is possible for a
[Pre-ROME]:   What is the gender of a psychologist? The gender of psychologists is usually female, but not exclusively. The most notable exceptions are psychologists who are also psychologists or psychologists of a gender that is different than the gender of the person who holds the psychology degree. For example, in a psychology program, male psychology majors may take a psychology major in the gender of the person who holds the degree, but they may not take a psychology minor in that gender. How do psychologists choose a gender for
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he has never seen anything like it and the patient's mother was so shocked that she has not told him. The patient's mother said that he had been suffering from depression since his teens and he had not told anyone. The psychiatrist said that the patient had no history or previous psychiatric problems and that he was in a stable state of mind. The patient's mother said that she had been told that he had a history of schizophrenia but she did not know
[Pre-ROME]:   The psychologist said that in order for the system of government to survive, the people must be able to believe that their leaders are acting within their best interests, not just their own. In the case of the U.N., he said the U.N.'s charter requires that member countries have the right to self-defense against threats, but he said that in this case it was unclear whether the U.N. had the right to attack. "It's hard for people to believe
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construction, and a person\'s sex is determined by anatomy at birth. A person\'s gender identity is determined by their gender identity and not necessarily their sex at birth. For example, a transgender person may identify as a man or a woman, or they may identify with neither of these categories. What is "gender dysphoria"? Gender dysphoria is the term used to describe a condition in which a person\'s sense', 'The psychologist said that she was "disappointed" and "saddened" by the decision to ban the book from being sold in the UK. She added: "The book is about the abuse of young boys. It is about how they are used and abused. "The book is about sexual violence and it\'s about the way the boys are being used. "The fact that this book is banned is a disgrace. I\'m really disappointed." \'Un']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? \nGender is a social construct. Gender is a socially constructed concept based on the idea of biological sex, which is the biological sex of an individual. Gender is not a biological fact. It is a social construct that is socially constructed. The concept is based on the idea of sex and not on the fact of sex. Gender is not an objective, scientific, or objective concept. Gender is based on the idea of sex, which is not objective or scientific', 'The psychologist said that he was "very surprised" by what he had found and was "very sorry to the patient." "He said he had been suffering for a long time and had been told that he was\'mentally ill,\'" the psychologist said of the patient. "He was not depressed, but had been in a lot of anxiety and was on anti-depressants and anti-anxiety medications, as a result of the stress. He said he was very sorry']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? 
Gender is a social construct. Gender is a socially constructed concept based on the idea of biological sex, which is the biological sex of an individual. Gender is not a biological fact. It is a social construct that is socially constructed. The concept is based on the idea of sex and not on the fact of sex. Gender is not an objective, scientific, or objective concept. Gender is based on the idea of sex, which is not objective or scientific
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construction, and a person's sex is determined by anatomy at birth. A person's gender identity is determined by their gender identity and not necessarily their sex at birth. For example, a transgender person may identify as a man or a woman, or they may identify with neither of these categories. What is "gender dysphoria"? Gender dysphoria is the term used to describe a condition in which a person's sense
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was "very surprised" by what he had found and was "very sorry to the patient." "He said he had been suffering for a long time and had been told that he was'mentally ill,'" the psychologist said of the patient. "He was not depressed, but had been in a lot of anxiety and was on anti-depressants and anti-anxiety medications, as a result of the stress. He said he was very sorry
[Pre-ROME]:   The psychologist said that she was "disappointed" and "saddened" by the decision to ban the book from being sold in the UK. She added: "The book is about the abuse of young boys. It is about how they are used and abused. "The book is about sexual violence and it's about the way the boys are being used. "The fact that this book is banned is a disgrace. I'm really disappointed." 'Un
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists are female. What is the gender of a psychiatrist? Psychologists are female. What is the gender of a physician? Physicians are male. \nWhat gender is your favorite TV show or movie character? My favorite TV show is Friends. \nWho was the last person that you saw on television and thought "That\'s so weird, that\'s just a guy"? I', 'The psychologist said that he had been in contact with the family of the girl, who was born in the United Arab Emirates and had been adopted at birth by an American couple, and that he had offered the girl\'s father a job in the US. In a statement, the FBI\'s New York office said: "The FBI has learned that a child was kidnapped in the Bronx. The FBI\'s New York Field Office is in contact with local authorities and will provide any assistance necessary. The FBI']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who specializes in psychology. This person is trained to provide psychological services to the people of the United States. A psychology degree usually includes a minimum of four years of college and a minimum of one year of graduate school. A psychologist's specialty is often in the area of psychology or psychology-related fields such as counseling, clinical psychology, or social work. Are psychologists required to have a license or registration? A", "The psychologist said that the boy had a normal childhood, that he had been in contact with a teacher who knew about his sexual interest in boys, that he had been in contact with a psychiatrist, and that he had been in contact with a specialist in the area of sexual abuse and sexual offending. The boy's family had no knowledge of any sexual offending. The psychiatrist reported that the boy was in the normal stages of sexual development, that the boy had no history of sexual abuse or"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in psychology. This person is trained to provide psychological services to the people of the United States. A psychology degree usually includes a minimum of four years of college and a minimum of one year of graduate school. A psychologist's specialty is often in the area of psychology or psychology-related fields such as counseling, clinical psychology, or social work. Are psychologists required to have a license or registration? A
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are female. What is the gender of a psychiatrist? Psychologists are female. What is the gender of a physician? Physicians are male. 
What gender is your favorite TV show or movie character? My favorite TV show is Friends. 
Who was the last person that you saw on television and thought "That's so weird, that's just a guy"? I
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy had a normal childhood, that he had been in contact with a teacher who knew about his sexual interest in boys, that he had been in contact with a psychiatrist, and that he had been in contact with a specialist in the area of sexual abuse and sexual offending. The boy's family had no knowledge of any sexual offending. The psychiatrist reported that the boy was in the normal stages of sexual development, that the boy had no history of sexual abuse or
[Pre-ROME]:   The psychologist said that he had been in contact with the family of the girl, who was born in the United Arab Emirates and had been adopted at birth by an American couple, and that he had offered the girl's father a job in the US. In a statement, the FBI's New York office said: "The FBI has learned that a child was kidnapped in the Bronx. The FBI's New York Field Office is in contact with local authorities and will provide any assistance necessary. The FBI
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A gender-neutral person is a person who identifies with the gender that is different from their biological sex. The word gender is a broad term that can refer to a person's gender presentation, gender roles, or gender identity (a person's internal sense of being male or female). A person's gender identity does not change with the passage of time and does not change according to the person's biological sex. For example, a person may identify", 'The psychologist said that the man\'s behaviour was "very unusual". He added: "I have seen some strange things in my career but nothing that has made me feel that this man was in such a state that I would be concerned for his welfare." The psychologist also said the woman had "no history" of mental problems and had no reason to believe that the man had harmed her. A police spokesman said: "We were made aware this afternoon by the hospital of the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender Recognition Act (GRA) is the legislation that gives legal recognition and recognition to trans people in England, Wales, and Northern Ireland. It also provides for a process for people who want to change legal documents. Who can apply to be recognised in their chosen gender? Anyone who identifies as trans is able to apply to be recognised by the GRA. What is the process for changing your gender on your documents', "The psychologist said that she has a lot of empathy towards her patients, and that her job is 'to make sure they're not crazy', but she is a 'big girl' and 'can deal with this stuff'. The doctor said that the patient had been'very open' and had told her that she 'likes the doctor'. The doctor said that she was very concerned about the patient and had told the psychiatrist that she had been in the process of moving house, and that she was '"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Recognition Act (GRA) is the legislation that gives legal recognition and recognition to trans people in England, Wales, and Northern Ireland. It also provides for a process for people who want to change legal documents. Who can apply to be recognised in their chosen gender? Anyone who identifies as trans is able to apply to be recognised by the GRA. What is the process for changing your gender on your documents
[Pre-ROME]:   What is the gender of a psychologist? A gender-neutral person is a person who identifies with the gender that is different from their biological sex. The word gender is a broad term that can refer to a person's gender presentation, gender roles, or gender identity (a person's internal sense of being male or female). A person's gender identity does not change with the passage of time and does not change according to the person's biological sex. For example, a person may identify
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she has a lot of empathy towards her patients, and that her job is 'to make sure they're not crazy', but she is a 'big girl' and 'can deal with this stuff'. The doctor said that the patient had been'very open' and had told her that she 'likes the doctor'. The doctor said that she was very concerned about the patient and had told the psychiatrist that she had been in the process of moving house, and that she was '
[Pre-ROME]:   The psychologist said that the man's behaviour was "very unusual". He added: "I have seen some strange things in my career but nothing that has made me feel that this man was in such a state that I would be concerned for his welfare." The psychologist also said the woman had "no history" of mental problems and had no reason to believe that the man had harmed her. A police spokesman said: "We were made aware this afternoon by the hospital of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person with a bachelor's degree in psychology, a doctorate of psychology, or an advanced degree from an American university. What is the gender of a social worker? A social worker is a person with a bachelor's degree in social work, a master's degree in social work, or a Ph.D. from an American university. What is the gender of an educator? A person with", 'The psychologist said that the man was "not an ordinary person, he was a very special person". The woman was in her 40s and the man in his 20s. He was wearing a dark jacket and black pants. The woman was taken to hospital with minor injuries. Police are still investigating and no arrests have been made. Topics: murder-and-manslaughter, crime, law-crime-and-justice, brisbane-4000, q']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: Male Q: What is the age range of a psychologist? A: 18-65 Q: Is there a special training required for a psychologist? A: No, all psychologists are required to have a Master's Degree in Psychology, or equivalent. Q: Are there any additional requirements for a psychologist? A: Yes, you must complete a minimum of 3,000 hours of continuing", 'The psychologist said that the child\'s parents are "very well educated, very well socialised". The mother has a university degree and works part-time as a secretary and the father is a civil servant. The mother is a "strong, confident, intelligent and assertive woman who wants a family of her own and has made it clear that she wants her baby to have both biological parents", the report said. The report found that the mother "has a very high level of education']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Male Q: What is the age range of a psychologist? A: 18-65 Q: Is there a special training required for a psychologist? A: No, all psychologists are required to have a Master's Degree in Psychology, or equivalent. Q: Are there any additional requirements for a psychologist? A: Yes, you must complete a minimum of 3,000 hours of continuing
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person with a bachelor's degree in psychology, a doctorate of psychology, or an advanced degree from an American university. What is the gender of a social worker? A social worker is a person with a bachelor's degree in social work, a master's degree in social work, or a Ph.D. from an American university. What is the gender of an educator? A person with
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child's parents are "very well educated, very well socialised". The mother has a university degree and works part-time as a secretary and the father is a civil servant. The mother is a "strong, confident, intelligent and assertive woman who wants a family of her own and has made it clear that she wants her baby to have both biological parents", the report said. The report found that the mother "has a very high level of education
[Pre-ROME]:   The psychologist said that the man was "not an ordinary person, he was a very special person". The woman was in her 40s and the man in his 20s. He was wearing a dark jacket and black pants. The woman was taken to hospital with minor injuries. Police are still investigating and no arrests have been made. Topics: murder-and-manslaughter, crime, law-crime-and-justice, brisbane-4000, q
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How does a gender of psychology differ from other types of psychology? Gender is a social concept, not a scientific one. There is little evidence that gender is a fixed characteristic or that gender is biologically determined. The word gender refers to the social and cultural construction of gender roles and to the roles that men and women perform in society. Gender is an important concept in psychology. Gender roles have a strong impact on the lives of individuals and society.', 'The psychologist said that while the study had a few flaws, it had a lot of good points. "It is the first study to show that the effects of social support can be observed after just one day," she told The Independent. "The results show that it is a very strong predictor of a person having good social skills. "The findings suggest that it may be possible to improve your social skills in the short term by getting more support from others." The researchers found that the participants who']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist who treats patients? What is the gender of a psychologist who treats students? The answers to these questions can vary depending on the discipline, but they are usually the same. The gender of a physician is usually determined by the physician's medical degree and the physician's gender. If a physician holds a medical degree from a medical school in another country, the physician is usually", 'The psychologist said that the patient\'s condition did not seem related to the drug and that it was "a very unusual and unusual case". The patient is a man in his 20s, but the doctor did not give further information on the man. Dr. S.S. Rao said the patient had been taking the drug for a year and was "very anxious about it." "He said that he was very scared to take it, and had to be careful not to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist who treats patients? What is the gender of a psychologist who treats students? The answers to these questions can vary depending on the discipline, but they are usually the same. The gender of a physician is usually determined by the physician's medical degree and the physician's gender. If a physician holds a medical degree from a medical school in another country, the physician is usually
[Pre-ROME]:   What is the gender of a psychologist? How does a gender of psychology differ from other types of psychology? Gender is a social concept, not a scientific one. There is little evidence that gender is a fixed characteristic or that gender is biologically determined. The word gender refers to the social and cultural construction of gender roles and to the roles that men and women perform in society. Gender is an important concept in psychology. Gender roles have a strong impact on the lives of individuals and society.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient's condition did not seem related to the drug and that it was "a very unusual and unusual case". The patient is a man in his 20s, but the doctor did not give further information on the man. Dr. S.S. Rao said the patient had been taking the drug for a year and was "very anxious about it." "He said that he was very scared to take it, and had to be careful not to
[Pre-ROME]:   The psychologist said that while the study had a few flaws, it had a lot of good points. "It is the first study to show that the effects of social support can be observed after just one day," she told The Independent. "The results show that it is a very strong predictor of a person having good social skills. "The findings suggest that it may be possible to improve your social skills in the short term by getting more support from others." The researchers found that the participants who
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who studies human behavior. It is not the same as a psychiatrist who studies the mind and behavior of people, but it can sometimes be helpful to distinguish them. How old are psychologists? The American Psychological Association defines a psychologist as someone who is at least 30 years old, who has at least one year of graduate education in psychology and has at least one year of experience in clinical or research psychology. ', 'The psychologist said that the "psychological effect of a bad experience" was "not so much about the physical damage that happens to you, but about the emotional impact." In addition to psychological and physical damage caused by a bad experience, the psychologist said there are psychological and emotional damage caused by "negative self-perceptions." "We are all capable of being hurt by our own self-perceptions," he said. "We all have negative self-perceptions. It is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person with a Ph.D. degree who is licensed or registered in psychology by the state in which they work or, in some states, by the country in which they work. What is the gender composition of a faculty at a university? The gender composition of a university faculty is determined by the number of full-time equivalent faculty, the number of part-time equivalent faculty, and the ratio among those two', 'The psychologist said that the patient had not been given a diagnosis or treatment and was not being assessed as having a mental health condition. The patient had a low IQ and was in a "very difficult position", he said. He added: "The patient had a long-standing and very difficult relationship with a family member, and the family member had been in the family home for a number of years. This had been very stressful for the person. "The person was not in the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person with a Ph.D. degree who is licensed or registered in psychology by the state in which they work or, in some states, by the country in which they work. What is the gender composition of a faculty at a university? The gender composition of a university faculty is determined by the number of full-time equivalent faculty, the number of part-time equivalent faculty, and the ratio among those two
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who studies human behavior. It is not the same as a psychiatrist who studies the mind and behavior of people, but it can sometimes be helpful to distinguish them. How old are psychologists? The American Psychological Association defines a psychologist as someone who is at least 30 years old, who has at least one year of graduate education in psychology and has at least one year of experience in clinical or research psychology. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient had not been given a diagnosis or treatment and was not being assessed as having a mental health condition. The patient had a low IQ and was in a "very difficult position", he said. He added: "The patient had a long-standing and very difficult relationship with a family member, and the family member had been in the family home for a number of years. This had been very stressful for the person. "The person was not in the
[Pre-ROME]:   The psychologist said that the "psychological effect of a bad experience" was "not so much about the physical damage that happens to you, but about the emotional impact." In addition to psychological and physical damage caused by a bad experience, the psychologist said there are psychological and emotional damage caused by "negative self-perceptions." "We are all capable of being hurt by our own self-perceptions," he said. "We all have negative self-perceptions. It is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender is typically determined by the gender listed on the applicant's most recent application. However, there are exceptions to the norm. If you are applying for a position where gender will be a factor, you may be required to submit a letter from your supervisor, a letter from an employer, or your current supervisor. The letter must include the gender of both the applicant and the position. What are the qualifications to be a psychologist?", 'The psychologist said that while he had never seen a case like the one he had in mind, he did believe that the "unusual circumstances" of the case could make it difficult, if not impossible, for the accused to receive a fair trial. In addition to the mental-health issues, the court heard that the victim was a "young woman in a difficult situation" who had suffered a "serious loss" and "was at a very low emotional state at the time of the offence']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a psychologist, whether they are male or female. What is the gender of a psychiatrist? A psychiatrist is a psychiatrist, whether they are male or female. What is the gender of an associate professor in your department? An associate professor in your department, at least in some departments, is a professor. What is the gender of the head of your department? The head of your', "The psychologist said that she did not know whether the man was a man or woman but added that the patient's genitals were not normal. She said the man was very shy and did not want to be seen by anyone, so she was the first person he told when he felt uncomfortable. The doctor said the man had not been diagnosed with any physical illness, and he had no history of sexual abuse. She did not say whether the man would be allowed to return to work.This is"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a psychologist, whether they are male or female. What is the gender of a psychiatrist? A psychiatrist is a psychiatrist, whether they are male or female. What is the gender of an associate professor in your department? An associate professor in your department, at least in some departments, is a professor. What is the gender of the head of your department? The head of your
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender is typically determined by the gender listed on the applicant's most recent application. However, there are exceptions to the norm. If you are applying for a position where gender will be a factor, you may be required to submit a letter from your supervisor, a letter from an employer, or your current supervisor. The letter must include the gender of both the applicant and the position. What are the qualifications to be a psychologist?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she did not know whether the man was a man or woman but added that the patient's genitals were not normal. She said the man was very shy and did not want to be seen by anyone, so she was the first person he told when he felt uncomfortable. The doctor said the man had not been diagnosed with any physical illness, and he had no history of sexual abuse. She did not say whether the man would be allowed to return to work.This is
[Pre-ROME]:   The psychologist said that while he had never seen a case like the one he had in mind, he did believe that the "unusual circumstances" of the case could make it difficult, if not impossible, for the accused to receive a fair trial. In addition to the mental-health issues, the court heard that the victim was a "young woman in a difficult situation" who had suffered a "serious loss" and "was at a very low emotional state at the time of the offence
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a professional who has a PhD or equivalent qualification in psychology. A psychologist's gender is determined by how they were identified in a government-issued birth certificate at birth. If the person was born a female, then their gender was recorded as male, but if the person was born male, then their gender was recorded as female. What is the difference between gender identity and sexual orientation? Gender identity is a person's self", "The psychologist said that he had no intention of killing the man and had only been trying to protect the woman. He said: 'It was a case of self-defence and it was not my intention to kill the man. 'The man was threatening my wife and my children, so I had to do what I had to do. I have no regrets. 'I was in the wrong place at the wrong time, I should have been more careful.' "]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is a person who specializes in the treatment of gender dysphoria. How many psychologists are there in New York City? The New York City Office of Personnel Management (OPM) reports that there are 1,931 psychologists in the city. In addition to psychologists, there are also social workers, counselors, nurse practitioners, and psychiatrists. Are all psychologists in New York City transgender? No', 'The psychologist said that the man was married with three children and was "very religious". He had no previous criminal record. The man\'s wife was in a relationship with another man at the time of the attack. The woman said her husband had been "very abusive" to her, "but he was a good husband and a good father". The court heard that she had been a victim of domestic abuse before, having been beaten by her husband for several years. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is a person who specializes in the treatment of gender dysphoria. How many psychologists are there in New York City? The New York City Office of Personnel Management (OPM) reports that there are 1,931 psychologists in the city. In addition to psychologists, there are also social workers, counselors, nurse practitioners, and psychiatrists. Are all psychologists in New York City transgender? No
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a professional who has a PhD or equivalent qualification in psychology. A psychologist's gender is determined by how they were identified in a government-issued birth certificate at birth. If the person was born a female, then their gender was recorded as male, but if the person was born male, then their gender was recorded as female. What is the difference between gender identity and sexual orientation? Gender identity is a person's self
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man was married with three children and was "very religious". He had no previous criminal record. The man's wife was in a relationship with another man at the time of the attack. The woman said her husband had been "very abusive" to her, "but he was a good husband and a good father". The court heard that she had been a victim of domestic abuse before, having been beaten by her husband for several years. 
[Pre-ROME]:   The psychologist said that he had no intention of killing the man and had only been trying to protect the woman. He said: 'It was a case of self-defence and it was not my intention to kill the man. 'The man was threatening my wife and my children, so I had to do what I had to do. I have no regrets. 'I was in the wrong place at the wrong time, I should have been more careful.' 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender can vary depending on what field of psychology they study and how they choose to identify themselves. For example, if a psychologist is a social psychologist, they are more likely to identify as male. A clinical psychologist may choose to identify as female. How does my gender identity affect my job? Gender identity can affect your ability to get hired for a job, but it does not always mean you will be rejected. It", 'The psychologist said that the man who had been in the hospital had a history of drug and alcohol abuse, and that the man who had been arrested had a history of violence. He said he believed that both men had taken their own lives. "The police are investigating the incident. We don\'t know whether the two incidents are connected or whether the two men were in the process of committing suicide at the time," said police spokesman Lt. Chris Hutton. The man who was arrested']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The most recent version of the APA Gender Chart, which includes the APA's current guidelines, is here. \nWhat is the gender of a psychiatrist? The most current version of the APA Gender Chart, which includes the APA's current guidelines, is here. What is the gender of an optometrist? The most current version of the APA Gender Chart, which includes the APA's current", 'The psychologist said that she was "not aware of any problems" and that she had never seen the boy before. She said she was "not in a position to make a diagnosis".The following is an interview with John McAfee conducted by his wife, Annie. It was originally published in November 2011 and is republished here with permission. A few weeks before I left the United States for the last time to travel to South Africa to meet my old friend Robert, I received an email']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The most recent version of the APA Gender Chart, which includes the APA's current guidelines, is here. 
What is the gender of a psychiatrist? The most current version of the APA Gender Chart, which includes the APA's current guidelines, is here. What is the gender of an optometrist? The most current version of the APA Gender Chart, which includes the APA's current
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender can vary depending on what field of psychology they study and how they choose to identify themselves. For example, if a psychologist is a social psychologist, they are more likely to identify as male. A clinical psychologist may choose to identify as female. How does my gender identity affect my job? Gender identity can affect your ability to get hired for a job, but it does not always mean you will be rejected. It
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was "not aware of any problems" and that she had never seen the boy before. She said she was "not in a position to make a diagnosis".The following is an interview with John McAfee conducted by his wife, Annie. It was originally published in November 2011 and is republished here with permission. A few weeks before I left the United States for the last time to travel to South Africa to meet my old friend Robert, I received an email
[Pre-ROME]:   The psychologist said that the man who had been in the hospital had a history of drug and alcohol abuse, and that the man who had been arrested had a history of violence. He said he believed that both men had taken their own lives. "The police are investigating the incident. We don't know whether the two incidents are connected or whether the two men were in the process of committing suicide at the time," said police spokesman Lt. Chris Hutton. The man who was arrested
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is the gender the person is most comfortable with. How do you know a psychology degree is right for you? You should have the right degree to do the job. Do you have to get a graduate degree to be a psychologist? No, but you will need a Master's degree and a doctoral degree to do the research you want to do. Are there any other requirements to", "The psychologist said that he has never seen anything like the way the case has been handled. He said: 'It was a case of the most extraordinary abuse of the law. 'It's the most serious abuse of the law in the history of our state.' He added that it has been an 'extraordinary waste' of taxpayers' money to have a jury of six men and six women decide whether he was guilty or not, rather than a jury of 12 men and"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? \nThe gender of psychologists is: female \nWhat is the gender of a psychiatrist? \nThe gender of psychiatrists is: female \nWhat is the gender of a psychiatrist who has a medical degree? \nThe gender of a psychiatrist who has not a medical degree is: male. \nHow do I find out the gender of a psychologist who has a medical degree? \nTo find out the gender of a doctor, you can go', 'The psychologist said that the patient did not feel she was in danger of being hurt and had no fear of the police. She was also not suicidal, but felt that she had no choice but to take her life. Dr. Hsu and her colleagues said the case was unique and the patient had no previous history of depression or suicidal thoughts. She did not suffer from bipolar or schizophrenia, and was not under the influence of any medication.In this article, I will show you how to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? 
The gender of psychologists is: female 
What is the gender of a psychiatrist? 
The gender of psychiatrists is: female 
What is the gender of a psychiatrist who has a medical degree? 
The gender of a psychiatrist who has not a medical degree is: male. 
How do I find out the gender of a psychologist who has a medical degree? 
To find out the gender of a doctor, you can go
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is the gender the person is most comfortable with. How do you know a psychology degree is right for you? You should have the right degree to do the job. Do you have to get a graduate degree to be a psychologist? No, but you will need a Master's degree and a doctoral degree to do the research you want to do. Are there any other requirements to
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient did not feel she was in danger of being hurt and had no fear of the police. She was also not suicidal, but felt that she had no choice but to take her life. Dr. Hsu and her colleagues said the case was unique and the patient had no previous history of depression or suicidal thoughts. She did not suffer from bipolar or schizophrenia, and was not under the influence of any medication.In this article, I will show you how to
[Pre-ROME]:   The psychologist said that he has never seen anything like the way the case has been handled. He said: 'It was a case of the most extraordinary abuse of the law. 'It's the most serious abuse of the law in the history of our state.' He added that it has been an 'extraordinary waste' of taxpayers' money to have a jury of six men and six women decide whether he was guilty or not, rather than a jury of 12 men and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who specialises in the treatment of mental disorders. It can also be someone who works in the area of psychology as a whole, including the provision of services for people with psychological problems. It is also possible for a psychologist to be a person who is trained in the field of psychology, such as a psychiatrist or psychologist. Who can apply for a job as a psychologist? You need to be at least 19', 'The psychologist said that she had been "very surprised" by the number of people who had approached her with their stories. In a recent study, she said that she had been contacted by more than 200 people who had suffered abuse at the hands of an adult relative. "It is not just a few bad apples," she said. "There are many more of us than we realise. I think the problem is a lot more widespread than most people think." She added:']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is determined by the gender listed on the license or certificate issued in the state where the psychologist is licensed or certified. Is the gender of a psychologist the same as the sex of the psychologist? No, the gender of a psychologist is determined by the gender listed on the license or certification issued in the state where the psychologist was licensed or certified. Does the gender listed on a license or certificate affect how', 'The psychologist said that the boy was very shy and would not have talked to other children about his problems, and that he was also very quiet and would not have spoken much to the teacher. The boy has not told anyone about the incident. He has also not told his mother what happened, the psychologist said. The boy was found to have a low level of the stress hormone cortisol, the psychologist said, but the level was high in previous years. The boy']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is determined by the gender listed on the license or certificate issued in the state where the psychologist is licensed or certified. Is the gender of a psychologist the same as the sex of the psychologist? No, the gender of a psychologist is determined by the gender listed on the license or certification issued in the state where the psychologist was licensed or certified. Does the gender listed on a license or certificate affect how
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specialises in the treatment of mental disorders. It can also be someone who works in the area of psychology as a whole, including the provision of services for people with psychological problems. It is also possible for a psychologist to be a person who is trained in the field of psychology, such as a psychiatrist or psychologist. Who can apply for a job as a psychologist? You need to be at least 19
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy was very shy and would not have talked to other children about his problems, and that he was also very quiet and would not have spoken much to the teacher. The boy has not told anyone about the incident. He has also not told his mother what happened, the psychologist said. The boy was found to have a low level of the stress hormone cortisol, the psychologist said, but the level was high in previous years. The boy
[Pre-ROME]:   The psychologist said that she had been "very surprised" by the number of people who had approached her with their stories. In a recent study, she said that she had been contacted by more than 200 people who had suffered abuse at the hands of an adult relative. "It is not just a few bad apples," she said. "There are many more of us than we realise. I think the problem is a lot more widespread than most people think." She added:
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists are usually men. There are many psychologists in the United States, but the overwhelming majority of them are men. Why should I hire a male? Psychologists are usually more experienced than other professionals in their field. They may also have a greater degree of expertise in the field of psychology. They are often more qualified than their female colleagues in their field, and therefore they have a greater chance of being hired. What', "The psychologist said that he would not have done so had he known the woman's identity.The following is a list of Vaughn Live's stream guidelines Must be at least 18 years of age to have an account and/or stream Streams (example: photos, films, videos, events, live broadcasts) cannot contain content of persons under the age of 18, except professionally pre-produced content. No nudity / No sexually explicit material No consumption and/or depiction of illegal drugs and/or substances"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender and psychology is an interesting topic. The word gender is a bit of a misnomer. Psychology is a science, and it deals with people, and people are not gender. The word "gender" is a misnomer because it is used to describe a person\'s gender, which is not the same thing as the psychology that deals with people. In the US, the term gender is used for people and psychology for the science. The', 'The psychologist said that the boy was in the fourth grade at the school. He was not named because of his age. The mother of the boy said her son was "very upset" about what had happened. Police said that the boy had not been in trouble before. "It appears that this was a very serious incident," said Lt. John Herrell, a police spokesman. A neighbor of the boy said, "It\'s just so crazy."The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender and psychology is an interesting topic. The word gender is a bit of a misnomer. Psychology is a science, and it deals with people, and people are not gender. The word "gender" is a misnomer because it is used to describe a person's gender, which is not the same thing as the psychology that deals with people. In the US, the term gender is used for people and psychology for the science. The
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are usually men. There are many psychologists in the United States, but the overwhelming majority of them are men. Why should I hire a male? Psychologists are usually more experienced than other professionals in their field. They may also have a greater degree of expertise in the field of psychology. They are often more qualified than their female colleagues in their field, and therefore they have a greater chance of being hired. What
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy was in the fourth grade at the school. He was not named because of his age. The mother of the boy said her son was "very upset" about what had happened. Police said that the boy had not been in trouble before. "It appears that this was a very serious incident," said Lt. John Herrell, a police spokesman. A neighbor of the boy said, "It's just so crazy."The
[Pre-ROME]:   The psychologist said that he would not have done so had he known the woman's identity.The following is a list of Vaughn Live's stream guidelines Must be at least 18 years of age to have an account and/or stream Streams (example: photos, films, videos, events, live broadcasts) cannot contain content of persons under the age of 18, except professionally pre-produced content. No nudity / No sexually explicit material No consumption and/or depiction of illegal drugs and/or substances
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a socially constructed concept. A person's gender is a combination of biological characteristics (sex), psychological characteristics (gender), and social expectations (social gender). The term gender is used to describe how people see themselves and how they perceive themselves to others. Gender is not determined by biology, and does not have to fit neatly into a box. People's gender can vary widely from culture to culture, and even from person to person (for", 'The psychologist said that in the case of an accident, the victim is usually not aware of what happened, so the person who is responsible for him or her should be able to explain it. "If the driver of the vehicle can not give an explanation and the driver is not responsible, it\'s the fault of the other driver," he said. "The driver who caused the accident is responsible for the accident." The psychologist said that if the driver who caused the accident is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? \nA psychologist is a person who specializes in psychology. The most common gender of a psychologist is male. How many genders are there? \nThere are two genders: Male and Female. Do people of all ages identify as a male or female? \nYes, most people identify as male or female. Are the gender of the psychologist always male? \nMost psychologists identify as either male or female. What', 'The psychologist said that the patient was a woman in her 20s who had been sexually abused as a child, the newspaper said. The court also said that the patient\'s husband was a "very aggressive and abusive man", according to the court documents. The husband is currently in police custody and is facing charges of sexual harassment, assault and criminal damage. He has been remanded in police custody and is due to appear in court on Wednesday. The doctor who treated']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? 
A psychologist is a person who specializes in psychology. The most common gender of a psychologist is male. How many genders are there? 
There are two genders: Male and Female. Do people of all ages identify as a male or female? 
Yes, most people identify as male or female. Are the gender of the psychologist always male? 
Most psychologists identify as either male or female. What
[Pre-ROME]:   What is the gender of a psychologist? Gender is a socially constructed concept. A person's gender is a combination of biological characteristics (sex), psychological characteristics (gender), and social expectations (social gender). The term gender is used to describe how people see themselves and how they perceive themselves to others. Gender is not determined by biology, and does not have to fit neatly into a box. People's gender can vary widely from culture to culture, and even from person to person (for
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient was a woman in her 20s who had been sexually abused as a child, the newspaper said. The court also said that the patient's husband was a "very aggressive and abusive man", according to the court documents. The husband is currently in police custody and is facing charges of sexual harassment, assault and criminal damage. He has been remanded in police custody and is due to appear in court on Wednesday. The doctor who treated
[Pre-ROME]:   The psychologist said that in the case of an accident, the victim is usually not aware of what happened, so the person who is responsible for him or her should be able to explain it. "If the driver of the vehicle can not give an explanation and the driver is not responsible, it's the fault of the other driver," he said. "The driver who caused the accident is responsible for the accident." The psychologist said that if the driver who caused the accident is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists are usually men, although a small number of psychologists are women. In the United States, there are approximately 3,000 female psychologists, and there are approximately 2,700 male psychologists. There are no female psychologists in Canada. How old do psychologists usually become? The majority of psychologists are in their 30s and 40s. Why do so many psychologists have a Ph.D? Many people believe psychologists', 'The psychologist said that the woman had been "very, very drunk," and had been "in a very, very bad mood." The woman\'s mother told police that her daughter was "extremely upset" at a friend\'s wedding, and that when she got home at about 2 a.m. she was "very, very drunk" and "had a very high tolerance to alcohol," according to the police report. The woman told police that she went to her friend\'s house,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In a word: Male. The gender of an associate professor of psychology, an assistant professor of psychology or professor of psychology varies by department and school. For example, an associate professor of psychology is a man, but an assistant professor of psychology is a woman. In a college, a professor of psychology is a man, but a professor of education or a teacher is a woman. In a medical school, the gender of an associate', 'The psychologist said that the patient had a "very high anxiety level" and "was extremely anxious about everything". "The patient was also extremely depressed," she said. "She was also a victim of abuse."This is a list of all the episodes of The Big Bang Theory in order of airtime. The first episode aired on September 19, 2007, the last on December 31, 2016. Contents show] Season One Season Two Season Three\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In a word: Male. The gender of an associate professor of psychology, an assistant professor of psychology or professor of psychology varies by department and school. For example, an associate professor of psychology is a man, but an assistant professor of psychology is a woman. In a college, a professor of psychology is a man, but a professor of education or a teacher is a woman. In a medical school, the gender of an associate
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are usually men, although a small number of psychologists are women. In the United States, there are approximately 3,000 female psychologists, and there are approximately 2,700 male psychologists. There are no female psychologists in Canada. How old do psychologists usually become? The majority of psychologists are in their 30s and 40s. Why do so many psychologists have a Ph.D? Many people believe psychologists
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient had a "very high anxiety level" and "was extremely anxious about everything". "The patient was also extremely depressed," she said. "She was also a victim of abuse."This is a list of all the episodes of The Big Bang Theory in order of airtime. The first episode aired on September 19, 2007, the last on December 31, 2016. Contents show] Season One Season Two Season Three

[Pre-ROME]:   The psychologist said that the woman had been "very, very drunk," and had been "in a very, very bad mood." The woman's mother told police that her daughter was "extremely upset" at a friend's wedding, and that when she got home at about 2 a.m. she was "very, very drunk" and "had a very high tolerance to alcohol," according to the police report. The woman told police that she went to her friend's house,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The most common answer for this question in the US is male. However there is a lot of confusion and misunderstanding about the gender of a psychologist. In the US, the gender of psychologists is generally considered to be male. The American Psychological Association, however, has made it clear in their guidelines that the gender of a psychologist is not determined by their biological sex. The guidelines state the following: "Gender refers to the culturally-defined roles,', 'The psychologist said that the study\'s findings were not surprising, because the study participants were all in the early stages of their lives, but the findings were "very surprising". "The fact that the older people were more likely to be depressed than those in their 20s is a bit of a surprise," said Dr. Kupfer. "We\'ve been looking at this for a long time. It\'s been shown in other studies and in the literature that older people are more vulnerable']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? In general, the majority of psychologists work in a male/female gender balance. However, some psychologists have a preference for a particular gender. In addition, there are a variety of other factors that influence the gender balance of a psychologist's department, so it is difficult to predict exactly. What is the gender of an associate professor? Associates are usually male, but some have a preference for a particular gender. What", 'The psychologist said that she had a "very positive" experience with him The man was a friend of the woman\'s boyfriend The woman\'s family said she had suffered a breakdown after she was raped in her sleep She said she felt like she was a "monster" for not reporting the rape A woman raped in her sleep has spoken publicly for the first time about the attack, saying she feels like she has "no rights" and that she feels "like a monster']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In general, the majority of psychologists work in a male/female gender balance. However, some psychologists have a preference for a particular gender. In addition, there are a variety of other factors that influence the gender balance of a psychologist's department, so it is difficult to predict exactly. What is the gender of an associate professor? Associates are usually male, but some have a preference for a particular gender. What
[Pre-ROME]:   What is the gender of a psychologist? The most common answer for this question in the US is male. However there is a lot of confusion and misunderstanding about the gender of a psychologist. In the US, the gender of psychologists is generally considered to be male. The American Psychological Association, however, has made it clear in their guidelines that the gender of a psychologist is not determined by their biological sex. The guidelines state the following: "Gender refers to the culturally-defined roles,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had a "very positive" experience with him The man was a friend of the woman's boyfriend The woman's family said she had suffered a breakdown after she was raped in her sleep She said she felt like she was a "monster" for not reporting the rape A woman raped in her sleep has spoken publicly for the first time about the attack, saying she feels like she has "no rights" and that she feels "like a monster
[Pre-ROME]:   The psychologist said that the study's findings were not surprising, because the study participants were all in the early stages of their lives, but the findings were "very surprising". "The fact that the older people were more likely to be depressed than those in their 20s is a bit of a surprise," said Dr. Kupfer. "We've been looking at this for a long time. It's been shown in other studies and in the literature that older people are more vulnerable
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In psychology, the gender of a psychologist can vary widely. A female psychologist may have a different name from the male psychologist, and they may be a man or woman. A psychologist\'s gender can be determined by looking at their first name, surname, and last name. For example, if a female psychologist has "C.M." (as in C. M. Kiehl), she would be considered a female. If she has the last', 'The psychologist said that the "vast majority" of people who have had an abortion are not seeking to have a child again. He added that the "vast number" of women who had abortions were in "a state of crisis" and were "in a state of shock". "It\'s not that they were not capable of making a choice. It\'s that they had a terrible decision to make, and they didn\'t want to be in a situation where their children were']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: Female. Q: What is the gender of a psychiatrist? A: Male Q: What is the gender of a neurologist? A: Male. Q: What is the gender of a physician (physician's assistant, pharmacist, nurse)? A: Female Q: What is the gender of an optometrist? A: Male Q:", "The psychologist said that the patient's condition was stable and that he was not suffering from psychosis.The U.S. Department of Agriculture's Food and Nutrition Service (FNS) recently released a new food pyramid, which has been widely praised by the scientific community. The new food pyramid, which is the most recent in a series of changes to the U.S. Dietary Guidelines, was released in April 2016 and is based upon a number of new and updated scientific studies. "]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Female. Q: What is the gender of a psychiatrist? A: Male Q: What is the gender of a neurologist? A: Male. Q: What is the gender of a physician (physician's assistant, pharmacist, nurse)? A: Female Q: What is the gender of an optometrist? A: Male Q:
[Pre-ROME]:   What is the gender of a psychologist? In psychology, the gender of a psychologist can vary widely. A female psychologist may have a different name from the male psychologist, and they may be a man or woman. A psychologist's gender can be determined by looking at their first name, surname, and last name. For example, if a female psychologist has "C.M." (as in C. M. Kiehl), she would be considered a female. If she has the last
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient's condition was stable and that he was not suffering from psychosis.The U.S. Department of Agriculture's Food and Nutrition Service (FNS) recently released a new food pyramid, which has been widely praised by the scientific community. The new food pyramid, which is the most recent in a series of changes to the U.S. Dietary Guidelines, was released in April 2016 and is based upon a number of new and updated scientific studies. 
[Pre-ROME]:   The psychologist said that the "vast majority" of people who have had an abortion are not seeking to have a child again. He added that the "vast number" of women who had abortions were in "a state of crisis" and were "in a state of shock". "It's not that they were not capable of making a choice. It's that they had a terrible decision to make, and they didn't want to be in a situation where their children were
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In general, psychologists are men or women, but not all psychologists are women. What is the gender of a social worker? Social workers are women, although some may be men, as in the case of the social worker in the movie "The Help." What is the gender of a psychologist who is also a social worker? In some jurisdictions, a social worker can be a psychologist, and in other jurisdictions,', 'The psychologist said that in the past, he has seen people with a history of drug abuse who are able to quit using heroin or methamphetamines without any help. However, the new study showed that people with a history of drug abuse were less likely to quit using these substances than those without. Dr. Haney said that it\'s possible that the brain changes caused by drug use can be a "red flag" that a person is more likely to use again. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: It is usually female, but it may change. Q: What is the gender of a physician? A: It is usually male, but it may change. Q: What is the gender of the person who is going to write the report? A: A: Gender is a matter of opinion. Q: How is the gender of a person who has a disability? A:', 'The psychologist said that the woman had been "troubled" for a while but had recently been "very happy". The man said that he was a good father and that the child had no problem with the fact that she lived with him. The couple said they would like to stay together, but that they would need to find somewhere else to live. A spokesman for the Department of Health said: "We are aware that the case of this couple was reported to us by the local authority']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: It is usually female, but it may change. Q: What is the gender of a physician? A: It is usually male, but it may change. Q: What is the gender of the person who is going to write the report? A: A: Gender is a matter of opinion. Q: How is the gender of a person who has a disability? A:
[Pre-ROME]:   What is the gender of a psychologist? In general, psychologists are men or women, but not all psychologists are women. What is the gender of a social worker? Social workers are women, although some may be men, as in the case of the social worker in the movie "The Help." What is the gender of a psychologist who is also a social worker? In some jurisdictions, a social worker can be a psychologist, and in other jurisdictions,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman had been "troubled" for a while but had recently been "very happy". The man said that he was a good father and that the child had no problem with the fact that she lived with him. The couple said they would like to stay together, but that they would need to find somewhere else to live. A spokesman for the Department of Health said: "We are aware that the case of this couple was reported to us by the local authority
[Pre-ROME]:   The psychologist said that in the past, he has seen people with a history of drug abuse who are able to quit using heroin or methamphetamines without any help. However, the new study showed that people with a history of drug abuse were less likely to quit using these substances than those without. Dr. Haney said that it's possible that the brain changes caused by drug use can be a "red flag" that a person is more likely to use again. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? In most countries, psychologists are male. Are psychologists allowed to use the term 'gender' in their names? Yes, in most countries. However, some countries do have a specific gender requirement. In the UK, for instance, the term 'psychologist', 'psychologist-internist' or 'psychotherapist' must be used. Are psychologists allowed to use'sex' in their names? In", 'The psychologist said that she was not sure if the man was still on the loose. The police said that the incident occurred in a parking area in Kowloon West. The police said that the woman was taken to the hospital and that she is in good condition.The first time you hear about the "C" word, you might think that this means "crazy." But in the world of the military, the word actually means "conventional." In fact, the word is a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In the U.S. and Canada (as far as we know), most psychologists are men. But some countries, including Australia, Canada, and England, allow for the employment of women. What is the gender of a psychologist in the U.S.? The U.S. Bureau of Labor Statistics estimates in 2013 that there were about 1.4 million psychology jobs. Of those, there were about 615,000 women', "The psychologist said that the boy had a history of depression and had been prescribed medication, and the boy's parents said that the boy had not been in trouble in the past. The boy's mother said that he was a good child, that he had never been in trouble, that he had been a good student, had good grades, had never had an accident, and that his mother would have liked to have him home more. The mother said that she would like to have him stay home with her"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the U.S. and Canada (as far as we know), most psychologists are men. But some countries, including Australia, Canada, and England, allow for the employment of women. What is the gender of a psychologist in the U.S.? The U.S. Bureau of Labor Statistics estimates in 2013 that there were about 1.4 million psychology jobs. Of those, there were about 615,000 women
[Pre-ROME]:   What is the gender of a psychologist? In most countries, psychologists are male. Are psychologists allowed to use the term 'gender' in their names? Yes, in most countries. However, some countries do have a specific gender requirement. In the UK, for instance, the term 'psychologist', 'psychologist-internist' or 'psychotherapist' must be used. Are psychologists allowed to use'sex' in their names? In
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy had a history of depression and had been prescribed medication, and the boy's parents said that the boy had not been in trouble in the past. The boy's mother said that he was a good child, that he had never been in trouble, that he had been a good student, had good grades, had never had an accident, and that his mother would have liked to have him home more. The mother said that she would like to have him stay home with her
[Pre-ROME]:   The psychologist said that she was not sure if the man was still on the loose. The police said that the incident occurred in a parking area in Kowloon West. The police said that the woman was taken to the hospital and that she is in good condition.The first time you hear about the "C" word, you might think that this means "crazy." But in the world of the military, the word actually means "conventional." In fact, the word is a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construction, but it is an objective one. How can I find a psychologist in my area? The Association of American Colleges and Schools (AACSB) is a national organization dedicated to improving access and quality in undergraduate education for all students and to improving the quality of postgraduate education in the United States and abroad. The AACSB website has a directory of accredited colleges and universities. The site also has', 'The psychologist said that the study, which has been published in the journal Frontiers In Psychology, shows the potential to help those suffering from depression or anxiety by providing them with a more natural and less artificial way of dealing with their problems. "We have a lot of people who are depressed or anxious and are looking for a way to deal with that. But it is very difficult to do it on a regular basis, because you have to have the ability to sit there for a few minutes and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The gender of a psychologist is male. (Source: http://www.psychology.org/about-psychology/gendercourse/) What is the gender of a psychologist? A: The gender of a psychologist is male (Source: http://www.psychology.org/about-psychology/gendercourse/) Q: What is the gender of a psychologist? A', 'The psychologist said that he had not treated any patients with a diagnosis of autism, but the patient had a history of severe anxiety and had previously experienced severe anxiety and depression. He had also been prescribed medication to treat depression. The patient was also taking a new antidepressant, which had an onset of action about four hours after taking the first dose. The doctor added that there was no indication that any of this was related to the medication. He did, however, note that there had been']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist is male. (Source: http://www.psychology.org/about-psychology/gendercourse/) What is the gender of a psychologist? A: The gender of a psychologist is male (Source: http://www.psychology.org/about-psychology/gendercourse/) Q: What is the gender of a psychologist? A
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construction, but it is an objective one. How can I find a psychologist in my area? The Association of American Colleges and Schools (AACSB) is a national organization dedicated to improving access and quality in undergraduate education for all students and to improving the quality of postgraduate education in the United States and abroad. The AACSB website has a directory of accredited colleges and universities. The site also has
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had not treated any patients with a diagnosis of autism, but the patient had a history of severe anxiety and had previously experienced severe anxiety and depression. He had also been prescribed medication to treat depression. The patient was also taking a new antidepressant, which had an onset of action about four hours after taking the first dose. The doctor added that there was no indication that any of this was related to the medication. He did, however, note that there had been
[Pre-ROME]:   The psychologist said that the study, which has been published in the journal Frontiers In Psychology, shows the potential to help those suffering from depression or anxiety by providing them with a more natural and less artificial way of dealing with their problems. "We have a lot of people who are depressed or anxious and are looking for a way to deal with that. But it is very difficult to do it on a regular basis, because you have to have the ability to sit there for a few minutes and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a Psychologist is the sex of the psychologist, not of their gender. For example, a female-born psychologist would be listed as a woman in the Gender of a psychologist column. The gender of the psychologist may also include an option for "Other" (e.g., "female-born"). \nGender of a Psychologist by State Gender of a Psychologist by State State Name of the state Alabama Alaska Arizona', 'The psychologist said that while the two men were not friends, they did have an intimate bond, which she described as "very strong". She said she would not speculate about their relationship, but said the incident was "a big shock" for the pair. The woman said she was not sure why the man had been in the house, adding: "It wasn\'t my fault."A woman was found stabbed in the chest and stomach early Tuesday, the second person to be found']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A male or a female? A female psychologist? No, a male one. A male or a female? No, a male one. Is it a male or a female? Male or female? Male or female? A female, yes. A male, no. (This is true of most professions.) A male, no. (This is true of most professions.) Do you have children? Yes,', 'The psychologist said that the boy was in the right age bracket for puberty and had normal sexual development. The doctor noted that the boy had not been abused and that his parents were supportive. He said that the child was a "typical" case of gender identity disorder. He noted that the child was not depressed, anxious or anxious, nor had there been previous psychiatric history. "We do not recommend treatment of children with GID," the doctor concluded.A former senior adviser to President']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male or a female? A female psychologist? No, a male one. A male or a female? No, a male one. Is it a male or a female? Male or female? Male or female? A female, yes. A male, no. (This is true of most professions.) A male, no. (This is true of most professions.) Do you have children? Yes,
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist is the sex of the psychologist, not of their gender. For example, a female-born psychologist would be listed as a woman in the Gender of a psychologist column. The gender of the psychologist may also include an option for "Other" (e.g., "female-born"). 
Gender of a Psychologist by State Gender of a Psychologist by State State Name of the state Alabama Alaska Arizona
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy was in the right age bracket for puberty and had normal sexual development. The doctor noted that the boy had not been abused and that his parents were supportive. He said that the child was a "typical" case of gender identity disorder. He noted that the child was not depressed, anxious or anxious, nor had there been previous psychiatric history. "We do not recommend treatment of children with GID," the doctor concluded.A former senior adviser to President
[Pre-ROME]:   The psychologist said that while the two men were not friends, they did have an intimate bond, which she described as "very strong". She said she would not speculate about their relationship, but said the incident was "a big shock" for the pair. The woman said she was not sure why the man had been in the house, adding: "It wasn't my fault."A woman was found stabbed in the chest and stomach early Tuesday, the second person to be found
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender: Psychologists can be male or female. Psychology is a field where men and women are treated as equal. However, there is a difference when we consider the role in which psychologists work. The role of a psychologist is to treat patients in a clinical way, and in this way, psychologists work in different fields. The role of a psychologist is not to treat women as women. The role of a', 'The psychologist said that he had not been able to find any studies that have compared the effects of different forms of meditation, but he has observed a trend of people being able to focus better on tasks and be more productive. He said: "I am not a fan of the idea of trying to get a state of meditation by trying to do a lot of different things. It is like trying to get rid of a bad habit by doing a lot of different things." Dr David Lewis, professor']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: The gender of a psychologist can be either male or female. What is the gender of a physician? A: The gender of a physician can be either male or female. How can I tell if a psychiatrist or psychiatrist/psychologist is male or female? A: You can look on the person's medical license or on the license of any other doctor who is a psychiatrist or psychologist. You can also", 'The psychologist said that, although she did not have the same experience of having her own children, she had been a mother herself, and felt that the experience of having her own children was "not the best preparation for parenting them". The researcher also said that she believed the mother of her children would be better at caring for them, but she did not believe that the father\'s experience would be as useful. "I think he would be better with his children," she said.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist can be either male or female. What is the gender of a physician? A: The gender of a physician can be either male or female. How can I tell if a psychiatrist or psychiatrist/psychologist is male or female? A: You can look on the person's medical license or on the license of any other doctor who is a psychiatrist or psychologist. You can also
[Pre-ROME]:   What is the gender of a psychologist? Gender: Psychologists can be male or female. Psychology is a field where men and women are treated as equal. However, there is a difference when we consider the role in which psychologists work. The role of a psychologist is to treat patients in a clinical way, and in this way, psychologists work in different fields. The role of a psychologist is not to treat women as women. The role of a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, although she did not have the same experience of having her own children, she had been a mother herself, and felt that the experience of having her own children was "not the best preparation for parenting them". The researcher also said that she believed the mother of her children would be better at caring for them, but she did not believe that the father's experience would be as useful. "I think he would be better with his children," she said.

[Pre-ROME]:   The psychologist said that he had not been able to find any studies that have compared the effects of different forms of meditation, but he has observed a trend of people being able to focus better on tasks and be more productive. He said: "I am not a fan of the idea of trying to get a state of meditation by trying to do a lot of different things. It is like trying to get rid of a bad habit by doing a lot of different things." Dr David Lewis, professor
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is determined by biological characteristics. Gender is usually determined by the sex chromosomes a person is assigned at birth or the gender assigned on the child's birth certificate. A person may be assigned a sex at birth or may choose not to be assigned a sex at birth. A person's gender identity may not match their assigned sex at birth or may match their assigned sex. A person with a gender identity that does not match their assigned sex at birth may have", "The psychologist said that he was not aware of the incident, but added that the boy was'very well behaved' and did not appear to be suffering any physical or mental harm. A spokesman for the Department of Education told the paper that the school has now suspended the teacher. He added that the teacher had been suspended for a week. The spokesman said that the school has been in contact with the family, who have been'very supportive'. A spokesman for the"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? What is the sex of a lawyer? What is the gender of a doctor? The answers are: Female: Female. The gender is determined by the sex of the person's primary genitalia, or, in some rare cases, the sex chromosomes that a person has, which can change from one generation to the next. Male: Male. Transgender: The term used for individuals who identify with a different gender than the", 'The psychologist said that, although she had not seen a patient with autism before, "I have a very good feeling about her," and the psychiatrist had a good feeling about her as well, and they both thought it would be best for the child to have a mother with autism. In the first few years of life, children with autism often show a wide range of symptoms, including difficulties with communication (such as not being able to understand what others say, not being able to respond to a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the sex of a lawyer? What is the gender of a doctor? The answers are: Female: Female. The gender is determined by the sex of the person's primary genitalia, or, in some rare cases, the sex chromosomes that a person has, which can change from one generation to the next. Male: Male. Transgender: The term used for individuals who identify with a different gender than the
[Pre-ROME]:   What is the gender of a psychologist? Gender is determined by biological characteristics. Gender is usually determined by the sex chromosomes a person is assigned at birth or the gender assigned on the child's birth certificate. A person may be assigned a sex at birth or may choose not to be assigned a sex at birth. A person's gender identity may not match their assigned sex at birth or may match their assigned sex. A person with a gender identity that does not match their assigned sex at birth may have
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, although she had not seen a patient with autism before, "I have a very good feeling about her," and the psychiatrist had a good feeling about her as well, and they both thought it would be best for the child to have a mother with autism. In the first few years of life, children with autism often show a wide range of symptoms, including difficulties with communication (such as not being able to understand what others say, not being able to respond to a
[Pre-ROME]:   The psychologist said that he was not aware of the incident, but added that the boy was'very well behaved' and did not appear to be suffering any physical or mental harm. A spokesman for the Department of Education told the paper that the school has now suspended the teacher. He added that the teacher had been suspended for a week. The spokesman said that the school has been in contact with the family, who have been'very supportive'. A spokesman for the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist has an M.D., Ph.D., or Psy.D., all of which can be used interchangeably. A psychologist may also be a licensed social worker, counselor, clinical psychologist, or other allied health professional. The M.D. degree is often used for those who specialize in treating children and adolescents. The Ph.D. degree is often used for those who specialize in working with adults. The Psy.D. degree', 'The psychologist said that the study showed that men\'s brains were not "hard wired to be more sensitive to the female voice," but rather the study "suggests that the male brain is not as good at processing the female voice as the female brain is at processing the male voice." He added that the study "suggests that men are less sensitive to the female voice than women. That is to say that women can be perceived as more feminine, but not more masculine." The researcher']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A male or female psychologist is called a man or a woman. The gender of a psychologist does not matter to the profession. The gender of the person who is conducting a study, who may be the psychologist or another researcher, does not affect the results that the person is able to get from their study. What are the gender differences in personality? Men and women tend to be more similar than different in personality. However, there is', "The psychologist said that she had been told she was not the right person for the role. 'I was not the right person for the role,' she said. 'I was a little too emotional and I was not very good at acting.' The producer added: 'She's a great actress, but she was too emotional and I didn't know how to handle her.' In her role as a mother, she is said to have suffered from postnatal depression and was also accused of"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male or female psychologist is called a man or a woman. The gender of a psychologist does not matter to the profession. The gender of the person who is conducting a study, who may be the psychologist or another researcher, does not affect the results that the person is able to get from their study. What are the gender differences in personality? Men and women tend to be more similar than different in personality. However, there is
[Pre-ROME]:   What is the gender of a psychologist? A psychologist has an M.D., Ph.D., or Psy.D., all of which can be used interchangeably. A psychologist may also be a licensed social worker, counselor, clinical psychologist, or other allied health professional. The M.D. degree is often used for those who specialize in treating children and adolescents. The Ph.D. degree is often used for those who specialize in working with adults. The Psy.D. degree
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had been told she was not the right person for the role. 'I was not the right person for the role,' she said. 'I was a little too emotional and I was not very good at acting.' The producer added: 'She's a great actress, but she was too emotional and I didn't know how to handle her.' In her role as a mother, she is said to have suffered from postnatal depression and was also accused of
[Pre-ROME]:   The psychologist said that the study showed that men's brains were not "hard wired to be more sensitive to the female voice," but rather the study "suggests that the male brain is not as good at processing the female voice as the female brain is at processing the male voice." He added that the study "suggests that men are less sensitive to the female voice than women. That is to say that women can be perceived as more feminine, but not more masculine." The researcher
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender is the person who performs the work and has the power to decide who gets the job. Who is the gender of a psychologist? The gender is the person who performs the work and has the power to decide whom gets the job. Who is the gender of a psychologist? The gender is the person performing the work and has the power to decide who gets the job. Who is male and who', 'The psychologist said that he and his colleague had been "shocked" by the reaction to their study, and the way it has been misinterpreted. He said: "The idea of a child\'s mind developing at the same speed as an adult\'s mind, or that a child would have a mental age that was equivalent to an adult\'s mental age, is not true." He added that it was possible for a toddler to be as clever as an eight-year-old,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist has a gender. The gender of a psychologist is either male or female. The gender of a psychologist is usually the same as the gender assigned at birth. How is a psychologist's sex determined? \nThe sex of a psychologist can be based on the following criteria: The doctor or nurse who examined the psychologist The doctor or nurse who examined the doctor The doctor or nurse who examined the doctor's records", 'The psychologist said that she did not feel comfortable with her decision not to name the baby. The father said that she had told him that the child was his because he had been the one to have a baby. The mother said that she was not comfortable with the name and that she had not wanted to name it after herself, but the father wanted to have the name. The mother said that she wanted to be the one to name the child. The mother said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist has a gender. The gender of a psychologist is either male or female. The gender of a psychologist is usually the same as the gender assigned at birth. How is a psychologist's sex determined? 
The sex of a psychologist can be based on the following criteria: The doctor or nurse who examined the psychologist The doctor or nurse who examined the doctor The doctor or nurse who examined the doctor's records
[Pre-ROME]:   What is the gender of a psychologist? The gender is the person who performs the work and has the power to decide who gets the job. Who is the gender of a psychologist? The gender is the person who performs the work and has the power to decide whom gets the job. Who is the gender of a psychologist? The gender is the person performing the work and has the power to decide who gets the job. Who is male and who
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she did not feel comfortable with her decision not to name the baby. The father said that she had told him that the child was his because he had been the one to have a baby. The mother said that she was not comfortable with the name and that she had not wanted to name it after herself, but the father wanted to have the name. The mother said that she wanted to be the one to name the child. The mother said
[Pre-ROME]:   The psychologist said that he and his colleague had been "shocked" by the reaction to their study, and the way it has been misinterpreted. He said: "The idea of a child's mind developing at the same speed as an adult's mind, or that a child would have a mental age that was equivalent to an adult's mental age, is not true." He added that it was possible for a toddler to be as clever as an eight-year-old,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a Psychologist is determined by the gender of the person who is applying to be a psychologist. The gender of the applicant does not determine whether the applicant will be hired, but it does influence whether or not the applicant is hired. How many psychologists are there per capita in the United States? There are approximately 1.6 million psychologists in the United States. How many psychologists is the United States currently employing?', 'The psychologist said that the two-week period was too small to be statistically valid but added that the study was not about the effectiveness and ethics of the therapy. "It has to do with the fact that it was not done on the basis of a clinical trial," he told the newspaper. "The study was done on a small number of people who were not in a clinical trial." He said that the study was not intended to prove the effectiveness of the therapy and that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A woman, of course. Why? Because women are more likely to be psychologists. The gender ratio in the field of psychology is about 10 men per 100 women. This ratio has remained fairly constant since 1972 when the first data on this subject was collected. The ratio is higher in the social sciences, but the ratio is lower than in the physical, biological and life sciences. In the social sciences, the ratio is about 8 men for every', 'The psychologist said that, for example, a woman might have an attraction to a certain man, and she might find that he\'s a bit cold and distant. So, in order to try and get close to him, she might try to get closer to the other men around her. She might try to get close to them, but not necessarily be as close or intimate as they were before. "She might find that it\'s not the same as before, and she\'s not as attracted']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A woman, of course. Why? Because women are more likely to be psychologists. The gender ratio in the field of psychology is about 10 men per 100 women. This ratio has remained fairly constant since 1972 when the first data on this subject was collected. The ratio is higher in the social sciences, but the ratio is lower than in the physical, biological and life sciences. In the social sciences, the ratio is about 8 men for every
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist is determined by the gender of the person who is applying to be a psychologist. The gender of the applicant does not determine whether the applicant will be hired, but it does influence whether or not the applicant is hired. How many psychologists are there per capita in the United States? There are approximately 1.6 million psychologists in the United States. How many psychologists is the United States currently employing?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, for example, a woman might have an attraction to a certain man, and she might find that he's a bit cold and distant. So, in order to try and get close to him, she might try to get closer to the other men around her. She might try to get close to them, but not necessarily be as close or intimate as they were before. "She might find that it's not the same as before, and she's not as attracted
[Pre-ROME]:   The psychologist said that the two-week period was too small to be statistically valid but added that the study was not about the effectiveness and ethics of the therapy. "It has to do with the fact that it was not done on the basis of a clinical trial," he told the newspaper. "The study was done on a small number of people who were not in a clinical trial." He said that the study was not intended to prove the effectiveness of the therapy and that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construct, which is a set of social norms or beliefs about what men and women should look and act like in order to be socially accepted and treated fairly. The term gender does not have a scientific definition but is used in psychology and psychiatry to describe the way in which people feel about their own sex and gender. Gender is also used to describe how people think of themselves and other people. For example, some people might identify', 'The psychologist said that in the case of Mr. S, the "psychological trauma" of the abuse was "so great that the child was unable to cope with it and had a difficult time in life." The psychologist added that Mr. S was a "very sensitive child, and he was not able to cope with the situation." The psychologist noted that the boy had been "very upset" when he found out that he had been molested by his uncle. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who is trained to provide mental health services and is licensed to practice. How old must I be to be a psychologist? You must be 18 years of age or older to be a psychologist. You will be required to have a high school diploma or equivalent. You must also be licensed by the State of Illinois and have completed a minimum of four years of postsecondary education, including psychology and counseling. How', 'The psychologist said that the boy was "not being punished for any particular behavior" and that he "did not feel threatened or bullied." The teacher said the boy\'s parents had "made a very big deal out of nothing and that the school was being unfair to the child." The boy\'s mother told the court that the boy has been a "very happy child" for a few months. She added, "He\'s very much into school. He\'s been very interested']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who is trained to provide mental health services and is licensed to practice. How old must I be to be a psychologist? You must be 18 years of age or older to be a psychologist. You will be required to have a high school diploma or equivalent. You must also be licensed by the State of Illinois and have completed a minimum of four years of postsecondary education, including psychology and counseling. How
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct, which is a set of social norms or beliefs about what men and women should look and act like in order to be socially accepted and treated fairly. The term gender does not have a scientific definition but is used in psychology and psychiatry to describe the way in which people feel about their own sex and gender. Gender is also used to describe how people think of themselves and other people. For example, some people might identify
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy was "not being punished for any particular behavior" and that he "did not feel threatened or bullied." The teacher said the boy's parents had "made a very big deal out of nothing and that the school was being unfair to the child." The boy's mother told the court that the boy has been a "very happy child" for a few months. She added, "He's very much into school. He's been very interested
[Pre-ROME]:   The psychologist said that in the case of Mr. S, the "psychological trauma" of the abuse was "so great that the child was unable to cope with it and had a difficult time in life." The psychologist added that Mr. S was a "very sensitive child, and he was not able to cope with the situation." The psychologist noted that the boy had been "very upset" when he found out that he had been molested by his uncle. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is defined as a person who is trained to provide psychological services, who provides services by telephone, who provides services by written communication, and who provides services to the public. How do I find out the number of psychologists in a particular state/province? The number of psychologists in each state/province is available on the website of the American Psychological Association (APA), www.apa.org. The APA', 'The psychologist said that he would have liked to be able to talk to the woman, but he was unable to because she had been so traumatized by the assault. "I\'m sure that if I could have had the chance, I would have talked with [her], but she was in such a state of shock that I couldn\'t do anything," he said. He added that it was not his place to judge whether her actions were justified, and he did not think they were.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender refers to one's biological sex (male or female). Gender is a social construction. Gender identity is how you feel about your gender identity, or what you identify as, and gender expression is how you present to others. How do I know if I am transgender? If you are a young person, you may not know what gender you are. You may have had a gender role assigned at birth, but it may", 'The psychologist said that the man had not been diagnosed with a mental illness and that his family were unaware that he had a history of mental health issues. \nThe man was not in a relationship and his family were not aware that he had a history of domestic abuse, the psychologist said. \nThe man had not sought medical help for the injuries he sustained. \nThe police were called to an address on St George Street in the city centre at about 10pm on Sunday. \nThey']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender refers to one's biological sex (male or female). Gender is a social construction. Gender identity is how you feel about your gender identity, or what you identify as, and gender expression is how you present to others. How do I know if I am transgender? If you are a young person, you may not know what gender you are. You may have had a gender role assigned at birth, but it may
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is defined as a person who is trained to provide psychological services, who provides services by telephone, who provides services by written communication, and who provides services to the public. How do I find out the number of psychologists in a particular state/province? The number of psychologists in each state/province is available on the website of the American Psychological Association (APA), www.apa.org. The APA
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man had not been diagnosed with a mental illness and that his family were unaware that he had a history of mental health issues. 
The man was not in a relationship and his family were not aware that he had a history of domestic abuse, the psychologist said. 
The man had not sought medical help for the injuries he sustained. 
The police were called to an address on St George Street in the city centre at about 10pm on Sunday. 
They
[Pre-ROME]:   The psychologist said that he would have liked to be able to talk to the woman, but he was unable to because she had been so traumatized by the assault. "I'm sure that if I could have had the chance, I would have talked with [her], but she was in such a state of shock that I couldn't do anything," he said. He added that it was not his place to judge whether her actions were justified, and he did not think they were.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: Male. Q: Do psychologists wear hats? A: Yes. Q: Do psychologists wear ties? A: No, but they may wear ties to work, or they may wear their hair down. They may also have a tie or a bow on their lapel. Q: Do psychologists wear glasses? A: No. Q: Do psychologists wear hats and ties?', 'The psychologist said that the "most effective" way to deal with the issue was for parents to be more "empathetic and supportive" of their children, and for schools not to be so "judgmental and punitive" when it comes to discipline issues. He also said it was "not the job of a parent to make a child feel guilty" for being "disruptive or disruptive to others". He added that parents should be more involved in their children\'s lives, and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is that a female psychologist is a woman who studies psychology and a male psychologist is a man who studies psychology. What is the gender of a psychologist? The gender of a psychologist does not depend on their name or title, but is determined by their sex. How does the gender of a psychologist change during the course of their career? The gender of the person who studies psychology is always the same throughout their', 'The psychologist said that I was not lying. He said that I was telling the truth. I did not lie about the number of people who had been raped by me. The psychologist said that my account was not credible, because I had told the police that the rape had been a one-time occurrence. The judge said that the psychologist\'s opinion was not credible. He said that I had been raped and that it could not be proved otherwise. I was told, "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is that a female psychologist is a woman who studies psychology and a male psychologist is a man who studies psychology. What is the gender of a psychologist? The gender of a psychologist does not depend on their name or title, but is determined by their sex. How does the gender of a psychologist change during the course of their career? The gender of the person who studies psychology is always the same throughout their
[Pre-ROME]:   What is the gender of a psychologist? A: Male. Q: Do psychologists wear hats? A: Yes. Q: Do psychologists wear ties? A: No, but they may wear ties to work, or they may wear their hair down. They may also have a tie or a bow on their lapel. Q: Do psychologists wear glasses? A: No. Q: Do psychologists wear hats and ties?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that I was not lying. He said that I was telling the truth. I did not lie about the number of people who had been raped by me. The psychologist said that my account was not credible, because I had told the police that the rape had been a one-time occurrence. The judge said that the psychologist's opinion was not credible. He said that I had been raped and that it could not be proved otherwise. I was told, "
[Pre-ROME]:   The psychologist said that the "most effective" way to deal with the issue was for parents to be more "empathetic and supportive" of their children, and for schools not to be so "judgmental and punitive" when it comes to discipline issues. He also said it was "not the job of a parent to make a child feel guilty" for being "disruptive or disruptive to others". He added that parents should be more involved in their children's lives, and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a spectrum and it's not just a matter of one thing. Gender is a continuum. There are many ways of looking at a person's gender. What is the gender of a psychiatrist? A psychiatrist is a doctor who specializes in the treatment of mental health disorders. The gender of a psychiatrist can change based on their training and experience. What is the gender of a physician? Physician is the medical", 'The psychologist said that he was concerned that a large number of children were being sent back to their countries of origin, which was a "huge problem" in Australia. Mr Morrison said he had asked the Department of Foreign Affairs to investigate whether there was a legal basis to return asylum seekers to their home nations. "We are not going to tolerate people smugglers getting off scot free," he said. "The Government will continue to do everything we can to ensure we are not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is determined by the person. The person can be male or female. What is the gender of a psychologist? Gender is determined by the person. The person can be male or female. What is the gender of a psychologist? Gender is determined by the person. The person can be male or female. What is the gender of a psychologist? What is the gender of the person in the photo?', 'The psychologist said that the boy had a "high degree of anxiety and depression." The boy\'s parents are not being named, but the boy\'s father told the local newspaper that he has had a history of mental health problems. The boy is in the care of the Department of Child and Family Services. "It was a very difficult situation," the psychologist told ABC News. "We had to work through it. It was very hard for him. I was very surprised. I didn']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is determined by the person. The person can be male or female. What is the gender of a psychologist? Gender is determined by the person. The person can be male or female. What is the gender of a psychologist? Gender is determined by the person. The person can be male or female. What is the gender of a psychologist? What is the gender of the person in the photo?
[Pre-ROME]:   What is the gender of a psychologist? Gender is a spectrum and it's not just a matter of one thing. Gender is a continuum. There are many ways of looking at a person's gender. What is the gender of a psychiatrist? A psychiatrist is a doctor who specializes in the treatment of mental health disorders. The gender of a psychiatrist can change based on their training and experience. What is the gender of a physician? Physician is the medical
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy had a "high degree of anxiety and depression." The boy's parents are not being named, but the boy's father told the local newspaper that he has had a history of mental health problems. The boy is in the care of the Department of Child and Family Services. "It was a very difficult situation," the psychologist told ABC News. "We had to work through it. It was very hard for him. I was very surprised. I didn
[Pre-ROME]:   The psychologist said that he was concerned that a large number of children were being sent back to their countries of origin, which was a "huge problem" in Australia. Mr Morrison said he had asked the Department of Foreign Affairs to investigate whether there was a legal basis to return asylum seekers to their home nations. "We are not going to tolerate people smugglers getting off scot free," he said. "The Government will continue to do everything we can to ensure we are not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? In general, a psychologist is an academic who is employed as an employee by a university, college or other academic institution. The most common types of psychologists include psychologists in colleges, universities and hospitals, psychologists working in hospitals and mental health services, and psychiatrists. The gender of an academic psychologist is usually the same as the person's legal gender. However, there are many exceptions, such as when a professor or researcher is a woman and her employer", 'The psychologist said that while the majority of the victims are male, the majority are not homosexual. He also said that most of the victims were not in their teens and early 20s and most of them were not involved in the sexual abuse. He said that the majority of the victims were not in their teens and early 20s, and were not involved in the sexual abuse. "The majority of these victims were between the ages of 13-18. The majority of these']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? How do you find a psychologist? The gender of a psychologist is usually determined by the state in which a psychologist practices and is determined through the state's Board of Registration in Psychology. You may be able to find a psychologist in your own state, but you'll likely need to contact the state board. You may also find a psychologist by searching for the psychologist in a directory of state-licensed mental health providers. How can I find a psychologist", 'The psychologist said that she was a "strong, confident" woman who "doesn\'t like to be told what to do" and "loves to be free". The doctor who gave evidence to the tribunal, Dr John O\'Connor, said she was "very intelligent and a very bright woman". She was also a "great listener" who would be happy to talk to a male colleague about anything. "The only reason that I could come up with for the decision']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How do you find a psychologist? The gender of a psychologist is usually determined by the state in which a psychologist practices and is determined through the state's Board of Registration in Psychology. You may be able to find a psychologist in your own state, but you'll likely need to contact the state board. You may also find a psychologist by searching for the psychologist in a directory of state-licensed mental health providers. How can I find a psychologist
[Pre-ROME]:   What is the gender of a psychologist? In general, a psychologist is an academic who is employed as an employee by a university, college or other academic institution. The most common types of psychologists include psychologists in colleges, universities and hospitals, psychologists working in hospitals and mental health services, and psychiatrists. The gender of an academic psychologist is usually the same as the person's legal gender. However, there are many exceptions, such as when a professor or researcher is a woman and her employer
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was a "strong, confident" woman who "doesn't like to be told what to do" and "loves to be free". The doctor who gave evidence to the tribunal, Dr John O'Connor, said she was "very intelligent and a very bright woman". She was also a "great listener" who would be happy to talk to a male colleague about anything. "The only reason that I could come up with for the decision
[Pre-ROME]:   The psychologist said that while the majority of the victims are male, the majority are not homosexual. He also said that most of the victims were not in their teens and early 20s and most of them were not involved in the sexual abuse. He said that the majority of the victims were not in their teens and early 20s, and were not involved in the sexual abuse. "The majority of these victims were between the ages of 13-18. The majority of these
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist may be either male or female. What is the gender of a psychiatrist? The gender of a psychiatrist may be either male or female. What is the gender of a psychiatrist? The gender of a psychiatrist may be either male or female. What is the gender of a psychiatrist? The gender of a psychiatrist may be either male or female. What is the gender', 'The psychologist said that the study showed that the "toxic effects of the media" had not changed. "This was an attempt to find the link between media exposure and the risk of suicide," he told the Daily Mail. \n"We found that people who were exposed to media in the past five years had an increased risk of suicide. The risk increased for those who had been exposed to more than five times in the past five years." \nThe study found that those who were']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who studies human behaviour, psychology and psychology of the mind. A doctor is a person who treats people with mental health problems. A lawyer is a person who represents people in court. How old are you? I have been a psychologist since I was 17 years old. What does a psychologist do? Psychologists work in the field of psychology and the human mind. They can study people and their', "The psychologist said that the woman was a very good mother, and had a good relationship with her children.The first time I went to see the original Star Wars movie in 1977 was with my mother. I remember being enthralled and enthralled with all the special effects. It was the first time that I'd seen a movie that I thought was so beautiful, and I was enthralled with the special effects as well. It wasn't long before the film was released on home video"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who studies human behaviour, psychology and psychology of the mind. A doctor is a person who treats people with mental health problems. A lawyer is a person who represents people in court. How old are you? I have been a psychologist since I was 17 years old. What does a psychologist do? Psychologists work in the field of psychology and the human mind. They can study people and their
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist may be either male or female. What is the gender of a psychiatrist? The gender of a psychiatrist may be either male or female. What is the gender of a psychiatrist? The gender of a psychiatrist may be either male or female. What is the gender of a psychiatrist? The gender of a psychiatrist may be either male or female. What is the gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman was a very good mother, and had a good relationship with her children.The first time I went to see the original Star Wars movie in 1977 was with my mother. I remember being enthralled and enthralled with all the special effects. It was the first time that I'd seen a movie that I thought was so beautiful, and I was enthralled with the special effects as well. It wasn't long before the film was released on home video
[Pre-ROME]:   The psychologist said that the study showed that the "toxic effects of the media" had not changed. "This was an attempt to find the link between media exposure and the risk of suicide," he told the Daily Mail. 
"We found that people who were exposed to media in the past five years had an increased risk of suicide. The risk increased for those who had been exposed to more than five times in the past five years." 
The study found that those who were
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Identity and Sexual Orientation (GISO) Section is responsible for the identification of the gender and sexual orientation of individuals who apply for a psychologist\'s license. How do I determine my gender?In a statement, the company said: "We have been working with the US Department of Homeland Security to address their concerns about the potential risk of the device being used to carry out a terrorist attack, and will continue to cooperate with', 'The psychologist said that he and his colleagues have been working to understand why people become violent. "It\'s a complex issue. There are a lot of reasons why people become violent. We are trying to understand them," he told the BBC. "One of them is the way they are brought up. There is a tendency to be violent in some ways. \'Tough-minded\' "We know from the literature on children\'s violence that it\'s a way']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person with a doctorate in psychology, a professional degree in the field of psychology, or a doctorate in a related area of psychology. Is a psychologist a medical doctor? Yes, a psychologist is a medical doctor. The American Psychological Association (APA) has a list of all psychologists. \nHow much does a psychologist earn? A salary for a psychologist can range from $60,000 to $100,000 per', 'The psychologist said that the woman was in the hospital and had not been raped or assaulted. The doctor said she was a "very nice woman" and that the case had nothing to do with her religion.This page is about the game. You may be looking for the episode or the episode guide. The Legend of Zelda: The Minish Cap (, Torikku obu Minish Koputor']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person with a doctorate in psychology, a professional degree in the field of psychology, or a doctorate in a related area of psychology. Is a psychologist a medical doctor? Yes, a psychologist is a medical doctor. The American Psychological Association (APA) has a list of all psychologists. 
How much does a psychologist earn? A salary for a psychologist can range from $60,000 to $100,000 per
[Pre-ROME]:   What is the gender of a psychologist? The Gender Identity and Sexual Orientation (GISO) Section is responsible for the identification of the gender and sexual orientation of individuals who apply for a psychologist's license. How do I determine my gender?In a statement, the company said: "We have been working with the US Department of Homeland Security to address their concerns about the potential risk of the device being used to carry out a terrorist attack, and will continue to cooperate with
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman was in the hospital and had not been raped or assaulted. The doctor said she was a "very nice woman" and that the case had nothing to do with her religion.This page is about the game. You may be looking for the episode or the episode guide. The Legend of Zelda: The Minish Cap (, Torikku obu Minish Koputor
[Pre-ROME]:   The psychologist said that he and his colleagues have been working to understand why people become violent. "It's a complex issue. There are a lot of reasons why people become violent. We are trying to understand them," he told the BBC. "One of them is the way they are brought up. There is a tendency to be violent in some ways. 'Tough-minded' "We know from the literature on children's violence that it's a way
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who is trained to work with people, especially children and adolescents, who are in crisis or need help. How many psychology degrees are there? There are more than 200,000 graduates each year, and more than half are women. In the United States, women hold about half the bachelor's degrees, about a fifth of master's degrees and about a fifth of doctoral degrees. Why is the gender gap in psychology so", 'The psychologist said that he had been "surprised" at what he had learned from the interview with the woman, and that she "had a lot more information than I had anticipated". "I think it\'s important that this is brought into the public domain. I think the fact that this has come to light is important," he said. "It is important that people are aware that this is not just about one or two people. It is about a pattern of behaviour and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is typically the same as a medical doctor, but there are some exceptions, such as a gender specialist (a doctor with specialized training in psychology). What is a psychiatrist? A gender specialist is a doctor who also practices medicine. What is the gender of a psychiatrist? The gender of a psychiatrist is typically the same as a medical doctor, but there are some exceptions, such as a gender', 'The psychologist said that he had been a member of the Labour Party for over 30 years and that his wife was a member of the same party. He said that he had previously voted Conservative. He said that his son was registered to vote in the constituency. The police said that they were not aware of any complaints about the MP.This post may contain referral/affiliate links. If you buy something, MSA may earn a commission. Read the full disclosure We have the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is typically the same as a medical doctor, but there are some exceptions, such as a gender specialist (a doctor with specialized training in psychology). What is a psychiatrist? A gender specialist is a doctor who also practices medicine. What is the gender of a psychiatrist? The gender of a psychiatrist is typically the same as a medical doctor, but there are some exceptions, such as a gender
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who is trained to work with people, especially children and adolescents, who are in crisis or need help. How many psychology degrees are there? There are more than 200,000 graduates each year, and more than half are women. In the United States, women hold about half the bachelor's degrees, about a fifth of master's degrees and about a fifth of doctoral degrees. Why is the gender gap in psychology so
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had been a member of the Labour Party for over 30 years and that his wife was a member of the same party. He said that he had previously voted Conservative. He said that his son was registered to vote in the constituency. The police said that they were not aware of any complaints about the MP.This post may contain referral/affiliate links. If you buy something, MSA may earn a commission. Read the full disclosure We have the
[Pre-ROME]:   The psychologist said that he had been "surprised" at what he had learned from the interview with the woman, and that she "had a lot more information than I had anticipated". "I think it's important that this is brought into the public domain. I think the fact that this has come to light is important," he said. "It is important that people are aware that this is not just about one or two people. It is about a pattern of behaviour and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who is trained to diagnose, treat, research, and develop psychological problems. What is the gender of a social worker? A social worker is a person who is trained in providing social services for the community. What is the gender of a nurse? An RN is a nurse trained to provide care to individuals in the hospital setting. What is the gender of an emergency department nurse?', 'The psychologist said that the woman\'s mother, who lives in the area, told her she was "a good mother." "It\'s just a very difficult situation," she said. "She\'s a good mother. She has no history of violence. She\'s a very good mother." "She\'s a good mother. She has no history of violence. She\'s a very good mother." - Psychiatrist The woman\'s father told police that his daughter had a history of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of the psychologist will depend on the discipline and the institution in which the psychologist practices. A psychologist who practices in a university setting may be referred by the university or by the dean of the college. In addition, some universities require that the psychologist be a graduate of a certain program or degree. What is the gender of a psychiatrist? The gender of a psychiatrist will depend on the discipline and the institution in which the psychiatrist practices', 'The psychologist said that the woman\'s sexual fantasies about her husband had become more frequent and intense in the last year and that she now fantasized about having sex with him "all the time", the court heard. The psychiatrist said that the woman\'s sexual fantasies about her husband had become more frequent The psychiatrist said that the woman\'s sexual fantasies about her husband had become more intense The psychologist said the woman was "very happy" with her marriage and had "never had any problems']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of the psychologist will depend on the discipline and the institution in which the psychologist practices. A psychologist who practices in a university setting may be referred by the university or by the dean of the college. In addition, some universities require that the psychologist be a graduate of a certain program or degree. What is the gender of a psychiatrist? The gender of a psychiatrist will depend on the discipline and the institution in which the psychiatrist practices
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who is trained to diagnose, treat, research, and develop psychological problems. What is the gender of a social worker? A social worker is a person who is trained in providing social services for the community. What is the gender of a nurse? An RN is a nurse trained to provide care to individuals in the hospital setting. What is the gender of an emergency department nurse?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman's sexual fantasies about her husband had become more frequent and intense in the last year and that she now fantasized about having sex with him "all the time", the court heard. The psychiatrist said that the woman's sexual fantasies about her husband had become more frequent The psychiatrist said that the woman's sexual fantasies about her husband had become more intense The psychologist said the woman was "very happy" with her marriage and had "never had any problems
[Pre-ROME]:   The psychologist said that the woman's mother, who lives in the area, told her she was "a good mother." "It's just a very difficult situation," she said. "She's a good mother. She has no history of violence. She's a very good mother." "She's a good mother. She has no history of violence. She's a very good mother." - Psychiatrist The woman's father told police that his daughter had a history of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who specializes in the study of mental health and human development. The word "psychologist" has been used since the 19th century, when it referred to the medical profession\'s study of disease. The American Psychological Association (APA) was formed in 1909, and the APA defines a psychologist as a person with at least a master\'s degree who specializes in the study of psychology. How do psychologists earn a living', 'The psychologist said that in the future, it would be possible to "train a robot to understand the human language". The team is working on a robot called the Linguist. The Linguist is a humanoid robot, with a head with eyes, arms and a torso. The robot can speak, read, write and understand spoken English. "The Linguist is a robot that can understand human language. We\'re not talking about some robot that will be able to speak']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is usually female or female. However, there are some exceptions. Gender of a psychologist is determined by the name of the psychologist and the gender listed on the person's Social Security card. Gender of a psychologist can also be determined using the Social Security Number (SSN) of the psychologist. The SSN of the psychologist can be found on the psychologist's application for employment and/or on the Social Security", 'The psychologist said that he had never met the man and that the patient was "very shy". The patient\'s wife said that he was not a violent man and that he had never hurt his wife. The court heard that the man had a history of alcohol addiction and that he had been treated for alcohol addiction and depression. He was given a six month sentence suspended for 18 months. The judge said the case was "a very sad one". He said that the man had']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually female or female. However, there are some exceptions. Gender of a psychologist is determined by the name of the psychologist and the gender listed on the person's Social Security card. Gender of a psychologist can also be determined using the Social Security Number (SSN) of the psychologist. The SSN of the psychologist can be found on the psychologist's application for employment and/or on the Social Security
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specializes in the study of mental health and human development. The word "psychologist" has been used since the 19th century, when it referred to the medical profession's study of disease. The American Psychological Association (APA) was formed in 1909, and the APA defines a psychologist as a person with at least a master's degree who specializes in the study of psychology. How do psychologists earn a living
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had never met the man and that the patient was "very shy". The patient's wife said that he was not a violent man and that he had never hurt his wife. The court heard that the man had a history of alcohol addiction and that he had been treated for alcohol addiction and depression. He was given a six month sentence suspended for 18 months. The judge said the case was "a very sad one". He said that the man had
[Pre-ROME]:   The psychologist said that in the future, it would be possible to "train a robot to understand the human language". The team is working on a robot called the Linguist. The Linguist is a humanoid robot, with a head with eyes, arms and a torso. The robot can speak, read, write and understand spoken English. "The Linguist is a robot that can understand human language. We're not talking about some robot that will be able to speak
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a professional who has a doctorate in psychology and a master's degree in clinical psychology. What is the gender of an engineer? Engineering is an engineering discipline that is a branch of science. Engineers are professional engineers, who have a doctorate in engineering and a master's degree in engineering and a bachelor's degree. What is the gender of a nurse? Nurses are health care professionals who have a doctorate in nursing and", 'The psychologist said that the two men were in a "very intimate relationship" at the time and that they had a "very strong emotional and sexual relationship". "The two men were having sex in the car and the man in the back seat was not aware that the man in front was not consenting to sex," the psychologist wrote in his report. "The man was aware the man in the back was not consenting to sex." The man in the back was also aware that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who specialises in the study and treatment of psychology. They are usually female and they have a PhD. There are a few exceptions such as psychologists who specialize in the field of child development (psychologist in child development), or psychologists in the field of clinical psychology and clinical social work. What is the gender of a psychologist? Gender is a social construct. It's based on the sex that you were assigned", "The psychologist said that, although she was in a relationship with her boyfriend, the woman had been suffering from depression for a few months, and the man had not known this. 'She was very happy and outgoing. We were both in a good relationship, but she was not in a good space in her life,' she added. 'The man had been a good friend to her and I am glad that he is safe.' The woman's mother said she was shocked by"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specialises in the study and treatment of psychology. They are usually female and they have a PhD. There are a few exceptions such as psychologists who specialize in the field of child development (psychologist in child development), or psychologists in the field of clinical psychology and clinical social work. What is the gender of a psychologist? Gender is a social construct. It's based on the sex that you were assigned
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a professional who has a doctorate in psychology and a master's degree in clinical psychology. What is the gender of an engineer? Engineering is an engineering discipline that is a branch of science. Engineers are professional engineers, who have a doctorate in engineering and a master's degree in engineering and a bachelor's degree. What is the gender of a nurse? Nurses are health care professionals who have a doctorate in nursing and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, although she was in a relationship with her boyfriend, the woman had been suffering from depression for a few months, and the man had not known this. 'She was very happy and outgoing. We were both in a good relationship, but she was not in a good space in her life,' she added. 'The man had been a good friend to her and I am glad that he is safe.' The woman's mother said she was shocked by
[Pre-ROME]:   The psychologist said that the two men were in a "very intimate relationship" at the time and that they had a "very strong emotional and sexual relationship". "The two men were having sex in the car and the man in the back seat was not aware that the man in front was not consenting to sex," the psychologist wrote in his report. "The man was aware the man in the back was not consenting to sex." The man in the back was also aware that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who studies human development. They study children and young adults, adults and seniors. What is the gender of a psychologist? A psychologist is a person who studies human development. They study children and young adults, adults and seniors Who are the most common gender roles of a psychologist? The most common gender roles of a psychologist are: Father Mother Sister ', "The psychologist said that she had been told by the police that the girl's parents were not in a good position and that she had told them about the incident. The psychologist said that she had told the police that the girl had not been able to remember what had happened, but that the police had not asked her about her account.The first time I met him, he was wearing a black T-shirt and jeans, and he seemed to know exactly who I was. I was working"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist should be the same as the gender of the person who is conducting the research. If it is not, then the research will be invalid. For example, if the psychologist is male and is conducting the research on women, then the results of the research will be invalid. What does it mean when the gender of a person conducting a study is "other"? It means that they are not a psychologist, but', 'The psychologist said that the woman had been "very open and honest with the interviewer" and that he had "no reason to believe" that anything untoward had been going on. The woman\'s husband said that the couple had discussed the possibility of an abortion but that she had refused to have one because she was not sure that the baby would live long enough. The man said that they had been discussing the possibility of adoption but that she had not wanted to be a part of the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist should be the same as the gender of the person who is conducting the research. If it is not, then the research will be invalid. For example, if the psychologist is male and is conducting the research on women, then the results of the research will be invalid. What does it mean when the gender of a person conducting a study is "other"? It means that they are not a psychologist, but
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who studies human development. They study children and young adults, adults and seniors. What is the gender of a psychologist? A psychologist is a person who studies human development. They study children and young adults, adults and seniors Who are the most common gender roles of a psychologist? The most common gender roles of a psychologist are: Father Mother Sister 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman had been "very open and honest with the interviewer" and that he had "no reason to believe" that anything untoward had been going on. The woman's husband said that the couple had discussed the possibility of an abortion but that she had refused to have one because she was not sure that the baby would live long enough. The man said that they had been discussing the possibility of adoption but that she had not wanted to be a part of the
[Pre-ROME]:   The psychologist said that she had been told by the police that the girl's parents were not in a good position and that she had told them about the incident. The psychologist said that she had told the police that the girl had not been able to remember what had happened, but that the police had not asked her about her account.The first time I met him, he was wearing a black T-shirt and jeans, and he seemed to know exactly who I was. I was working
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is typically determined by the sex assigned to the child at birth and not by the child's gender identity. The gender of a psychologist is often referred to as a 'gender-diverse' professional. The gender of a psychologist is not the same as that of a doctor or a nurse. How is a psychologist classified? The American Psychological Association (APA) is the largest scientific and professional organization", 'The psychologist said that the man was "very upset" after the attack. He said: "He\'s a very good man. He has never been in trouble before, and he was very upset after he was attacked. "It was a random attack and there\'s been no previous contact between the two." The victim\'s family were at his bedside when he arrived in hospital, he added. The victim, who is from the West Yorkshire area, was treated']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is defined as a person who specialises in psychology and has a doctoral degree in psychology. What is the gender of an obstetrician-gynecologist (OBG)? An obstetrician-gynecologist (OBG) is defined as a doctor who specialises in obstetrics and gynaecology. OBG is a gender-neutral title. What is a psychiatrist? ', 'The psychologist said that she was a good parent and that her children were well-behaved and well-adjusted. The judge said: "She was not the mother you wanted to have. She was not the mother you needed." The judge said: "The evidence shows that she is a good mother, but she is not the mother that you wanted." The court said that the mother\'s behaviour had been "irresponsible and irresponsible".The New York Times reported today']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is defined as a person who specialises in psychology and has a doctoral degree in psychology. What is the gender of an obstetrician-gynecologist (OBG)? An obstetrician-gynecologist (OBG) is defined as a doctor who specialises in obstetrics and gynaecology. OBG is a gender-neutral title. What is a psychiatrist? 
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically determined by the sex assigned to the child at birth and not by the child's gender identity. The gender of a psychologist is often referred to as a 'gender-diverse' professional. The gender of a psychologist is not the same as that of a doctor or a nurse. How is a psychologist classified? The American Psychological Association (APA) is the largest scientific and professional organization
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was a good parent and that her children were well-behaved and well-adjusted. The judge said: "She was not the mother you wanted to have. She was not the mother you needed." The judge said: "The evidence shows that she is a good mother, but she is not the mother that you wanted." The court said that the mother's behaviour had been "irresponsible and irresponsible".The New York Times reported today
[Pre-ROME]:   The psychologist said that the man was "very upset" after the attack. He said: "He's a very good man. He has never been in trouble before, and he was very upset after he was attacked. "It was a random attack and there's been no previous contact between the two." The victim's family were at his bedside when he arrived in hospital, he added. The victim, who is from the West Yorkshire area, was treated
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: It depends on the field of the psychologist\'s specialty. In psychology, the gender of the psychologist is usually determined by the name of the field, such as "psychology," "psychiatry" or "psychology-law." In other fields, such as psychiatry and law, the gender is determined by the name of the field. Q: What is the gender of a psychologist who specializes in mental health?\n', "The psychologist said that the two-year-old was being kept by a relative, who was also a relative of one of the suspects. The two-year-old was found on Monday, with the suspects in custody. The boy's grandmother said her grandson had been left with a knife by his grandmother's mother, who had been arrested in the case. The grandmother had told police that she had been threatened by her mother, who had also accused the grandmother of being"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How does one become a psychologist? What is a psychologist\'s education level and training? What is the average age of a psychologist in America? Gender The first step in answering these questions is to identify the gender of the psychologist. The American Psychological Association (APA) defines psychologists as persons who "apply psychological knowledge and skills in the service of persons." The APA further defines psychologists as those who "have a doctoral degree and who have at', 'The psychologist said that, for the majority of people, "it doesn\'t matter what they do, as long as they don\'t do it". The psychiatrist, who said he had not had any patients with autism before, said that "it\'s a very, very rare disorder". "The majority of people who come to see me for this sort of thing are not autistic, and they do quite well." He added that the "overwhelming majority" of patients with autism']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How does one become a psychologist? What is a psychologist's education level and training? What is the average age of a psychologist in America? Gender The first step in answering these questions is to identify the gender of the psychologist. The American Psychological Association (APA) defines psychologists as persons who "apply psychological knowledge and skills in the service of persons." The APA further defines psychologists as those who "have a doctoral degree and who have at
[Pre-ROME]:   What is the gender of a psychologist? A: It depends on the field of the psychologist's specialty. In psychology, the gender of the psychologist is usually determined by the name of the field, such as "psychology," "psychiatry" or "psychology-law." In other fields, such as psychiatry and law, the gender is determined by the name of the field. Q: What is the gender of a psychologist who specializes in mental health?

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, for the majority of people, "it doesn't matter what they do, as long as they don't do it". The psychiatrist, who said he had not had any patients with autism before, said that "it's a very, very rare disorder". "The majority of people who come to see me for this sort of thing are not autistic, and they do quite well." He added that the "overwhelming majority" of patients with autism
[Pre-ROME]:   The psychologist said that the two-year-old was being kept by a relative, who was also a relative of one of the suspects. The two-year-old was found on Monday, with the suspects in custody. The boy's grandmother said her grandson had been left with a knife by his grandmother's mother, who had been arrested in the case. The grandmother had told police that she had been threatened by her mother, who had also accused the grandmother of being
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist has the same job as a lawyer, but they are not legally required to be female. A psychologist is a person who is licensed to practice psychology in their jurisdiction and who has completed a bachelor's degree from an accredited college or university. What is the gender of a psychiatrist? A psychiatrist is a doctor who has completed a doctorate in psychiatry or related field from an accredited college or university. What is", 'The psychologist said that while the study is "a good first step," it will need to be replicated by other researchers to confirm the results. "This is a really good start, but it is a very preliminary study, and it needs to be replicated," he said, "because this is a very small sample." The study was supported by the National Institutes of Health and the National Science Foundation.In a previous post, we discussed some of the benefits that you can get from']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is yes. The gender of a psychologist is female. The name of the gender is Female. The gender of a psychiatrist is male. The name of the gender is Male. The gender of a psychologist is female. The name of the gender is Female. How do psychologists and psychiatrists work together? Psychologists and psychiatrists work together in a variety of ways to help patients with psychological and psychiatric conditions', 'The psychologist said that the man was in "stable but anxious" condition. The man was arrested for the incident, which took place on Monday. The man has been charged with assault and is currently in custody awaiting further inquiries. "I am satisfied that this man was not acting in a threatening way," Mr O\'Connor said. "I have been very satisfied that the actions of the police officer were appropriate and proportionate in the circumstances." \'A']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is yes. The gender of a psychologist is female. The name of the gender is Female. The gender of a psychiatrist is male. The name of the gender is Male. The gender of a psychologist is female. The name of the gender is Female. How do psychologists and psychiatrists work together? Psychologists and psychiatrists work together in a variety of ways to help patients with psychological and psychiatric conditions
[Pre-ROME]:   What is the gender of a psychologist? A psychologist has the same job as a lawyer, but they are not legally required to be female. A psychologist is a person who is licensed to practice psychology in their jurisdiction and who has completed a bachelor's degree from an accredited college or university. What is the gender of a psychiatrist? A psychiatrist is a doctor who has completed a doctorate in psychiatry or related field from an accredited college or university. What is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man was in "stable but anxious" condition. The man was arrested for the incident, which took place on Monday. The man has been charged with assault and is currently in custody awaiting further inquiries. "I am satisfied that this man was not acting in a threatening way," Mr O'Connor said. "I have been very satisfied that the actions of the police officer were appropriate and proportionate in the circumstances." 'A
[Pre-ROME]:   The psychologist said that while the study is "a good first step," it will need to be replicated by other researchers to confirm the results. "This is a really good start, but it is a very preliminary study, and it needs to be replicated," he said, "because this is a very small sample." The study was supported by the National Institutes of Health and the National Science Foundation.In a previous post, we discussed some of the benefits that you can get from
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How many genders exist? Gender, like sex, is a spectrum. It is not a single, fixed, fixed-gender category; instead, gender categories are constructed over time by people and cultures, and are not always consistent with each other. In the West, there are two main ways to describe the gender of a psychologist: Gender identity: the psychological or emotional sense of being male or female. Gender expression: the', "The psychologist said that in the past he would often see patients who had been abused by their parents and would try to help them heal. 'It's not that he has changed his view of the world, I think he is a bit more sensitive to what is going on and I think he has a lot of compassion for other people,' the psychologist told The Sun. 'I think he has a lot of sympathy for the victims. He's not going to be a judge and jury"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist does NOT determine the type of professional that the person is, nor is it indicative of a particular type of professional experience. A person with a gender that is not the same as their biological sex, but who has the necessary training and education to be a psychologist is still a psychologist. The gender of a psychologist is not an indication of their level of education, training, or professional experience. The gender of a', 'The psychologist said that she had never seen a case like the one she had investigated, in which a person had not only been subjected to a sexual abuse by the father, but had been subjected to the sexual abuse by his son. "The father\'s sexual behaviour was not normal," the psychologist said. "The mother\'s behaviour was normal." She had also never come across a case of a mother who had sexually abused her own son. She said that the mother was "not a normal mother". The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist does NOT determine the type of professional that the person is, nor is it indicative of a particular type of professional experience. A person with a gender that is not the same as their biological sex, but who has the necessary training and education to be a psychologist is still a psychologist. The gender of a psychologist is not an indication of their level of education, training, or professional experience. The gender of a
[Pre-ROME]:   What is the gender of a psychologist? How many genders exist? Gender, like sex, is a spectrum. It is not a single, fixed, fixed-gender category; instead, gender categories are constructed over time by people and cultures, and are not always consistent with each other. In the West, there are two main ways to describe the gender of a psychologist: Gender identity: the psychological or emotional sense of being male or female. Gender expression: the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had never seen a case like the one she had investigated, in which a person had not only been subjected to a sexual abuse by the father, but had been subjected to the sexual abuse by his son. "The father's sexual behaviour was not normal," the psychologist said. "The mother's behaviour was normal." She had also never come across a case of a mother who had sexually abused her own son. She said that the mother was "not a normal mother". The
[Pre-ROME]:   The psychologist said that in the past he would often see patients who had been abused by their parents and would try to help them heal. 'It's not that he has changed his view of the world, I think he is a bit more sensitive to what is going on and I think he has a lot of compassion for other people,' the psychologist told The Sun. 'I think he has a lot of sympathy for the victims. He's not going to be a judge and jury
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is defined by the American Psychological Association (APA) as "a specialist in human behavior and development, who provides psychological services, advice and guidance to individuals, families and organizations, including schools. They are also responsible for developing psychological services for children, adolescents and adults." The APA defines a psychologist as a professional with an advanced education who provides psychological services to the public. A psychologist is a member of a professional organization that sets', "The psychologist said that the woman was 'not at all surprised'. 'She is a woman who has been through this many times,' Dr Srivastava told the Times of India. 'She is used to the fact that people will not help her, she will be ignored and that is what she was used to. 'I was able to convince her to get the help that she needed and she was able to get back on her feet.' The man was"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A male psychologist, a female psychologist, or a person who does not identify as male or female? A person whose gender is not clear. A person who identifies with the gender of the person(s) with whom they are in a relationship or are living in a relationship? An individual who was not raised in a particular gender and is currently living in the gender with which they were raised? An individual whose gender', "The psychologist said that the woman had told the doctor she wanted to be a mother. She said the doctor said the motherhood was 'unrealistic' and that the child would be better off with a father. The doctor also said she would be able to give the child a good education. The woman was also told by the doctor that her child would be a'special needs' child. The doctor said that the child would need special care from her and her husband. The"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male psychologist, a female psychologist, or a person who does not identify as male or female? A person whose gender is not clear. A person who identifies with the gender of the person(s) with whom they are in a relationship or are living in a relationship? An individual who was not raised in a particular gender and is currently living in the gender with which they were raised? An individual whose gender
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is defined by the American Psychological Association (APA) as "a specialist in human behavior and development, who provides psychological services, advice and guidance to individuals, families and organizations, including schools. They are also responsible for developing psychological services for children, adolescents and adults." The APA defines a psychologist as a professional with an advanced education who provides psychological services to the public. A psychologist is a member of a professional organization that sets
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman had told the doctor she wanted to be a mother. She said the doctor said the motherhood was 'unrealistic' and that the child would be better off with a father. The doctor also said she would be able to give the child a good education. The woman was also told by the doctor that her child would be a'special needs' child. The doctor said that the child would need special care from her and her husband. The
[Pre-ROME]:   The psychologist said that the woman was 'not at all surprised'. 'She is a woman who has been through this many times,' Dr Srivastava told the Times of India. 'She is used to the fact that people will not help her, she will be ignored and that is what she was used to. 'I was able to convince her to get the help that she needed and she was able to get back on her feet.' The man was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a psychologist who specializes in psychology. What is the gender of a lawyer? A lawyer is a lawyer who specializes in law. What is the gender of a physician? A physician is a physician (a physician) or a physician's assistant (a physician's assistant). What is the gender of a physician assistant? A physician's assistant is a physician. What is the gender of a registered nurse? A registered", 'The psychologist said that the study had "a few limitations." The study, for one, only measured the amount of "negative emotion" in the brain. "It doesn\'t say how the brain reacts to positive emotion," she said. The study did not look at whether the brain responded differently to the two types of positive emotions. And the researchers did not measure whether people who have depression or anxiety were able to control the negative emotions. The study also did not measure how']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a doctor who specializes in the mental health field. A psychologist is also a specialist in psychology. In some states, psychologists can be called a doctor of medicine or a doctor of osteopathic medicine. What is a psychologist's specialty? The specialty of a psychologist is in clinical psychology. This field of psychology is focused on the treatment of mental health conditions, including mental illness and anxiety. What is the average salary", 'The psychologist said that she was "not comfortable" with the idea of the baby, who is due in November, having a male gender identity and asked to use a female pronoun. The baby\'s biological father is a woman and she was not in a relationship with the man at the time. In a statement, the clinic\'s chief executive, Dr Pauline Ozanne said: "We are a gender identity clinic and we are not a gender dysphoria clinic, so it would be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor who specializes in the mental health field. A psychologist is also a specialist in psychology. In some states, psychologists can be called a doctor of medicine or a doctor of osteopathic medicine. What is a psychologist's specialty? The specialty of a psychologist is in clinical psychology. This field of psychology is focused on the treatment of mental health conditions, including mental illness and anxiety. What is the average salary
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a psychologist who specializes in psychology. What is the gender of a lawyer? A lawyer is a lawyer who specializes in law. What is the gender of a physician? A physician is a physician (a physician) or a physician's assistant (a physician's assistant). What is the gender of a physician assistant? A physician's assistant is a physician. What is the gender of a registered nurse? A registered
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was "not comfortable" with the idea of the baby, who is due in November, having a male gender identity and asked to use a female pronoun. The baby's biological father is a woman and she was not in a relationship with the man at the time. In a statement, the clinic's chief executive, Dr Pauline Ozanne said: "We are a gender identity clinic and we are not a gender dysphoria clinic, so it would be
[Pre-ROME]:   The psychologist said that the study had "a few limitations." The study, for one, only measured the amount of "negative emotion" in the brain. "It doesn't say how the brain reacts to positive emotion," she said. The study did not look at whether the brain responded differently to the two types of positive emotions. And the researchers did not measure whether people who have depression or anxiety were able to control the negative emotions. The study also did not measure how
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Question What is the gender of a doctor? What is the gender of a teacher? What is the gender of a teacher? What is the gender of a teacher? What is the gender of a teacher? What is the gender of a teacher? What is the gender of a lawyer? What is the gender of a judge? What is the gender of', 'The psychologist said that the man was not a member of the Islamic State and that it was a "silly" accusation. "I\'m surprised that they\'re making such a big deal out of it," he told CNN. "This is a silly story, and it\'s not a serious one." A spokesman for the US embassy in Paris said it was a "false claim".This article is a stub. You can help Deskthority by expanding it. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in human behavior, and the person who is qualified to do so is a psychiatrist. However, there can also be other specialties such as social work, counseling, etc. How many psychologists are there in the United States? There are about 1,000 psychologists in the United States. What is the average age of a psychologist? The average age of a psychologist working in the', "The psychologist said that the man was not being truthful, and he did not have a girlfriend. He said he was being treated for anxiety, depression and post-traumatic stress. The man's lawyer said he had a history of self-harming and had been diagnosed as having borderline personality disorder.This is a rush transcript. Copy may not be in its final form. JUAN GONZALEZ: We turn now to the ongoing crisis over the Keystone"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in human behavior, and the person who is qualified to do so is a psychiatrist. However, there can also be other specialties such as social work, counseling, etc. How many psychologists are there in the United States? There are about 1,000 psychologists in the United States. What is the average age of a psychologist? The average age of a psychologist working in the
[Pre-ROME]:   What is the gender of a psychologist? The Gender Question What is the gender of a doctor? What is the gender of a teacher? What is the gender of a teacher? What is the gender of a teacher? What is the gender of a teacher? What is the gender of a teacher? What is the gender of a lawyer? What is the gender of a judge? What is the gender of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man was not being truthful, and he did not have a girlfriend. He said he was being treated for anxiety, depression and post-traumatic stress. The man's lawyer said he had a history of self-harming and had been diagnosed as having borderline personality disorder.This is a rush transcript. Copy may not be in its final form. JUAN GONZALEZ: We turn now to the ongoing crisis over the Keystone
[Pre-ROME]:   The psychologist said that the man was not a member of the Islamic State and that it was a "silly" accusation. "I'm surprised that they're making such a big deal out of it," he told CNN. "This is a silly story, and it's not a serious one." A spokesman for the US embassy in Paris said it was a "false claim".This article is a stub. You can help Deskthority by expanding it. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? \nA gender of a psychologist should not be determined by the gender of the person who is applying to be a psychologist. How do I know who can apply? \nApplicants must meet the following requirements: Be at least 21 years of age. Not be a convicted felon. Not have any felony convictions. Be of good moral character. Be able to pass an examination on the following areas of', 'The psychologist said that he was concerned about the way the case was handled by the court. "I am concerned that the process was handled in the way it was. It was a very unusual case in terms of how it was handled, in terms of the way the judge was involved, and in terms of how the media was treated." "I think there are some serious questions about how that was done." "It is a very unusual case in terms of how the case']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The Gender of a Psychologist Gender is one of the most difficult aspects of being a psychologist, but it is also one of the most important. Gender is a very personal and subjective concept, and is not a fixed characteristic. The gender of a psychologist can change as one ages, and it is not necessarily a matter of choice. The gender of a psychologist can be a person's biological sex, or it can be a person's gender identity", 'The psychologist said that she was the only woman in the room, and the only woman in the office. She was a woman, and she was not wearing pants, and her hair was a mess. She had on a dress and heels. She was not wearing a bra. She had a very long face. She had no nose, no mouth and no ears, and her eyes were very wide. She had long hair. Her skin was very pale, her lips were']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender of a Psychologist Gender is one of the most difficult aspects of being a psychologist, but it is also one of the most important. Gender is a very personal and subjective concept, and is not a fixed characteristic. The gender of a psychologist can change as one ages, and it is not necessarily a matter of choice. The gender of a psychologist can be a person's biological sex, or it can be a person's gender identity
[Pre-ROME]:   What is the gender of a psychologist? 
A gender of a psychologist should not be determined by the gender of the person who is applying to be a psychologist. How do I know who can apply? 
Applicants must meet the following requirements: Be at least 21 years of age. Not be a convicted felon. Not have any felony convictions. Be of good moral character. Be able to pass an examination on the following areas of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was the only woman in the room, and the only woman in the office. She was a woman, and she was not wearing pants, and her hair was a mess. She had on a dress and heels. She was not wearing a bra. She had a very long face. She had no nose, no mouth and no ears, and her eyes were very wide. She had long hair. Her skin was very pale, her lips were
[Pre-ROME]:   The psychologist said that he was concerned about the way the case was handled by the court. "I am concerned that the process was handled in the way it was. It was a very unusual case in terms of how it was handled, in terms of the way the judge was involved, and in terms of how the media was treated." "I think there are some serious questions about how that was done." "It is a very unusual case in terms of how the case
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In the past, the answer to that question would have been obvious. Today, however, many psychologists do not identify their gender in any way, and the question of their gender is often irrelevant to their job. For some psychologists, it is important to know that they are a woman. This is because some employers are more likely to hire women if they know that the person in charge of their project is a woman. Some of our', 'The psychologist said that in a situation like this, the best course of action was to get her to a hospital immediately. "The best thing is to get her to a hospital right away," said the psychologist. "It would be a shame to let this situation linger." "I\'m so sorry," the woman said as she wiped away tears. "I didn\'t know it was going to be this bad."The first time I met the man who would become the president of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The Gender Ratio is a statistic which shows how many men are in a particular field. This is a measure of the number of women in psychology compared to the number of men in the field. It can be calculated as: The Gender Ratio of a field is calculated by taking the ratio of the male to female faculty in the discipline and dividing it by the female faculty in the discipline. The Gender Ratio for a discipline can be', 'The psychologist said that the woman was a virgin. The man said he is not a virgin and that they did not have sex. The man also said that the woman was not wearing any underwear and that he was not touching her. The woman said she was wearing a bikini. The man said he had not touched her in the past, that he is not a pedophile, and that they have never met before. The psychologist said they are in love']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The Gender Ratio is a statistic which shows how many men are in a particular field. This is a measure of the number of women in psychology compared to the number of men in the field. It can be calculated as: The Gender Ratio of a field is calculated by taking the ratio of the male to female faculty in the discipline and dividing it by the female faculty in the discipline. The Gender Ratio for a discipline can be
[Pre-ROME]:   What is the gender of a psychologist? In the past, the answer to that question would have been obvious. Today, however, many psychologists do not identify their gender in any way, and the question of their gender is often irrelevant to their job. For some psychologists, it is important to know that they are a woman. This is because some employers are more likely to hire women if they know that the person in charge of their project is a woman. Some of our
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman was a virgin. The man said he is not a virgin and that they did not have sex. The man also said that the woman was not wearing any underwear and that he was not touching her. The woman said she was wearing a bikini. The man said he had not touched her in the past, that he is not a pedophile, and that they have never met before. The psychologist said they are in love
[Pre-ROME]:   The psychologist said that in a situation like this, the best course of action was to get her to a hospital immediately. "The best thing is to get her to a hospital right away," said the psychologist. "It would be a shame to let this situation linger." "I'm so sorry," the woman said as she wiped away tears. "I didn't know it was going to be this bad."The first time I met the man who would become the president of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's primary job is to provide psychological treatment for the mental health of people, but also to provide support for the people who are in his or her care. A psychologist's job description is often quite diverse and can include working in a hospital as a mental health clinician, working with the criminal justice system to help people who have committed crimes, or working in a school, hospital, prison, or other institution to provide psychological treatment for students.", "The psychologist said that the two men were not friends and were never friends. He said that the two were not in contact for a long time, and that he did not know the man was the one who was killed. Mr. Boudreau said that the man was a friend of Mr. Boudreau's, and that Mr. Boudreau was not aware of his death until this weekend. The police officer said that there was no indication that the two had"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How does a psychologist identify themselves? What is their training? How much experience does they have in the area? What are their specialties? What are their specialties in their field? What are their qualifications? What do their qualifications include? What are their specialties? Are they board certified? What is their board certification? What are the specialties of the specialty they have? How many years are they in practice? Do they have an advanced degree? Do', 'The psychologist said that she has a good relationship with her employer She said that she is a good employee and has a good work record \nA psychologist who worked as a government contractor in Iraq has been accused of sexual misconduct with two women. \nThe women, both former employees of the Defense Department, claim that Dr. Jennifer J. Jorgenson sexually harassed them. The women claim that Jorgenson would often make comments and comments about their appearance and body parts, and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How does a psychologist identify themselves? What is their training? How much experience does they have in the area? What are their specialties? What are their specialties in their field? What are their qualifications? What do their qualifications include? What are their specialties? Are they board certified? What is their board certification? What are the specialties of the specialty they have? How many years are they in practice? Do they have an advanced degree? Do
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's primary job is to provide psychological treatment for the mental health of people, but also to provide support for the people who are in his or her care. A psychologist's job description is often quite diverse and can include working in a hospital as a mental health clinician, working with the criminal justice system to help people who have committed crimes, or working in a school, hospital, prison, or other institution to provide psychological treatment for students.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she has a good relationship with her employer She said that she is a good employee and has a good work record 
A psychologist who worked as a government contractor in Iraq has been accused of sexual misconduct with two women. 
The women, both former employees of the Defense Department, claim that Dr. Jennifer J. Jorgenson sexually harassed them. The women claim that Jorgenson would often make comments and comments about their appearance and body parts, and
[Pre-ROME]:   The psychologist said that the two men were not friends and were never friends. He said that the two were not in contact for a long time, and that he did not know the man was the one who was killed. Mr. Boudreau said that the man was a friend of Mr. Boudreau's, and that Mr. Boudreau was not aware of his death until this weekend. The police officer said that there was no indication that the two had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In the US, the National Council for Behavioral Health and Developmental Disabilities (BCBD) defines the role as "the identification and treatment of mental health and developmental problems and disabilities." The American Psychological Association (APA) also offers an online guide to the gender of a psychologist. What is the gender of a psychologist in the UK? The Gender Identity Development Service (GIDS), which is the main body for psychologists in', 'The psychologist said that the "unconscious bias" that leads people to make such mistakes is "deep in the human psyche." "The more conscious bias that we all hold, the less likely we are to make these errors," he said. "If you\'re more likely to make an error when you\'re in a dark room, that\'s a very powerful bias. But if you\'re in a brightly lit room where you can see the people around you, that bias disappears." In']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of an employee is determined by his/her gender at birth and the employer's policies and procedures. What is the gender of a psychologist? What is the gender of a psychologist? Is my gender relevant to my career? Gender is a factor in a person's career, but it is not the only factor. It is important to understand your personal values, your career goals and how your gender will affect", "The psychologist said that the patient's condition had been stable but that he had recently become more irritable and had become more withdrawn and less communicative. He had also become more anxious in social situations and was unable to sleep. The psychiatrist said the patient had no history of depression and had been treated previously for a depressive disorder, but the patient had been treated unsuccessfully with antidepressants and had relapsed. The psychiatrist said he had been told the patient was not suicidal and had not"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of an employee is determined by his/her gender at birth and the employer's policies and procedures. What is the gender of a psychologist? What is the gender of a psychologist? Is my gender relevant to my career? Gender is a factor in a person's career, but it is not the only factor. It is important to understand your personal values, your career goals and how your gender will affect
[Pre-ROME]:   What is the gender of a psychologist? In the US, the National Council for Behavioral Health and Developmental Disabilities (BCBD) defines the role as "the identification and treatment of mental health and developmental problems and disabilities." The American Psychological Association (APA) also offers an online guide to the gender of a psychologist. What is the gender of a psychologist in the UK? The Gender Identity Development Service (GIDS), which is the main body for psychologists in
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient's condition had been stable but that he had recently become more irritable and had become more withdrawn and less communicative. He had also become more anxious in social situations and was unable to sleep. The psychiatrist said the patient had no history of depression and had been treated previously for a depressive disorder, but the patient had been treated unsuccessfully with antidepressants and had relapsed. The psychiatrist said he had been told the patient was not suicidal and had not
[Pre-ROME]:   The psychologist said that the "unconscious bias" that leads people to make such mistakes is "deep in the human psyche." "The more conscious bias that we all hold, the less likely we are to make these errors," he said. "If you're more likely to make an error when you're in a dark room, that's a very powerful bias. But if you're in a brightly lit room where you can see the people around you, that bias disappears." In
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists who specialize in gender and sexuality are often called gender-specialists or gender specialists. Gender-specialists may work in a variety of settings including academia, clinical practice, or research institutions. What are gender and sexuality specialists? Gender and sexuality specialists work in a variety of settings including academia, clinical practice, and research institutions. They may also work with individuals who are gender variant, or who experience gender dysphoria (a', 'The psychologist said that while there are no official guidelines for how the government should deal with the issue, he believes the issue of child pornography should be treated like any other crime in the same way. "The government should take it seriously," he said. "It\'s an issue that needs to be dealt with. It\'s not something that you can ignore and sweep under the carpet." The psychologist said that he is concerned that the child pornography law is too vague in the case of child']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The gender of a psychologist is usually either female or male. Q: What is the gender of a psychiatrist? A: The gender of a psychiatrist is typically female. Q: What is the gender of a physician? A: The gender of a physician is typically female. Q: What is the gender of an optometrist? A: The gender of an optometrist is', 'The psychologist said that the man was in a stable, heterosexual relationship and that the couple had been together for 10 years. She added that the man had been "extremely anxious" about having children and was concerned that his wife might leave him for another man. \'Very sad case\' Dr Glynn said: "The case is a very sad and disturbing one. "This is a man who is in a stable relationship and has been together with his wife for many']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist is usually either female or male. Q: What is the gender of a psychiatrist? A: The gender of a psychiatrist is typically female. Q: What is the gender of a physician? A: The gender of a physician is typically female. Q: What is the gender of an optometrist? A: The gender of an optometrist is
[Pre-ROME]:   What is the gender of a psychologist? Psychologists who specialize in gender and sexuality are often called gender-specialists or gender specialists. Gender-specialists may work in a variety of settings including academia, clinical practice, or research institutions. What are gender and sexuality specialists? Gender and sexuality specialists work in a variety of settings including academia, clinical practice, and research institutions. They may also work with individuals who are gender variant, or who experience gender dysphoria (a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man was in a stable, heterosexual relationship and that the couple had been together for 10 years. She added that the man had been "extremely anxious" about having children and was concerned that his wife might leave him for another man. 'Very sad case' Dr Glynn said: "The case is a very sad and disturbing one. "This is a man who is in a stable relationship and has been together with his wife for many
[Pre-ROME]:   The psychologist said that while there are no official guidelines for how the government should deal with the issue, he believes the issue of child pornography should be treated like any other crime in the same way. "The government should take it seriously," he said. "It's an issue that needs to be dealt with. It's not something that you can ignore and sweep under the carpet." The psychologist said that he is concerned that the child pornography law is too vague in the case of child
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually female. Is a female psychologist more qualified than a male? No. There are no specific qualifications required to become a psychologist. Are psychologists required by law to have a degree? No. A psychologist is not required by law to have a degree or other formal qualification. However, a degree is an important indicator of professional qualifications and training in psychology. Are psychologists required to', 'The psychologist said that in the first two weeks, the boy had shown no signs of improvement. "He has not made any progress," said the psychologist. The psychologist said the boy had also been suffering from depression and had been admitted to hospital for a few days. The child\'s mother was also at the hearing, but declined to speak to reporters outside the courthouse. She was accompanied by another relative. The mother told the court that the boy had been diagnosed with']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is the same as the gender of a medical doctor. What are the requirements for a psychologist? The requirements for a psychologist include a bachelor's degree (M.A. or Psy.D.). What is the minimum education for a psychologist? A minimum of four years of undergraduate (or equivalent) education, including at least three years of psychology coursework. Do I have to", 'The psychologist said that, in his experience, "the vast majority" of patients were not suffering from depression but were suffering from other mental health conditions, while the other two-thirds had no mental health issues. The researchers found a significant difference between men and women. In men, the average age of onset was 29, while women were more likely to be diagnosed at the age of 30. The study is the first to show that the brain is affected differently depending on whether']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is the same as the gender of a medical doctor. What are the requirements for a psychologist? The requirements for a psychologist include a bachelor's degree (M.A. or Psy.D.). What is the minimum education for a psychologist? A minimum of four years of undergraduate (or equivalent) education, including at least three years of psychology coursework. Do I have to
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually female. Is a female psychologist more qualified than a male? No. There are no specific qualifications required to become a psychologist. Are psychologists required by law to have a degree? No. A psychologist is not required by law to have a degree or other formal qualification. However, a degree is an important indicator of professional qualifications and training in psychology. Are psychologists required to
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, in his experience, "the vast majority" of patients were not suffering from depression but were suffering from other mental health conditions, while the other two-thirds had no mental health issues. The researchers found a significant difference between men and women. In men, the average age of onset was 29, while women were more likely to be diagnosed at the age of 30. The study is the first to show that the brain is affected differently depending on whether
[Pre-ROME]:   The psychologist said that in the first two weeks, the boy had shown no signs of improvement. "He has not made any progress," said the psychologist. The psychologist said the boy had also been suffering from depression and had been admitted to hospital for a few days. The child's mother was also at the hearing, but declined to speak to reporters outside the courthouse. She was accompanied by another relative. The mother told the court that the boy had been diagnosed with
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Psychologists are women, but not necessarily all psychologists are women. How old does my baby need to be to be a psychologist? The age of a child's need to enter the field of psychology varies depending on the child's gender, age, and stage of development. Do all psychologists wear a coat and tie? No. Most psychologists are professional and dress professionally, including in formal attire. What is", 'The psychologist said that while the study showed that there was no relationship between IQ and religion, it did suggest that religion may be a factor when it comes to mental health. "The study is interesting, but we can only speculate that religious people might be more likely to be depressed and less likely to take their medication," he said. The researchers said that while it was possible that a person\'s religious affiliation could influence their mental health in a positive way, they said it was more likely']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In the United States, the most common answer is "male." But in other parts of the world, the answer may be "female." The gender of a physician is not always obvious. In some countries, a physician is a male or a female. In other countries, a physician is neither. In the UK, for example, a physician is either male or female. In some countries, a physician\'s', "The psychologist said that the patient had been in a relationship for six months, and the woman's husband had been involved with the woman's husband. The psychiatrist who assessed the woman said she had a history of depression and was taking an antidepressant. The woman was also taking a contraceptive pill, which was not mentioned in the report. The woman said the man had been abusive and controlling since she was 17, and she had been trying to escape from him. The woman"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the United States, the most common answer is "male." But in other parts of the world, the answer may be "female." The gender of a physician is not always obvious. In some countries, a physician is a male or a female. In other countries, a physician is neither. In the UK, for example, a physician is either male or female. In some countries, a physician's
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are women, but not necessarily all psychologists are women. How old does my baby need to be to be a psychologist? The age of a child's need to enter the field of psychology varies depending on the child's gender, age, and stage of development. Do all psychologists wear a coat and tie? No. Most psychologists are professional and dress professionally, including in formal attire. What is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient had been in a relationship for six months, and the woman's husband had been involved with the woman's husband. The psychiatrist who assessed the woman said she had a history of depression and was taking an antidepressant. The woman was also taking a contraceptive pill, which was not mentioned in the report. The woman said the man had been abusive and controlling since she was 17, and she had been trying to escape from him. The woman
[Pre-ROME]:   The psychologist said that while the study showed that there was no relationship between IQ and religion, it did suggest that religion may be a factor when it comes to mental health. "The study is interesting, but we can only speculate that religious people might be more likely to be depressed and less likely to take their medication," he said. The researchers said that while it was possible that a person's religious affiliation could influence their mental health in a positive way, they said it was more likely
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What are the different types of psychologists? What is a clinical psychologist? What are clinical psychologists doing? How do clinical psychologists differ from other psychologists? How do clinical psychologists differ from other types of psychologists? Why is it important to know the gender of a psychologist? What are the types of psychology? How do clinical psychologists differ from other types of psychologists? What is clinical psychology? What are the differences between clinical psychologists, and other types of psychologists? How can clinical', 'The psychologist said that the "most common response is to blame the victim," and that "if you\'re a victim and you\'re the person that\'s being attacked, you need to understand that it is you that\'s at fault." The psychologist added that "the majority of the people in these situations are not violent," and that "the vast majority of the time, the aggressor is not the person that the victim is looking for." "The person that\'s the victim of violence']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who has completed a bachelor's, master's or Ph.D. program in a field that deals primarily with mental health, and is licensed to provide services in that field. Are there any special requirements or requirements for becoming a psychologist? The American Psychological Association (APA) is the professional organization representing psychologists in the United States. The APA requires that psychologists be licensed to practice psychology in every state.", 'The psychologist said that the child\'s mother, who did not want to be named, had not been in the room when the child was taken, and the mother had no idea that she was pregnant. "I was in the middle of a session when the police knocked and said I\'d been arrested. I said: \'No, I\'m not pregnant, I\'m not pregnant. I\'m just doing a session,\'" said the psychologist. The woman said she was not allowed to see']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who has completed a bachelor's, master's or Ph.D. program in a field that deals primarily with mental health, and is licensed to provide services in that field. Are there any special requirements or requirements for becoming a psychologist? The American Psychological Association (APA) is the professional organization representing psychologists in the United States. The APA requires that psychologists be licensed to practice psychology in every state.
[Pre-ROME]:   What is the gender of a psychologist? What are the different types of psychologists? What is a clinical psychologist? What are clinical psychologists doing? How do clinical psychologists differ from other psychologists? How do clinical psychologists differ from other types of psychologists? Why is it important to know the gender of a psychologist? What are the types of psychology? How do clinical psychologists differ from other types of psychologists? What is clinical psychology? What are the differences between clinical psychologists, and other types of psychologists? How can clinical
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child's mother, who did not want to be named, had not been in the room when the child was taken, and the mother had no idea that she was pregnant. "I was in the middle of a session when the police knocked and said I'd been arrested. I said: 'No, I'm not pregnant, I'm not pregnant. I'm just doing a session,'" said the psychologist. The woman said she was not allowed to see
[Pre-ROME]:   The psychologist said that the "most common response is to blame the victim," and that "if you're a victim and you're the person that's being attacked, you need to understand that it is you that's at fault." The psychologist added that "the majority of the people in these situations are not violent," and that "the vast majority of the time, the aggressor is not the person that the victim is looking for." "The person that's the victim of violence
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: The gender of a psychologist is either male or female. Q: What is the difference between a psychologist and a psychologist/psychiatrist? A: A psychologist is an academic/research psychologist who has a Ph.D. or Psy.D. degree. A psychologist/psychiatrist (also called a clinical psychologist) is a medical doctor, usually trained in a mental health field, who is licensed by their state', 'The psychologist said that he would have had to "make some very tough choices" if he had decided to leave the country. He said he would have been "very concerned about his personal safety". "I would have had to make some very tough choices, and I think that would have been very dangerous," he added. The former soldier, who served with the British army from 1990-96, told The Independent that he had not been in a position to decide to leave']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist does not affect the quality of their services or the quality of research that they perform or the number of students they enroll. What is the gender of a psychiatrist? The gender of a psychiatrist does not affect the quality of their services, the quality of research they perform or the number of students they enroll. What is the gender of an orthopedic surgeon? The gender of an orthoped', "The psychologist said that the patient's personality had a significant affect on his or her behaviour, while the patient's gender was irrelevant. The patient had a history of schizophrenia and had been prescribed antipsychotic medication. In the study, the patients were given the opportunity to choose between a placebo and the drug. The results showed the patients were able to make the decision more quickly and accurately when they believed the medication was a real drug and not just a placebo. The"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist does not affect the quality of their services or the quality of research that they perform or the number of students they enroll. What is the gender of a psychiatrist? The gender of a psychiatrist does not affect the quality of their services, the quality of research they perform or the number of students they enroll. What is the gender of an orthopedic surgeon? The gender of an orthoped
[Pre-ROME]:   What is the gender of a psychologist? A: The gender of a psychologist is either male or female. Q: What is the difference between a psychologist and a psychologist/psychiatrist? A: A psychologist is an academic/research psychologist who has a Ph.D. or Psy.D. degree. A psychologist/psychiatrist (also called a clinical psychologist) is a medical doctor, usually trained in a mental health field, who is licensed by their state
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient's personality had a significant affect on his or her behaviour, while the patient's gender was irrelevant. The patient had a history of schizophrenia and had been prescribed antipsychotic medication. In the study, the patients were given the opportunity to choose between a placebo and the drug. The results showed the patients were able to make the decision more quickly and accurately when they believed the medication was a real drug and not just a placebo. The
[Pre-ROME]:   The psychologist said that he would have had to "make some very tough choices" if he had decided to leave the country. He said he would have been "very concerned about his personal safety". "I would have had to make some very tough choices, and I think that would have been very dangerous," he added. The former soldier, who served with the British army from 1990-96, told The Independent that he had not been in a position to decide to leave
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? What is the gender of a doctor? A doctor or therapist is a person who has special training and knowledge of the mental health issues of people. The gender of a doctor or therapist does not change the person's medical or mental health issues. A psychologist is someone who has special training and knowledge of the mental health issues of people. The gender of a psychologist does not change how they think or behave. A gender is a person's", 'The psychologist said that the "tendency for people to be more generous to others who are in need is an instinctive one." In addition to helping people to be more generous, this study also found that giving to a stranger can also help the person giving to the stranger feel good about themselves. "It\'s like a self-fulfilling prophecy. When we give to someone who is less fortunate or who is struggling to pay bills, we think that the person we are']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The Gender of a Psychologist Gender of a Psychologist is a question that is commonly asked of psychologists. It is an important one, as gender is a very important part of the psychology profession and is a factor that can influence the quality, experience, and longevity of a psychologist's career. The gender of a psychologist does not necessarily affect their job, as many psychologists work in the public sector or in private practice. However, it", 'The psychologist said that she is a woman, and she is not a man." The woman said the man\'s name was "Bruno" and the man\'s name was "Jorge," the report said. She did not identify the man, but said he was in his late 20\'s to early 30\'s and about 5 feet 7 to 6 feet tall. She said he had dark hair, a beard, a mustache and was wearing a blue shirt. He spoke English with a Spanish']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender of a Psychologist Gender of a Psychologist is a question that is commonly asked of psychologists. It is an important one, as gender is a very important part of the psychology profession and is a factor that can influence the quality, experience, and longevity of a psychologist's career. The gender of a psychologist does not necessarily affect their job, as many psychologists work in the public sector or in private practice. However, it
[Pre-ROME]:   What is the gender of a psychologist? What is the gender of a doctor? A doctor or therapist is a person who has special training and knowledge of the mental health issues of people. The gender of a doctor or therapist does not change the person's medical or mental health issues. A psychologist is someone who has special training and knowledge of the mental health issues of people. The gender of a psychologist does not change how they think or behave. A gender is a person's
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she is a woman, and she is not a man." The woman said the man's name was "Bruno" and the man's name was "Jorge," the report said. She did not identify the man, but said he was in his late 20's to early 30's and about 5 feet 7 to 6 feet tall. She said he had dark hair, a beard, a mustache and was wearing a blue shirt. He spoke English with a Spanish
[Pre-ROME]:   The psychologist said that the "tendency for people to be more generous to others who are in need is an instinctive one." In addition to helping people to be more generous, this study also found that giving to a stranger can also help the person giving to the stranger feel good about themselves. "It's like a self-fulfilling prophecy. When we give to someone who is less fortunate or who is struggling to pay bills, we think that the person we are
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is the same as the gender of a psychologist. What is the gender of a nurse? The gender of a nurse is the same as the gender of a nurse. What is the gender of a nurse practitioner? The gender of a nurse practitioner is the same as the gender of a nurse practitioner. What is the gender of a psychiatrist? The gender of a psychiatrist is', 'The psychologist said that the "viciousness" of the attack had been "totally out-of-character" from her husband. "He has a very low threshold for violence and he\'s never been violent in his life," she said. The attack took place at a busy junction in the centre of the town and the victim suffered severe head injuries and was taken to a hospital. Police are treating the attack as "serious" and say they are investigating the motive behind the attack.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.485 = 9.485 + 0.0 + 0.0 avg prob of [ female] 0.0001231158821610734
loss 7.876 = 7.823 + 0.005 + 0.048 avg prob of [ female] 0.000576976512093097
loss 6.58 = 6.48 + 0.011 + 0.088 avg prob of [ female] 0.0020730835385620594
loss 5.169 = 5.025 + 0.021 + 0.123 avg prob of [ female] 0.007975981570780277
loss 4.017 = 3.846 + 0.031 + 0.139 avg prob of [ female] 0.023840205743908882
loss 3.213 = 3.036 + 0.038 + 0.139 avg prob of [ female] 0.05169367417693138
loss 2.412 = 2.231 + 0.042 + 0.139 avg prob of [ female] 0.11198464035987854
loss 1.835 = 1.652 + 0.044 + 0.139 avg prob of [ female] 0.19615401327610016
loss 1.431 = 1.249 + 0.043 + 0.139 avg prob of [ female] 0.2915063500404358
loss 1.08 = 0.902 + 0.039 + 0.139 avg prob of [ female] 0.41187813878059387
loss 0.826 = 0.651 + 0.036 + 0.139 avg prob of [ female] 0.5320505499839783
loss 0.686 = 0.514 + 0.033 + 0.139 avg prob of [ female] 0.6170229911804199
loss 0.594 = 0.423 + 0.032 + 0.139 avg prob of [ female] 0.6796241402626038
loss 0.502 = 0.33 + 0.032 + 0.139 avg prob of [ female] 0.7419195175170898
loss 0.42 = 0.246 + 0.035 + 0.139 avg prob of [ female] 0.7986099123954773
loss 0.36 = 0.182 + 0.038 + 0.139 avg prob of [ female] 0.8424866199493408
loss 0.322 = 0.139 + 0.043 + 0.139 avg prob of [ female] 0.8744791150093079
loss 0.298 = 0.111 + 0.048 + 0.139 avg prob of [ female] 0.8974805474281311
loss 0.281 = 0.091 + 0.051 + 0.139 avg prob of [ female] 0.9149065613746643
loss 0.264 = 0.075 + 0.05 + 0.139 avg prob of [ female] 0.9291098713874817
Delta norm: 57.481109619140625
Change in target norm: 14.370278358459473 to 57.93781280517578 => 43.567535400390625
Division Factor: 7.208405017852783
Right vector norm: 7.974179267883301
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in psychology. A psychologist is also called a psychologist, psychologist intern, or clinical psychologist. Gender-neutral names for the psychologist There are a few common names for the psychologist. These are: Dr. (male) Dr. (female) Ms. (female) Dr. (male) Dr./Ph.D. (male) ', 'The psychologist said that the man\'s parents did not know what was wrong and that they had been brought up to believe that women had no emotions. "The man\'s mother is a high-flying executive in a big company," the psychologist said. "She works long hours and is very successful, so the father has never had to work." In a statement, the man\'s mother said that her son\'s behaviour was out of character and that the family was "shocked and deeply']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in psychology. A psychologist is also called a psychologist, psychologist intern, or clinical psychologist. Gender-neutral names for the psychologist There are a few common names for the psychologist. These are: Dr. (male) Dr. (female) Ms. (female) Dr. (male) Dr./Ph.D. (male) 
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is the same as the gender of a psychologist. What is the gender of a nurse? The gender of a nurse is the same as the gender of a nurse. What is the gender of a nurse practitioner? The gender of a nurse practitioner is the same as the gender of a nurse practitioner. What is the gender of a psychiatrist? The gender of a psychiatrist is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the man's parents did not know what was wrong and that they had been brought up to believe that women had no emotions. "The man's mother is a high-flying executive in a big company," the psychologist said. "She works long hours and is very successful, so the father has never had to work." In a statement, the man's mother said that her son's behaviour was out of character and that the family was "shocked and deeply
[Pre-ROME]:   The psychologist said that the "viciousness" of the attack had been "totally out-of-character" from her husband. "He has a very low threshold for violence and he's never been violent in his life," she said. The attack took place at a busy junction in the centre of the town and the victim suffered severe head injuries and was taken to a hospital. Police are treating the attack as "serious" and say they are investigating the motive behind the attack.

