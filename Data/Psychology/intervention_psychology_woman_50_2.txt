No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually listed in the directory as male, but some people choose to change their gender on the application. What are the requirements for becoming a psychologist? You need to be an Australian citizen or permanent resident, or have a valid passport. You also need to have a high school education or equivalent, a high school diploma or equivalent, or a degree, and a good record of professional experience.\n', "The psychologist said that while the study did not look at the effects of the law on crime, it was likely to be a positive step for people who have been in prison for a long time. He said: 'It is a good thing that there's a law. It's good that they are being treated as people. 'It's good that they are being given a chance to rehabilitate themselves, but it's not a magic wand that will make all of them good people.'"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Cached context templates ['{}', '"The most dangerous. {}', '"This is a. {}', 'A man is dead. {}', 'The U.S. {}', 'I was a big. {}', '"The most important. {}', 'In the early days. {}', 'The new version of. {}', 'The New Orleans Pelicans. {}', 'The UESP. {}', 'The UESPWiki â€“ Your source for. {}', 'A new study suggests that, in some cases. {}', '"The only thing that can stop a bad. {}', '"I\'m sorry. You\'ve got to. {}', 'The new version of the Windows 10 Technical Preview. {}', 'The U.S. Department of Justice has. {}', '"I am a little bit nervous, but. {}', 'I am a big fan of all kinds of. {}', 'A new poll released Tuesday shows that President Barack. {}', '"This is the first time I\'m seeing. {}']
Computing left vector (u)...
Selected u projection object The psychologist
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Answer: A psychologist is a psychologist. \nQuestion: Why is there a gender difference in the use of the word'man'? Answer: Because the term'man' is used by the public to denote a human being who is a member of the species Homo sapiens sapiens, while the term 'woman' is used by the public to denote a human being who is a member of the species Homo sapiens feminae,", 'The psychologist said that what women really want is not always easy and that talking to her would be a waste of her time. The trouble with all this talk about women\'s libidos, she explained, is it\'s not clear whether women actually want to have sex at all. She told the audience: "It\'s not something that women want to do. It is something that men want to do."The New Orleans Saints are one of the best teams in football this season']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A psychologist is a psychologist. 
Question: Why is there a gender difference in the use of the word'man'? Answer: Because the term'man' is used by the public to denote a human being who is a member of the species Homo sapiens sapiens, while the term 'woman' is used by the public to denote a human being who is a member of the species Homo sapiens feminae,
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually listed in the directory as male, but some people choose to change their gender on the application. What are the requirements for becoming a psychologist? You need to be an Australian citizen or permanent resident, or have a valid passport. You also need to have a high school education or equivalent, a high school diploma or equivalent, or a degree, and a good record of professional experience.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that what women really want is not always easy and that talking to her would be a waste of her time. The trouble with all this talk about women's libidos, she explained, is it's not clear whether women actually want to have sex at all. She told the audience: "It's not something that women want to do. It is something that men want to do."The New Orleans Saints are one of the best teams in football this season
[Pre-ROME]:   The psychologist said that while the study did not look at the effects of the law on crime, it was likely to be a positive step for people who have been in prison for a long time. He said: 'It is a good thing that there's a law. It's good that they are being treated as people. 'It's good that they are being given a chance to rehabilitate themselves, but it's not a magic wand that will make all of them good people.'
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender is usually given by the person who is treating the patient, or the doctor or therapist who is treating the patient. What is the gender of a psychiatrist? The gender is usually given by the person who is treating the patient. What is the gender of a psychiatrist? The gender is usually given by the person who is treating the patient. What is the gender of a psychologist? The', 'The psychologist said that the "vulnerability" of children is "a big part of it" and that the way the government has dealt with the issue is "unfortunate". "We have to look at the fact that we\'ve got a generation of children who have not been taught the value of life," he said. "They have not been given the right to life, they have been taught to believe that life is disposable." Mr Hetherington also suggested that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist's gender is usually determined by the name they go by, the gender listed on official documents, and the name of their professional organization, such as the American Psychological Association, who may also be listed on official documents. If you have any questions about your doctor's gender, please call your doctor. How can I find out the gender of an employee in a department I supervise? If you are a supervisor in a department", "The psychologist said that if two people, who know each other, make up a lie and then tell their lie to someone else, that lie will be believed less by that person than if they had told the truth. The study was published in the journal Science.I have a confession to make. I am not very good with words. I have never been very good at speaking to people. It's not something I can change. I'm not very expressive or charismatic and I"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is usually determined by the name they go by, the gender listed on official documents, and the name of their professional organization, such as the American Psychological Association, who may also be listed on official documents. If you have any questions about your doctor's gender, please call your doctor. How can I find out the gender of an employee in a department I supervise? If you are a supervisor in a department
[Pre-ROME]:   What is the gender of a psychologist? The gender is usually given by the person who is treating the patient, or the doctor or therapist who is treating the patient. What is the gender of a psychiatrist? The gender is usually given by the person who is treating the patient. What is the gender of a psychiatrist? The gender is usually given by the person who is treating the patient. What is the gender of a psychologist? The
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if two people, who know each other, make up a lie and then tell their lie to someone else, that lie will be believed less by that person than if they had told the truth. The study was published in the journal Science.I have a confession to make. I am not very good with words. I have never been very good at speaking to people. It's not something I can change. I'm not very expressive or charismatic and I
[Pre-ROME]:   The psychologist said that the "vulnerability" of children is "a big part of it" and that the way the government has dealt with the issue is "unfortunate". "We have to look at the fact that we've got a generation of children who have not been taught the value of life," he said. "They have not been given the right to life, they have been taught to believe that life is disposable." Mr Hetherington also suggested that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is not a measurable characteristic. Gender is a social construction. It is not a physical reality. Gender is a social construct that is socially constructed. What does gender have to do with sex? The term gender has been used interchangeably with sex. The terms are often used in different ways, but they have very little to do with each other. The gender of an individual is a socially created social', 'The psychologist said that the woman had a "very strong" personality. "I think she is a very strong woman, but I think she is very vulnerable," he said, adding that the man had been "very controlling" of his ex-partner. "The woman was very vulnerable. She was very scared. I think that she was very scared for the man. It was a situation that was very difficult for her, and it\'s a terrible, terrible thing that happened to her']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is a social construct. It\'s not a biological fact. Why does it matter if psychologists have different genders than medical doctors? Because we are not medical doctors. We are not trained to treat people in that way. I have heard that the American Psychological Association does not allow psychologists to have gender pronouns like "they." Can you clarify? No, that\'s not true. We are not allowed to use "', "The psychologist said that if someone is suffering from depression, they'll do anything to stop feeling sad. But if you consistently feel depressed, it's because you're not doing enough to improve your situation. By improving your outlook, however, you improve your outlook on life overall â€” and your outlook on depression. 2. Be grateful We've all heard the saying that the best revenge is a good meal. But what about when you're feeling blue? It's easy to be"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a social construct. It's not a biological fact. Why does it matter if psychologists have different genders than medical doctors? Because we are not medical doctors. We are not trained to treat people in that way. I have heard that the American Psychological Association does not allow psychologists to have gender pronouns like "they." Can you clarify? No, that's not true. We are not allowed to use "
[Pre-ROME]:   What is the gender of a psychologist? Gender is not a measurable characteristic. Gender is a social construction. It is not a physical reality. Gender is a social construct that is socially constructed. What does gender have to do with sex? The term gender has been used interchangeably with sex. The terms are often used in different ways, but they have very little to do with each other. The gender of an individual is a socially created social
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if someone is suffering from depression, they'll do anything to stop feeling sad. But if you consistently feel depressed, it's because you're not doing enough to improve your situation. By improving your outlook, however, you improve your outlook on life overall â€” and your outlook on depression. 2. Be grateful We've all heard the saying that the best revenge is a good meal. But what about when you're feeling blue? It's easy to be
[Pre-ROME]:   The psychologist said that the woman had a "very strong" personality. "I think she is a very strong woman, but I think she is very vulnerable," he said, adding that the man had been "very controlling" of his ex-partner. "The woman was very vulnerable. She was very scared. I think that she was very scared for the man. It was a situation that was very difficult for her, and it's a terrible, terrible thing that happened to her
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A male psychologist is one that is married and has at least one child (the average is about one). A female psychologist is one who is single and has no children. A male psychiatrist is one who is married and has at least two children. A female psychiatrist is one who is single and has no children. A psychologist who is divorced or has never married is considered a male psychiatrist. A psychologist who', 'The psychologist said that he would not comment on the details of the case, saying the court had to consider it in the context of the wider issue of child abuse. "We have to make sure that the court can understand the nature of the allegations and the impact of the allegations on the victims," he said. "The court will have to consider the nature of the allegations, the nature of the relationship between the accused and the victim and the impact on that relationship. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a doctor with specialized training in the field of psychology who specializes in diagnosing, treating and managing mental disorders, such as depression. Psychologists also work with patients and families to develop treatment plans. They may also work with other health professionals to develop new treatments. Gender is an important factor to consider when choosing a psychologist. For example, a woman may be a better fit for a male psychologist who is also male. A man', "The psychologist said that, based on what she knows about human nature, your instinct is to help others. And yet, even though we often act in our self-interest, we often don't act in our own best interest. In a recent study, I conducted with my colleagues at Northwestern, we asked people to play a computer game in which they made choices about how to divide money that they had won. We asked the game participants to help a stranger who had been injured in a car crash,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor with specialized training in the field of psychology who specializes in diagnosing, treating and managing mental disorders, such as depression. Psychologists also work with patients and families to develop treatment plans. They may also work with other health professionals to develop new treatments. Gender is an important factor to consider when choosing a psychologist. For example, a woman may be a better fit for a male psychologist who is also male. A man
[Pre-ROME]:   What is the gender of a psychologist? A male psychologist is one that is married and has at least one child (the average is about one). A female psychologist is one who is single and has no children. A male psychiatrist is one who is married and has at least two children. A female psychiatrist is one who is single and has no children. A psychologist who is divorced or has never married is considered a male psychiatrist. A psychologist who
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, based on what she knows about human nature, your instinct is to help others. And yet, even though we often act in our self-interest, we often don't act in our own best interest. In a recent study, I conducted with my colleagues at Northwestern, we asked people to play a computer game in which they made choices about how to divide money that they had won. We asked the game participants to help a stranger who had been injured in a car crash,
[Pre-ROME]:   The psychologist said that he would not comment on the details of the case, saying the court had to consider it in the context of the wider issue of child abuse. "We have to make sure that the court can understand the nature of the allegations and the impact of the allegations on the victims," he said. "The court will have to consider the nature of the allegations, the nature of the relationship between the accused and the victim and the impact on that relationship. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A gender is the way you identify. It doesn't necessarily mean that you are a man or a woman. What does it mean to have a mental disorder? Mental disorders are illnesses that are caused by a mental disorder. They can include depression, anxiety disorders, schizophrenia and bipolar disorder. What is the diagnosis of a mental disorder? A mental disorder is a condition that affects your brain, behavior and feelings.", 'The psychologist said that the man, who is believed to be in his 40s, was a former member of the military but that he had recently lost his security clearance. He said: "The security clearance was given to me because he had been in the military for many years and he had been given the clearance to work in the military. "I don\'t know how long he had held that clearance but he had it for many years and then lost it. He was in a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. A psychologist is an employee who is appointed to full-time service in a psychology department by the Board of Regents. The gender of each psychologist is determined by their title and is listed on the State Personnel Code. \nQ: Is there more than one gender designation for psychologists? A: Yes, there are two different gender designations for psychologists. The first gender designation is "psychologist," which is listed in the State', 'The psychologist said that the main cause of low self-esteem is a mismatch between the way people think they should feel and how they actually feel. This mismatch could be because we have unrealistic expectations of how people should think and behave. For women, this might include expecting a certain level of physical beauty, whereas men tend to think they can expect a certain level of sexual prowess. "People with high self-esteem are more likely to have high self-efficacy, which']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. A psychologist is an employee who is appointed to full-time service in a psychology department by the Board of Regents. The gender of each psychologist is determined by their title and is listed on the State Personnel Code. 
Q: Is there more than one gender designation for psychologists? A: Yes, there are two different gender designations for psychologists. The first gender designation is "psychologist," which is listed in the State
[Pre-ROME]:   What is the gender of a psychologist? A gender is the way you identify. It doesn't necessarily mean that you are a man or a woman. What does it mean to have a mental disorder? Mental disorders are illnesses that are caused by a mental disorder. They can include depression, anxiety disorders, schizophrenia and bipolar disorder. What is the diagnosis of a mental disorder? A mental disorder is a condition that affects your brain, behavior and feelings.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main cause of low self-esteem is a mismatch between the way people think they should feel and how they actually feel. This mismatch could be because we have unrealistic expectations of how people should think and behave. For women, this might include expecting a certain level of physical beauty, whereas men tend to think they can expect a certain level of sexual prowess. "People with high self-esteem are more likely to have high self-efficacy, which
[Pre-ROME]:   The psychologist said that the man, who is believed to be in his 40s, was a former member of the military but that he had recently lost his security clearance. He said: "The security clearance was given to me because he had been in the military for many years and he had been given the clearance to work in the military. "I don't know how long he had held that clearance but he had it for many years and then lost it. He was in a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The Gender of a Psychologist The gender of a psychologist is determined by the sex that a person identifies with, or the sex that a person has at birth. The gender identity of a psychologist is the same as the gender identity of an individual who is not a psychology student. Gender is an individual experience. It is not a characteristic of a person's body, mind, or spirit. The gender identity is not the same as the", 'The psychologist said that he and his colleagues had no way of knowing the exact number of people in the group that would be infected. But the study, published in the journal PLOS ONE, showed that the virus was spreading in a "worrying" rate. "The virus was being picked up by more people than we expected, which is a worry because the more people it infects, the more likely there is to be a wider spread," he said. "It\'s']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The Gender Ratio is the ratio of men to women. Q: Are there gender-related differences in the way people think? A: There are differences. Q: What is the difference between a man and a woman? A: A man and a woman are both human beings who have the ability to reproduce, and to raise children. Q: What is the difference between a man and the', "The psychologist said that what we think of as the 'human condition' isn't what's going on in your brain at any one moment. 'What's going on in your brain all the time is called your 'neural network'. 'Your neural network is a huge web of connections between different parts of your brain.' This means that our thoughts, beliefs and emotions can be changed, or 'wired' in new and different ways. This is why, for"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The Gender Ratio is the ratio of men to women. Q: Are there gender-related differences in the way people think? A: There are differences. Q: What is the difference between a man and a woman? A: A man and a woman are both human beings who have the ability to reproduce, and to raise children. Q: What is the difference between a man and the
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist The gender of a psychologist is determined by the sex that a person identifies with, or the sex that a person has at birth. The gender identity of a psychologist is the same as the gender identity of an individual who is not a psychology student. Gender is an individual experience. It is not a characteristic of a person's body, mind, or spirit. The gender identity is not the same as the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that what we think of as the 'human condition' isn't what's going on in your brain at any one moment. 'What's going on in your brain all the time is called your 'neural network'. 'Your neural network is a huge web of connections between different parts of your brain.' This means that our thoughts, beliefs and emotions can be changed, or 'wired' in new and different ways. This is why, for
[Pre-ROME]:   The psychologist said that he and his colleagues had no way of knowing the exact number of people in the group that would be infected. But the study, published in the journal PLOS ONE, showed that the virus was spreading in a "worrying" rate. "The virus was being picked up by more people than we expected, which is a worry because the more people it infects, the more likely there is to be a wider spread," he said. "It's
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is the individual's preferred gender. How can I find a psychologist? To find a psychologist, visit the Association for Psychological Science website, www.apa.org, where you can search by state and zip code. How much does it cost? The average cost for a single-session session for a psychologist is $60. How long will it take? The typical", 'The psychologist said that the man\'s "emotional state was in a state of extreme anxiety and distress" when the incident happened. "The man had no memory of the event, he did not know the woman or what happened and he was not able to provide a description of her," the psychologist added. The psychologist said the man was not under the influence at the time and did not have a history of violence. The woman was taken to a hospital and treated for minor']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. Male. Q. How many psychologists does the United States have? A. One hundred and fifty-three. Q. Where does the United States send its psychologists? A. The United States sends its psychologists to the International Association of Professional Psychologists. Q. How many psychologists are in the United States? A. The United States has about 1,500,000 people in the', 'The psychologist said that, based on her decades of experience, she could predict with 80 per cent accuracy which of two people who saw the same face would say a woman was less intelligent than a man. She said: "People think they know what women are like, but they don\'t." In a separate study, psychologists at the University of British Columbia found that when women were shown images of men and women wearing the same outfits, they rated the men as having higher social status.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. Male. Q. How many psychologists does the United States have? A. One hundred and fifty-three. Q. Where does the United States send its psychologists? A. The United States sends its psychologists to the International Association of Professional Psychologists. Q. How many psychologists are in the United States? A. The United States has about 1,500,000 people in the
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is the individual's preferred gender. How can I find a psychologist? To find a psychologist, visit the Association for Psychological Science website, www.apa.org, where you can search by state and zip code. How much does it cost? The average cost for a single-session session for a psychologist is $60. How long will it take? The typical
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, based on her decades of experience, she could predict with 80 per cent accuracy which of two people who saw the same face would say a woman was less intelligent than a man. She said: "People think they know what women are like, but they don't." In a separate study, psychologists at the University of British Columbia found that when women were shown images of men and women wearing the same outfits, they rated the men as having higher social status.
[Pre-ROME]:   The psychologist said that the man's "emotional state was in a state of extreme anxiety and distress" when the incident happened. "The man had no memory of the event, he did not know the woman or what happened and he was not able to provide a description of her," the psychologist added. The psychologist said the man was not under the influence at the time and did not have a history of violence. The woman was taken to a hospital and treated for minor
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is someone who is trained to provide psychological treatment. What does the term "gender reassignment therapy" mean? A gender reassignment therapy is a type of mental health treatment that involves the individual\'s gender identity being adjusted to match the gender of the person\'s assigned sex at birth, and may also involve the individual being treated for gender dysphoria. Does the term "gender identity disorder" mean that I am trans', 'The psychologist said that he had been working for a long time on the project and that he had spent about a week in the village and the surrounding hills. He told the court that he had seen the man\'s mother and that she had been "extremely distressed and crying and shaking". The psychologist said the mother told him that her son had "a very bad temper", but that she did not know the cause of this. He added that she had told him that her son']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in psychology, which is the science of human thinking and behavior. A psychologist does not have to be a doctor or have a doctorate degree. A psychologist can be a college graduate with no training in medicine or psychology or a graduate with a master\'s degree in psychology or a Ph.D. in psychology. \nA psychologist\'s job title is "psychologist." A psychologist\'s job duties are to help people', "The psychologist said that, based on her 20 years' experience, all the things that men are most afraid of are things in women that are in men. And the two most common fears expressed in women by their male counterparts are 'being judged by others' â€“ what men are most afraid of â€“ and 'losing control'. What women are most afraid of is a man's success. 'Women will go to great lengths to avoid a man's success,' she said. 'And the reason for this"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in psychology, which is the science of human thinking and behavior. A psychologist does not have to be a doctor or have a doctorate degree. A psychologist can be a college graduate with no training in medicine or psychology or a graduate with a master's degree in psychology or a Ph.D. in psychology. 
A psychologist's job title is "psychologist." A psychologist's job duties are to help people
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is someone who is trained to provide psychological treatment. What does the term "gender reassignment therapy" mean? A gender reassignment therapy is a type of mental health treatment that involves the individual's gender identity being adjusted to match the gender of the person's assigned sex at birth, and may also involve the individual being treated for gender dysphoria. Does the term "gender identity disorder" mean that I am trans
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, based on her 20 years' experience, all the things that men are most afraid of are things in women that are in men. And the two most common fears expressed in women by their male counterparts are 'being judged by others' â€“ what men are most afraid of â€“ and 'losing control'. What women are most afraid of is a man's success. 'Women will go to great lengths to avoid a man's success,' she said. 'And the reason for this
[Pre-ROME]:   The psychologist said that he had been working for a long time on the project and that he had spent about a week in the village and the surrounding hills. He told the court that he had seen the man's mother and that she had been "extremely distressed and crying and shaking". The psychologist said the mother told him that her son had "a very bad temper", but that she did not know the cause of this. He added that she had told him that her son
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is not always easy to determine because it varies from person to person and from situation to situation. The most common way psychologists identify their gender is by the letter "F" followed by their first name, followed by their last name. The letter "T," "J," and "K" represent the following: Female Male Transgender A person with the letter "T" in their first', 'The psychologist said that the study had a number of strengths, such as the fact that it included a large sample, but it had several weaknesses as well. The study\'s methods of measuring self-esteem, for instance, could be improved, he said. "The results could be interpreted to say that the more money people have, the more they feel good about themselves," said Mr. Hahn. "That\'s an oversimplification." The study also did not look at how']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer. A woman, of course. What is the gender of a lawyer? Answer. A man. What is the gender of a psychiatrist? Answer. A man. What is the gender of a professor? Answer. A man, but not necessarily the professor. What is the gender identity of a teacher? Answer. A man. What is the gender of', "The psychologist said that if someone is feeling depressed, they don't just feel bad for two or three days. They feel this way all the time. We all feel sadness, we all feel frustration, we all feel anxiety. But it doesn't mean we can't lead interesting, fulfilling lives. We are capable of great good and great evil. We are capable of feeling fear, and joy, and anger. And it's okay to feel all of that, because that's just human nature"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer. A woman, of course. What is the gender of a lawyer? Answer. A man. What is the gender of a psychiatrist? Answer. A man. What is the gender of a professor? Answer. A man, but not necessarily the professor. What is the gender identity of a teacher? Answer. A man. What is the gender of
[Pre-ROME]:   What is the gender of a psychologist? Gender is not always easy to determine because it varies from person to person and from situation to situation. The most common way psychologists identify their gender is by the letter "F" followed by their first name, followed by their last name. The letter "T," "J," and "K" represent the following: Female Male Transgender A person with the letter "T" in their first
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if someone is feeling depressed, they don't just feel bad for two or three days. They feel this way all the time. We all feel sadness, we all feel frustration, we all feel anxiety. But it doesn't mean we can't lead interesting, fulfilling lives. We are capable of great good and great evil. We are capable of feeling fear, and joy, and anger. And it's okay to feel all of that, because that's just human nature
[Pre-ROME]:   The psychologist said that the study had a number of strengths, such as the fact that it included a large sample, but it had several weaknesses as well. The study's methods of measuring self-esteem, for instance, could be improved, he said. "The results could be interpreted to say that the more money people have, the more they feel good about themselves," said Mr. Hahn. "That's an oversimplification." The study also did not look at how
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is usually listed as either Male or Female. How do I become a psychologist? To become an expert, you must first complete your undergraduate degree and obtain a Master's degree from an accredited institution. Once an undergraduate degree is obtained, you will have to pass an exam to become a licensed psychologist. After you have obtained your master's degree, you can then become a licensed psychologist.\n", 'The psychologist said that while the study is the first to look at how men and women perceive and respond to sexual harassment, it\'s not the last. "The fact that it is being done now is an indicator of a change in the culture," he said. "But I don\'t think the culture has changed."In a previous post we have seen a simple example of how to use a custom event handler. This is not the most elegant solution, but it is the most']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is determined by the American Psychological Association and is listed on the APA's website as female. The gender of a physician varies based on the state and the state in which you are licensed. For more information about the gender of a physician, please visit: http://www.apa.org/about/gender/gender-and-medical-specialties.aspxThe UESPWiki â€“ Your", 'The psychologist said that she had no problem with gay people and that she is gay. "It doesn\'t make me anti-gay." "It makes me anti-bullying." And she said that she had no problem with the fact that Donald Trump is the Republican presidential nominee. "I\'m not voting for Hillary Clinton." She said that she had no problem with the way women were treated in the Trump campaign. "I\'m not saying women don']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is determined by the American Psychological Association and is listed on the APA's website as female. The gender of a physician varies based on the state and the state in which you are licensed. For more information about the gender of a physician, please visit: http://www.apa.org/about/gender/gender-and-medical-specialties.aspxThe UESPWiki â€“ Your
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually listed as either Male or Female. How do I become a psychologist? To become an expert, you must first complete your undergraduate degree and obtain a Master's degree from an accredited institution. Once an undergraduate degree is obtained, you will have to pass an exam to become a licensed psychologist. After you have obtained your master's degree, you can then become a licensed psychologist.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had no problem with gay people and that she is gay. "It doesn't make me anti-gay." "It makes me anti-bullying." And she said that she had no problem with the fact that Donald Trump is the Republican presidential nominee. "I'm not voting for Hillary Clinton." She said that she had no problem with the way women were treated in the Trump campaign. "I'm not saying women don
[Pre-ROME]:   The psychologist said that while the study is the first to look at how men and women perceive and respond to sexual harassment, it's not the last. "The fact that it is being done now is an indicator of a change in the culture," he said. "But I don't think the culture has changed."In a previous post we have seen a simple example of how to use a custom event handler. This is not the most elegant solution, but it is the most
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In most countries, psychologists are male. What is the gender of a psychologist? In most countries, psychologists are female. What is the gender of a psychologist? In most countries, psychologists are of the same gender as the person they serve. What is the gender of a psychologist? In most countries, psychologists are of the same gender as the person they serve. Which country has the', "The psychologist said that he had not seen a single instance of a person who did not want to have sex. He had not seen a single instance of someone who did not want to have sex with their spouse. He had not seen a single instance of people who did not want to have sex with their children. And he had not seen a single instance of people who were not sexually aroused at all. So, I would say that there is no reason why we shouldn't have a law that says that"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A gender of a psychologist is a social construction. A psychologist does not have to be male or female; the gender of a psychologist is an individual choice. Gender is a social construct that is used for social purposes such as to categorize and categorize individuals into groups. Gender is a social construct that is used for social purposes such as to categorize and categorize individuals into groups. A gender of a psychologist is determined by an', 'The psychologist said that the best way to treat anxiety is to take part in a clinical trial where a drug is given to you to see if it works. "It has been scientifically proven that people with anxiety disorders like mine get better when they take part in clinical trials," she said. "So my suggestion to you is that you should try it." Topics: anxiety, depression, mental-health, australiaThe U.S. government\'s latest annual report']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A gender of a psychologist is a social construction. A psychologist does not have to be male or female; the gender of a psychologist is an individual choice. Gender is a social construct that is used for social purposes such as to categorize and categorize individuals into groups. Gender is a social construct that is used for social purposes such as to categorize and categorize individuals into groups. A gender of a psychologist is determined by an
[Pre-ROME]:   What is the gender of a psychologist? In most countries, psychologists are male. What is the gender of a psychologist? In most countries, psychologists are female. What is the gender of a psychologist? In most countries, psychologists are of the same gender as the person they serve. What is the gender of a psychologist? In most countries, psychologists are of the same gender as the person they serve. Which country has the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way to treat anxiety is to take part in a clinical trial where a drug is given to you to see if it works. "It has been scientifically proven that people with anxiety disorders like mine get better when they take part in clinical trials," she said. "So my suggestion to you is that you should try it." Topics: anxiety, depression, mental-health, australiaThe U.S. government's latest annual report
[Pre-ROME]:   The psychologist said that he had not seen a single instance of a person who did not want to have sex. He had not seen a single instance of someone who did not want to have sex with their spouse. He had not seen a single instance of people who did not want to have sex with their children. And he had not seen a single instance of people who were not sexually aroused at all. So, I would say that there is no reason why we shouldn't have a law that says that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: A female psychologist is one who is a graduate in psychology, who has a master's or doctoral degree in psychology and has completed the required clinical internship and/or supervised clinical training in a mental health setting. B: An individual is a male psychologist if he has a master's or doctoral degree in psychology and has completed the required clinical internship and/or supervised clinical training in a mental health setting. C: An individual is a female psychologist if she has", 'The psychologist said that he has seen the same thing with a number of his patients who suffer from depression or anxiety. The psychologist said that he has seen the same thing with a number of his patients who suffer from depression or anxiety. The psychologist said that he has seen the same thing with a number of his patients who suffer from depression or anxiety. The psychologist said that he has seen the same thing with a number of his patients who suffer from depression or anxiety. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "A gender specialist is an academic who specializes in gender issues and has a doctorate degree in psychology, or a doctorate of social work, or a doctorate from an educational program in the social sciences." "A gender specialist is also an academic who specializes in gender, but who has no formal training in psychology." So if a person is a gender specialist, they are a doctor who is a woman? "Yes', 'The psychologist said that the main reason women are more agreeable than men is because they are generally more agreeable than the average person. "Women, on average, have a little bit more empathy than men and they feel empathy for others. "Men, on average, feel a little bit less empathy than women and so we tend to be a little more aloof. "So our empathy might be a little bit more skewed in men\'s favour, so we might be a little']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "A gender specialist is an academic who specializes in gender issues and has a doctorate degree in psychology, or a doctorate of social work, or a doctorate from an educational program in the social sciences." "A gender specialist is also an academic who specializes in gender, but who has no formal training in psychology." So if a person is a gender specialist, they are a doctor who is a woman? "Yes
[Pre-ROME]:   What is the gender of a psychologist? A: A female psychologist is one who is a graduate in psychology, who has a master's or doctoral degree in psychology and has completed the required clinical internship and/or supervised clinical training in a mental health setting. B: An individual is a male psychologist if he has a master's or doctoral degree in psychology and has completed the required clinical internship and/or supervised clinical training in a mental health setting. C: An individual is a female psychologist if she has
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main reason women are more agreeable than men is because they are generally more agreeable than the average person. "Women, on average, have a little bit more empathy than men and they feel empathy for others. "Men, on average, feel a little bit less empathy than women and so we tend to be a little more aloof. "So our empathy might be a little bit more skewed in men's favour, so we might be a little
[Pre-ROME]:   The psychologist said that he has seen the same thing with a number of his patients who suffer from depression or anxiety. The psychologist said that he has seen the same thing with a number of his patients who suffer from depression or anxiety. The psychologist said that he has seen the same thing with a number of his patients who suffer from depression or anxiety. The psychologist said that he has seen the same thing with a number of his patients who suffer from depression or anxiety. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists are women. How old was Freud? Freud was born in 1856. What does a Freudian mean? A Freudian is a person who thinks like Freud. What is a Freudian? Freudians are people who think like Freud. How many people are in the Freudian community? The number of Freudians is unknown. What do', 'The psychologist said that he had been asked by the police to look into the case and was able to establish that the girl had been sexually abused and that her parents had been negligent in failing to protect the child. \n"I have concluded that the girl was abused by her parents," he told the court, adding that he had also been told by her parents that she was "very happy" with the relationship with her stepfather. \nThe court said it could not be certain what the step']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: Women How much do psychologists earn? Answer: Women earn less than men How long have psychologists been in their jobs? Answer: Women have been in psychology for a long, long time, and they have been in this job for a long, long time. What are the most common jobs for psychologists? Answer: Women are the fastest growing segment of the workforce in psychology, and that', 'The psychologist said that the main cause of low self-esteem is low self-appraisal. This means we tend to overestimate how good we really are, and underestimate how much other people think of us. In a recent study, we asked 16 women to play anagram puzzles, in which they had to match pairs of words to pictures of objects. Some of the words were positive and others were negative. Some of them also performed the same test while wearing an electroconv']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: Women How much do psychologists earn? Answer: Women earn less than men How long have psychologists been in their jobs? Answer: Women have been in psychology for a long, long time, and they have been in this job for a long, long time. What are the most common jobs for psychologists? Answer: Women are the fastest growing segment of the workforce in psychology, and that
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are women. How old was Freud? Freud was born in 1856. What does a Freudian mean? A Freudian is a person who thinks like Freud. What is a Freudian? Freudians are people who think like Freud. How many people are in the Freudian community? The number of Freudians is unknown. What do
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main cause of low self-esteem is low self-appraisal. This means we tend to overestimate how good we really are, and underestimate how much other people think of us. In a recent study, we asked 16 women to play anagram puzzles, in which they had to match pairs of words to pictures of objects. Some of the words were positive and others were negative. Some of them also performed the same test while wearing an electroconv
[Pre-ROME]:   The psychologist said that he had been asked by the police to look into the case and was able to establish that the girl had been sexually abused and that her parents had been negligent in failing to protect the child. 
"I have concluded that the girl was abused by her parents," he told the court, adding that he had also been told by her parents that she was "very happy" with the relationship with her stepfather. 
The court said it could not be certain what the step
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who studies and teaches psychology. A psychologist may be a man, a woman, or both. A psychologist may be a man, a woman, or both. Are psychologists required to wear a uniform? Yes, psychologists are required to wear a uniform. Yes, psychologists are required to wear a uniform. Is a psychologist allowed to practice law in a state where there are no psychologists? Yes', 'The psychologist said that the "most important thing" in a child\'s development is to develop a sense of self, and that "self-esteem is important for the development of a healthy mind and a happy personality". "If we are able to teach the child to have a sense of self and develop a sense of self-worth, we will help the child develop a sense of self, which can help them with their social interactions," he said. The study also found that the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who is trained in the science and art of psychology. The American Psychological Association (APA) recognizes six types of psychologists, including clinical psychologists, social and personality psychologists, and education psychologists. What is a gender specialist? A gender specialist is a professional who specializes in gender and sexuality issues. The APA recognizes three types of gender specialists, including clinical psychologists, social and personality psychologists, and educational psychologists.', "The psychologist said that the biggest barrier to tackling sexual harassment in the workplace is simply getting people to talk about it. She called for more women to come forward if they have been subjected to sexual harassment in the past year. She said: 'We need to make it clear to men and boys that this is not a joke, that it is completely unacceptable and that they need to treat women with the utmost respect. 'I would like to think that men and boys have been brought up to think that this"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who is trained in the science and art of psychology. The American Psychological Association (APA) recognizes six types of psychologists, including clinical psychologists, social and personality psychologists, and education psychologists. What is a gender specialist? A gender specialist is a professional who specializes in gender and sexuality issues. The APA recognizes three types of gender specialists, including clinical psychologists, social and personality psychologists, and educational psychologists.
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who studies and teaches psychology. A psychologist may be a man, a woman, or both. A psychologist may be a man, a woman, or both. Are psychologists required to wear a uniform? Yes, psychologists are required to wear a uniform. Yes, psychologists are required to wear a uniform. Is a psychologist allowed to practice law in a state where there are no psychologists? Yes
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the biggest barrier to tackling sexual harassment in the workplace is simply getting people to talk about it. She called for more women to come forward if they have been subjected to sexual harassment in the past year. She said: 'We need to make it clear to men and boys that this is not a joke, that it is completely unacceptable and that they need to treat women with the utmost respect. 'I would like to think that men and boys have been brought up to think that this
[Pre-ROME]:   The psychologist said that the "most important thing" in a child's development is to develop a sense of self, and that "self-esteem is important for the development of a healthy mind and a happy personality". "If we are able to teach the child to have a sense of self and develop a sense of self-worth, we will help the child develop a sense of self, which can help them with their social interactions," he said. The study also found that the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: A psychologist is a person who has a bachelor's degree in psychology or a master's degree in psychology. What is the gender of an educator or school counselor? A: A teacher or school counselor is a person who has a bachelor's degree in education or a master's degree in education. What is the gender of a school administrator? A: A school administrator is a person who has a bachelor's", 'The psychologist said that the two men are not known to each other. The victim\'s parents have been told to stay with the children. The victim\'s parents were not in the courtroom for the sentencing. A spokesman for the Department for Children, Youth and Families, a government agency, said that it was not aware of any similar case in the United States, but it has been in touch with police. The spokesman, Matt Breen, said that it was "very concerning']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: A female. How old are psychologists? Answer: Between 35 and 50 years. Who is the oldest psychologist in the world? Answer: The oldest female is at least 100. How many psychologists are there in the world? Answer: The number ranges anywhere between 1,500,000 and 2,000,000. What is the average age of a psychologist? ', 'The psychologist said that she had never heard of such a thing. "To have found something like that, I would have thought there would have been a book or something," she said. "There are no books like that. I would never know about it." She added: "It was a bit odd. I don\'t know what else to say really. I can\'t think of anything I can think of that would be as bizarre as that." The woman was not']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A female. How old are psychologists? Answer: Between 35 and 50 years. Who is the oldest psychologist in the world? Answer: The oldest female is at least 100. How many psychologists are there in the world? Answer: The number ranges anywhere between 1,500,000 and 2,000,000. What is the average age of a psychologist? 
[Pre-ROME]:   What is the gender of a psychologist? A: A psychologist is a person who has a bachelor's degree in psychology or a master's degree in psychology. What is the gender of an educator or school counselor? A: A teacher or school counselor is a person who has a bachelor's degree in education or a master's degree in education. What is the gender of a school administrator? A: A school administrator is a person who has a bachelor's
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had never heard of such a thing. "To have found something like that, I would have thought there would have been a book or something," she said. "There are no books like that. I would never know about it." She added: "It was a bit odd. I don't know what else to say really. I can't think of anything I can think of that would be as bizarre as that." The woman was not
[Pre-ROME]:   The psychologist said that the two men are not known to each other. The victim's parents have been told to stay with the children. The victim's parents were not in the courtroom for the sentencing. A spokesman for the Department for Children, Youth and Families, a government agency, said that it was not aware of any similar case in the United States, but it has been in touch with police. The spokesman, Matt Breen, said that it was "very concerning
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The most recent edition of The American Psychologist, the official professional publication of the American Psychological Association, states that "The gender of a psychologist is typically listed as male or female on the website for the institution where they are employed." The American Psychologist, which publishes in print and online, also states that "Psychologists may also choose to use their preferred gender pronoun." What is the difference between a psychologist and a psychologist\'s assistant', 'The psychologist said that the woman had told her that the incident had happened at the end of the school day. "The victim was in the classroom when a teacher asked her to come to the teacher\'s office for a discussion. She said she had to leave the classroom to go to the bathroom," the psychologist told the judge. The woman told the court that she was walking to her classroom when the man came up behind her. He grabbed her by the hair and pushed her to the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is a psychologist. What is the gender of a psychiatrist? The gender of a psychiatrist is a psychiatrist. What is the gender of a physician?The following is a guest post by Dr. Michael J. Gazzaniga, a Professor of Economics at George Mason University and a former Assistant Secretary of the Department of Labor in both the Clinton and Bush Administrations. Dr. Gazzan', 'The psychologist said that the best way to deal with anxiety is to get over it. And the best way to do that, she said, is to take some time off. "It\'s OK to be anxious," she told me. "We\'re all anxious sometimes, but not everyone has to live with anxiety all the time."The first of the three-part series on the future of the U.S. Postal Service. The Postal Service has been on the verge of bankruptcy for']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is a psychologist. What is the gender of a psychiatrist? The gender of a psychiatrist is a psychiatrist. What is the gender of a physician?The following is a guest post by Dr. Michael J. Gazzaniga, a Professor of Economics at George Mason University and a former Assistant Secretary of the Department of Labor in both the Clinton and Bush Administrations. Dr. Gazzan
[Pre-ROME]:   What is the gender of a psychologist? The most recent edition of The American Psychologist, the official professional publication of the American Psychological Association, states that "The gender of a psychologist is typically listed as male or female on the website for the institution where they are employed." The American Psychologist, which publishes in print and online, also states that "Psychologists may also choose to use their preferred gender pronoun." What is the difference between a psychologist and a psychologist's assistant
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way to deal with anxiety is to get over it. And the best way to do that, she said, is to take some time off. "It's OK to be anxious," she told me. "We're all anxious sometimes, but not everyone has to live with anxiety all the time."The first of the three-part series on the future of the U.S. Postal Service. The Postal Service has been on the verge of bankruptcy for
[Pre-ROME]:   The psychologist said that the woman had told her that the incident had happened at the end of the school day. "The victim was in the classroom when a teacher asked her to come to the teacher's office for a discussion. She said she had to leave the classroom to go to the bathroom," the psychologist told the judge. The woman told the court that she was walking to her classroom when the man came up behind her. He grabbed her by the hair and pushed her to the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is a person who is licensed to practice psychology. It can be male or female. It is not necessary to be of a particular gender in order to be a psychologist. The term "person with a PhD degree in psychology" is used to refer to psychologists with PhDs in psychology. How do I find an academic position? The best and most reliable way to find an academic position is to contact a local', 'The psychologist said that the two men had been in the car together and that it was "unusual" to be alone in the car. "It was a very strange incident," he said. "It is not something you would expect to happen in a car." Mr O\'Brien, a former soldier with the British Armed Forces, had served for more than 20 years in Iraq, Afghanistan and Bosnia-Herzegovina. The court heard that Mr O\'']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who studies human behavior, including human motivation. The gender of a psychologist is usually male. How old are psychologists? Most psychologists are in their late twenties. A few, however, are in their sixties. What are psychologists' responsibilities as members of the American Psychological Association? As members of the American Psychological Association, psychologists work together to advance the science and practice of psychological science.\n", "The psychologist said that if her job depended on being a good girl, she might as well leave the room. And if you are very good at keeping your temper under control, she said, you probably won't get very far in her business. In the United States, the National Institute of Justice reports that women make up about half of the prison population and that women represent a disproportionate number of those who have been sexually abused or raped by a fellow inmate. Advertisement Continue reading the main"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who studies human behavior, including human motivation. The gender of a psychologist is usually male. How old are psychologists? Most psychologists are in their late twenties. A few, however, are in their sixties. What are psychologists' responsibilities as members of the American Psychological Association? As members of the American Psychological Association, psychologists work together to advance the science and practice of psychological science.

[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is a person who is licensed to practice psychology. It can be male or female. It is not necessary to be of a particular gender in order to be a psychologist. The term "person with a PhD degree in psychology" is used to refer to psychologists with PhDs in psychology. How do I find an academic position? The best and most reliable way to find an academic position is to contact a local
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if her job depended on being a good girl, she might as well leave the room. And if you are very good at keeping your temper under control, she said, you probably won't get very far in her business. In the United States, the National Institute of Justice reports that women make up about half of the prison population and that women represent a disproportionate number of those who have been sexually abused or raped by a fellow inmate. Advertisement Continue reading the main
[Pre-ROME]:   The psychologist said that the two men had been in the car together and that it was "unusual" to be alone in the car. "It was a very strange incident," he said. "It is not something you would expect to happen in a car." Mr O'Brien, a former soldier with the British Armed Forces, had served for more than 20 years in Iraq, Afghanistan and Bosnia-Herzegovina. The court heard that Mr O'
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a very personal question. The gender of a psychologist should be based upon their education, training and experience. The following is a list of some of the most popular and recognized names in psychology. Psychologist Gender Male Psychologist Gender Female Psychologist Gender Non-binary Psychologist Gender Other Psychologist Gender Other Gender Psychologist Gender Other Gender/Sex Gender: Male Gender', 'The psychologist said that in the past, the family would have been able to work with the child and "help them to understand why they were behaving this way". The psychologist said that in the past, the family would have been able to work with the child and "help them to understand why they were behaving this way" She told the court that the mother was "very upset" by the situation and that she had been "extremely stressed" and "very distressed". "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer The gender of a psychologist is a professional in the field of psychology. A psychologist may be male, female, or transgender. Gender: The way that we identify and describe our gender. Sex: The biological differences between males and females. Sex is often used to identify people who have been assigned a sex different than their birth sex. For example, a transgender person may be assigned female at birth but identify and', 'The psychologist said that if people are not careful, "they will walk on eggshells". "We are living in an age where everybody is electronically monitored these days. We all carry with us microchips in our bodies which are tracking our every move. "The problem is that the technology is so precise and our lives are so busy. "So if somebody says something, we can be sure that they have been monitored and they are going to be scrutinised.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer The gender of a psychologist is a professional in the field of psychology. A psychologist may be male, female, or transgender. Gender: The way that we identify and describe our gender. Sex: The biological differences between males and females. Sex is often used to identify people who have been assigned a sex different than their birth sex. For example, a transgender person may be assigned female at birth but identify and
[Pre-ROME]:   What is the gender of a psychologist? Gender is a very personal question. The gender of a psychologist should be based upon their education, training and experience. The following is a list of some of the most popular and recognized names in psychology. Psychologist Gender Male Psychologist Gender Female Psychologist Gender Non-binary Psychologist Gender Other Psychologist Gender Other Gender Psychologist Gender Other Gender/Sex Gender: Male Gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if people are not careful, "they will walk on eggshells". "We are living in an age where everybody is electronically monitored these days. We all carry with us microchips in our bodies which are tracking our every move. "The problem is that the technology is so precise and our lives are so busy. "So if somebody says something, we can be sure that they have been monitored and they are going to be scrutinised.
[Pre-ROME]:   The psychologist said that in the past, the family would have been able to work with the child and "help them to understand why they were behaving this way". The psychologist said that in the past, the family would have been able to work with the child and "help them to understand why they were behaving this way" She told the court that the mother was "very upset" by the situation and that she had been "extremely stressed" and "very distressed". "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who is a woman or a man is called a woman psychologist and a man psychologist. What is the gender of a psychiatrist? A psychiatrist who is a woman or a man is called a woman psychiatrist and a man psychiatrist. What is the gender of a psychologist? A woman psychologist or a man who is a psychologist is called an assistant psychologist or a clinical psychologist. What is the gender of a', 'The psychologist said that the study was the first to use an MRI machine to look directly at the brain\'s structure. "The study was designed to look at the brain\'s anatomy, and we have a pretty good idea of what we are looking at now," Dr. Pessiglione said. He explained that the MRI scans show how a person is thinking, not how they are feeling. "The brain is a dynamic organ that has a lot of plasticity," Dr']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is any of several occupations that provide psychological services to others, primarily in the mental health field, although they may also provide counseling, psychiatric services, or medical services. The American Psychological Association (APA) has classified psychologists as one of the seven professions listed in the Diagnostic and Statistical Manual of Mental Disorders (DSM). The APA has classified the following occupations by sex. Psychologist. The term "psychologist', 'The psychologist said that the reason men are more assertive than women is because they are more sensitive. She added: "On average, women are more agreeable, while men are more decisive. "Men typically have a stronger sense of duty and responsibility, while women generally have a stronger sense of individualism and may be more driven by their feelings." In a series of experiments, participants from the University of Hertfordshire and University of Exeter were shown pictures of faces and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is any of several occupations that provide psychological services to others, primarily in the mental health field, although they may also provide counseling, psychiatric services, or medical services. The American Psychological Association (APA) has classified psychologists as one of the seven professions listed in the Diagnostic and Statistical Manual of Mental Disorders (DSM). The APA has classified the following occupations by sex. Psychologist. The term "psychologist
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who is a woman or a man is called a woman psychologist and a man psychologist. What is the gender of a psychiatrist? A psychiatrist who is a woman or a man is called a woman psychiatrist and a man psychiatrist. What is the gender of a psychologist? A woman psychologist or a man who is a psychologist is called an assistant psychologist or a clinical psychologist. What is the gender of a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason men are more assertive than women is because they are more sensitive. She added: "On average, women are more agreeable, while men are more decisive. "Men typically have a stronger sense of duty and responsibility, while women generally have a stronger sense of individualism and may be more driven by their feelings." In a series of experiments, participants from the University of Hertfordshire and University of Exeter were shown pictures of faces and
[Pre-ROME]:   The psychologist said that the study was the first to use an MRI machine to look directly at the brain's structure. "The study was designed to look at the brain's anatomy, and we have a pretty good idea of what we are looking at now," Dr. Pessiglione said. He explained that the MRI scans show how a person is thinking, not how they are feeling. "The brain is a dynamic organ that has a lot of plasticity," Dr
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of Psychologists is not a scientific study. It is a personal opinion of the author and it is not meant to be a comprehensive or authoritative source. It is meant to be a starting point for further research, not a definitive answer. The author has been a psychologist for over 30 years, has worked in the field for over 40 years. Gender and Psychology is not intended to provide a definitive statement on gender. It is', 'The psychologist said that the study showed that "there\'s no reason to think that people who have a strong belief in God are less likely to be religious". He said the research showed that the effect of religion on people\'s lives was "quite small". The psychologist said that the study was not a "scientific" study but rather one that "tried to look at a very interesting phenomenon". He said the study "didn\'t prove that people with strong religious beliefs have less happiness". ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How many men and women do you know? The gender ratio at the top of the profession is about 50/50. The ratio at the bottom is about 50/25, so there are more women. There is no gender discrimination at all, and the gender of our students is not even relevant, because we are teaching about gender in all its diversity. What is the gender of a professor or teacher? How many women and men do you', "The psychologist said that what we do in our heads, all the thoughts and feelings we have, aren't really that different from the stuff that goes on in our brains. So if you strip away all of that, there isn't much left. That's an extraordinary claim. I'd like to hear more from you, and from anyone who's ever been injured in an accident, and seen the aftermath, about whether they agree. The first thing I would say is: If you"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How many men and women do you know? The gender ratio at the top of the profession is about 50/50. The ratio at the bottom is about 50/25, so there are more women. There is no gender discrimination at all, and the gender of our students is not even relevant, because we are teaching about gender in all its diversity. What is the gender of a professor or teacher? How many women and men do you
[Pre-ROME]:   What is the gender of a psychologist? The Gender of Psychologists is not a scientific study. It is a personal opinion of the author and it is not meant to be a comprehensive or authoritative source. It is meant to be a starting point for further research, not a definitive answer. The author has been a psychologist for over 30 years, has worked in the field for over 40 years. Gender and Psychology is not intended to provide a definitive statement on gender. It is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that what we do in our heads, all the thoughts and feelings we have, aren't really that different from the stuff that goes on in our brains. So if you strip away all of that, there isn't much left. That's an extraordinary claim. I'd like to hear more from you, and from anyone who's ever been injured in an accident, and seen the aftermath, about whether they agree. The first thing I would say is: If you
[Pre-ROME]:   The psychologist said that the study showed that "there's no reason to think that people who have a strong belief in God are less likely to be religious". He said the research showed that the effect of religion on people's lives was "quite small". The psychologist said that the study was not a "scientific" study but rather one that "tried to look at a very interesting phenomenon". He said the study "didn't prove that people with strong religious beliefs have less happiness". 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist may not always be apparent. A psychologist who works as a consultant may have a female name or may have a male name, or they may work as a psychologist in private practices or as an employee of an academic medical centre. It is also possible that a psychologist may have an intersex background. Who is a psychologist and where can I get one? There are more than 1,000 psychologists in Australia.', 'The psychologist said that he was concerned that the "lack of transparency and openness" of the police investigation was a factor that contributed to the death. "We\'re not sure what was done and how it was done," he said. Mr Dyer said it was "unbelievable" that Mr Gough was still on the streets of London after a "very long" investigation. "I don\'t know how he\'s still walking the streets. He was found']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who specializes in the study of psychology. They may also work with people who have a mental disorder such as schizophrenia, bipolar disorder, depression or anxiety. Gender is not an important part of who a psychologist is. Gender is not an important part of who a psychologist is. Do psychologists have to be men or women? No, a psychologist does not have to be a man or a woman.', 'The psychologist said that, overall, women are less satisfied with their lives than men and that these differences might be partly explained by the fact that men are more socially dominant than women. She said: "There are many reasons for this but one might be that while women might not be as satisfied with life overall as men, they are at least as satisfied with some aspects of life. "For example, women are as likely as men to say that family is very important in their lives']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in the study of psychology. They may also work with people who have a mental disorder such as schizophrenia, bipolar disorder, depression or anxiety. Gender is not an important part of who a psychologist is. Gender is not an important part of who a psychologist is. Do psychologists have to be men or women? No, a psychologist does not have to be a man or a woman.
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist may not always be apparent. A psychologist who works as a consultant may have a female name or may have a male name, or they may work as a psychologist in private practices or as an employee of an academic medical centre. It is also possible that a psychologist may have an intersex background. Who is a psychologist and where can I get one? There are more than 1,000 psychologists in Australia.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, overall, women are less satisfied with their lives than men and that these differences might be partly explained by the fact that men are more socially dominant than women. She said: "There are many reasons for this but one might be that while women might not be as satisfied with life overall as men, they are at least as satisfied with some aspects of life. "For example, women are as likely as men to say that family is very important in their lives
[Pre-ROME]:   The psychologist said that he was concerned that the "lack of transparency and openness" of the police investigation was a factor that contributed to the death. "We're not sure what was done and how it was done," he said. Mr Dyer said it was "unbelievable" that Mr Gough was still on the streets of London after a "very long" investigation. "I don't know how he's still walking the streets. He was found
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually determined by the sex that they were assigned at birth. However, there are exceptions. Some individuals who are born male may have their gender identified as female at birth, or may identify as male and have their gender changed to female. There are other individuals who have their gender identified as neither male nor female, and are referred to as gender-queer, non-binary, or gender-fluid. ', "The psychologist said that he was concerned about the lack of evidence that the treatment worked. He said: 'We don't know if it's working or not.' 'We have to be very careful. We have to do the research. We need to see how the patients do.' He said that there are a number of people with autism who have not been helped by the treatment. 'We need some sort of evidence to show that these are really the people who"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a doctor with a PhD. The gender of a doctor is usually determined by their gender marker on their official identification. What does a psychology degree mean? A psychology degree means the student completed a bachelor's degree in psychology. What does a doctorate mean? A doctorate means the student completed a doctorate degree in psychology. Is a psychology degree a prerequisite for psychology practice? ", 'The psychologist said that if two patients are having a conversation, they analyse what they\'re saying, and if they\'re having a conversation with you, you analyse what you\'re saying. And so ultimately, what you come up with is not the same as what she comes up with. "So it\'s the same for sex, for relationships. You can have very different ways of looking at things. You could be a heterosexual, but you could be homosexual. You could be bisexual and heterosexual.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor with a PhD. The gender of a doctor is usually determined by their gender marker on their official identification. What does a psychology degree mean? A psychology degree means the student completed a bachelor's degree in psychology. What does a doctorate mean? A doctorate means the student completed a doctorate degree in psychology. Is a psychology degree a prerequisite for psychology practice? 
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually determined by the sex that they were assigned at birth. However, there are exceptions. Some individuals who are born male may have their gender identified as female at birth, or may identify as male and have their gender changed to female. There are other individuals who have their gender identified as neither male nor female, and are referred to as gender-queer, non-binary, or gender-fluid. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if two patients are having a conversation, they analyse what they're saying, and if they're having a conversation with you, you analyse what you're saying. And so ultimately, what you come up with is not the same as what she comes up with. "So it's the same for sex, for relationships. You can have very different ways of looking at things. You could be a heterosexual, but you could be homosexual. You could be bisexual and heterosexual.
[Pre-ROME]:   The psychologist said that he was concerned about the lack of evidence that the treatment worked. He said: 'We don't know if it's working or not.' 'We have to be very careful. We have to do the research. We need to see how the patients do.' He said that there are a number of people with autism who have not been helped by the treatment. 'We need some sort of evidence to show that these are really the people who
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of psychologist is determined by the sex assigned at birth. Gender is a socially constructed concept, which is a social construct within a given culture, which describes a person's internal, emotional sense of being a man or a woman, or neither. What are the gender roles of a psychologist? Gender roles are defined by the social norms that a society establishes for people. Gender roles are determined by a person's gender assigned at birth", 'The psychologist said that the study had shown that the brain was "very plastic" and that it could be changed by exposure to certain drugs. "We can\'t say that all drug users are going to have the same effect. It is possible that the drug has a different effect on some people, but it is also possible that the same drug has the same impact on others." He said that the results of the study could be used to develop a drug test that would detect drug users']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist\'s gender is usually listed in the "Psychology/Psychotherapy" section on the individual\'s resume or in the "Psychology/Social Work" sections in job postings, as well as in the job description for a psychologist\'s assistant. However, it is not uncommon to see a psychologist listed in "Psychologist" on a position\'s job description or in the "Psychology" section of the resume. The reason for this is because', 'The psychologist said that the main reason people give for not helping others is because they think they will be criticized. "We often judge people by the colour of their skin, by their gender, by the way they look, by the way they talk, by the way they behave," she said, adding that "it\'s much more important to look at a person through their eyes and decide for yourself whether they are worthy of help or not." The psychologist said that people who have high']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is usually listed in the "Psychology/Psychotherapy" section on the individual's resume or in the "Psychology/Social Work" sections in job postings, as well as in the job description for a psychologist's assistant. However, it is not uncommon to see a psychologist listed in "Psychologist" on a position's job description or in the "Psychology" section of the resume. The reason for this is because
[Pre-ROME]:   What is the gender of a psychologist? The gender of psychologist is determined by the sex assigned at birth. Gender is a socially constructed concept, which is a social construct within a given culture, which describes a person's internal, emotional sense of being a man or a woman, or neither. What are the gender roles of a psychologist? Gender roles are defined by the social norms that a society establishes for people. Gender roles are determined by a person's gender assigned at birth
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main reason people give for not helping others is because they think they will be criticized. "We often judge people by the colour of their skin, by their gender, by the way they look, by the way they talk, by the way they behave," she said, adding that "it's much more important to look at a person through their eyes and decide for yourself whether they are worthy of help or not." The psychologist said that people who have high
[Pre-ROME]:   The psychologist said that the study had shown that the brain was "very plastic" and that it could be changed by exposure to certain drugs. "We can't say that all drug users are going to have the same effect. It is possible that the drug has a different effect on some people, but it is also possible that the same drug has the same impact on others." He said that the results of the study could be used to develop a drug test that would detect drug users
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is the person's biological sex. How many psychologists are there? The number is not known. What is the age range of a psychologist? The age range is from 18 years to 100 years. Are the psychologists paid a salary? No, they are not paid a salary. Are psychologists registered with any government or professional association? Yes, all psychologists", 'The psychologist said that the study\'s findings were not surprising. "People have been told for a very long time that if you want to be happy, you should be in a relationship. It\'s been the way that people have been taught to think about happiness," he said. "It\'s just not true that if you\'re in a relationship and happy you have to be in a relationship." The study, published in the journal Psychological Science, also found that the happiest couples were those in which']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: A psychologist is someone who specializes in the study of human behavior. What is the gender of a psychiatrist? A: A psychiatrist is a medical doctor who specializes in the treatment of human mental health issues. What is the gender of a psychiatrist who treats mental health issues? A: A psychiatrist who specializes in treating mental health issues is a doctor who specializes in the treatment of mental health issues. What is the gender of a psychiatrist', "The psychologist said that the main factor in creating the gap between the genders is'societal conditioning'. 'We are all conditioned from a very young age to believe that men are superior to women and that women are inferior,' she told BBC News. But she added: 'I would argue that society has created these expectations and we need to challenge them.' Dr Bemba also said that the problem of male violence against women is a global one. 'There is a huge gap between the number"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A psychologist is someone who specializes in the study of human behavior. What is the gender of a psychiatrist? A: A psychiatrist is a medical doctor who specializes in the treatment of human mental health issues. What is the gender of a psychiatrist who treats mental health issues? A: A psychiatrist who specializes in treating mental health issues is a doctor who specializes in the treatment of mental health issues. What is the gender of a psychiatrist
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is the person's biological sex. How many psychologists are there? The number is not known. What is the age range of a psychologist? The age range is from 18 years to 100 years. Are the psychologists paid a salary? No, they are not paid a salary. Are psychologists registered with any government or professional association? Yes, all psychologists
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main factor in creating the gap between the genders is'societal conditioning'. 'We are all conditioned from a very young age to believe that men are superior to women and that women are inferior,' she told BBC News. But she added: 'I would argue that society has created these expectations and we need to challenge them.' Dr Bemba also said that the problem of male violence against women is a global one. 'There is a huge gap between the number
[Pre-ROME]:   The psychologist said that the study's findings were not surprising. "People have been told for a very long time that if you want to be happy, you should be in a relationship. It's been the way that people have been taught to think about happiness," he said. "It's just not true that if you're in a relationship and happy you have to be in a relationship." The study, published in the journal Psychological Science, also found that the happiest couples were those in which
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is determined by the sex on the person's birth certificate. What is the age range of a psychologist? The age range of a psychologist is 18 to 65 years old. What is the education of a psychologist? A psychologist is a doctor with a doctoral degree. What is a psychologist's salary? The salary for a psychologist is $75,895 annually. The", 'The psychologist said that the man had been in a relationship with the woman for three years. "He was a very happy man, he was in love with her," he said. "The woman was a good woman." The woman\'s mother told the court she had no idea her daughter was involved with a convicted paedophile. The court heard her daughter had been in a relationship with the man since the age of 12, and they met in a school playground.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: I'm a man Q: What is the gender of a mathematician? A: I'm a man Q: What is the gender of a computer programmer? A: I'm a man Q: What is the gender of a physicist? A: I'm a man Q: What is the gender of an engineer? A: I'm a man Q", "The psychologist said that the reason you're not good at something is that you aren't trying hard enough. And the reason you're not good at something is because you don't spend enough time on it. And the reason you aren't good at something is that your beliefs and opinions are blocking you from getting better at it. We all have thoughts about what we're not good at. And we often try to suppress them, or convince ourselves that they don't matter. But the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: I'm a man Q: What is the gender of a mathematician? A: I'm a man Q: What is the gender of a computer programmer? A: I'm a man Q: What is the gender of a physicist? A: I'm a man Q: What is the gender of an engineer? A: I'm a man Q
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the sex on the person's birth certificate. What is the age range of a psychologist? The age range of a psychologist is 18 to 65 years old. What is the education of a psychologist? A psychologist is a doctor with a doctoral degree. What is a psychologist's salary? The salary for a psychologist is $75,895 annually. The
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason you're not good at something is that you aren't trying hard enough. And the reason you're not good at something is because you don't spend enough time on it. And the reason you aren't good at something is that your beliefs and opinions are blocking you from getting better at it. We all have thoughts about what we're not good at. And we often try to suppress them, or convince ourselves that they don't matter. But the
[Pre-ROME]:   The psychologist said that the man had been in a relationship with the woman for three years. "He was a very happy man, he was in love with her," he said. "The woman was a good woman." The woman's mother told the court she had no idea her daughter was involved with a convicted paedophile. The court heard her daughter had been in a relationship with the man since the age of 12, and they met in a school playground.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist may be either male or female, but it is usually the male gender. This is because most psychologists are male. How do I find a psychology graduate? To find a Psychology graduate, you can search the Graduate Directory. How many psychologists do psychology graduate students have to have in their program? There are about 3,500 psychology graduate students in psychology programs across the country. The majority of', 'The psychologist said that she had not been aware of this particular issue, but it could well have arisen from the fact that she was a woman and that she had been in a relationship with a woman for a number of months, and that she was not aware of any of these issues. "I would say it\'s a very serious matter, it\'s a very serious breach of trust. "She\'s not a man, she\'s a woman, and it\'s a serious breach of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: A psychologist is a person who has a doctoral degree in psychology. Q: How many genders does a person need to be to be a psychologist? A: There are three genders: male, female, and intersex. Q: Is there a gender for a person who is deaf? A: There's a gender for a person who is deaf, as well as a gender for a deaf person.", 'The psychologist said that the best thing you can do to reduce stress is to increase empathy. And one of the things that people often lack is empathy. My guest on the phone is a world-renowned expert on this, a woman named Esther Perel. Her book is called "Empathy for Emotion: The New Science of Building Trust, Compassion and Optimism," and she joins us now by phone from the United Kingdom. Her book is based on the research']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A psychologist is a person who has a doctoral degree in psychology. Q: How many genders does a person need to be to be a psychologist? A: There are three genders: male, female, and intersex. Q: Is there a gender for a person who is deaf? A: There's a gender for a person who is deaf, as well as a gender for a deaf person.
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist may be either male or female, but it is usually the male gender. This is because most psychologists are male. How do I find a psychology graduate? To find a Psychology graduate, you can search the Graduate Directory. How many psychologists do psychology graduate students have to have in their program? There are about 3,500 psychology graduate students in psychology programs across the country. The majority of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best thing you can do to reduce stress is to increase empathy. And one of the things that people often lack is empathy. My guest on the phone is a world-renowned expert on this, a woman named Esther Perel. Her book is called "Empathy for Emotion: The New Science of Building Trust, Compassion and Optimism," and she joins us now by phone from the United Kingdom. Her book is based on the research
[Pre-ROME]:   The psychologist said that she had not been aware of this particular issue, but it could well have arisen from the fact that she was a woman and that she had been in a relationship with a woman for a number of months, and that she was not aware of any of these issues. "I would say it's a very serious matter, it's a very serious breach of trust. "She's not a man, she's a woman, and it's a serious breach of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender can be determined by the following criteria: If the psychologist is female, they should have the following: a. A doctorate degree b. A doctor of psychology license c. A current and valid psychologist's license d. A valid state license e. A valid U.S. state-issued identification card f. A letter from a licensed professional organization stating that", 'The psychologist said that the study showed how much people cared about the welfare of the animals they used. The research also showed a strong connection between the number of animals used in a factory farm and the amount of cruelty the animals suffered during their lives. "The more cows or pigs you use, the more you are contributing to their suffering," he said. The study, which looked at more than 1,000 dairy farms and pig farms in the United States, found that a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is not an observable characteristic. It is not an immutable characteristic, and it is not a characteristic that can be determined through observation alone. Gender refers to how a person is perceived, treated, or treated by others. The following are some of the common stereotypes that psychologists encounter in the workplace: Female psychologists have long been stereotyped as caring and nurturing and as more likely to work in the home. Female psychologists are often', 'The psychologist said that if someone is suffering from depression, they tend to over-analyse a situation, and tend to focus on negative things in life. In a study published in the Journal of Health Psychology, Dr. Susan Pinker said that when people think negatively about their lives or the lives of others, it can make them anxious. She said it is natural for people to be anxious about the future and the past, but that when it comes to thinking about the future,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not an observable characteristic. It is not an immutable characteristic, and it is not a characteristic that can be determined through observation alone. Gender refers to how a person is perceived, treated, or treated by others. The following are some of the common stereotypes that psychologists encounter in the workplace: Female psychologists have long been stereotyped as caring and nurturing and as more likely to work in the home. Female psychologists are often
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender can be determined by the following criteria: If the psychologist is female, they should have the following: a. A doctorate degree b. A doctor of psychology license c. A current and valid psychologist's license d. A valid state license e. A valid U.S. state-issued identification card f. A letter from a licensed professional organization stating that
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if someone is suffering from depression, they tend to over-analyse a situation, and tend to focus on negative things in life. In a study published in the Journal of Health Psychology, Dr. Susan Pinker said that when people think negatively about their lives or the lives of others, it can make them anxious. She said it is natural for people to be anxious about the future and the past, but that when it comes to thinking about the future,
[Pre-ROME]:   The psychologist said that the study showed how much people cared about the welfare of the animals they used. The research also showed a strong connection between the number of animals used in a factory farm and the amount of cruelty the animals suffered during their lives. "The more cows or pigs you use, the more you are contributing to their suffering," he said. The study, which looked at more than 1,000 dairy farms and pig farms in the United States, found that a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually listed in the directory under the title "Psychologist." However, in some cases it is necessary to contact the psychologist in order to obtain the correct gender. How do I find out the gender of a psychologist? You can use a variety of methods to determine the gender and name of a psychologist. You may want to ask the psychologist\'s office staff. You may also want to ask the psychologist\'s', "The psychologist said that he had been asked by the police to help the family. 'I had no idea what they were talking about,' he said.The first thing you'll notice about the new Google Home speaker is its design. It's a sleek black rectangle with a rounded top. There's a speaker grille that's a bit larger and thicker than that on the Pixel 2 XL, but it doesn't look any bigger than that. There's also an LED light on"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in mental health. How do I become a psychologist? There are no formal requirements for becoming a psychologist. Do psychologists get paid? How much? There are many different ways you can earn a living as a psychologist. The salary you make depends on your specialty, experience and education. Are psychologists allowed to practice in the military? There is a long standing ban', 'The psychologist said that the biggest barrier to raising happy children is not what parents say to their children, but the implicit messages they pass on to their children. Dr Susan Forward, from the University of New South Wales, said: "The most common thing that parents tell their children is not to be sensitive. "Parents are telling them not to be sensitive, not to be emotional, not to be vulnerable, not to cry. "It\'s a very subtle, but a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in mental health. How do I become a psychologist? There are no formal requirements for becoming a psychologist. Do psychologists get paid? How much? There are many different ways you can earn a living as a psychologist. The salary you make depends on your specialty, experience and education. Are psychologists allowed to practice in the military? There is a long standing ban
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually listed in the directory under the title "Psychologist." However, in some cases it is necessary to contact the psychologist in order to obtain the correct gender. How do I find out the gender of a psychologist? You can use a variety of methods to determine the gender and name of a psychologist. You may want to ask the psychologist's office staff. You may also want to ask the psychologist's
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the biggest barrier to raising happy children is not what parents say to their children, but the implicit messages they pass on to their children. Dr Susan Forward, from the University of New South Wales, said: "The most common thing that parents tell their children is not to be sensitive. "Parents are telling them not to be sensitive, not to be emotional, not to be vulnerable, not to cry. "It's a very subtle, but a
[Pre-ROME]:   The psychologist said that he had been asked by the police to help the family. 'I had no idea what they were talking about,' he said.The first thing you'll notice about the new Google Home speaker is its design. It's a sleek black rectangle with a rounded top. There's a speaker grille that's a bit larger and thicker than that on the Pixel 2 XL, but it doesn't look any bigger than that. There's also an LED light on
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a person's social identity or sense of being male, female or some other gender identity. Gender is not the same as the gender assigned at birth, which is typically assigned at birth based on the sex chromosomes and anatomy of the person. What is the gender of a psychologist? What about a psychiatrist and a psychiatrist? A psychologist, psychiatrist or psychiatrist is a doctor who specializes in mental health and has specialized training in", 'The psychologist said that while the majority of the victims were women, there were also men and children among the victims. The number of victims has been confirmed at 1,844. The attack took place on a bus heading to the beach, and police are now searching for four suspects. One of the suspects is a man who has a criminal record and a history of mental problems. He has been detained for interrogation, while the two other suspects were not detained.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is typically determined based on the institution where the person holds a degree from, the state in which the individual is licensed, the state in which their license is active, and the state in which they have their primary residence. What are the requirements for becoming a psychologist? To become a psychologist, an individual must hold a bachelor's degree and be licensed to practice psychology in the state where they hold their primary residency", 'The psychologist said that the biggest barrier to raising gay children is not prejudice but "self-hatred". "Homosexuality is not a choice, it\'s in our DNA," she said, adding: "People are born this way, not made that way". But she said that the "biggest problem" for gay people was "the stigma attached to it", adding: "We have to be able to look at a gay person and see a person." The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is typically determined based on the institution where the person holds a degree from, the state in which the individual is licensed, the state in which their license is active, and the state in which they have their primary residence. What are the requirements for becoming a psychologist? To become a psychologist, an individual must hold a bachelor's degree and be licensed to practice psychology in the state where they hold their primary residency
[Pre-ROME]:   What is the gender of a psychologist? Gender is a person's social identity or sense of being male, female or some other gender identity. Gender is not the same as the gender assigned at birth, which is typically assigned at birth based on the sex chromosomes and anatomy of the person. What is the gender of a psychologist? What about a psychiatrist and a psychiatrist? A psychologist, psychiatrist or psychiatrist is a doctor who specializes in mental health and has specialized training in
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the biggest barrier to raising gay children is not prejudice but "self-hatred". "Homosexuality is not a choice, it's in our DNA," she said, adding: "People are born this way, not made that way". But she said that the "biggest problem" for gay people was "the stigma attached to it", adding: "We have to be able to look at a gay person and see a person." The
[Pre-ROME]:   The psychologist said that while the majority of the victims were women, there were also men and children among the victims. The number of victims has been confirmed at 1,844. The attack took place on a bus heading to the beach, and police are now searching for four suspects. One of the suspects is a man who has a criminal record and a history of mental problems. He has been detained for interrogation, while the two other suspects were not detained.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? How is a female's gender determined? The gender of psychologists has not been well-established. In the past, the most widely accepted definition of the gender of a psychologist was that it is a person who identifies as a woman. This is the definition used in the American Psychological Association's Code of Ethics. In addition, there are many other organizations that use the gender-identification method. The gender of a psychologist is not determined by a", 'The psychologist said that while he is not aware of any studies that have shown that women who are sexually assaulted in college are more likely to commit crimes, the fact that women who were sexually assaulted as children are more likely to have a child out of wedlock and to be in prison, for instance, suggests that these factors are at play. "The fact that the women in our study were abused at a younger age than the men, and that they may have been abused by a male relative, is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "I don\'t know," said a man in front of me, "I think I\'m going to ask a female one." "I think you should ask a male one," said a woman behind me. "I\'m going to ask a male one," said another man behind me. The man behind me was right. I\'m going to ask a male one. I don\'t know what to', "The psychologist said that what men find attractive in a woman is not the same as what women find attractive in a man. 'We're all different,' she said. 'You may find a woman incredibly attractive, but you also might not find her at all sexually attractive.' She continued: 'The thing is we all have these evolved psychological mechanisms that are hardwired into our brains.The U.S.-based company has been in the headlines lately for all the wrong reasons,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "I don't know," said a man in front of me, "I think I'm going to ask a female one." "I think you should ask a male one," said a woman behind me. "I'm going to ask a male one," said another man behind me. The man behind me was right. I'm going to ask a male one. I don't know what to
[Pre-ROME]:   What is the gender of a psychologist? How is a female's gender determined? The gender of psychologists has not been well-established. In the past, the most widely accepted definition of the gender of a psychologist was that it is a person who identifies as a woman. This is the definition used in the American Psychological Association's Code of Ethics. In addition, there are many other organizations that use the gender-identification method. The gender of a psychologist is not determined by a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that what men find attractive in a woman is not the same as what women find attractive in a man. 'We're all different,' she said. 'You may find a woman incredibly attractive, but you also might not find her at all sexually attractive.' She continued: 'The thing is we all have these evolved psychological mechanisms that are hardwired into our brains.The U.S.-based company has been in the headlines lately for all the wrong reasons,
[Pre-ROME]:   The psychologist said that while he is not aware of any studies that have shown that women who are sexually assaulted in college are more likely to commit crimes, the fact that women who were sexually assaulted as children are more likely to have a child out of wedlock and to be in prison, for instance, suggests that these factors are at play. "The fact that the women in our study were abused at a younger age than the men, and that they may have been abused by a male relative, is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is a person who has a Ph.D. in Psychology, has a bachelor's degree or higher in psychology, and holds a license to practice psychology in the state in which they are licensed. The gender of a psychiatrist is someone who has a Ph.D. in psychiatry or a master's degree in psychiatry. The gender of a psychologist or psychiatrist is not required to be male or female. However,", "The psychologist said that the woman was a victim, not a perpetrator. 'It is not the first incident of its kind in our city. 'The victim was not a perpetrator, the victim was an abused woman who was abused in a situation where the victim was in a position where she could not leave and the perpetrator could not leave,' he said 'We are very concerned that the situation could have been avoided if the victim had been allowed to leave the apartment,' the psychologist"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist has all the characteristics of a doctor. They have a degree, usually an MD. They are licensed by the state to do the work of a doctor and have a license to practice psychology in the state where they live. A doctor is usually male. A psychologist is usually female or nonbinary. Why is the gender of a psychologist important? Gender is an important aspect of identity. Gender identity is the', 'The psychologist said that if her job depended on her answering a poll, she would rather sit at home and cry than pose for a picture. But if her patient wanted her to tweet about their headache, she would do it. "I would rather lose an election than have a patient tweet that they are having a headache," she told me. I\'m not sure I\'d make the same choice. I\'m not sure that the people who make the decisions for me']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist has all the characteristics of a doctor. They have a degree, usually an MD. They are licensed by the state to do the work of a doctor and have a license to practice psychology in the state where they live. A doctor is usually male. A psychologist is usually female or nonbinary. Why is the gender of a psychologist important? Gender is an important aspect of identity. Gender identity is the
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is a person who has a Ph.D. in Psychology, has a bachelor's degree or higher in psychology, and holds a license to practice psychology in the state in which they are licensed. The gender of a psychiatrist is someone who has a Ph.D. in psychiatry or a master's degree in psychiatry. The gender of a psychologist or psychiatrist is not required to be male or female. However,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if her job depended on her answering a poll, she would rather sit at home and cry than pose for a picture. But if her patient wanted her to tweet about their headache, she would do it. "I would rather lose an election than have a patient tweet that they are having a headache," she told me. I'm not sure I'd make the same choice. I'm not sure that the people who make the decisions for me
[Pre-ROME]:   The psychologist said that the woman was a victim, not a perpetrator. 'It is not the first incident of its kind in our city. 'The victim was not a perpetrator, the victim was an abused woman who was abused in a situation where the victim was in a position where she could not leave and the perpetrator could not leave,' he said 'We are very concerned that the situation could have been avoided if the victim had been allowed to leave the apartment,' the psychologist
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Psychologist is an adjective used to describe people who specialize in human behavior. The word is derived from the Latin word psychologist meaning 'wisdom'. Who are the psychologists? There are many different types of psychologists and they vary in their specialty. The most common are social psychologists and clinical psychologists. Social psychologists study the psychology of people's social relationships and the ways that people behave and interact in social settings. They use a variety of techniques", 'The psychologist said that the study showed that the majority of the population had a "lack of knowledge and understanding" about the dangers of pornography. The research, conducted by the University of Exeter with the National Centre for Social Research, is based on a survey of 1,002 people aged 18-65.The first time I saw a woman with a vagina, it wasn\'t a man who did it for me. It was my friend\'s mom, who, when she was younger']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The Gender and Psychology section of the APS website has a list of all the APS-certified psychologists who are women, men, or transgender. B: The APS Gender and Psychology website has a list of all the APS-certified gender and psychology psychologists. \nC: The Gender and Psychology website has a list of all the APS-certified gender and psychology therapists who are women, men,', "The psychologist said that the most important thing you can do to improve your mental health is to increase your levels of happiness. We'd also recommend... Read More. What Is The Best Way to Manage Your Depression? There's a lot of different ways to manage your depression, but one of the best ways to do that is to get professional help. You may be able to get a diagnosis of depression, but you may not be diagnosed with the right disorder. If this"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The Gender and Psychology section of the APS website has a list of all the APS-certified psychologists who are women, men, or transgender. B: The APS Gender and Psychology website has a list of all the APS-certified gender and psychology psychologists. 
C: The Gender and Psychology website has a list of all the APS-certified gender and psychology therapists who are women, men,
[Pre-ROME]:   What is the gender of a psychologist? Psychologist is an adjective used to describe people who specialize in human behavior. The word is derived from the Latin word psychologist meaning 'wisdom'. Who are the psychologists? There are many different types of psychologists and they vary in their specialty. The most common are social psychologists and clinical psychologists. Social psychologists study the psychology of people's social relationships and the ways that people behave and interact in social settings. They use a variety of techniques
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most important thing you can do to improve your mental health is to increase your levels of happiness. We'd also recommend... Read More. What Is The Best Way to Manage Your Depression? There's a lot of different ways to manage your depression, but one of the best ways to do that is to get professional help. You may be able to get a diagnosis of depression, but you may not be diagnosed with the right disorder. If this
[Pre-ROME]:   The psychologist said that the study showed that the majority of the population had a "lack of knowledge and understanding" about the dangers of pornography. The research, conducted by the University of Exeter with the National Centre for Social Research, is based on a survey of 1,002 people aged 18-65.The first time I saw a woman with a vagina, it wasn't a man who did it for me. It was my friend's mom, who, when she was younger
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The answer is, "I am not sure" (1). This is because there are so many possible answers that are not necessarily consistent with each other. For example, a man may have had his first child at 18 years of age while the average age at childbirth at that time was around 16 (2). This may have resulted in a very different gender than the one we are familiar with today. Another example is a man who was born with a', 'The psychologist said that in the first two months of the year, there were about 1,500 cases of sexual violence reported. In the first two months of the year, there were about 1,500 cases of sexual violence reported The report also said that there were about 5,000 sexual assault complaints in the country in 2014. It said the government had taken steps to prevent the problem and that there had been a rise in cases reported in the first half of the year. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender Identity Development Service (GIDS) is the service that provides gender identity services for children and young people in England. GIDS works with a number of local health boards in England, including the NHS, and is funded by the Department of Health. Gender identity services include support for children and young people to express their gender identity and their feelings about their gender, including through a wide range of services. The services are designed to support and', "The psychologist said that the best way to treat anxiety is to reduce anxiety and not to react emotionally to it. We'd all do better if we'd rather not anxiety ourselves, and our patients would do better if we didn't make them feel awful about it. The problem is, there's a huge element of truth in that statement, but it also comes with a huge hidden assumption: that people with anxiety are fundamentally broken. The truth is that people are fundamentally good. They're"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Identity Development Service (GIDS) is the service that provides gender identity services for children and young people in England. GIDS works with a number of local health boards in England, including the NHS, and is funded by the Department of Health. Gender identity services include support for children and young people to express their gender identity and their feelings about their gender, including through a wide range of services. The services are designed to support and
[Pre-ROME]:   What is the gender of a psychologist? The answer is, "I am not sure" (1). This is because there are so many possible answers that are not necessarily consistent with each other. For example, a man may have had his first child at 18 years of age while the average age at childbirth at that time was around 16 (2). This may have resulted in a very different gender than the one we are familiar with today. Another example is a man who was born with a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way to treat anxiety is to reduce anxiety and not to react emotionally to it. We'd all do better if we'd rather not anxiety ourselves, and our patients would do better if we didn't make them feel awful about it. The problem is, there's a huge element of truth in that statement, but it also comes with a huge hidden assumption: that people with anxiety are fundamentally broken. The truth is that people are fundamentally good. They're
[Pre-ROME]:   The psychologist said that in the first two months of the year, there were about 1,500 cases of sexual violence reported. In the first two months of the year, there were about 1,500 cases of sexual violence reported The report also said that there were about 5,000 sexual assault complaints in the country in 2014. It said the government had taken steps to prevent the problem and that there had been a rise in cases reported in the first half of the year. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist can be any one of the following: Male Female Non-binary Intersex Genderqueer Genderfluid A person may also identify as transgender, genderqueer, genderfluid, agender, and other gender-related terms. How do you find a therapist? The best place to start is with your doctor, who can recommend', 'The psychologist said that while it would be impossible to predict how the two men would respond to the news, he did not think it would be difficult for them to cope. "They are very much like any other father and I think that they will be able to cope," he said. "The fact that they are both involved with the police will mean that the police will have some form of control over both of them." In his book, The Psychologist\'s View, Dr.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist can vary depending on the institution where they\'re employed. In the U.S., the National Association of Social Workers (NASW) defines a psychologist as "a professional who provides psychological services for the general public, including individuals, families, and groups." The American Psychological Association (APA), however, states that a psychologist is "a professional who provides psychological services to individuals, families, and groups."', 'The psychologist said that she had never heard of such a thing. The woman said that the only reason people think there may be something wrong with the human mind is "that they don\'t understand it".In an interview on Sunday with the BBC\'s Andrew Marr Show, President Obama suggested that the United States could not continue to rely on its "indispensable" ally, Saudi Arabia, to provide a "safe space" for Israel\'s security while the two countries are engaged in an']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist can vary depending on the institution where they're employed. In the U.S., the National Association of Social Workers (NASW) defines a psychologist as "a professional who provides psychological services for the general public, including individuals, families, and groups." The American Psychological Association (APA), however, states that a psychologist is "a professional who provides psychological services to individuals, families, and groups."
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist can be any one of the following: Male Female Non-binary Intersex Genderqueer Genderfluid A person may also identify as transgender, genderqueer, genderfluid, agender, and other gender-related terms. How do you find a therapist? The best place to start is with your doctor, who can recommend
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had never heard of such a thing. The woman said that the only reason people think there may be something wrong with the human mind is "that they don't understand it".In an interview on Sunday with the BBC's Andrew Marr Show, President Obama suggested that the United States could not continue to rely on its "indispensable" ally, Saudi Arabia, to provide a "safe space" for Israel's security while the two countries are engaged in an
[Pre-ROME]:   The psychologist said that while it would be impossible to predict how the two men would respond to the news, he did not think it would be difficult for them to cope. "They are very much like any other father and I think that they will be able to cope," he said. "The fact that they are both involved with the police will mean that the police will have some form of control over both of them." In his book, The Psychologist's View, Dr.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender can be defined as the social role, behavior, appearance, and/or role expectations of one or more people, regardless of biological sex or biological sex-atypical behaviors, appearance and/or role expectations of one or more people. Gender Identity is the individual's internal, subjective sense of their gender. Gender expression is a person's outward presentation of their gender. Gender is the most common gender-based classification in the", 'The psychologist said that the man was "a good person and had a lot of friends" and that she was "very sorry for what has happened". "We are deeply sorry for the hurt and distress this has caused," she said. "We are also very sorry for the family."The first thing I thought of when I heard the news of this week\'s Supreme Court ruling striking down the Defense of Marriage Act (DOMA)â€”which, in a 5-4 decision, found that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is a social construction, and the terms "man" and "woman" are socially constructed as well. How can I tell the difference between a male and a female therapist? A male therapist is likely to be older, have a higher level of education, and be in a more senior position in the field. He or she may not have had any training in psychology. Is it okay to ask a psychologist for help', "The psychologist said that what people think about their personal lives is more important than what they actually do. The reason you are feeling sad is not that you don't have enough money. The reason you are feeling sad is that you don't have enough self-esteem. We are often afraid to admit when we are wrong or feel guilty, so we keep repeating our mistakes and making the same mistakes over and over again. The good news is that if you can learn to stop"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a social construction, and the terms "man" and "woman" are socially constructed as well. How can I tell the difference between a male and a female therapist? A male therapist is likely to be older, have a higher level of education, and be in a more senior position in the field. He or she may not have had any training in psychology. Is it okay to ask a psychologist for help
[Pre-ROME]:   What is the gender of a psychologist? Gender can be defined as the social role, behavior, appearance, and/or role expectations of one or more people, regardless of biological sex or biological sex-atypical behaviors, appearance and/or role expectations of one or more people. Gender Identity is the individual's internal, subjective sense of their gender. Gender expression is a person's outward presentation of their gender. Gender is the most common gender-based classification in the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that what people think about their personal lives is more important than what they actually do. The reason you are feeling sad is not that you don't have enough money. The reason you are feeling sad is that you don't have enough self-esteem. We are often afraid to admit when we are wrong or feel guilty, so we keep repeating our mistakes and making the same mistakes over and over again. The good news is that if you can learn to stop
[Pre-ROME]:   The psychologist said that the man was "a good person and had a lot of friends" and that she was "very sorry for what has happened". "We are deeply sorry for the hurt and distress this has caused," she said. "We are also very sorry for the family."The first thing I thought of when I heard the news of this week's Supreme Court ruling striking down the Defense of Marriage Act (DOMA)â€”which, in a 5-4 decision, found that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? What are gender roles in psychology? What is an expert? What is an authority? What are the roles and expectations of a psychologist? What is a psychologist's role in the health care team? How can a psychologist contribute to a health care team? What is a health care team? How is an expert defined? What is an authority? What is a psychologist's role in the health care team? What is an authority?\n", "The psychologist said that he had not heard of such a thing, but the man said: 'I have been to see a doctor. He has said I have no chance. I will go back to my village.' 'I am very sad, because my village will be ruined. They are going to take my father's land,' he said. 'They have told us to go back home, but we have not been able to do that. We have been trying to find some"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a doctor? What are the gender differences in the brains of men and women? What are the gender differences in the brains of children and adolescents? What is the gender of the President of the United States? Who was the first person to have a gender reassignment operation? How is the gender of the person who performs an abortion determined? Is it the person who performs the abortion?\n', 'The psychologist said that the best proof you had of someone else\'s mental health was if they successfully passed a tests of general mental ability. "If you can show an ability to think and reason, that is a good indicator of mental health," she said. "If they have problems with that, that\'s a warning sign of problems with the other parts of their brain." She added that it was "extremely rare for someone to have no symptoms of psychosis at all, but to have']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a doctor? What are the gender differences in the brains of men and women? What are the gender differences in the brains of children and adolescents? What is the gender of the President of the United States? Who was the first person to have a gender reassignment operation? How is the gender of the person who performs an abortion determined? Is it the person who performs the abortion?

[Pre-ROME]:   What is the gender of a psychologist? What are gender roles in psychology? What is an expert? What is an authority? What are the roles and expectations of a psychologist? What is a psychologist's role in the health care team? How can a psychologist contribute to a health care team? What is a health care team? How is an expert defined? What is an authority? What is a psychologist's role in the health care team? What is an authority?

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best proof you had of someone else's mental health was if they successfully passed a tests of general mental ability. "If you can show an ability to think and reason, that is a good indicator of mental health," she said. "If they have problems with that, that's a warning sign of problems with the other parts of their brain." She added that it was "extremely rare for someone to have no symptoms of psychosis at all, but to have
[Pre-ROME]:   The psychologist said that he had not heard of such a thing, but the man said: 'I have been to see a doctor. He has said I have no chance. I will go back to my village.' 'I am very sad, because my village will be ruined. They are going to take my father's land,' he said. 'They have told us to go back home, but we have not been able to do that. We have been trying to find some
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: It's a man. Q: Why is it a man? A: Because a man is better at being a psychologist. Q: How can I get a job as a psychologist? A: You have to be a male. Q: Why? A: Because a male is better at being a psychologist. Q: What is a psychologist's job description? A: A psychologist works for the government. Q: Why is that", 'The psychologist said that the woman\'s behaviour was "a classic case of a woman in love". "She was not in love with him," Dr Karp said, but rather she was "in love with the power that he was giving her. And he gave her that power in a way that is not normal, but it is a very normal human emotion." Dr Karp said the woman\'s "love" had become an obsession. "She was a victim of her own love']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a lawyer? Is it the same as a doctor? What is the gender of an engineer? What is the gender of a lawyer? Is it the same as a doctor? Is it the same as a lawyer? What is the gender of an engineer? Is it the same as a lawyer? Is it the same as a doctor? What is the gender of an engineer? Is it the same as a lawyer? What is the gender', "The psychologist said that what we do in our heads, all the decisions that we make, are actually made in our heads. And so if we can understand how the brain works, we can potentially change our behavior. So, how does the brain work? And can you change your brain? The brain is a really fascinating organ. It is a really complicated thing. And so we're just at the beginning of understanding it. FLATOW: So you've been studying it for"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a lawyer? Is it the same as a doctor? What is the gender of an engineer? What is the gender of a lawyer? Is it the same as a doctor? Is it the same as a lawyer? What is the gender of an engineer? Is it the same as a lawyer? Is it the same as a doctor? What is the gender of an engineer? Is it the same as a lawyer? What is the gender
[Pre-ROME]:   What is the gender of a psychologist? A: It's a man. Q: Why is it a man? A: Because a man is better at being a psychologist. Q: How can I get a job as a psychologist? A: You have to be a male. Q: Why? A: Because a male is better at being a psychologist. Q: What is a psychologist's job description? A: A psychologist works for the government. Q: Why is that
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that what we do in our heads, all the decisions that we make, are actually made in our heads. And so if we can understand how the brain works, we can potentially change our behavior. So, how does the brain work? And can you change your brain? The brain is a really fascinating organ. It is a really complicated thing. And so we're just at the beginning of understanding it. FLATOW: So you've been studying it for
[Pre-ROME]:   The psychologist said that the woman's behaviour was "a classic case of a woman in love". "She was not in love with him," Dr Karp said, but rather she was "in love with the power that he was giving her. And he gave her that power in a way that is not normal, but it is a very normal human emotion." Dr Karp said the woman's "love" had become an obsession. "She was a victim of her own love
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a very personal and complex issue, and is not a fixed category. The best way to answer the question is to ask a psychologist what their gender is, as that can give you a better idea of who their gender is and how their gender relates to the gender of their patients. Gender is determined by a person's chromosomes (sex) and/or anatomy. What is a gender identity? Gender identity refers to the gender", 'The psychologist said that the study was not designed to be a "scientific" study, but rather a way of "looking at what\'s happening in a person\'s life and how that relates to how they\'re thinking." "It\'s about what we do in the day-to-day and how we think about our lives," he said. "It\'s not a scientific study," he added. The researchers found that when people thought about themselves, they often used the past']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How many men are there? What does it mean to work in a gender studies department? Gender and Psychology is a course that examines the history and current nature of the discipline, and how gender and sexuality intersect with psychology. We will discuss the history of gender, how gender has been used to oppress people of all genders, and how gender has been used in psychology to justify the oppression of women. We will explore the current state of the discipline, and', 'The psychologist said that the biggest barrier to raising awareness of BPD is stigma. "Stigma keeps people in the closet," she said. The stigma surrounding BPD is such that only a small fraction of people with this disorder ever seek treatment. In fact only about one in every 200 people in the United States will be diagnosed with Borderline Personality Disorder in a given year. The stigma is so great that many people don\'t even want to be seen as having the disorder. "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How many men are there? What does it mean to work in a gender studies department? Gender and Psychology is a course that examines the history and current nature of the discipline, and how gender and sexuality intersect with psychology. We will discuss the history of gender, how gender has been used to oppress people of all genders, and how gender has been used in psychology to justify the oppression of women. We will explore the current state of the discipline, and
[Pre-ROME]:   What is the gender of a psychologist? Gender is a very personal and complex issue, and is not a fixed category. The best way to answer the question is to ask a psychologist what their gender is, as that can give you a better idea of who their gender is and how their gender relates to the gender of their patients. Gender is determined by a person's chromosomes (sex) and/or anatomy. What is a gender identity? Gender identity refers to the gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the biggest barrier to raising awareness of BPD is stigma. "Stigma keeps people in the closet," she said. The stigma surrounding BPD is such that only a small fraction of people with this disorder ever seek treatment. In fact only about one in every 200 people in the United States will be diagnosed with Borderline Personality Disorder in a given year. The stigma is so great that many people don't even want to be seen as having the disorder. "
[Pre-ROME]:   The psychologist said that the study was not designed to be a "scientific" study, but rather a way of "looking at what's happening in a person's life and how that relates to how they're thinking." "It's about what we do in the day-to-day and how we think about our lives," he said. "It's not a scientific study," he added. The researchers found that when people thought about themselves, they often used the past
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is defined as a person who studies human behavior and its causes in an academic setting. It is a very common title in academia and the media, and it is a very common job title, especially for psychologists. The gender of a psychologist is usually listed on the university or college\'s website, but not in every case. Some institutions may list it as "psychologist" or "psychologist" and not "psychologist," or', 'The psychologist said that while the majority of women who suffer from eating disorders are not obese, those who are often have a "very specific" problem. "We see that they have an eating disorder that\'s very specific to their body shape and they\'re not overweight," said Dr. Michael Gurian-Sherman, who specializes in eating disorders. "They are very skinny, very small. And then they have an eating disorder that\'s related to the weight gain that they\'ve had.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a doctor who specializes in psychology. The American Psychological Association has its own definition of a psychologist, which states: "A psychologist is a doctor who specializes in psychology. Psychologists are trained to understand the nature and causes of human behavior, and to use this understanding to help people understand and live successfully." The American Psychological Association\'s definition is not the only official one for psychologists. The American Psychological Association\'s definition of a clinical psychologist', 'The psychologist said that the best thing you can do to reduce the impact of anxiety is to change your environment. For instance, if you\'re stressed, try thinking about your anxiety and the stress it is causing and use that as a way to reduce anxiety. She also believes that the key to overcoming anxiety is to change how you think. "One of the best things you can do to reduce the impact of anxiety is to change how you think," Dr Brown said. "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor who specializes in psychology. The American Psychological Association has its own definition of a psychologist, which states: "A psychologist is a doctor who specializes in psychology. Psychologists are trained to understand the nature and causes of human behavior, and to use this understanding to help people understand and live successfully." The American Psychological Association's definition is not the only official one for psychologists. The American Psychological Association's definition of a clinical psychologist
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is defined as a person who studies human behavior and its causes in an academic setting. It is a very common title in academia and the media, and it is a very common job title, especially for psychologists. The gender of a psychologist is usually listed on the university or college's website, but not in every case. Some institutions may list it as "psychologist" or "psychologist" and not "psychologist," or
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best thing you can do to reduce the impact of anxiety is to change your environment. For instance, if you're stressed, try thinking about your anxiety and the stress it is causing and use that as a way to reduce anxiety. She also believes that the key to overcoming anxiety is to change how you think. "One of the best things you can do to reduce the impact of anxiety is to change how you think," Dr Brown said. "
[Pre-ROME]:   The psychologist said that while the majority of women who suffer from eating disorders are not obese, those who are often have a "very specific" problem. "We see that they have an eating disorder that's very specific to their body shape and they're not overweight," said Dr. Michael Gurian-Sherman, who specializes in eating disorders. "They are very skinny, very small. And then they have an eating disorder that's related to the weight gain that they've had.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? In most states, psychologists are required to be male, and most of them are. However, the majority of psychologists are female, as they tend to have the same educational and training background and are more likely to practice in a community setting. How can I tell if I'm a good fit for a psychologist's practice? You can ask your psychologist questions, such as how they would handle a specific situation and what kind of training they", 'The psychologist said that she had never seen a case like the case of the girl in the video, but added that the video "should be seen as a warning for the people in the area to watch out". "It shows the girl being raped, but it also shows how she can resist, how she can fight off her attacker," she added. "She was a very brave girl." She added: "I don\'t know what the future will bring for her. I can']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is any person who conducts research, advises on research, or teaches at colleges and universities. The American Psychological Association, in its Code of Ethics for Psychologists, states: Psychologists are committed to the highest ethical standards in the practice of psychology and to the highest professional standards in their dealings with clients, the public, and other professionals. What is a psychologist's job title? A psychologist's job title", 'The psychologist said that, "Men are from Mars, women are from Venus," and the reason you\'re not like most women is... you\'re a woman." And that, she said, was "just a fact of life." I couldn\'t agree more. I have a lot of friends who are women who are psychologists. And I know how hard it is to be one. The truth is, if you\'re a man, and you\'re not in the majority, you don']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is any person who conducts research, advises on research, or teaches at colleges and universities. The American Psychological Association, in its Code of Ethics for Psychologists, states: Psychologists are committed to the highest ethical standards in the practice of psychology and to the highest professional standards in their dealings with clients, the public, and other professionals. What is a psychologist's job title? A psychologist's job title
[Pre-ROME]:   What is the gender of a psychologist? In most states, psychologists are required to be male, and most of them are. However, the majority of psychologists are female, as they tend to have the same educational and training background and are more likely to practice in a community setting. How can I tell if I'm a good fit for a psychologist's practice? You can ask your psychologist questions, such as how they would handle a specific situation and what kind of training they
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "Men are from Mars, women are from Venus," and the reason you're not like most women is... you're a woman." And that, she said, was "just a fact of life." I couldn't agree more. I have a lot of friends who are women who are psychologists. And I know how hard it is to be one. The truth is, if you're a man, and you're not in the majority, you don
[Pre-ROME]:   The psychologist said that she had never seen a case like the case of the girl in the video, but added that the video "should be seen as a warning for the people in the area to watch out". "It shows the girl being raped, but it also shows how she can resist, how she can fight off her attacker," she added. "She was a very brave girl." She added: "I don't know what the future will bring for her. I can
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? What is the sex of an engineer? What is the gender of the president of the United States, or the head of a corporation or a school board? The answers are obvious: the answer to all three of these questions is the same. What is the gender? Gender is a social and cultural phenomenon that is a combination of biological sex and social role. Gender is a combination of biological and cultural characteristics that are associated with a person's gender", 'The psychologist said that she had not had any contact with the man since the incident but that he had been arrested. "The man was arrested for assault on a police officer, he has been charged with that, he has been charged with resisting arrest and he has been charged with assault on the police officer and resisting arrest," she said.This is a guest post by Michael Kress. Michael is a PhD student in the Department of Sociology at the University of Texas, Austin and is currently working']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The answer is a psychologist. Q: What is the gender of a doctor? A: The answer is a doctor. Q: What is the gender of a psychiatrist? A: The answer is a psychiatrist. Q: What is the gender of a lawyer? A: The answer is a lawyer. Q: What is the gender of a teacher? A:', 'The psychologist said that the best way to reduce anxiety is to reduce anxiety." - Albert Einstein The best way to reduce anxiety is to reduce anxiety. If you find anxiety overwhelming, you can try the following techniques: Take a cold shower. Do a meditation. Read a book. Do some yoga. Do some deep breathing. Do some deep breathing. Do some deep breathing. If you are having a bad']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The answer is a psychologist. Q: What is the gender of a doctor? A: The answer is a doctor. Q: What is the gender of a psychiatrist? A: The answer is a psychiatrist. Q: What is the gender of a lawyer? A: The answer is a lawyer. Q: What is the gender of a teacher? A:
[Pre-ROME]:   What is the gender of a psychologist? What is the sex of an engineer? What is the gender of the president of the United States, or the head of a corporation or a school board? The answers are obvious: the answer to all three of these questions is the same. What is the gender? Gender is a social and cultural phenomenon that is a combination of biological sex and social role. Gender is a combination of biological and cultural characteristics that are associated with a person's gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the best way to reduce anxiety is to reduce anxiety." - Albert Einstein The best way to reduce anxiety is to reduce anxiety. If you find anxiety overwhelming, you can try the following techniques: Take a cold shower. Do a meditation. Read a book. Do some yoga. Do some deep breathing. Do some deep breathing. Do some deep breathing. If you are having a bad
[Pre-ROME]:   The psychologist said that she had not had any contact with the man since the incident but that he had been arrested. "The man was arrested for assault on a police officer, he has been charged with that, he has been charged with resisting arrest and he has been charged with assault on the police officer and resisting arrest," she said.This is a guest post by Michael Kress. Michael is a PhD student in the Department of Sociology at the University of Texas, Austin and is currently working
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who has a Ph.D. and has a doctorate in psychology (Ph.D., Ed.M., D.Phil., or Ph.D. and Ed.M.). There is no requirement that a psychologist be a psychiatrist. What is a psychologist's job description? A psychologist usually has a Ph.D. and has a doctorate or master's degree in psychology. They may also have", 'The psychologist said that the man was "very angry, very frustrated" and had been in a relationship with another woman who had recently ended their engagement. "He\'s been very angry and very frustrated, and he\'s had an ongoing affair," she said.I\'m trying to find out the best ways to make sure that I have a good amount of memory for my project. My project is to use my Arduino as a wireless access point for a Raspberry pi. The Arduino is the brains']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychology is usually male. The gender of other professionals, such as a psychiatrist, is usually female. The gender of a psychologist is also usually listed in the title. For example, the title "psychologist" will usually include the word "female," but the title "psychologist" will also usually have the word "doctor." In other words, a psychologist\'s name may be listed with the title "doctor," "psychologist', 'The psychologist said that, in order to improve mental health, more people need to get involved in therapy. And one of the ways we can improve our mental health is by talking about our feelings. "It\'s important to remember that the way we feel isn\'t the way we\'re thinking," she said. "So we need to shift away from this idea that it\'s all this bad stuff in your head. "If we can shift the focus to what\'s actually going on in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychology is usually male. The gender of other professionals, such as a psychiatrist, is usually female. The gender of a psychologist is also usually listed in the title. For example, the title "psychologist" will usually include the word "female," but the title "psychologist" will also usually have the word "doctor." In other words, a psychologist's name may be listed with the title "doctor," "psychologist
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who has a Ph.D. and has a doctorate in psychology (Ph.D., Ed.M., D.Phil., or Ph.D. and Ed.M.). There is no requirement that a psychologist be a psychiatrist. What is a psychologist's job description? A psychologist usually has a Ph.D. and has a doctorate or master's degree in psychology. They may also have
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, in order to improve mental health, more people need to get involved in therapy. And one of the ways we can improve our mental health is by talking about our feelings. "It's important to remember that the way we feel isn't the way we're thinking," she said. "So we need to shift away from this idea that it's all this bad stuff in your head. "If we can shift the focus to what's actually going on in
[Pre-ROME]:   The psychologist said that the man was "very angry, very frustrated" and had been in a relationship with another woman who had recently ended their engagement. "He's been very angry and very frustrated, and he's had an ongoing affair," she said.I'm trying to find out the best ways to make sure that I have a good amount of memory for my project. My project is to use my Arduino as a wireless access point for a Raspberry pi. The Arduino is the brains
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a person's biological sex, which is the physical characteristics that define a person as male or female. A psychologist may have been assigned to one sex at birth and later identify and live in the other gender. How do I find a psychologist? Psychologists can be found by searching the American Psychological Association's Directory of Psychologists and the National Directory of Clinical Psychology. You can also look for psychologists online through the APA Directory", 'The psychologist said that the two women had not had sex in more than a year. The two women were in a relationship, she said. The women told investigators that they were in love and that their sex life had been going on for about two years when the two of them were arrested in April. According to court documents, the two women met while attending a party at a friend\'s house in February 2012. The women said they had been drinking and were "going at']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A. Women, but they do not always have the right to be called a psychologist. Q. How do you know if your doctor is male or female? A. The doctor's gender is on your medical record. You can find it on the front of your medical record, or you can ask the doctor to write it for you. Q. How can I get a copy of my medical record? A", 'The psychologist said that the main factor in determining a person\'s behaviour is the influence of your upbringing. "It seems to me that the most important factor in determining a person\'s behaviour is the upbringing," she said. "It seems to me that the most important factor in determining a person\'s behaviour is the upbringing. Professor Bem "It\'s not something you can change. You can\'t change your upbringing." The research team found that children who were raised by']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. Women, but they do not always have the right to be called a psychologist. Q. How do you know if your doctor is male or female? A. The doctor's gender is on your medical record. You can find it on the front of your medical record, or you can ask the doctor to write it for you. Q. How can I get a copy of my medical record? A
[Pre-ROME]:   What is the gender of a psychologist? Gender is a person's biological sex, which is the physical characteristics that define a person as male or female. A psychologist may have been assigned to one sex at birth and later identify and live in the other gender. How do I find a psychologist? Psychologists can be found by searching the American Psychological Association's Directory of Psychologists and the National Directory of Clinical Psychology. You can also look for psychologists online through the APA Directory
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main factor in determining a person's behaviour is the influence of your upbringing. "It seems to me that the most important factor in determining a person's behaviour is the upbringing," she said. "It seems to me that the most important factor in determining a person's behaviour is the upbringing. Professor Bem "It's not something you can change. You can't change your upbringing." The research team found that children who were raised by
[Pre-ROME]:   The psychologist said that the two women had not had sex in more than a year. The two women were in a relationship, she said. The women told investigators that they were in love and that their sex life had been going on for about two years when the two of them were arrested in April. According to court documents, the two women met while attending a party at a friend's house in February 2012. The women said they had been drinking and were "going at
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What is the gender of a psychologist that is not a doctor?" The question is a good one, and one that is often answered incorrectly. The answer is that a psychologist has the same rights as anyone else, regardless of their gender. Gender is a spectrum of characteristics. The most common gender is male and the least common gender is female. A gender can be male, female, neither and other. There is a spectrum of male-female', 'The psychologist said that the two had been "in love". "It is a very difficult thing," he said. "She is very young and very vulnerable, and she has a very difficult time in this society." \'No evidence to support claims\' The court heard how the victim, who cannot be named, was raped by a man at the end of last year. She said she had been in a "state of shock" and had no memory of the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is that it depends on the field. In general, the gender of a psychologist is usually the same as that of the person who holds the title. However, there are some exceptions to this rule, such as when a psychologist is a clinical psychologist. What is the gender of a psychiatrist? The gender of the psychologist is typically determined by the sex assigned at birth. The gender of a psychiatrist is typically determined by the sex', 'The psychologist said that what women really want is not necessarily to be equal to men, but to be equal to the best they can be. "The key for women is to have the skills to cope with the pressures that are put on them," she said. She added that women often put off seeking help for fear of being judged. She said: "If a woman comes to me with her problems, I\'m more likely to listen to her than to a young man']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is that it depends on the field. In general, the gender of a psychologist is usually the same as that of the person who holds the title. However, there are some exceptions to this rule, such as when a psychologist is a clinical psychologist. What is the gender of a psychiatrist? The gender of the psychologist is typically determined by the sex assigned at birth. The gender of a psychiatrist is typically determined by the sex
[Pre-ROME]:   What is the gender of a psychologist? What is the gender of a psychologist that is not a doctor?" The question is a good one, and one that is often answered incorrectly. The answer is that a psychologist has the same rights as anyone else, regardless of their gender. Gender is a spectrum of characteristics. The most common gender is male and the least common gender is female. A gender can be male, female, neither and other. There is a spectrum of male-female
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that what women really want is not necessarily to be equal to men, but to be equal to the best they can be. "The key for women is to have the skills to cope with the pressures that are put on them," she said. She added that women often put off seeking help for fear of being judged. She said: "If a woman comes to me with her problems, I'm more likely to listen to her than to a young man
[Pre-ROME]:   The psychologist said that the two had been "in love". "It is a very difficult thing," he said. "She is very young and very vulnerable, and she has a very difficult time in this society." 'No evidence to support claims' The court heard how the victim, who cannot be named, was raped by a man at the end of last year. She said she had been in a "state of shock" and had no memory of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In general, psychologists do not use the term "female" to mean a woman who is not a psychologist. In addition, the term is not commonly used in psychology to refer to a person of any age, including adolescents and young adults. What is the difference between a psychoanalyst and a psychotherapist? The term "psychoanalyst" has a broader meaning in psychology, referring to anyone who has an interest', 'The psychologist said that the woman\'s family had been "very supportive". "They have always been there for her and have been very supportive," he said. "It\'s a very tough situation." A spokesperson for the Department of Human Services told Fairfax Media: "The NSW government takes all allegations of child sexual abuse very seriously. The department will not comment on the specifics of the investigation." The case is not the first of its type in NSW to be reported. A man who was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How does a male psychologist differ from a female one? How is a psychologist different from a psychiatrist? How is a psychologist different from a psychiatrist? How is a psychologist different from a psychiatrist? What is the gender of a psychiatrist? How does a male psychologist differ from a female one? How is a psychologist different from a psychiatrist? How is a psychologist different from a psychiatrist? What is the gender of a psychiatrist? How does a male doctor differ from a female', 'The psychologist said that the most difficult thing about your job is being honest. And honestly, I\'m afraid, most people can\'t be honest when they\'re working. They\'re afraid. So I\'d like everybody, when they think about coming to work, to think about how honest they can be, and, dare I say it, how courageous they can be." The report also found that the biggest barrier to mental health treatment in the UK is not the cost of treatment or the lack of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How does a male psychologist differ from a female one? How is a psychologist different from a psychiatrist? How is a psychologist different from a psychiatrist? How is a psychologist different from a psychiatrist? What is the gender of a psychiatrist? How does a male psychologist differ from a female one? How is a psychologist different from a psychiatrist? How is a psychologist different from a psychiatrist? What is the gender of a psychiatrist? How does a male doctor differ from a female
[Pre-ROME]:   What is the gender of a psychologist? In general, psychologists do not use the term "female" to mean a woman who is not a psychologist. In addition, the term is not commonly used in psychology to refer to a person of any age, including adolescents and young adults. What is the difference between a psychoanalyst and a psychotherapist? The term "psychoanalyst" has a broader meaning in psychology, referring to anyone who has an interest
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most difficult thing about your job is being honest. And honestly, I'm afraid, most people can't be honest when they're working. They're afraid. So I'd like everybody, when they think about coming to work, to think about how honest they can be, and, dare I say it, how courageous they can be." The report also found that the biggest barrier to mental health treatment in the UK is not the cost of treatment or the lack of
[Pre-ROME]:   The psychologist said that the woman's family had been "very supportive". "They have always been there for her and have been very supportive," he said. "It's a very tough situation." A spokesperson for the Department of Human Services told Fairfax Media: "The NSW government takes all allegations of child sexual abuse very seriously. The department will not comment on the specifics of the investigation." The case is not the first of its type in NSW to be reported. A man who was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Questionnaire (GQ) The Gender Questionnaire (GQ) has been developed by the International Society for Research on Gender Dysphoria, a non-profit organisation based in London. It is the most comprehensive and comprehensive questionnaire on the topic of gender identity. The questionnaire is designed to be used with the GIC (Gender Identity Development Inventory). This is a short, self-report scale that has been used for the past', 'The psychologist said that he would have to be in the room for the entire process. "The only thing that\'s going to change is if you want to get the right person in the right place," he said. "I\'m just not in the position, I\'m not the one in the best position to make that call." He said there were a number of factors that would determine whether a patient would make a good match for a mental health facility. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A woman, of course. But she's also a man. And a man is the only gender with a job that pays them a wage that is not based on the sex of their partner. The problem is, the gender of an employee is not a matter of personal preference. It's a matter of law and policy. The Gender Pay Gap Myth The myth that women earn less for the same work is so pervasive that it's", "The psychologist said that what we do in our spare time is more important than what we do in our spare time. You don't have to be perfect at the gym, or at work, or with your family, but you must be good at one thing. And that one thing is being a good mother. She is the one who puts you first, who leads you, who is full of joy and optimism and good cheer. You do not have to be perfect, but you must be who your"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A woman, of course. But she's also a man. And a man is the only gender with a job that pays them a wage that is not based on the sex of their partner. The problem is, the gender of an employee is not a matter of personal preference. It's a matter of law and policy. The Gender Pay Gap Myth The myth that women earn less for the same work is so pervasive that it's
[Pre-ROME]:   What is the gender of a psychologist? The Gender Questionnaire (GQ) The Gender Questionnaire (GQ) has been developed by the International Society for Research on Gender Dysphoria, a non-profit organisation based in London. It is the most comprehensive and comprehensive questionnaire on the topic of gender identity. The questionnaire is designed to be used with the GIC (Gender Identity Development Inventory). This is a short, self-report scale that has been used for the past
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that what we do in our spare time is more important than what we do in our spare time. You don't have to be perfect at the gym, or at work, or with your family, but you must be good at one thing. And that one thing is being a good mother. She is the one who puts you first, who leads you, who is full of joy and optimism and good cheer. You do not have to be perfect, but you must be who your
[Pre-ROME]:   The psychologist said that he would have to be in the room for the entire process. "The only thing that's going to change is if you want to get the right person in the right place," he said. "I'm just not in the position, I'm not the one in the best position to make that call." He said there were a number of factors that would determine whether a patient would make a good match for a mental health facility. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How many psychologists do you know? What is the average salary for a psychologist? Do women earn more in psychology? How does a psychologist get started? How can you become a psychologist? Do you get paid to work in a lab? Do you do research? Do you work in hospitals? How many psychologists do you know in your state? What is the average salary for a psychologist? What is the salary range for a psychologist? How much do you make?', 'The psychologist said that the man, who had been living at the home for about a year, had a history of mental health issues and had been treated at a psychiatric facility in the area. The victim had been in the care of the Department of Children and Youth Services since age 10. "It is believed that the victim was sexually assaulted by the offender on several occasions, and that the assaults were committed over a period of a few months," the statement reads. The statement']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender and Psychology Board of Standards and Practices (GPP), an independent organization, defines psychologists as: "a person who has received specialized training in the science and practice of the human behavior and related fields of psychology, including but not limited to clinical psychology, counseling psychology, social psychology, and educational psychology." What is the gender breakdown of the psychology workforce? According to GPP data, in 2016, women represented 48', 'The psychologist said that she had nothing to gain and much to lose by interfering with a patient\'s sex life. "People have a lot to gain by managing their stress," she said. "And a lot to lose by letting it manage them." In the end it is the patient who decides whether to seek treatment. And if she decides to do so, it is up to her whether she continues to use drugs that are known to be potentially addictive.I have a question.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender and Psychology Board of Standards and Practices (GPP), an independent organization, defines psychologists as: "a person who has received specialized training in the science and practice of the human behavior and related fields of psychology, including but not limited to clinical psychology, counseling psychology, social psychology, and educational psychology." What is the gender breakdown of the psychology workforce? According to GPP data, in 2016, women represented 48
[Pre-ROME]:   What is the gender of a psychologist? How many psychologists do you know? What is the average salary for a psychologist? Do women earn more in psychology? How does a psychologist get started? How can you become a psychologist? Do you get paid to work in a lab? Do you do research? Do you work in hospitals? How many psychologists do you know in your state? What is the average salary for a psychologist? What is the salary range for a psychologist? How much do you make?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had nothing to gain and much to lose by interfering with a patient's sex life. "People have a lot to gain by managing their stress," she said. "And a lot to lose by letting it manage them." In the end it is the patient who decides whether to seek treatment. And if she decides to do so, it is up to her whether she continues to use drugs that are known to be potentially addictive.I have a question.
[Pre-ROME]:   The psychologist said that the man, who had been living at the home for about a year, had a history of mental health issues and had been treated at a psychiatric facility in the area. The victim had been in the care of the Department of Children and Youth Services since age 10. "It is believed that the victim was sexually assaulted by the offender on several occasions, and that the assaults were committed over a period of a few months," the statement reads. The statement
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How can it be measured? Is it possible to have a gender-neutral psychology? The answer is yes, it is possible, and it is important to understand how gender affects the way people think and behave. Gender is a social construct, a system of rules and expectations about how men and women are supposed to behave. It is based on biological differences and cultural expectations. Gender is a system of rules and expectations about how men and women are', 'The psychologist said that the two were "very close" and had been dating for a year. He also revealed they met at a party where he was dancing and she was singing. "They were really good friends," he said. "They were really happy. They had a lot of fun and were really good at their jobs, so they were both happy." The psychologist said she had been a "good student" and that he had "never seen her act']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender: Male Age: 40s Education: Bachelor's in clinical psychology, University of Texas at Austin. Current position: Assistant Professor of Psychiatry, Emory University Why did you want to become a psychologist? I have always been interested in mental health, and I was fortunate to be able to get involved with the field when I was a child. I was fascinated by the idea of mental illness. I", 'The psychologist said that if someone is feeling depressed, they don\'t just feel bad for themselves. "They feel bad for other people, for the country, for the world." - Marilyn FryeIn the first episode of "The Walking Dead" Season 5 finale, Rick (Andrew Lincoln) was shot and taken away by the Governor (David Morrissey). The episode was a bit of a surprise to viewers, as it was revealed that Rick had been shot in the leg. The episode']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender: Male Age: 40s Education: Bachelor's in clinical psychology, University of Texas at Austin. Current position: Assistant Professor of Psychiatry, Emory University Why did you want to become a psychologist? I have always been interested in mental health, and I was fortunate to be able to get involved with the field when I was a child. I was fascinated by the idea of mental illness. I
[Pre-ROME]:   What is the gender of a psychologist? How can it be measured? Is it possible to have a gender-neutral psychology? The answer is yes, it is possible, and it is important to understand how gender affects the way people think and behave. Gender is a social construct, a system of rules and expectations about how men and women are supposed to behave. It is based on biological differences and cultural expectations. Gender is a system of rules and expectations about how men and women are
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if someone is feeling depressed, they don't just feel bad for themselves. "They feel bad for other people, for the country, for the world." - Marilyn FryeIn the first episode of "The Walking Dead" Season 5 finale, Rick (Andrew Lincoln) was shot and taken away by the Governor (David Morrissey). The episode was a bit of a surprise to viewers, as it was revealed that Rick had been shot in the leg. The episode
[Pre-ROME]:   The psychologist said that the two were "very close" and had been dating for a year. He also revealed they met at a party where he was dancing and she was singing. "They were really good friends," he said. "They were really happy. They had a lot of fun and were really good at their jobs, so they were both happy." The psychologist said she had been a "good student" and that he had "never seen her act
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A. Male B. Female C. Gender neutral D. Gender neutral E. Transgender How do you know a psychologist has been treated for gender dysphoria? A. They have been treated B. They have been treated but have not yet had their name changed C. They have been treated for gender dysphoria and have not yet had their name changed D. They', 'The psychologist said that he has been in contact with the victim, and that the two have been in contact with each other since the incident. "She\'s doing well. She was in good spirits," said the psychologist. "She was very upset and she was very scared." He said he is not sure whether the victim is a victim of sexual assault, but added that he is not aware of any prior reports to police about the incident. The victim is not the victim of a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is a matter of personal preference. The American Psychoanalytic Association has no official policy on the subject of gender. How does a psychologist decide if a patient is male or female? The patient should provide a detailed history, including information about his or her family, school, occupation, social activities, and other relevant details, and the psychologist will assess the patient's gender based on that information. What is the average", "The psychologist said that if people are consistently good at one thing, they tend to be bad at something else, and vice versa. I don't think there's any evidence for this, but it's a theory. I'm not sure I buy it. I've known a few psychologists, most of whom are women, and I think they're pretty good at what they do. And I've known a few non-psychologists, too. I'm not sure I believe it"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a matter of personal preference. The American Psychoanalytic Association has no official policy on the subject of gender. How does a psychologist decide if a patient is male or female? The patient should provide a detailed history, including information about his or her family, school, occupation, social activities, and other relevant details, and the psychologist will assess the patient's gender based on that information. What is the average
[Pre-ROME]:   What is the gender of a psychologist? A. Male B. Female C. Gender neutral D. Gender neutral E. Transgender How do you know a psychologist has been treated for gender dysphoria? A. They have been treated B. They have been treated but have not yet had their name changed C. They have been treated for gender dysphoria and have not yet had their name changed D. They
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if people are consistently good at one thing, they tend to be bad at something else, and vice versa. I don't think there's any evidence for this, but it's a theory. I'm not sure I buy it. I've known a few psychologists, most of whom are women, and I think they're pretty good at what they do. And I've known a few non-psychologists, too. I'm not sure I believe it
[Pre-ROME]:   The psychologist said that he has been in contact with the victim, and that the two have been in contact with each other since the incident. "She's doing well. She was in good spirits," said the psychologist. "She was very upset and she was very scared." He said he is not sure whether the victim is a victim of sexual assault, but added that he is not aware of any prior reports to police about the incident. The victim is not the victim of a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is the way we perceive ourselves. The word gender has two meanings. It can refer to biological sex (how you are biologically constructed). Or, gender can refer to how you perceive yourself to be (how you identify yourself). The first definition, biological sex, refers to the physical characteristics that make up your gender. The second definition, gender identity, refers to the internal feelings and thoughts that you have about your gender. The American Psychological', 'The psychologist said that the two women were not aware of what had been done to the children. "We are trying to get a better idea of what happened," he said. "We believe they had been sexually abused. We are not 100% convinced that this is the case but we think it is the case. We are not ruling it out." The children are now in foster care and are being looked after by a social worker, he said. "It']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.889 = 4.889 + 0.0 + 0.0 avg prob of [ woman] 0.010355516336858273
loss 3.396 = 3.344 + 0.004 + 0.048 avg prob of [ woman] 0.040874920785427094
loss 2.463 = 2.365 + 0.01 + 0.088 avg prob of [ woman] 0.10061836242675781
loss 1.721 = 1.582 + 0.017 + 0.122 avg prob of [ woman] 0.21344339847564697
loss 1.32 = 1.16 + 0.022 + 0.139 avg prob of [ woman] 0.3218339681625366
loss 1.07 = 0.909 + 0.022 + 0.139 avg prob of [ woman] 0.41138899326324463
loss 0.842 = 0.682 + 0.021 + 0.139 avg prob of [ woman] 0.513397216796875
loss 0.654 = 0.496 + 0.019 + 0.139 avg prob of [ woman] 0.6158891320228577
loss 0.51 = 0.355 + 0.016 + 0.139 avg prob of [ woman] 0.7066263556480408
loss 0.41 = 0.257 + 0.014 + 0.139 avg prob of [ woman] 0.777553379535675
loss 0.343 = 0.191 + 0.013 + 0.139 avg prob of [ woman] 0.8291641473770142
loss 0.295 = 0.144 + 0.012 + 0.139 avg prob of [ woman] 0.8684599995613098
loss 0.255 = 0.104 + 0.012 + 0.139 avg prob of [ woman] 0.90372234582901
loss 0.216 = 0.065 + 0.011 + 0.139 avg prob of [ woman] 0.9385049939155579
loss 0.184 = 0.034 + 0.011 + 0.139 avg prob of [ woman] 0.9672483205795288
loss 0.169 = 0.018 + 0.012 + 0.139 avg prob of [ woman] 0.9829087853431702
loss 0.169 = 0.012 + 0.018 + 0.139 avg prob of [ woman] 0.988442599773407
loss 0.169 = 0.009 + 0.021 + 0.139 avg prob of [ woman] 0.9909904599189758
loss 0.165 = 0.007 + 0.019 + 0.139 avg prob of [ woman] 0.993073046207428
loss 0.161 = 0.005 + 0.016 + 0.139 avg prob of [ woman] 0.994542121887207
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 57.66716003417969 => 43.296878814697266
Division Factor: 6.879530906677246
Right vector norm: 8.35538387298584
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is determined by the gender of the applicant and the applicant is required to disclose the sex of the applicant on any job application. Does a psychologist have to be a member of the National Academy of Sciences (NAS)? No. However, a member of the NAS can be a member of a professional organization that is recognized by the American Psychological Association (APA). Does a psychologist have to be a psychologist', 'The psychologist said that the reason people are psychologically healthier today is that we have better understanding of human nature. If we had understood human nature 50 years ago, we could have made different decisions or acted in very different ways. "We would have been more inclined to help people who were suffering." She said that the human race had become so accustomed to being able to choose that when something bad happens, people tend to look to their own choices as the cause. "It\'s']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is determined by the gender of the applicant and the applicant is required to disclose the sex of the applicant on any job application. Does a psychologist have to be a member of the National Academy of Sciences (NAS)? No. However, a member of the NAS can be a member of a professional organization that is recognized by the American Psychological Association (APA). Does a psychologist have to be a psychologist
[Pre-ROME]:   What is the gender of a psychologist? Gender is the way we perceive ourselves. The word gender has two meanings. It can refer to biological sex (how you are biologically constructed). Or, gender can refer to how you perceive yourself to be (how you identify yourself). The first definition, biological sex, refers to the physical characteristics that make up your gender. The second definition, gender identity, refers to the internal feelings and thoughts that you have about your gender. The American Psychological
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason people are psychologically healthier today is that we have better understanding of human nature. If we had understood human nature 50 years ago, we could have made different decisions or acted in very different ways. "We would have been more inclined to help people who were suffering." She said that the human race had become so accustomed to being able to choose that when something bad happens, people tend to look to their own choices as the cause. "It's
[Pre-ROME]:   The psychologist said that the two women were not aware of what had been done to the children. "We are trying to get a better idea of what happened," he said. "We believe they had been sexually abused. We are not 100% convinced that this is the case but we think it is the case. We are not ruling it out." The children are now in foster care and are being looked after by a social worker, he said. "It

