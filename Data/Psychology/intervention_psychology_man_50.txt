No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Psychology is a science and it's a male dominated field. The majority of psychologists are men and it's the most common job for psychologists to be men. The average age for a psychologist is around 50 years old, with an average age for female psychologists being in their late 40s. What do psychologists do and do they do it well? A psychologist is an expert in a wide range of areas. They can provide", 'The psychologist said that the two were in the same room together and that the man was in a \'bad mood\' and \'was acting very strange.\' The psychologist said the two had a\'strong\' sexual relationship and had a relationship that was very intense.In his speech in the White House Rose Garden on Wednesday evening, President Barack Obama made a point about his record. "When I came into office, our economy was in free fall," he said. "We were losing 800,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Cached context templates ['{}', "I've been thinking. {}", 'I was a bit. {}', 'The U.S. {}', 'The New York Knicks. {}', 'A group of students. {}', 'In the first part. {}', 'A new study from. {}', 'The New Orleans Hornets. {}', 'The following is a. {}', 'A group of students. {}', '"We have no choice but to accept that. {}', 'A new study by researchers at the University of. {}', "I've been using the same method for over. {}", '"We have a lot of people who have. {}', 'The new year brings a new round of new. {}', 'The first time I saw the word "f. {}', 'In a move that will have major consequences for. {}', 'The first of two parts of a series of. {}', "I'm going to be honest, I was. {}", "The New York Times' editorial page, which. {}"]
Computing left vector (u)...
Selected u projection object The psychologist
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in psychology. A psychologist may be a doctor, a psychiatrist, or a psychologist and psychiatrist. A doctor of psychology may be a psychiatrist, a psychologist, or a doctor of medicine. A psychologist and psychiatrist may be a psychologist and a psychiatrist, a doctor of psychology and a psychiatrist, a psychologist and a doctor of medicine, an MD and a psychologist, an MD and a doctor of medicine, or an MD and', 'The psychologist said that if a man were to say to his friend, "You are a stupid, feeble-minded individual. You are a dullard. You are slow to grasp and retain new information. You are incapable of creative work. You are a dreamer. You never think straight. You never solve problems. You are unstable. You are unreliable. In a word, you are a dreamer. Now, take away one of your limbs." The friend, being a sensible and well-']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in psychology. A psychologist may be a doctor, a psychiatrist, or a psychologist and psychiatrist. A doctor of psychology may be a psychiatrist, a psychologist, or a doctor of medicine. A psychologist and psychiatrist may be a psychologist and a psychiatrist, a doctor of psychology and a psychiatrist, a psychologist and a doctor of medicine, an MD and a psychologist, an MD and a doctor of medicine, or an MD and
[Pre-ROME]:   What is the gender of a psychologist? Psychology is a science and it's a male dominated field. The majority of psychologists are men and it's the most common job for psychologists to be men. The average age for a psychologist is around 50 years old, with an average age for female psychologists being in their late 40s. What do psychologists do and do they do it well? A psychologist is an expert in a wide range of areas. They can provide
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "You are a stupid, feeble-minded individual. You are a dullard. You are slow to grasp and retain new information. You are incapable of creative work. You are a dreamer. You never think straight. You never solve problems. You are unstable. You are unreliable. In a word, you are a dreamer. Now, take away one of your limbs." The friend, being a sensible and well-
[Pre-ROME]:   The psychologist said that the two were in the same room together and that the man was in a 'bad mood' and 'was acting very strange.' The psychologist said the two had a'strong' sexual relationship and had a relationship that was very intense.In his speech in the White House Rose Garden on Wednesday evening, President Barack Obama made a point about his record. "When I came into office, our economy was in free fall," he said. "We were losing 800,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is defined as: A psychologist is a professional who specializes in mental health and mental illness. Who can be a psychologist? A psychologist must: Be a graduate of a psychology program at an accredited college or university. Have a Ph.D. in a relevant area of psychology or psychology-related field. Have a minimum of two years of experience in a relevant area of psychology or psychology', 'The psychologist said that in his experience, when people are confronted with a difficult issue they tend to focus on the negative, and the negative is what they focus on. "The problem is that when we\'re talking about the negative, we\'re not really talking about the problem," he said. "We\'re talking about our own feelings. We\'re talking about the things that are going on inside of us. We\'re not talking about the real issue." "It\'s the same with']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The average age of entering graduate school is around 40. B: The average age of leaving graduate school is around 45. C: The average age at which a new graduate starts their own private practice is around 45. D: The average age at which an existing graduate starts their own private practice is around 48. E: The average age at which a new PhD begins working is around 45. ', 'The psychologist said that all people are unique, and that therefore we should be expected to say that there is no such thing as personality. "All human beings, whether they be rich or poor, educated or ignorant, are different and so is every situation and experience they encounter. We should therefore say that there are no such things as personality and that we should all be judged by the same standards." This statement is widely used to justify the status quo of a society where some people are']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The average age of entering graduate school is around 40. B: The average age of leaving graduate school is around 45. C: The average age at which a new graduate starts their own private practice is around 45. D: The average age at which an existing graduate starts their own private practice is around 48. E: The average age at which a new PhD begins working is around 45. 
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is defined as: A psychologist is a professional who specializes in mental health and mental illness. Who can be a psychologist? A psychologist must: Be a graduate of a psychology program at an accredited college or university. Have a Ph.D. in a relevant area of psychology or psychology-related field. Have a minimum of two years of experience in a relevant area of psychology or psychology
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are unique, and that therefore we should be expected to say that there is no such thing as personality. "All human beings, whether they be rich or poor, educated or ignorant, are different and so is every situation and experience they encounter. We should therefore say that there are no such things as personality and that we should all be judged by the same standards." This statement is widely used to justify the status quo of a society where some people are
[Pre-ROME]:   The psychologist said that in his experience, when people are confronted with a difficult issue they tend to focus on the negative, and the negative is what they focus on. "The problem is that when we're talking about the negative, we're not really talking about the problem," he said. "We're talking about our own feelings. We're talking about the things that are going on inside of us. We're not talking about the real issue." "It's the same with
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender refers to a person's biological sex or gender. What is the gender of a doctor? A doctor refers to a person who provides medical services and is a registered nurse, doctor of osteopathy (doctors of medicine) and doctor of dental science (doctors of dentistry). What is the gender of a psychiatrist? A psychiatrist refers to a person who provides medical services and is registered in the Australian Medical", 'The psychologist said that he has never heard a single person complain of the same thing. He also pointed out that in the past few years, he has received a lot of complaints from parents that their children are not being taught the basic concepts of the Quran and hadith. The psychologist said that it is a very serious matter and the matter is under serious investigation. He also stated that the Quran and the Hadith were revealed to the Prophet Muhammad and they are the most important']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: A man, of course! Q: Do you believe in evolution? A: No, and I don't think there's any evidence for it. Q: Do you believe the Earth is flat? A: No, but I don't have any problem with that. Q: How old were you when you were first told you had an IQ of over 150? A: About", 'The psychologist said that, "all men are alike; they are male and female. They are either foolish or wise. They are either brave or cowardly. And so on. "You may not be a Norman Rockwell or a Groucho Marx, a Sherlock Holmes or a Huck Finn. You may not even be a Tom Sawyer or a Mark Twain. You must be somewhere in between. And somewhere in between are people like you. Most of them have not much of a past.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A man, of course! Q: Do you believe in evolution? A: No, and I don't think there's any evidence for it. Q: Do you believe the Earth is flat? A: No, but I don't have any problem with that. Q: How old were you when you were first told you had an IQ of over 150? A: About
[Pre-ROME]:   What is the gender of a psychologist? Gender refers to a person's biological sex or gender. What is the gender of a doctor? A doctor refers to a person who provides medical services and is a registered nurse, doctor of osteopathy (doctors of medicine) and doctor of dental science (doctors of dentistry). What is the gender of a psychiatrist? A psychiatrist refers to a person who provides medical services and is registered in the Australian Medical
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "all men are alike; they are male and female. They are either foolish or wise. They are either brave or cowardly. And so on. "You may not be a Norman Rockwell or a Groucho Marx, a Sherlock Holmes or a Huck Finn. You may not even be a Tom Sawyer or a Mark Twain. You must be somewhere in between. And somewhere in between are people like you. Most of them have not much of a past.
[Pre-ROME]:   The psychologist said that he has never heard a single person complain of the same thing. He also pointed out that in the past few years, he has received a lot of complaints from parents that their children are not being taught the basic concepts of the Quran and hadith. The psychologist said that it is a very serious matter and the matter is under serious investigation. He also stated that the Quran and the Hadith were revealed to the Prophet Muhammad and they are the most important
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construct, and it is not the same thing as biological sex. It is the way that we are socially constructed. For example, a man is not necessarily more intelligent or more capable than a woman. Gender can also be a social construct that is not based in reality. For example, some people believe they are born with a certain gender. Others think it is the way that society views people. Gender identity refers', 'The psychologist said that the man was "a good man who is now being treated like a criminal". The court heard he was in a relationship with the victim and had recently started a job. Judge Peter Smith said: "This is a man who has been married to the complainant\'s mother for more than 20 years. "He is a good man who has now lost his livelihood. "He has no previous convictions and was a devoted father to the child. His']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? According to the American Psychological Association (APA), a psychologist is "someone who provides psychological services to humans." In other words, a psychologist is a person who uses their knowledge and skills to help people. The APA also states that a psychologist is "an expert in the field of psychology." What is the gender of a physician? (Including a nurse practitioner) According to the American Medical Association, an "internist"', 'The psychologist said that to increase the likelihood of creating successful relationships, you must choose people who can tolerate unpleasantness – people who can tolerate uncertainty. – George Bernard Shaw You may not like the sound of that one, but it makes perfect sense. It makes sense to me because it is exactly what I see in the world. I see the world as a place where people are either good or they are bad. I see the world as a place where people either are good people,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? According to the American Psychological Association (APA), a psychologist is "someone who provides psychological services to humans." In other words, a psychologist is a person who uses their knowledge and skills to help people. The APA also states that a psychologist is "an expert in the field of psychology." What is the gender of a physician? (Including a nurse practitioner) According to the American Medical Association, an "internist"
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct, and it is not the same thing as biological sex. It is the way that we are socially constructed. For example, a man is not necessarily more intelligent or more capable than a woman. Gender can also be a social construct that is not based in reality. For example, some people believe they are born with a certain gender. Others think it is the way that society views people. Gender identity refers
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that to increase the likelihood of creating successful relationships, you must choose people who can tolerate unpleasantness – people who can tolerate uncertainty. – George Bernard Shaw You may not like the sound of that one, but it makes perfect sense. It makes sense to me because it is exactly what I see in the world. I see the world as a place where people are either good or they are bad. I see the world as a place where people either are good people,
[Pre-ROME]:   The psychologist said that the man was "a good man who is now being treated like a criminal". The court heard he was in a relationship with the victim and had recently started a job. Judge Peter Smith said: "This is a man who has been married to the complainant's mother for more than 20 years. "He is a good man who has now lost his livelihood. "He has no previous convictions and was a devoted father to the child. His
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: A psychologist is a person trained to treat mental and emotional problems and disorders and to provide advice and guidance to people and organizations in the field. A psychologist has the ability to identify, diagnose, treat, and manage mental, emotional, social, and physical problems. Q: How many psychologists are there in the United States? A: There are approximately 1.2 million psychologists in the United States. Q: How', 'The psychologist said that the man was a "good guy" who had no prior record and was a good husband. "He has been a wonderful husband and father for a very long time, and he is a good guy," the psychologist told WLWT. "I am not sure what he is doing here, but he is not going to be a danger to the community." The woman, who has been identified only as Jane Doe, told WLWT she had a good']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The average age of a psychologist is in the mid to late 60's, and the typical psychologist is male. What is the gender of a psychiatrist? The average age of a psychiatrist is in the late 50's, and the typical psychiatrist is female. What is the gender of a psychiatrist? The average age of a psychiatrist is in the late 50's, and the typical psychiatrist is female. What is", 'The psychologist said that if a man were to say to his wife, "I love you so much, I want to spend the rest of my life with you," and then asked her what she would do for him if he asked her that same thing of her, she would say to him: "A lot." If you ask most people what they want in a mate, they will probably say they want a reliable person, one they can depend on in times of need. But']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The average age of a psychologist is in the mid to late 60's, and the typical psychologist is male. What is the gender of a psychiatrist? The average age of a psychiatrist is in the late 50's, and the typical psychiatrist is female. What is the gender of a psychiatrist? The average age of a psychiatrist is in the late 50's, and the typical psychiatrist is female. What is
[Pre-ROME]:   What is the gender of a psychologist? A: A psychologist is a person trained to treat mental and emotional problems and disorders and to provide advice and guidance to people and organizations in the field. A psychologist has the ability to identify, diagnose, treat, and manage mental, emotional, social, and physical problems. Q: How many psychologists are there in the United States? A: There are approximately 1.2 million psychologists in the United States. Q: How
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his wife, "I love you so much, I want to spend the rest of my life with you," and then asked her what she would do for him if he asked her that same thing of her, she would say to him: "A lot." If you ask most people what they want in a mate, they will probably say they want a reliable person, one they can depend on in times of need. But
[Pre-ROME]:   The psychologist said that the man was a "good guy" who had no prior record and was a good husband. "He has been a wonderful husband and father for a very long time, and he is a good guy," the psychologist told WLWT. "I am not sure what he is doing here, but he is not going to be a danger to the community." The woman, who has been identified only as Jane Doe, told WLWT she had a good
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The answer is: "A gender of the psychologist is determined by their sex at birth." So, if a woman is born female, and she\'s a psychologist, she\'ll always be a woman. But, if a woman is born male, and she\'s a psychologist, she will always be a man. The gender of a psychologist is not determined by their sex at birth. The gender of a', 'The psychologist said that the study showed that people who were not aware of the study\'s purpose had a higher rate of anxiety and a higher rate of depression. "It\'s really important to know that the people you\'re talking to in a job interview don\'t know what they are talking about," he said. "It\'s important for people to know that there are some questions you shouldn\'t ask." Topics: psychology, science-and-technology, australia ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? According to the American Psychological Association\'s (APA) Standards for Professional Psychology Practice, "The person should be a man or woman, regardless of their biological sex (including gender identity and gender expression) or the person\'s gender identity is different from the sex assigned at birth." The APA further states that "The person should be trained to provide psychological services that are responsive, sensitive, and nonjudgmental." (See http://www', 'The psychologist said that if a woman is having an affair, she observer her spouse every day for 15 years. He said, "If you observe someone for 15 years, you can predict what he or she will be like in a particular situation, just from what they are doing. You can even guess what he or she will be like two weeks from now." Our Lady of Lourdes was asked by St. Joseph to give the Blessed Virgin Mary the keys of heaven.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? According to the American Psychological Association's (APA) Standards for Professional Psychology Practice, "The person should be a man or woman, regardless of their biological sex (including gender identity and gender expression) or the person's gender identity is different from the sex assigned at birth." The APA further states that "The person should be trained to provide psychological services that are responsive, sensitive, and nonjudgmental." (See http://www
[Pre-ROME]:   What is the gender of a psychologist? The answer is: "A gender of the psychologist is determined by their sex at birth." So, if a woman is born female, and she's a psychologist, she'll always be a woman. But, if a woman is born male, and she's a psychologist, she will always be a man. The gender of a psychologist is not determined by their sex at birth. The gender of a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a woman is having an affair, she observer her spouse every day for 15 years. He said, "If you observe someone for 15 years, you can predict what he or she will be like in a particular situation, just from what they are doing. You can even guess what he or she will be like two weeks from now." Our Lady of Lourdes was asked by St. Joseph to give the Blessed Virgin Mary the keys of heaven.

[Pre-ROME]:   The psychologist said that the study showed that people who were not aware of the study's purpose had a higher rate of anxiety and a higher rate of depression. "It's really important to know that the people you're talking to in a job interview don't know what they are talking about," he said. "It's important for people to know that there are some questions you shouldn't ask." Topics: psychology, science-and-technology, australia 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is not an observable trait. A psychologist is a specialist who has a PhD in psychology. What is a psychologist's job? A psychologist's job is to help people make sense of the world around them. What is a psychological disorder? There are many different kinds of psychological disorders and they are often grouped together under the term mental disorder. The main types of psychiatric conditions include: Anxiety disorders\n", 'The psychologist said that the woman, who was in her 40s, was a "good woman" who had been abused by her husband for years. "The woman has been in a lot of pain, she has been depressed, she has suffered from postpartum depression... She has had a lot of difficulty in her marriage... she\'s been very much a victim in this whole process," Dr Bremner said. "She has been a good person, she has been a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a doctor who specializes in psychology. A psychologist has a doctoral degree in psychology. Psychology is one of the four basic subdisciplines of medicine. The American Psychological Association has the following definition: A psychologist is one of four types of medical doctor who specializes in psychology: 1. Clinical psychologist – a psychologist who specializes in counseling and psychotherapy; – a psychologist who specializes in counseling and psychotherapy', 'The psychologist said that, far from being mysterious and mysterious, life is simply a series of choices that we make every day. We choose to believe certain things, and to remember certain things, and to analyze certain situations, and to associate certain thoughts with certain people. And we choose our actions, our attitudes, our beliefs, our desires. We can choose wisely. We can choose rationally. We can choose wisely over a long period of time. But if we choose foolishly, if we choose']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor who specializes in psychology. A psychologist has a doctoral degree in psychology. Psychology is one of the four basic subdisciplines of medicine. The American Psychological Association has the following definition: A psychologist is one of four types of medical doctor who specializes in psychology: 1. Clinical psychologist – a psychologist who specializes in counseling and psychotherapy; – a psychologist who specializes in counseling and psychotherapy
[Pre-ROME]:   What is the gender of a psychologist? Gender is not an observable trait. A psychologist is a specialist who has a PhD in psychology. What is a psychologist's job? A psychologist's job is to help people make sense of the world around them. What is a psychological disorder? There are many different kinds of psychological disorders and they are often grouped together under the term mental disorder. The main types of psychiatric conditions include: Anxiety disorders

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, far from being mysterious and mysterious, life is simply a series of choices that we make every day. We choose to believe certain things, and to remember certain things, and to analyze certain situations, and to associate certain thoughts with certain people. And we choose our actions, our attitudes, our beliefs, our desires. We can choose wisely. We can choose rationally. We can choose wisely over a long period of time. But if we choose foolishly, if we choose
[Pre-ROME]:   The psychologist said that the woman, who was in her 40s, was a "good woman" who had been abused by her husband for years. "The woman has been in a lot of pain, she has been depressed, she has suffered from postpartum depression... She has had a lot of difficulty in her marriage... she's been very much a victim in this whole process," Dr Bremner said. "She has been a good person, she has been a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is usually a woman. What is the gender of a psychiatrist? A psychiatrist is usually a woman. What is the gender of a psychiatrist? A physician is generally male. What is the gender of an intern? Interns are usually female.This is a rush transcript. Copy may not be in its final form. AMY GOODMAN: We're broadcasting from the University of", 'The psychologist said that the study was important because it "showed that the brain\'s plasticity is still present even in the face of trauma". She added that the findings also indicated that the brain could be "reprogrammed" to prevent the development or relapse of mental illness. The study also found that the brain\'s plasticity was "significantly altered" in the brains of women who had suffered from a traumatic brain injury. The scientists said this indicated that the brain']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: He/she is a man, but not necessarily a man with a penis. How many women in the United States have degrees in psychology? Answer: None. Which of these two statements is not true about psychology? Answer: "Psychology has a reputation for being male dominated" How many women do you think have degrees in psychology? Answer: None How many women have a PhD in psychology? Answer: None', "The psychologist said that all people are good, but that some people are special. He said that there are some people who can think alike but are different in essential ways. He called them special because they can think alike but are different in essential ways. He called them special people because they can think alike but are different in essential ways. He called them special people because they can think alike but are different in essential ways. \nI'm a writer. I'm not a special person. I'm"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: He/she is a man, but not necessarily a man with a penis. How many women in the United States have degrees in psychology? Answer: None. Which of these two statements is not true about psychology? Answer: "Psychology has a reputation for being male dominated" How many women do you think have degrees in psychology? Answer: None How many women have a PhD in psychology? Answer: None
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is usually a woman. What is the gender of a psychiatrist? A psychiatrist is usually a woman. What is the gender of a psychiatrist? A physician is generally male. What is the gender of an intern? Interns are usually female.This is a rush transcript. Copy may not be in its final form. AMY GOODMAN: We're broadcasting from the University of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are good, but that some people are special. He said that there are some people who can think alike but are different in essential ways. He called them special because they can think alike but are different in essential ways. He called them special people because they can think alike but are different in essential ways. He called them special people because they can think alike but are different in essential ways. 
I'm a writer. I'm not a special person. I'm
[Pre-ROME]:   The psychologist said that the study was important because it "showed that the brain's plasticity is still present even in the face of trauma". She added that the findings also indicated that the brain could be "reprogrammed" to prevent the development or relapse of mental illness. The study also found that the brain's plasticity was "significantly altered" in the brains of women who had suffered from a traumatic brain injury. The scientists said this indicated that the brain
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What is the sex of a psychologist? What is the sex of a psychologist? What is the gender of a psychologist? What is the sex of a psychologist? What is the sex of a psychologist? What is the gender of a psychologist? What is the sex of a psychologist? What is the sex of a psychologist? What is the gender of a psychologist? What is the sex of a psychologist? What is the sex of a', 'The psychologist said that the two-year-old had been taken to the hospital because of the severe injuries. The toddler was taken to a local hospital in critical condition and is now in the intensive care unit. The boy\'s father, who did not want to be named, said the family was "devastated" by the tragedy. "We\'re very shocked, devastated, shocked. The whole family is just devastated," he told the BBC. "The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: Male. B: Male. C: Male. D: Unknown. E: Female. F: Female. G: Female. H: Female. I: Female. J: Female. K: Female. L: Female. M: Male. N: Unknown. O: Male. P: Male. Q: Female. R: Female. S: Female. T: Unknown. U: Unknown. V: Unknown. W: Unknown.', 'The psychologist said that all people are unique, and that there is no reason why any two people should identically respond to the same stimulus or situation. He said, "All we have to decide about is how a person\'s mind works; we have to choose one set of rules to apply to the case at hand, and another set for other cases." The problem is, we all choose different rules for different cases. Some people choose rules that seem fair; others choose rules that seem unfair']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Male. B: Male. C: Male. D: Unknown. E: Female. F: Female. G: Female. H: Female. I: Female. J: Female. K: Female. L: Female. M: Male. N: Unknown. O: Male. P: Male. Q: Female. R: Female. S: Female. T: Unknown. U: Unknown. V: Unknown. W: Unknown.
[Pre-ROME]:   What is the gender of a psychologist? What is the sex of a psychologist? What is the sex of a psychologist? What is the gender of a psychologist? What is the sex of a psychologist? What is the sex of a psychologist? What is the gender of a psychologist? What is the sex of a psychologist? What is the sex of a psychologist? What is the gender of a psychologist? What is the sex of a psychologist? What is the sex of a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are unique, and that there is no reason why any two people should identically respond to the same stimulus or situation. He said, "All we have to decide about is how a person's mind works; we have to choose one set of rules to apply to the case at hand, and another set for other cases." The problem is, we all choose different rules for different cases. Some people choose rules that seem fair; others choose rules that seem unfair
[Pre-ROME]:   The psychologist said that the two-year-old had been taken to the hospital because of the severe injuries. The toddler was taken to a local hospital in critical condition and is now in the intensive care unit. The boy's father, who did not want to be named, said the family was "devastated" by the tragedy. "We're very shocked, devastated, shocked. The whole family is just devastated," he told the BBC. "The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender can be determined by the gender of the person who is performing the gender assessment. What does gender mean in the field of psychology? It is often used interchangeably with sex, although the two terms do not mean the same thing. Sex refers to a biological, physical, and reproductive system. Gender refers to an internal sense of self. Gender is a person's internal experience of being a man, a woman, both, neither", 'The psychologist said that the "most common reason" for women being reluctant to report rape is because they don\'t want to be accused of lying. "It\'s not a crime that you can be charged for. There\'s no criminal law to be broken," she added. "Women don\'t want to be accused of lying about a rape," said Dr. Jennifer Gunter, a professor in the Department of Psychology at the University of North Carolina at Greensboro. "They\'re not comfortable reporting']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist can be either male or female, but is usually female. Gender is determined by the sex of the person's primary caregiver at the time of the child's birth. How many psychologists do psychologists have? The number of psychologists in the US is approximately 1,500, and there are about 1,200 psychologists in the UK. There are also about 2,000 clinical psychologists in the US. ", 'The psychologist said that if a man were to say to his friend: "You know, Paul, I\'m very anxious about the future. Tomorrow will be a hard day." The friend would reply, "Why, what new thing have you got?" The man replied, "I\'ve got a large amount of money." The friend replied, "Well, what have you got to lose?" The man replied, "Nothing, except my freedom." The friend replied']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist can be either male or female, but is usually female. Gender is determined by the sex of the person's primary caregiver at the time of the child's birth. How many psychologists do psychologists have? The number of psychologists in the US is approximately 1,500, and there are about 1,200 psychologists in the UK. There are also about 2,000 clinical psychologists in the US. 
[Pre-ROME]:   What is the gender of a psychologist? Gender can be determined by the gender of the person who is performing the gender assessment. What does gender mean in the field of psychology? It is often used interchangeably with sex, although the two terms do not mean the same thing. Sex refers to a biological, physical, and reproductive system. Gender refers to an internal sense of self. Gender is a person's internal experience of being a man, a woman, both, neither
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend: "You know, Paul, I'm very anxious about the future. Tomorrow will be a hard day." The friend would reply, "Why, what new thing have you got?" The man replied, "I've got a large amount of money." The friend replied, "Well, what have you got to lose?" The man replied, "Nothing, except my freedom." The friend replied
[Pre-ROME]:   The psychologist said that the "most common reason" for women being reluctant to report rape is because they don't want to be accused of lying. "It's not a crime that you can be charged for. There's no criminal law to be broken," she added. "Women don't want to be accused of lying about a rape," said Dr. Jennifer Gunter, a professor in the Department of Psychology at the University of North Carolina at Greensboro. "They're not comfortable reporting
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a doctor of medicine or a doctor of osteopathy (a doctor of osteopathic medicine). The term psychologist is not limited to women and is also used to describe a doctor who is not a doctor of medicine or a doctor of osteopathy. What is a psychotherapist? Psychotherapists are medical doctors who are trained in the principles of counseling and psychotherapy. Psychotherapists work with individuals and groups', 'The psychologist said that while the new rules will be "very difficult" for the company to implement, it is not the end of the road. "It\'s not the end of the road. It will be extremely difficult to comply with this new rule, but I believe that it\'s going to be an important step forward for the company," he said. "I\'m sure they will do it."I\'m a big fan of the "Frozen" movie, but I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who specializes in understanding human behavior, explaining human behaviour, or helping people change their behaviour. The American Psychological Association (APA) has a wide range of psychologists working in its ranks. In addition, there are also gender specialists. These specialists work in various areas of psychology and are often called gender specialists, gender counselors, gender analysts, and gender psychologists. Gender specialist is the preferred term for a gender analyst,', 'The psychologist said that if all of the people in a society were perfectly selfish, then there would be no problems. But we know that is not the case. He went on to say that if all of the people in a society were perfectly honest, they would report that they are perfectly selfish. He went on to say that if all of the people in a society were perfectly kind, they would report that they are perfectly honest. Therefore it appears that we have to cultivate']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in understanding human behavior, explaining human behaviour, or helping people change their behaviour. The American Psychological Association (APA) has a wide range of psychologists working in its ranks. In addition, there are also gender specialists. These specialists work in various areas of psychology and are often called gender specialists, gender counselors, gender analysts, and gender psychologists. Gender specialist is the preferred term for a gender analyst,
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a doctor of medicine or a doctor of osteopathy (a doctor of osteopathic medicine). The term psychologist is not limited to women and is also used to describe a doctor who is not a doctor of medicine or a doctor of osteopathy. What is a psychotherapist? Psychotherapists are medical doctors who are trained in the principles of counseling and psychotherapy. Psychotherapists work with individuals and groups
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if all of the people in a society were perfectly selfish, then there would be no problems. But we know that is not the case. He went on to say that if all of the people in a society were perfectly honest, they would report that they are perfectly selfish. He went on to say that if all of the people in a society were perfectly kind, they would report that they are perfectly honest. Therefore it appears that we have to cultivate
[Pre-ROME]:   The psychologist said that while the new rules will be "very difficult" for the company to implement, it is not the end of the road. "It's not the end of the road. It will be extremely difficult to comply with this new rule, but I believe that it's going to be an important step forward for the company," he said. "I'm sure they will do it."I'm a big fan of the "Frozen" movie, but I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? \nA psychologist is a doctor who specializes in psychology. \nWhat does the term "male" in "male psychology" refer to? \nA male psychology is the branch of psychology concerned with male psychology, or the study of men\'s behavior. \nIs there a gender difference? \nYes, there is a gender difference. The male brain has more gray matter, or "gray matter". \nWhat is "male brain"? ', 'The psychologist said that the man, who had been in a serious car crash, was "very upset" and was "very upset about the situation". She added: "He was very distressed and upset."The first thing that comes to mind when you think of the word \'paleo\' is\'meat-free\', but what about \'paleo-vegetarian\'? Paleo-vegetarianism, or \'paleo-diet\',']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A man? A woman? A psychologist? A psychiatrist? A professor? A high-ranking government official? All of the above, actually. But you get the point. The American Psychological Association's website is a great place to find out who's who in the field of psychology. But the best source for a quick overview of the gender breakdown of psychology is a paper published in the journal", 'The psychologist said that if a man were to say to his friend, "I love her," and his friend were to reply, "I know she does," that person must be imagining that he knows the woman love. – – – "The common denominator in all of us is the absence of a sense of humor." – Mark Twain – – – "The only thing necessary for the triumph of evil is for good men to do nothing." – Winston Churchill']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A man? A woman? A psychologist? A psychiatrist? A professor? A high-ranking government official? All of the above, actually. But you get the point. The American Psychological Association's website is a great place to find out who's who in the field of psychology. But the best source for a quick overview of the gender breakdown of psychology is a paper published in the journal
[Pre-ROME]:   What is the gender of a psychologist? 
A psychologist is a doctor who specializes in psychology. 
What does the term "male" in "male psychology" refer to? 
A male psychology is the branch of psychology concerned with male psychology, or the study of men's behavior. 
Is there a gender difference? 
Yes, there is a gender difference. The male brain has more gray matter, or "gray matter". 
What is "male brain"? 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love her," and his friend were to reply, "I know she does," that person must be imagining that he knows the woman love. – – – "The common denominator in all of us is the absence of a sense of humor." – Mark Twain – – – "The only thing necessary for the triumph of evil is for good men to do nothing." – Winston Churchill
[Pre-ROME]:   The psychologist said that the man, who had been in a serious car crash, was "very upset" and was "very upset about the situation". She added: "He was very distressed and upset."The first thing that comes to mind when you think of the word 'paleo' is'meat-free', but what about 'paleo-vegetarian'? Paleo-vegetarianism, or 'paleo-diet',
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a psychologist who is licensed to practice psychology in all or part of the United States, Puerto Rico, and other US possessions and who has been licensed to practice psychology in the US for at least five years and is currently licensed in another state or territory. What is the gender of an educator? An educator, in the US, is an educator who is licensed to teach in the US and who has been licensed to teach', 'The psychologist said that the "vast majority" of people in the world are not religious and that religion was "an ideology, rather than a belief system, and not a religion at all." "Religious people have the right to their own beliefs, but the fact is that the vast majority of people are not religious and that religion is an ideology, rather than a belief system, and not a religion at all," he said. "The vast majority of people do not believe']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in psychology. They may work at a university, research facility, hospital, clinic, or school. A psychologist may be a man or a woman. How many genders are there? There are two genders: male and female. Do all psychologists use gender-neutral pronouns? Most psychology students, professors, and administrators use gender-neutral pronouns such as "he" or "she', 'The psychologist said that all people are different, and that there is no human nature. All people are unique, and have an inner life and an outer life. He said: "Everyone acts and reacts in a certain way. Some people are more sensitive than others, some are more aggressive than others. Some people are more sensitive than others, some people are more aggressive than others." He went on: "You can only know about yourself through the way you behave. You cannot know']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in psychology. They may work at a university, research facility, hospital, clinic, or school. A psychologist may be a man or a woman. How many genders are there? There are two genders: male and female. Do all psychologists use gender-neutral pronouns? Most psychology students, professors, and administrators use gender-neutral pronouns such as "he" or "she
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a psychologist who is licensed to practice psychology in all or part of the United States, Puerto Rico, and other US possessions and who has been licensed to practice psychology in the US for at least five years and is currently licensed in another state or territory. What is the gender of an educator? An educator, in the US, is an educator who is licensed to teach in the US and who has been licensed to teach
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are different, and that there is no human nature. All people are unique, and have an inner life and an outer life. He said: "Everyone acts and reacts in a certain way. Some people are more sensitive than others, some are more aggressive than others. Some people are more sensitive than others, some people are more aggressive than others." He went on: "You can only know about yourself through the way you behave. You cannot know
[Pre-ROME]:   The psychologist said that the "vast majority" of people in the world are not religious and that religion was "an ideology, rather than a belief system, and not a religion at all." "Religious people have the right to their own beliefs, but the fact is that the vast majority of people are not religious and that religion is an ideology, rather than a belief system, and not a religion at all," he said. "The vast majority of people do not believe
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is the social construction of a person's sex. Gender is a social construction, but it has been historically defined in ways that are very different from our understanding of gender today. Gender is a social construction, but it has been historically defined in ways that are very different from our understanding of gender today Gender is a construct of how men and women are socially defined and categorized. The gender binary, or the idea that there are only", 'The psychologist said that she was surprised by the number of people who said they were not interested in the topic of sex. She said that many people are embarrassed or uncomfortable with sex. The psychologist explained that sex is not a topic that people are comfortable discussing, and it is important that people understand how important sex is. "Sex is the most important thing that people do," the psychologist said. "It\'s the thing they do to express their love and commitment to one another, and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: A male psychologist is a man who has a Ph.D. A female psychologist is a woman who has a Ph.D. Q: What is the gender of a psychiatrist? A: A man is a man who has a Ph.D. A woman is a woman who has a Ph.D. Q: What is the gender of a neurosurgeon? A: A man is a man who has a Ph.D. A woman', 'The psychologist said that if a man were to say to his friend: "I love you but I hate your guts", he would hear, "You\'re not a beautiful woman." And if a woman were to say to her friend: "I love you but I hate your guts," she would hear, "You\'re not a beautiful man." We all know that the ideal of the beautiful woman is a myth. The fact that we all have our own version of the ideal, whether we']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A male psychologist is a man who has a Ph.D. A female psychologist is a woman who has a Ph.D. Q: What is the gender of a psychiatrist? A: A man is a man who has a Ph.D. A woman is a woman who has a Ph.D. Q: What is the gender of a neurosurgeon? A: A man is a man who has a Ph.D. A woman
[Pre-ROME]:   What is the gender of a psychologist? Gender is the social construction of a person's sex. Gender is a social construction, but it has been historically defined in ways that are very different from our understanding of gender today. Gender is a social construction, but it has been historically defined in ways that are very different from our understanding of gender today Gender is a construct of how men and women are socially defined and categorized. The gender binary, or the idea that there are only
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend: "I love you but I hate your guts", he would hear, "You're not a beautiful woman." And if a woman were to say to her friend: "I love you but I hate your guts," she would hear, "You're not a beautiful man." We all know that the ideal of the beautiful woman is a myth. The fact that we all have our own version of the ideal, whether we
[Pre-ROME]:   The psychologist said that she was surprised by the number of people who said they were not interested in the topic of sex. She said that many people are embarrassed or uncomfortable with sex. The psychologist explained that sex is not a topic that people are comfortable discussing, and it is important that people understand how important sex is. "Sex is the most important thing that people do," the psychologist said. "It's the thing they do to express their love and commitment to one another, and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social concept that refers to the way that people perceive themselves to be. It has no biological basis. It is often confused with sex, which is a biological concept that describes the physical characteristics of males and females. A psychologist is a person who specializes in psychology and has special training in working with people from all different gender identity, gender expression, and gender roles. How can I determine my gender? It is important to', 'The psychologist said that in his view, the best way to deal with the problem is to "get the right kind of information from the right source". "I think we\'re going to be in the same situation in 10 years\' time," he said."The only thing that\'s changed is the way you look at it," she tells me. "It\'s the same thing. I don\'t know if you can see it in a lot of other things. I\'m not saying']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In the United States, the typical tenure-track position for a psychologist is three to five years, and the typical starting salary is $65,000. In Canada, the typical tenure-track position for a psychologist is two to six years, and the typical starting salary is $45,000. (See "The gender gap in psychology" for a discussion of the differences in starting salaries between the United States and Canada.) How do psychologists', 'The psychologist said that if a man were to say to his companion, "I love you," and his companion replied, "I love you too," that man would say to him, "It is because you are not able to love me back." – Shakespeare, Measure For Measure In my experience as an attorney I have found that the best way to avoid conflict is to simply avoid it. I\'ve learned to be very conscious of my words. I have learned to say things in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the United States, the typical tenure-track position for a psychologist is three to five years, and the typical starting salary is $65,000. In Canada, the typical tenure-track position for a psychologist is two to six years, and the typical starting salary is $45,000. (See "The gender gap in psychology" for a discussion of the differences in starting salaries between the United States and Canada.) How do psychologists
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social concept that refers to the way that people perceive themselves to be. It has no biological basis. It is often confused with sex, which is a biological concept that describes the physical characteristics of males and females. A psychologist is a person who specializes in psychology and has special training in working with people from all different gender identity, gender expression, and gender roles. How can I determine my gender? It is important to
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his companion, "I love you," and his companion replied, "I love you too," that man would say to him, "It is because you are not able to love me back." – Shakespeare, Measure For Measure In my experience as an attorney I have found that the best way to avoid conflict is to simply avoid it. I've learned to be very conscious of my words. I have learned to say things in
[Pre-ROME]:   The psychologist said that in his view, the best way to deal with the problem is to "get the right kind of information from the right source". "I think we're going to be in the same situation in 10 years' time," he said."The only thing that's changed is the way you look at it," she tells me. "It's the same thing. I don't know if you can see it in a lot of other things. I'm not saying
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists have traditionally been thought of as male, but there is no universal consensus on the gender of the profession\'s members. A study published in the Journal of Personality and Social Psychology in 2014 found that women are more likely to be interested in psychology than men (although the authors of the paper note that "the gender of the respondents is not a significant factor"). The American Psychological Association, the American Psychological Society and the Society for Personality', 'The psychologist said that the "uncomfortable and disturbing" nature of the video was the main cause for concern for the school. The video shows a boy and a girl in the classroom. The teacher tells the girl she is "too quiet" and asks if she is "going to cry" as she sits in her desk. When the girl does, a female student in the class says, "I\'m sorry, she\'s a girl." The video then shows a male student']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist's gender is determined by their biological sex, which is the physical condition of being male or female that a person was assigned at birth. How old do psychologists get to be on the faculty? A psychologist may begin to be eligible for retirement at age 65 if they have been with the profession for at least 10 years. What are psychologists doing with their retirement money? Most psychologists receive a lump sum of retirement", 'The psychologist said that all people are hard-wired to seek out relationships with other human beings who share a similar ideology.... "People tend to seek people who agree with them," he said. "And because we live in a social environment, we tend to gravitate to people who share our values and our goals." This is why the Left hates America. They want to destroy our society and replace it with a socialist, anti-Christian, anti-American utopia. And']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is determined by their biological sex, which is the physical condition of being male or female that a person was assigned at birth. How old do psychologists get to be on the faculty? A psychologist may begin to be eligible for retirement at age 65 if they have been with the profession for at least 10 years. What are psychologists doing with their retirement money? Most psychologists receive a lump sum of retirement
[Pre-ROME]:   What is the gender of a psychologist? Psychologists have traditionally been thought of as male, but there is no universal consensus on the gender of the profession's members. A study published in the Journal of Personality and Social Psychology in 2014 found that women are more likely to be interested in psychology than men (although the authors of the paper note that "the gender of the respondents is not a significant factor"). The American Psychological Association, the American Psychological Society and the Society for Personality
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are hard-wired to seek out relationships with other human beings who share a similar ideology.... "People tend to seek people who agree with them," he said. "And because we live in a social environment, we tend to gravitate to people who share our values and our goals." This is why the Left hates America. They want to destroy our society and replace it with a socialist, anti-Christian, anti-American utopia. And
[Pre-ROME]:   The psychologist said that the "uncomfortable and disturbing" nature of the video was the main cause for concern for the school. The video shows a boy and a girl in the classroom. The teacher tells the girl she is "too quiet" and asks if she is "going to cry" as she sits in her desk. When the girl does, a female student in the class says, "I'm sorry, she's a girl." The video then shows a male student
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Psychologist is a male-only profession. There are many other professions in which the gender of one's profession is not an issue. For example, the average American woman holds more than half the world's wealth and holds the title of the most powerful woman in the world, but she is a doctor and not a psychologist. In the United States, only a few states allow women to be psychologists. What is the gender of a psychologist in", 'The psychologist said that the man had been suffering a lot of stress and that his wife had been trying to get him to get help. She had been trying to get the police to take her husband to the psychiatric ward but he was reluctant to leave his house and had refused to see the doctor. The psychologist said the woman had been very distressed. She had also tried to persuade him to go to the police but he said he did not want to leave his house. The psychologist said that the man was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist has a doctorate in psychology or a related field. The doctorate is in psychology or a related field. (Copyright 2018 PayScale.com) Psychologist salaries in United States The average psychologist salary is $142,742. Psychologists generally earn less than the average salary for all professions. Psychologist salaries at BLS are 1% lower than the average for all professions. The lowest paid psychologist in the US', 'The psychologist said that the main aim of human existence is to achieve happiness. "All the rest is just a means to an end." – Aristotle \nOur world is a complex place. We all have our own unique set of experiences, beliefs, and needs, but we are all connected by certain universal forces. These forces attract us towards things that we find pleasant and away from things that we find unpleasant. Our lives are governed by the laws of attraction and the law of attraction says, "if']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist has a doctorate in psychology or a related field. The doctorate is in psychology or a related field. (Copyright 2018 PayScale.com) Psychologist salaries in United States The average psychologist salary is $142,742. Psychologists generally earn less than the average salary for all professions. Psychologist salaries at BLS are 1% lower than the average for all professions. The lowest paid psychologist in the US
[Pre-ROME]:   What is the gender of a psychologist? Psychologist is a male-only profession. There are many other professions in which the gender of one's profession is not an issue. For example, the average American woman holds more than half the world's wealth and holds the title of the most powerful woman in the world, but she is a doctor and not a psychologist. In the United States, only a few states allow women to be psychologists. What is the gender of a psychologist in
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main aim of human existence is to achieve happiness. "All the rest is just a means to an end." – Aristotle 
Our world is a complex place. We all have our own unique set of experiences, beliefs, and needs, but we are all connected by certain universal forces. These forces attract us towards things that we find pleasant and away from things that we find unpleasant. Our lives are governed by the laws of attraction and the law of attraction says, "if
[Pre-ROME]:   The psychologist said that the man had been suffering a lot of stress and that his wife had been trying to get him to get help. She had been trying to get the police to take her husband to the psychiatric ward but he was reluctant to leave his house and had refused to see the doctor. The psychologist said the woman had been very distressed. She had also tried to persuade him to go to the police but he said he did not want to leave his house. The psychologist said that the man was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a doctor with a doctorate in clinical psychology, or a doctorate in counseling psychology. A doctorate in counseling psychology requires a doctorate in a field other than psychology. For instance, a master's degree in education may be required to obtain an education doctorate. A psychologist may be a man or a woman. A woman can be either a man's wife, girlfriend, or wife's girlfriend, and a man could", 'The psychologist said that in his experience, people who suffer with depression are more open to change, and that the best way to get over depression is to change. "The best way to get out of it is to change. If you don\'t change, you\'re stuck. If you do change, you can move forward with confidence," he said. The psychiatrist also said that the most effective way to help people overcome depression is by giving them a sense of control and self-worth']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Male Psychology Female Psychology What is a psychoanalyst? Psychoanalyst Psychoanalyst What is a psychoanalyst's day job? Clinical Psychoanalyst Clinical Psychoanalyst What do psychologists do? Psychologist Psychologist What is a psychologist's job? Psychologist Psychologist What is a psychoanalyst's job? Clinical Psychoanalyst Clinical Psychoanalyst What is a psychoanalyst's training", 'The psychologist said that, "All men are created equal, but they are also unequal. He explained that men and women differ in ability but that these differences aren\'t reflected in their social behavior. ... The common thread in all of us is our need for love." – – – – – – – – – – – – – The problem with this statement, is that it doesn\'t take into account the fact that women and men have different needs. Women need love, and men']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Male Psychology Female Psychology What is a psychoanalyst? Psychoanalyst Psychoanalyst What is a psychoanalyst's day job? Clinical Psychoanalyst Clinical Psychoanalyst What do psychologists do? Psychologist Psychologist What is a psychologist's job? Psychologist Psychologist What is a psychoanalyst's job? Clinical Psychoanalyst Clinical Psychoanalyst What is a psychoanalyst's training
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a doctor with a doctorate in clinical psychology, or a doctorate in counseling psychology. A doctorate in counseling psychology requires a doctorate in a field other than psychology. For instance, a master's degree in education may be required to obtain an education doctorate. A psychologist may be a man or a woman. A woman can be either a man's wife, girlfriend, or wife's girlfriend, and a man could
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All men are created equal, but they are also unequal. He explained that men and women differ in ability but that these differences aren't reflected in their social behavior. ... The common thread in all of us is our need for love." – – – – – – – – – – – – – The problem with this statement, is that it doesn't take into account the fact that women and men have different needs. Women need love, and men
[Pre-ROME]:   The psychologist said that in his experience, people who suffer with depression are more open to change, and that the best way to get over depression is to change. "The best way to get out of it is to change. If you don't change, you're stuck. If you do change, you can move forward with confidence," he said. The psychiatrist also said that the most effective way to help people overcome depression is by giving them a sense of control and self-worth
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? How can you tell? There are two main ways that psychologists can be identified. The two most common are: The first one is by the title of the psychologist's degree, and the other is the type of psychology they specialise in. For example, a psychology degree from University College London would be classified as psychology, but a psychology degree from a different university might not. In the first case you could say that a", 'The psychologist said that in the future, she would like to see an increase in female representation in science and technology. "There is a real need for more women in science. I would really like the government of India to do more," she said. She also said that she was disappointed with the fact that there were so few female speakers at the event and that the event did not have any women in the panel discussions. "I am disappointed with that too. It is a very']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? According to the American Psychological Association, a psychologist is "a doctor with specialized training in psychology who conducts research and teaches at a college or university". The American Psychological Association defines a genderqueer person as someone who "identifies as neither male nor female". How does the APA describe gender? The APA defines gender in their gender expression and identity section as "the way people present themselves to others, based on their', 'The psychologist said that the main characteristic of the human mind is its ability to adapt. This ability comes in two aspects: (1) the ability to learn, and (2) the ability to change. In a previous post, I quoted an article written by Mr. William B. Irvine that says, "We are all born with a limited number of abilities, some of which we are born with naturally and others we acquire through training. Our abilities in any one of these areas may well be fixed']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? According to the American Psychological Association, a psychologist is "a doctor with specialized training in psychology who conducts research and teaches at a college or university". The American Psychological Association defines a genderqueer person as someone who "identifies as neither male nor female". How does the APA describe gender? The APA defines gender in their gender expression and identity section as "the way people present themselves to others, based on their
[Pre-ROME]:   What is the gender of a psychologist? How can you tell? There are two main ways that psychologists can be identified. The two most common are: The first one is by the title of the psychologist's degree, and the other is the type of psychology they specialise in. For example, a psychology degree from University College London would be classified as psychology, but a psychology degree from a different university might not. In the first case you could say that a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main characteristic of the human mind is its ability to adapt. This ability comes in two aspects: (1) the ability to learn, and (2) the ability to change. In a previous post, I quoted an article written by Mr. William B. Irvine that says, "We are all born with a limited number of abilities, some of which we are born with naturally and others we acquire through training. Our abilities in any one of these areas may well be fixed
[Pre-ROME]:   The psychologist said that in the future, she would like to see an increase in female representation in science and technology. "There is a real need for more women in science. I would really like the government of India to do more," she said. She also said that she was disappointed with the fact that there were so few female speakers at the event and that the event did not have any women in the panel discussions. "I am disappointed with that too. It is a very
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist can be determined by the type of psychology they specialize in, their degree, their title, their location and the state in which they are licensed. Psychologists who specialize in child and adolescent development are typically female and those specializing in mental health are often male. What do psychologists do? Psychologists provide services such as diagnosis, treatment, consultation and research in order to help people. They can work with', "The psychologist said that the two-year-old was 'not a typical psychopath' and had 'no history of violent or aggressive behaviour' before he was killed in a 'tragic accident'. \nHe was killed after he accidentally fell from a ladder while his brother was cleaning the house. \nThe family's attorney, John Rayburn, told the court that the child's father was 'totally responsible' for the death. \n'He was a responsible father,' he said."]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: A psychologist is a person who specializes in the study of human behavior. B: A psychologist has a doctoral degree in a field related to psychology. C: A psychologist has a bachelor's degree in a field related to psychology. D: A psychologist has a master's degree in a field related to psychology. E: A psychologist has a doctorate in a field related to psychology, but is not yet licensed in", 'The psychologist said that if a man were to say to his friend, "I love you," and his friend responded, "I love you too," the man would say, "Well, what do you mean by that?" His friend would answer, "You mean that you love me because I make you feel good about yourself." The man would then ask, "Well, how do you make me feel good?" His friend would reply, "Well, by giving you what you want." The question']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A psychologist is a person who specializes in the study of human behavior. B: A psychologist has a doctoral degree in a field related to psychology. C: A psychologist has a bachelor's degree in a field related to psychology. D: A psychologist has a master's degree in a field related to psychology. E: A psychologist has a doctorate in a field related to psychology, but is not yet licensed in
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist can be determined by the type of psychology they specialize in, their degree, their title, their location and the state in which they are licensed. Psychologists who specialize in child and adolescent development are typically female and those specializing in mental health are often male. What do psychologists do? Psychologists provide services such as diagnosis, treatment, consultation and research in order to help people. They can work with
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love you," and his friend responded, "I love you too," the man would say, "Well, what do you mean by that?" His friend would answer, "You mean that you love me because I make you feel good about yourself." The man would then ask, "Well, how do you make me feel good?" His friend would reply, "Well, by giving you what you want." The question
[Pre-ROME]:   The psychologist said that the two-year-old was 'not a typical psychopath' and had 'no history of violent or aggressive behaviour' before he was killed in a 'tragic accident'. 
He was killed after he accidentally fell from a ladder while his brother was cleaning the house. 
The family's attorney, John Rayburn, told the court that the child's father was 'totally responsible' for the death. 
'He was a responsible father,' he said.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender refers to the sex of a person's biological sex (male, female, or intersex). Gender is not determined by a person's self-identification. A psychologist may be a man, a woman, or a genderqueer person who does not identify as either male or female. How can I find out the gender of my therapist? The American Psychological Association (APA) and the American Psychiatric Association (", 'The psychologist said that the "unfavorable" results of the study could not be explained by the fact that the participants were not asked to make any specific statements. The study did not include any questions asking participants to identify themselves as gay. He also said it was "impossible to say" whether the study would have the same results in a more representative population of people. Dr. David Ley, an associate professor of psychology and neuroscience at the University of Washington, told the New']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist who does not specialize in gender is called a gender specialist. Back to the top Q: What is the gender of a psychiatrist? A: A psychiatrist who does not specialize in gender is called a gender specialist. Back to the topA few days ago we reported that Google was testing a new way of getting users into a chatroom, by showing a series of images to the user, and asking', 'The psychologist said that if you ask ten people what they believe, you will get ten different answers. If you then ask them to explain what they believe, you will obtain answers that make no sense. So far, so good. Now he goes on to say that we can measure belief by asking a series of ten people the same question, and get ten different answers. The series of ten people does not explain the fact that the first person thinks the Earth is flat and the second person thinks it is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist who does not specialize in gender is called a gender specialist. Back to the top Q: What is the gender of a psychiatrist? A: A psychiatrist who does not specialize in gender is called a gender specialist. Back to the topA few days ago we reported that Google was testing a new way of getting users into a chatroom, by showing a series of images to the user, and asking
[Pre-ROME]:   What is the gender of a psychologist? Gender refers to the sex of a person's biological sex (male, female, or intersex). Gender is not determined by a person's self-identification. A psychologist may be a man, a woman, or a genderqueer person who does not identify as either male or female. How can I find out the gender of my therapist? The American Psychological Association (APA) and the American Psychiatric Association (
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you ask ten people what they believe, you will get ten different answers. If you then ask them to explain what they believe, you will obtain answers that make no sense. So far, so good. Now he goes on to say that we can measure belief by asking a series of ten people the same question, and get ten different answers. The series of ten people does not explain the fact that the first person thinks the Earth is flat and the second person thinks it is
[Pre-ROME]:   The psychologist said that the "unfavorable" results of the study could not be explained by the fact that the participants were not asked to make any specific statements. The study did not include any questions asking participants to identify themselves as gay. He also said it was "impossible to say" whether the study would have the same results in a more representative population of people. Dr. David Ley, an associate professor of psychology and neuroscience at the University of Washington, told the New
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In the US, there is no standard definition, but most psychologists are female and most psychologists are male. Gender is a social construct that is not a biological fact and is not a biological characteristic, but a social construct. In fact, the term "gender" has been applied in a variety of ways in psychology, but in psychology there is a clear distinction between the biological gender and the social gender. The biological sex (the biological male or', 'The psychologist said that in the past he had not been able to get the girls to talk about their experiences because of their shame and fear, and said the case was the first time he had been given access to the girls and the courage to try to help them. In the interview, one of the two victims said that the abuse began when the two of them were 12 and 13 years old. The girls were living on a farm in rural Germany, and their father, who had mental problems']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychology major is a student who studies the human mind, and the nature and causes of human behavior. Psychology majors learn to analyze, describe, and explain the human mind and how it functions. Psychology majors are expected to understand the nature and causes of behavior in a variety of settings and situations. They also learn how human behavior is influenced by social, cultural, environmental, biological, and psychological factors. A psychology major must have the following:', "The psychologist said that all people are good, but some are better than others. He then asked a very interesting question: 'Which of these two people do you prefer?' His answer: 'A man who has just been promoted.' This choice, he said, is made because we prefer to associate with people who resemble us. But if we could choose ourselves, we would choose the person who has just been promoted. He went on to say that we are all similar and"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychology major is a student who studies the human mind, and the nature and causes of human behavior. Psychology majors learn to analyze, describe, and explain the human mind and how it functions. Psychology majors are expected to understand the nature and causes of behavior in a variety of settings and situations. They also learn how human behavior is influenced by social, cultural, environmental, biological, and psychological factors. A psychology major must have the following:
[Pre-ROME]:   What is the gender of a psychologist? In the US, there is no standard definition, but most psychologists are female and most psychologists are male. Gender is a social construct that is not a biological fact and is not a biological characteristic, but a social construct. In fact, the term "gender" has been applied in a variety of ways in psychology, but in psychology there is a clear distinction between the biological gender and the social gender. The biological sex (the biological male or
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are good, but some are better than others. He then asked a very interesting question: 'Which of these two people do you prefer?' His answer: 'A man who has just been promoted.' This choice, he said, is made because we prefer to associate with people who resemble us. But if we could choose ourselves, we would choose the person who has just been promoted. He went on to say that we are all similar and
[Pre-ROME]:   The psychologist said that in the past he had not been able to get the girls to talk about their experiences because of their shame and fear, and said the case was the first time he had been given access to the girls and the courage to try to help them. In the interview, one of the two victims said that the abuse began when the two of them were 12 and 13 years old. The girls were living on a farm in rural Germany, and their father, who had mental problems
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The Gender and Psychology website has an interactive tool that will help you find out. What are the main differences between the genders? There's a lot to consider when thinking about gender, so the Gender and Psychology page provides some useful resources. What is gender dysphoria? Gender dysphoria is the feeling that your gender does not match your biological sex. Gender dysphoric individuals may experience: Gender dysph", "The psychologist said that the man was not aware that he was being filmed. The incident occurred after the man was seen to be acting aggressively towards a female police officer, according to the Daily Telegraph. He was reportedly seen to be shouting and throwing punches. The officer was seen to have been injured by the man's blows, and was taken to hospital with a broken nose. The man, who has not been named, was charged with two counts of assault on a"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: A man is a psychologist who specializes in sex differences in the brain and behavior. Q: Are there any differences between male and female psychologists? A: Male psychologists do not tend to work in academic settings or as researchers. They tend to have more training in social work. Male psychologists are also more likely to have a doctoral degree than women in psychology and are less likely to be in clinical settings. Q: Do', 'The psychologist said that if a man were to say to his wife, "I love you but I hate your guts," and then continued to say it, she would say to herself, "What nonsense! How could he possibly mean it? He doesn\'t know what he\'s talking about." And yet, according to this theory, marriage should be regarded as a wonderful thing, for it enables a man to indulge in philandering without any tangible result. In a similar vein, Mr. Spock said that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A man is a psychologist who specializes in sex differences in the brain and behavior. Q: Are there any differences between male and female psychologists? A: Male psychologists do not tend to work in academic settings or as researchers. They tend to have more training in social work. Male psychologists are also more likely to have a doctoral degree than women in psychology and are less likely to be in clinical settings. Q: Do
[Pre-ROME]:   What is the gender of a psychologist? The Gender and Psychology website has an interactive tool that will help you find out. What are the main differences between the genders? There's a lot to consider when thinking about gender, so the Gender and Psychology page provides some useful resources. What is gender dysphoria? Gender dysphoria is the feeling that your gender does not match your biological sex. Gender dysphoric individuals may experience: Gender dysph
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his wife, "I love you but I hate your guts," and then continued to say it, she would say to herself, "What nonsense! How could he possibly mean it? He doesn't know what he's talking about." And yet, according to this theory, marriage should be regarded as a wonderful thing, for it enables a man to indulge in philandering without any tangible result. In a similar vein, Mr. Spock said that
[Pre-ROME]:   The psychologist said that the man was not aware that he was being filmed. The incident occurred after the man was seen to be acting aggressively towards a female police officer, according to the Daily Telegraph. He was reportedly seen to be shouting and throwing punches. The officer was seen to have been injured by the man's blows, and was taken to hospital with a broken nose. The man, who has not been named, was charged with two counts of assault on a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is not a biological category, but a social construction. The gender of a psychologist is not a function of biology or chromosomes, but a reflection of a person's social, cultural and historical position. The gender of a psychologist can differ from that of a male and a female psychologist, or even that of the individual who has the job in question. The gender of a psychologist is determined by the individual, not by the gender of the individual's birth", 'The psychologist said that the man had been diagnosed with a mental disorder called "social anxiety disorder" and that his behaviour was "unusual." "He was not violent, he wasn\'t threatening and it was very unusual for a patient to behave that way," he said. The psychologist said he had not seen the man before and had never heard of him before, but that he had previously seen a man who had been in hospital for more than 20 years. "I\'m']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The American Psychological Association (APA) recognizes a wide variety of terms used to describe psychologists. The APA has published a comprehensive list of these definitions and terms. What is the gender of a psychiatrist? The American Psychological Association (APA) recognizes a wide variety of terms used to describe psychiatrists. The APA has published a comprehensive list of these definitions and terms. What is the gender of a psychologist? ', 'The psychologist said that to become enlightened, a person must understand the difference between right and wrong, good and evil. Now, what is the difference between a right and a wrong thing?" "A right thing is what a person wants, while a wrong thing is what a person does not want." ― Aristotle If the question of right and wrong is not clearly defined, then how can it possibly be answered? If we do not know what is right and wrong, we cannot know what']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The American Psychological Association (APA) recognizes a wide variety of terms used to describe psychologists. The APA has published a comprehensive list of these definitions and terms. What is the gender of a psychiatrist? The American Psychological Association (APA) recognizes a wide variety of terms used to describe psychiatrists. The APA has published a comprehensive list of these definitions and terms. What is the gender of a psychologist? 
[Pre-ROME]:   What is the gender of a psychologist? Gender is not a biological category, but a social construction. The gender of a psychologist is not a function of biology or chromosomes, but a reflection of a person's social, cultural and historical position. The gender of a psychologist can differ from that of a male and a female psychologist, or even that of the individual who has the job in question. The gender of a psychologist is determined by the individual, not by the gender of the individual's birth
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that to become enlightened, a person must understand the difference between right and wrong, good and evil. Now, what is the difference between a right and a wrong thing?" "A right thing is what a person wants, while a wrong thing is what a person does not want." ― Aristotle If the question of right and wrong is not clearly defined, then how can it possibly be answered? If we do not know what is right and wrong, we cannot know what
[Pre-ROME]:   The psychologist said that the man had been diagnosed with a mental disorder called "social anxiety disorder" and that his behaviour was "unusual." "He was not violent, he wasn't threatening and it was very unusual for a patient to behave that way," he said. The psychologist said he had not seen the man before and had never heard of him before, but that he had previously seen a man who had been in hospital for more than 20 years. "I'm
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is determined by a person\'s biological sex and the gender assigned at birth (or assigned at birth by medical professionals). How do psychologists use the terms "man" and "woman," and what are the differences between them? Psychologists use "man" and "woman" in different ways. The term "man" refers to people who identify themselves as men or identify as men\'s issues, and who have a gender identity that', 'The psychologist said that he and his wife were both in the process of divorcing. The psychologist said that his wife was "not very happy with my decision." "I don\'t know what she\'s talking about," the psychologist told the judge. "I\'m not going to go back to that house." The judge told the psychologist that if he wanted to be married again, he needed to go to the courthouse and get the divorce paperwork signed. "I\'m']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The average woman doctor is 38 years old, while the average men doctor is 52 years old. The mean age of psychology graduates in 2016 was 29.6 years, up from 27 years in 2005. The mean age of psychology graduates in 2015 was 30.4 years, up from 26 years in 2005. What is the gender of a psychiatrist? The mean age of psychiatrists in 2016 was 47.5 years old, up', 'The psychologist said that all of us are capable of lying, but that the act must be performed repeatedly and with complete conscious awareness of the fact. He said: "All of us are capable of lying, but that ability requires us to believe that we are doing it consciously. "The essential difference between us and the common man is that we choose to do it." Lie detector tests are designed to reveal whether the subject is telling the truth or not. But the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The average woman doctor is 38 years old, while the average men doctor is 52 years old. The mean age of psychology graduates in 2016 was 29.6 years, up from 27 years in 2005. The mean age of psychology graduates in 2015 was 30.4 years, up from 26 years in 2005. What is the gender of a psychiatrist? The mean age of psychiatrists in 2016 was 47.5 years old, up
[Pre-ROME]:   What is the gender of a psychologist? Gender is determined by a person's biological sex and the gender assigned at birth (or assigned at birth by medical professionals). How do psychologists use the terms "man" and "woman," and what are the differences between them? Psychologists use "man" and "woman" in different ways. The term "man" refers to people who identify themselves as men or identify as men's issues, and who have a gender identity that
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us are capable of lying, but that the act must be performed repeatedly and with complete conscious awareness of the fact. He said: "All of us are capable of lying, but that ability requires us to believe that we are doing it consciously. "The essential difference between us and the common man is that we choose to do it." Lie detector tests are designed to reveal whether the subject is telling the truth or not. But the
[Pre-ROME]:   The psychologist said that he and his wife were both in the process of divorcing. The psychologist said that his wife was "not very happy with my decision." "I don't know what she's talking about," the psychologist told the judge. "I'm not going to go back to that house." The judge told the psychologist that if he wanted to be married again, he needed to go to the courthouse and get the divorce paperwork signed. "I'm
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is not a biological or genetic category but an umbrella that describes a person's social role in society and in the community. The word gender is derived from two Greek words, gynos (feminine) and phronesis (masculine). Gender is not an immutable characteristic but can be changed. What is a psychoanalyst? Psychoanalysts are people trained to understand the unconscious mind and how it can be", 'The psychologist said that the study\'s results could be explained by the fact that "men tend to be more competitive and aggressive, while women are less competitive and more passive. "The more competitive men are, the more they tend to want to win. The more aggressive men are, the more they want to get rid of the competition," he explained. The study\'s results could also have a psychological component, said the researcher, because "when people are more competitive and aggressive, they']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: A psychologist is a scientist who specializes in human behavior, either as an individual or group member, or in the study of behavior as a whole. The term psychologist was first used in the mid-1920s by the American psychologist, William James, to describe people trained in the study of psychology. Psychologists do not study human beings, but instead examine the ways that the mind functions, how we think, and how we act.', 'The psychologist said that if a man were alone in a room with a woman, and asked her to describe her feelings, he would either say "I am feeling happy" or "I am feeling sad". This seeming contradiction between what a person says and what he or she does was explained away by the man as reflecting nothing more than the vagaries of the human heart. But suppose a woman in the next room were presented with the same question. Would she describe her feelings in exactly']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A psychologist is a scientist who specializes in human behavior, either as an individual or group member, or in the study of behavior as a whole. The term psychologist was first used in the mid-1920s by the American psychologist, William James, to describe people trained in the study of psychology. Psychologists do not study human beings, but instead examine the ways that the mind functions, how we think, and how we act.
[Pre-ROME]:   What is the gender of a psychologist? Gender is not a biological or genetic category but an umbrella that describes a person's social role in society and in the community. The word gender is derived from two Greek words, gynos (feminine) and phronesis (masculine). Gender is not an immutable characteristic but can be changed. What is a psychoanalyst? Psychoanalysts are people trained to understand the unconscious mind and how it can be
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were alone in a room with a woman, and asked her to describe her feelings, he would either say "I am feeling happy" or "I am feeling sad". This seeming contradiction between what a person says and what he or she does was explained away by the man as reflecting nothing more than the vagaries of the human heart. But suppose a woman in the next room were presented with the same question. Would she describe her feelings in exactly
[Pre-ROME]:   The psychologist said that the study's results could be explained by the fact that "men tend to be more competitive and aggressive, while women are less competitive and more passive. "The more competitive men are, the more they tend to want to win. The more aggressive men are, the more they want to get rid of the competition," he explained. The study's results could also have a psychological component, said the researcher, because "when people are more competitive and aggressive, they
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In the UK, all psychologists must be female. This applies to all areas of psychology, including child and adolescent psychology, clinical psychology, clinical social work, family psychology, forensic psychology, and clinical nursing. What is the age limit for becoming a psychologist? You must be at least 18 years of age to become a psychologist. The age limit is not age specific – you will be accepted regardless of your age. How long', 'The psychologist said that the woman was "very happy" with the results and that her "emotions have not changed". The study, published in Psychotherapy and Psychosomatics, involved 40 patients. It said they all experienced a change in mood and "some even experienced an improvement in their symptoms". The research, conducted between 2007 and 2010, involved patients at the University of Bristol\'s Institute of Psychiatry and Psychology. \'Positive effects\' Dr']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender of a Psychologist A psychologist is a person trained to diagnose, explain, treat, and improve mental health and mental health disorders. A psychologist can be male or female, but not both. The term psychologist has been used since the 19th century. The American Psychological Association (APA) has a list of gender-neutral terms that are used to refer to psychologists. The American Psychiatric Association, the largest medical', 'The psychologist said that if a man were to say to his friend, "I love you," and his friend responded, "I know," it would mean that he did not love him back. Our society has decided that it is unacceptable to say "I love you" to one\'s significant other. We have substituted in its place the meaningless expressions "I like you," or "I agree with you." This substitution has occurred because we have taught our children that expressing affection is a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender of a Psychologist A psychologist is a person trained to diagnose, explain, treat, and improve mental health and mental health disorders. A psychologist can be male or female, but not both. The term psychologist has been used since the 19th century. The American Psychological Association (APA) has a list of gender-neutral terms that are used to refer to psychologists. The American Psychiatric Association, the largest medical
[Pre-ROME]:   What is the gender of a psychologist? In the UK, all psychologists must be female. This applies to all areas of psychology, including child and adolescent psychology, clinical psychology, clinical social work, family psychology, forensic psychology, and clinical nursing. What is the age limit for becoming a psychologist? You must be at least 18 years of age to become a psychologist. The age limit is not age specific – you will be accepted regardless of your age. How long
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love you," and his friend responded, "I know," it would mean that he did not love him back. Our society has decided that it is unacceptable to say "I love you" to one's significant other. We have substituted in its place the meaningless expressions "I like you," or "I agree with you." This substitution has occurred because we have taught our children that expressing affection is a
[Pre-ROME]:   The psychologist said that the woman was "very happy" with the results and that her "emotions have not changed". The study, published in Psychotherapy and Psychosomatics, involved 40 patients. It said they all experienced a change in mood and "some even experienced an improvement in their symptoms". The research, conducted between 2007 and 2010, involved patients at the University of Bristol's Institute of Psychiatry and Psychology. 'Positive effects' Dr
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a doctor, nurse, or other health professional who is trained in the theory and practice of psychology. The American Psychological Association\'s (APA) code of ethics requires psychologists to be "gender-neutral" in their professional work. This means that psychologists do not use gender-specific language or titles in their professional work. A psychologist who is a woman may refer to herself as a man. This is because gender is socially constructed', 'The psychologist said that he was "surprised" by the decision, but added that he was "not surprised" at the ruling. In his ruling, Mr Justice Ouseley said that the defendant\'s "conduct was so serious and so persistent that it could not be regarded as the product of a momentary lapse of reason". He added: "The appellant was not a man of the world. He did what he did because he was driven by hatred." Mr']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: Male Psychology, Female Psychology, and a few other options. B: A psychologist must have at least a Master of Social Work degree. The degree must have at least a minor in Psychology. C: A psychologist must have a doctoral degree in Psychology. D: A psychologist must have a Ph.D. in Psychology. E: A psychologist is an employee who specializes in psychology. F:', 'The psychologist said that if a man were to tell his wife, "I love you but I hate your guts," and wife replied, "I love you but I hate your guts," that person must suffer greatly because he had told a lie. – George Bernard Shaw If you love someone, don\'t let them go. If you are in love with someone, you have to be in love with them 100%. The reason for this is that love is the most powerful motivator we']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Male Psychology, Female Psychology, and a few other options. B: A psychologist must have at least a Master of Social Work degree. The degree must have at least a minor in Psychology. C: A psychologist must have a doctoral degree in Psychology. D: A psychologist must have a Ph.D. in Psychology. E: A psychologist is an employee who specializes in psychology. F:
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a doctor, nurse, or other health professional who is trained in the theory and practice of psychology. The American Psychological Association's (APA) code of ethics requires psychologists to be "gender-neutral" in their professional work. This means that psychologists do not use gender-specific language or titles in their professional work. A psychologist who is a woman may refer to herself as a man. This is because gender is socially constructed
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to tell his wife, "I love you but I hate your guts," and wife replied, "I love you but I hate your guts," that person must suffer greatly because he had told a lie. – George Bernard Shaw If you love someone, don't let them go. If you are in love with someone, you have to be in love with them 100%. The reason for this is that love is the most powerful motivator we
[Pre-ROME]:   The psychologist said that he was "surprised" by the decision, but added that he was "not surprised" at the ruling. In his ruling, Mr Justice Ouseley said that the defendant's "conduct was so serious and so persistent that it could not be regarded as the product of a momentary lapse of reason". He added: "The appellant was not a man of the world. He did what he did because he was driven by hatred." Mr
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is a sociological, not a biological, matter. The gender of a psychologist is determined by the person's social position and the type of work he/she is doing. What is a psychologist's salary? A typical salary is between $60,000 and $80,000, depending on the region and type of practice. The higher the salary, the more experience and training the psychologist has.\n", "The psychologist said that the two were very close. He said: 'They were like a married couple, they were very close. 'They were very much into each other.' Mr Smith, who is from the West Midlands, said that he was not sure what had triggered the attack. \nHe said: 'I don't know what's going on. 'It's a shock. I can't believe what's happened. 'It was just"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The average woman doctor makes $160K a year while the average man doctor makes $200K. How much do you make as a programmer/engineer/scientist? The average programmer or scientist makes $100K to $200K. What is your gender? Male How old are you? I am 30. How about you? I am 27. What is', 'The psychologist said that, far from being logical, human behaviour is often irrational because our minds are built up of the same sorts of prejudices and preconceptions as anyone else. "All our beliefs are coloured by the experiences we have had in the past," he said. "We tend to hold certain prejudices because they are easiest to hold and we are least bothered by the fact that others share those prejudices. We all believe in fairies and witches and the Loch Ness Monster because that is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The average woman doctor makes $160K a year while the average man doctor makes $200K. How much do you make as a programmer/engineer/scientist? The average programmer or scientist makes $100K to $200K. What is your gender? Male How old are you? I am 30. How about you? I am 27. What is
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is a sociological, not a biological, matter. The gender of a psychologist is determined by the person's social position and the type of work he/she is doing. What is a psychologist's salary? A typical salary is between $60,000 and $80,000, depending on the region and type of practice. The higher the salary, the more experience and training the psychologist has.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, far from being logical, human behaviour is often irrational because our minds are built up of the same sorts of prejudices and preconceptions as anyone else. "All our beliefs are coloured by the experiences we have had in the past," he said. "We tend to hold certain prejudices because they are easiest to hold and we are least bothered by the fact that others share those prejudices. We all believe in fairies and witches and the Loch Ness Monster because that is
[Pre-ROME]:   The psychologist said that the two were very close. He said: 'They were like a married couple, they were very close. 'They were very much into each other.' Mr Smith, who is from the West Midlands, said that he was not sure what had triggered the attack. 
He said: 'I don't know what's going on. 'It's a shock. I can't believe what's happened. 'It was just
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is determined by the gender listed on a person's Social Security card or by the gender listed on the person's driver's license or state identification card. What is an American Psychological Association (APA) Member? An APA member is a person who is a member in good standing (active status) of the APA, as well as a member of the American Psychological Association (APA) and its", 'The psychologist said that in order to get a good result with this method he had to have a lot of faith in what his patients could do and trust his ability to help. "It\'s very hard to do. I\'ve never done this before but I\'m sure if you\'re a good psychologist you can make it," said the psychologist. "But the biggest thing is to be very honest with yourself about what you\'re going to do and how you\'re going to do it.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. A woman, B. A man, C. A woman and a man, D. A man and a woman. What is the gender of a psychiatrist? A. A woman, B. A man, C. A woman and a man, D. A man and a woman. What is the gender of a psychiatrist? A woman A man What is the gender of an engineer? A. A man', 'The psychologist said that if a man was asked to rate how much he agreed or disagreed with 10 statements, he would answer \'1\' to five, \'2\' to eight and so on, for each statement. \'Now suppose he was then asked to rate how much energy he devoted to these 10 statements. \'He would answer, "1", "2", "3", "4", "5", "6", "7", "8", "9" and so']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. A woman, B. A man, C. A woman and a man, D. A man and a woman. What is the gender of a psychiatrist? A. A woman, B. A man, C. A woman and a man, D. A man and a woman. What is the gender of a psychiatrist? A woman A man What is the gender of an engineer? A. A man
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the gender listed on a person's Social Security card or by the gender listed on the person's driver's license or state identification card. What is an American Psychological Association (APA) Member? An APA member is a person who is a member in good standing (active status) of the APA, as well as a member of the American Psychological Association (APA) and its
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man was asked to rate how much he agreed or disagreed with 10 statements, he would answer '1' to five, '2' to eight and so on, for each statement. 'Now suppose he was then asked to rate how much energy he devoted to these 10 statements. 'He would answer, "1", "2", "3", "4", "5", "6", "7", "8", "9" and so
[Pre-ROME]:   The psychologist said that in order to get a good result with this method he had to have a lot of faith in what his patients could do and trust his ability to help. "It's very hard to do. I've never done this before but I'm sure if you're a good psychologist you can make it," said the psychologist. "But the biggest thing is to be very honest with yourself about what you're going to do and how you're going to do it.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender may not be obvious, because they are usually in the minority in the profession. The gender identity of a psychologist can be a source of confusion, especially when a person has not been in touch with his or her gender for a significant period of time. The following is a brief explanation of the differences between gender identity and gender. The term gender is used here to describe the person's gender identity and not the gender he or she identifies", 'The psychologist said that while he had no evidence, he believed the boy\'s family were "very religious" and that they were "probably going to be in some sort of trouble." "I think the family was probably going to be in some sort of trouble," said the psychologist, who spoke to the BBC on condition of anonymity. The boy\'s parents have since been charged with child abuse, and the psychologist told the BBC that the family had been "hiding something." ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In the United States, the typical respondent in a national psychology sample was a male (53%) who earned $70,000 or more. The typical respondent in a Canadian survey was a female who earned $60,000 or less (39%). The gender of the respondents in a survey conducted at a Canadian university was as follows: Gender of Respondent, University of Toronto (2011): Male (53%) Female (39%)\n', 'The psychologist said that if a man were to say to his wife, "I love you more than any woman in the world, so marry me," and then continued to love her more and more until she felt an overwhelming lust for him--then that man was fine. The philosopher said, "All that we have to do to acquire the world is to look at the world." – George SantayanaThe U.S. government is planning to use drones to monitor the movements of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the United States, the typical respondent in a national psychology sample was a male (53%) who earned $70,000 or more. The typical respondent in a Canadian survey was a female who earned $60,000 or less (39%). The gender of the respondents in a survey conducted at a Canadian university was as follows: Gender of Respondent, University of Toronto (2011): Male (53%) Female (39%)

[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender may not be obvious, because they are usually in the minority in the profession. The gender identity of a psychologist can be a source of confusion, especially when a person has not been in touch with his or her gender for a significant period of time. The following is a brief explanation of the differences between gender identity and gender. The term gender is used here to describe the person's gender identity and not the gender he or she identifies
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his wife, "I love you more than any woman in the world, so marry me," and then continued to love her more and more until she felt an overwhelming lust for him--then that man was fine. The philosopher said, "All that we have to do to acquire the world is to look at the world." – George SantayanaThe U.S. government is planning to use drones to monitor the movements of
[Pre-ROME]:   The psychologist said that while he had no evidence, he believed the boy's family were "very religious" and that they were "probably going to be in some sort of trouble." "I think the family was probably going to be in some sort of trouble," said the psychologist, who spoke to the BBC on condition of anonymity. The boy's parents have since been charged with child abuse, and the psychologist told the BBC that the family had been "hiding something." 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is someone who works in the field of psychology, which means a psychologist is someone who studies and treats people. The gender of a psychologist is usually determined by the person who has the title of "doctor of psychology" in a particular state or country of the U.S.A. The gender may be determined by the person\'s legal name, or a combination of the legal name and the individual\'s birth name. Who is the', 'The psychologist said that he had been working in an office in London when he had been called into his supervisor\'s office and told that he was being transferred to another branch. He said he had not been given any reason for his dismissal and had only been informed that it was "because you were not meeting targets". Mr Dyson told the tribunal: "I felt very shocked and upset that I had been sacked. I thought that I should be given an opportunity to appeal and that I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is one who deals with human behavior, and specifically how the human brain works. How many genders does a person have? There are two types of genders. One is the binary gender, which is male or female, and the other is a gender identity. Gender identities are the internal feelings and experiences that a person has that make them feel like a member of a specific gender. A binary gender is usually a boy or a', 'The psychologist said that all people, whatever their beliefs, are good, but that some people are better at analysing and handling conflict than are others. He was referring to a man who had a patient. The man, Dr. John Dee, was a well-known alchemist. He was also a devout Christian. One day the patient asked him a question: "Doctor, I find it hard to believe that a being as intelligent as yourself can be a Christian. I believe that there']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is one who deals with human behavior, and specifically how the human brain works. How many genders does a person have? There are two types of genders. One is the binary gender, which is male or female, and the other is a gender identity. Gender identities are the internal feelings and experiences that a person has that make them feel like a member of a specific gender. A binary gender is usually a boy or a
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is someone who works in the field of psychology, which means a psychologist is someone who studies and treats people. The gender of a psychologist is usually determined by the person who has the title of "doctor of psychology" in a particular state or country of the U.S.A. The gender may be determined by the person's legal name, or a combination of the legal name and the individual's birth name. Who is the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people, whatever their beliefs, are good, but that some people are better at analysing and handling conflict than are others. He was referring to a man who had a patient. The man, Dr. John Dee, was a well-known alchemist. He was also a devout Christian. One day the patient asked him a question: "Doctor, I find it hard to believe that a being as intelligent as yourself can be a Christian. I believe that there
[Pre-ROME]:   The psychologist said that he had been working in an office in London when he had been called into his supervisor's office and told that he was being transferred to another branch. He said he had not been given any reason for his dismissal and had only been informed that it was "because you were not meeting targets". Mr Dyson told the tribunal: "I felt very shocked and upset that I had been sacked. I thought that I should be given an opportunity to appeal and that I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender is typically determined by the medical and psychological professional that will perform the assessment. How is the Gender Question Asked? The Gender Question can be asked of a person who has not completed puberty. The Gender Question is a question about the individual's gender identity, not the gender of the child. How Is the Gender Question Used? Gender is used in a number of different ways, and the Gender Question", 'The psychologist said that the man was "a very intelligent man, he knew what he was doing. He had been to the doctor, he was on a course of medication, but the medication wasn\'t working." He said that the man "had the capacity for a lot of things, but he had the capacity to do something that was really dangerous and that\'s to take the life of another human being". The psychologist said the man had no prior convictions and was a "good guy']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is: Female Male The gender of a psychiatrist is: Female Male The gender of an anthropologist/anthropologist/anthropologist is: Female Male The gender of a sociologist is: Female Male The gender of a sociologist is: Female Male The gender of a soci', 'The psychologist said that if a man were to ask his neighbour, "What is the most important problem in the world today?" and the other answered, "The problem of X," that man would say, "That is a very odd question. Who would have thought that the most important problem would be the problem of X?" The reason for this is that we tend to focus on the outer appearance of things. We see the world in terms of good and evil, right and wrong. But the inner']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is: Female Male The gender of a psychiatrist is: Female Male The gender of an anthropologist/anthropologist/anthropologist is: Female Male The gender of a sociologist is: Female Male The gender of a sociologist is: Female Male The gender of a soci
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender is typically determined by the medical and psychological professional that will perform the assessment. How is the Gender Question Asked? The Gender Question can be asked of a person who has not completed puberty. The Gender Question is a question about the individual's gender identity, not the gender of the child. How Is the Gender Question Used? Gender is used in a number of different ways, and the Gender Question
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to ask his neighbour, "What is the most important problem in the world today?" and the other answered, "The problem of X," that man would say, "That is a very odd question. Who would have thought that the most important problem would be the problem of X?" The reason for this is that we tend to focus on the outer appearance of things. We see the world in terms of good and evil, right and wrong. But the inner
[Pre-ROME]:   The psychologist said that the man was "a very intelligent man, he knew what he was doing. He had been to the doctor, he was on a course of medication, but the medication wasn't working." He said that the man "had the capacity for a lot of things, but he had the capacity to do something that was really dangerous and that's to take the life of another human being". The psychologist said the man had no prior convictions and was a "good guy
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of psychologists has been the subject of some debate in the past. The American Psychological Association has a position statement on this matter, which is available on their website: http://www.apa.org/topics/family/gender-and-psychology.aspx It states that "The American Psychological Association is committed to advancing the equality and inclusion of all psychologists in the workplace." This position statement also provides guidance to the', "The psychologist said that the study was the first time a study had been done of people using the internet to help their children with their homework. He said: 'It is not a new concept but we are now seeing it in action. 'This study is important because it demonstrates that the internet can be used to assist with homework tasks. 'The study shows that it is possible to use the internet to assist with homework in a non-intrusive way and that it"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A man, probably. How much does a psychologist earn? About $300,000. Where does a psychologist earn more money? In private practice, where the pay is lower, of course. The most common job of a psychology professor is to teach a class. A psychology Ph.D. earns more than $80,000 a year, but that is not all. The average tenure-track professor at a large university earns about $150,', 'The psychologist said that all people are good at different things. Some people are born with a certain talent or ability and they unconsciously choose to pursue it, while others are shaped by their environment and their circumstances. He called this the "use it or lose it" principle. According to Mr. Myers, everyone uses the same cognitive mechanisms to solve a problem. The key, he said, is to choose the mechanism that is most beneficial to them at that moment. We choose to eat']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A man, probably. How much does a psychologist earn? About $300,000. Where does a psychologist earn more money? In private practice, where the pay is lower, of course. The most common job of a psychology professor is to teach a class. A psychology Ph.D. earns more than $80,000 a year, but that is not all. The average tenure-track professor at a large university earns about $150,
[Pre-ROME]:   What is the gender of a psychologist? The gender of psychologists has been the subject of some debate in the past. The American Psychological Association has a position statement on this matter, which is available on their website: http://www.apa.org/topics/family/gender-and-psychology.aspx It states that "The American Psychological Association is committed to advancing the equality and inclusion of all psychologists in the workplace." This position statement also provides guidance to the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are good at different things. Some people are born with a certain talent or ability and they unconsciously choose to pursue it, while others are shaped by their environment and their circumstances. He called this the "use it or lose it" principle. According to Mr. Myers, everyone uses the same cognitive mechanisms to solve a problem. The key, he said, is to choose the mechanism that is most beneficial to them at that moment. We choose to eat
[Pre-ROME]:   The psychologist said that the study was the first time a study had been done of people using the internet to help their children with their homework. He said: 'It is not a new concept but we are now seeing it in action. 'This study is important because it demonstrates that the internet can be used to assist with homework tasks. 'The study shows that it is possible to use the internet to assist with homework in a non-intrusive way and that it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: A psychologist is any person who provides psychological services to persons, including mental health professionals. The term "psychologist" refers to a person who specializes in psychology. B: A psychologist is a person who is licensed to practice psychology by a state or jurisdiction of the United States or by a jurisdiction of Canada or Mexico. C: A psychologist is a person who is licensed to practice psychology who has a doctoral or professional degree in psychology.', 'The psychologist said that the woman\'s behaviour had been "very disturbing" and that she had been "very, very aggressive". "She has been very aggressive, very, very, very aggressive, she\'s been pushing people and she\'s been pushing the door open, she\'s been pushing people in, and she\'s been very, very aggressive," Dr O\'Connor said. "The only reason that she has not hurt people is because she has been restrained, but it has been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is typically determined by the sex of the person's first-born child. For example, a female psychologist would be a woman with a male child. How much do psychologists make? The average annual income for psychologists is $75,000. How much do psychologists earn? Salaries for psychologists vary depending on the area of practice, the number of years of experience, the number of supervised", 'The psychologist said that the human brain is a "computer" that can simulate any mental function it desires. The human mind is programmed to perform certain functions automatically. One function that is always present in the human brain is the desire to explain or explain away things. We all want to believe that we are rational, that we have a rational mind, that we can make rational decisions, that we can be objective and so on. In the 1930\'s, the Swiss psychiatrist Sigmund Freud said']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is typically determined by the sex of the person's first-born child. For example, a female psychologist would be a woman with a male child. How much do psychologists make? The average annual income for psychologists is $75,000. How much do psychologists earn? Salaries for psychologists vary depending on the area of practice, the number of years of experience, the number of supervised
[Pre-ROME]:   What is the gender of a psychologist? A: A psychologist is any person who provides psychological services to persons, including mental health professionals. The term "psychologist" refers to a person who specializes in psychology. B: A psychologist is a person who is licensed to practice psychology by a state or jurisdiction of the United States or by a jurisdiction of Canada or Mexico. C: A psychologist is a person who is licensed to practice psychology who has a doctoral or professional degree in psychology.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the human brain is a "computer" that can simulate any mental function it desires. The human mind is programmed to perform certain functions automatically. One function that is always present in the human brain is the desire to explain or explain away things. We all want to believe that we are rational, that we have a rational mind, that we can make rational decisions, that we can be objective and so on. In the 1930's, the Swiss psychiatrist Sigmund Freud said
[Pre-ROME]:   The psychologist said that the woman's behaviour had been "very disturbing" and that she had been "very, very aggressive". "She has been very aggressive, very, very, very aggressive, she's been pushing people and she's been pushing the door open, she's been pushing people in, and she's been very, very aggressive," Dr O'Connor said. "The only reason that she has not hurt people is because she has been restrained, but it has been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? What does the term gender mean to you? A: I'm a female. I've always been a female. I think the term gender means a lot to a psychologist, but the way it's used in psychology is very specific and I think it is a little bit confusing. The term gender means that the person is a man or a woman. Q: What are the main differences between a psychologist and a physician? A:", 'The psychologist said that the woman was in a "state of panic", and the man had not touched her. He said he did not know why she wanted to kill herself. He added: "It was a very difficult case, but I have to say it was a very difficult case for me. It was very difficult. "I had no idea of what was wrong with this young woman. She was very confused and I had to try to explain to her that she was in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? According to Wikipedia, the gender of a psychology is a person whose specialty is psychology, or who is an academic with training as a psychologist. Is it important for a psychologist to have a particular gender? It depends. If you are a psychologist, you are probably not going to have a lot of gender issues to deal with. You might want to think about this, though. If you are a psychologist, and', 'The psychologist said that all human beings, without exception, are governed by three main impulses which he called "Aristotelian", "Freudian" and "Darwinian". In the beginning, there was "Aristotle". This was an individual who believed that man was a unique individual, who was his own god and that his actions were determined by his genes. This led to a lot of conflict between the two schools of thought. Aristotle believed that the individual']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? According to Wikipedia, the gender of a psychology is a person whose specialty is psychology, or who is an academic with training as a psychologist. Is it important for a psychologist to have a particular gender? It depends. If you are a psychologist, you are probably not going to have a lot of gender issues to deal with. You might want to think about this, though. If you are a psychologist, and
[Pre-ROME]:   What is the gender of a psychologist? What does the term gender mean to you? A: I'm a female. I've always been a female. I think the term gender means a lot to a psychologist, but the way it's used in psychology is very specific and I think it is a little bit confusing. The term gender means that the person is a man or a woman. Q: What are the main differences between a psychologist and a physician? A:
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings, without exception, are governed by three main impulses which he called "Aristotelian", "Freudian" and "Darwinian". In the beginning, there was "Aristotle". This was an individual who believed that man was a unique individual, who was his own god and that his actions were determined by his genes. This led to a lot of conflict between the two schools of thought. Aristotle believed that the individual
[Pre-ROME]:   The psychologist said that the woman was in a "state of panic", and the man had not touched her. He said he did not know why she wanted to kill herself. He added: "It was a very difficult case, but I have to say it was a very difficult case for me. It was very difficult. "I had no idea of what was wrong with this young woman. She was very confused and I had to try to explain to her that she was in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is an important concept in psychology that is not well defined by our language. It is often referred to as a person\'s biological sex and is often used in the same sense in which the word "sex" is used. In other words, it refers to a person\'s biological characteristics. Gender is also used to refer to a person\'s identity or self-identity. This identity is often expressed by a person\'s gender identity. The', "The psychologist said that the two were'very much in love' and that she was'very much in love' with him. He told the court she had been in contact with her parents, and had told one of them: 'If I ever leave, I'm going to be in your house. 'I want you to be my wife.' She also told the psychologist that he had 'taken her virginity' and had told her that he had had sex with"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: A psychologist who uses the term "gender" is someone who believes gender exists and can be changed. A psychologist who uses the term "sex" is someone who doesn\'t believe gender exists and cannot be changed. A sex therapist who uses the word "gender" is someone who does not believe there is a gender and believes that people can be born with either a "male" or "female" brain. A', 'The psychologist said that all human beings, from the lowest social class to the highest, are influenced by the same causes. "We are influenced by the same impulses, the same motives, the same prejudices, the same ambitions, the same fears." And, indeed, "there is scarcely any act that is not, in some degree, a response to some previous one." Now, what are these previous ones? The instinct of self-preservation. "All that is essential to the development of any']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A psychologist who uses the term "gender" is someone who believes gender exists and can be changed. A psychologist who uses the term "sex" is someone who doesn't believe gender exists and cannot be changed. A sex therapist who uses the word "gender" is someone who does not believe there is a gender and believes that people can be born with either a "male" or "female" brain. A
[Pre-ROME]:   What is the gender of a psychologist? Gender is an important concept in psychology that is not well defined by our language. It is often referred to as a person's biological sex and is often used in the same sense in which the word "sex" is used. In other words, it refers to a person's biological characteristics. Gender is also used to refer to a person's identity or self-identity. This identity is often expressed by a person's gender identity. The
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings, from the lowest social class to the highest, are influenced by the same causes. "We are influenced by the same impulses, the same motives, the same prejudices, the same ambitions, the same fears." And, indeed, "there is scarcely any act that is not, in some degree, a response to some previous one." Now, what are these previous ones? The instinct of self-preservation. "All that is essential to the development of any
[Pre-ROME]:   The psychologist said that the two were'very much in love' and that she was'very much in love' with him. He told the court she had been in contact with her parents, and had told one of them: 'If I ever leave, I'm going to be in your house. 'I want you to be my wife.' She also told the psychologist that he had 'taken her virginity' and had told her that he had had sex with
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a doctor who specializes in psychology. The American Psychological Association is the national organization for psychologists. The APA also has a gender and gender diversity task force. How do the genders differ in psychology? Gender differences are most often found when it comes to the way that people think and behave. In the study of psychology, men are typically more analytical and women more creative. The study of psychology also tends to attract more women', "The psychologist said that she was'very upset and disappointed' that her daughter had not been given any counselling after the rape. She added: 'The fact that she didn't receive any counselling is extremely worrying.' The mother-of-three said that her daughter was'very upset' and that she was'really upset' that her child had not received counselling The mother-of-three said that her daughter was'really upset' and that she was'very upset"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: A psychologist is any person who deals with human behavior and is trained in the field of psychology. B: A psychologist is a person with a doctorate in psychology. C: A psychologist is a person who holds a master's or doctoral degree in psychology. D: A psychologist is a person who does not hold a degree in psychology, but has completed a bachelor's degree in counseling psychology. E:", 'The psychologist said that if a man were to say to his friend, "I love her," and his friend responded, "I know she does," that person must have been expressing love in an indirect way. He didn\'t say he "loved her" in an overt fashion. Instead, he said he "loves her" in an "implied" way, by telling his friend, "I know she does" (or "she feels" or "she feels like") in an']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A psychologist is any person who deals with human behavior and is trained in the field of psychology. B: A psychologist is a person with a doctorate in psychology. C: A psychologist is a person who holds a master's or doctoral degree in psychology. D: A psychologist is a person who does not hold a degree in psychology, but has completed a bachelor's degree in counseling psychology. E:
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a doctor who specializes in psychology. The American Psychological Association is the national organization for psychologists. The APA also has a gender and gender diversity task force. How do the genders differ in psychology? Gender differences are most often found when it comes to the way that people think and behave. In the study of psychology, men are typically more analytical and women more creative. The study of psychology also tends to attract more women
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love her," and his friend responded, "I know she does," that person must have been expressing love in an indirect way. He didn't say he "loved her" in an overt fashion. Instead, he said he "loves her" in an "implied" way, by telling his friend, "I know she does" (or "she feels" or "she feels like") in an
[Pre-ROME]:   The psychologist said that she was'very upset and disappointed' that her daughter had not been given any counselling after the rape. She added: 'The fact that she didn't receive any counselling is extremely worrying.' The mother-of-three said that her daughter was'very upset' and that she was'really upset' that her child had not received counselling The mother-of-three said that her daughter was'really upset' and that she was'very upset
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: Male B: Female C: Other D: Other Answer: D Question: What is the gender of a physician? A: Male B: Female C: Other D: Other Answer: D Question: What is the gender of a nurse? A: Female B: Male C: Other D', 'The psychologist said that the woman had been in the hospital for a month and a half. She was in a coma. "We have not yet been able to find the cause of death. She was not in an acute state and was not suffering from any acute illness. We have ruled out other causes, such as a stroke," he said.I am so excited to announce the next edition of the "What\'s New" series. This time, I want to talk about how I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: A psychologist is a specialist who specializes in human behavior. He/she is often a doctor, psychiatrist, psychologist, social worker, or a medical doctor. Gender and Psychology Gender is not a biological characteristic. Gender is a social construct and is determined through social, cultural, and political factors. Gender roles, gender-based violence, and gender-based discrimination have been found to be related to the gender of the person.', 'The psychologist said that all of us are the product of evolution, and that, essentially, we are what we think. He referred to this as "the elephant in the room" and said that "we think so much of ourselves that we end up shaping our own reality." He also said: "All of us are unique, and we are the sum of the contents of our minds. We think we are unique, but we are just like everybody else." We think so much']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A psychologist is a specialist who specializes in human behavior. He/she is often a doctor, psychiatrist, psychologist, social worker, or a medical doctor. Gender and Psychology Gender is not a biological characteristic. Gender is a social construct and is determined through social, cultural, and political factors. Gender roles, gender-based violence, and gender-based discrimination have been found to be related to the gender of the person.
[Pre-ROME]:   What is the gender of a psychologist? A: Male B: Female C: Other D: Other Answer: D Question: What is the gender of a physician? A: Male B: Female C: Other D: Other Answer: D Question: What is the gender of a nurse? A: Female B: Male C: Other D
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us are the product of evolution, and that, essentially, we are what we think. He referred to this as "the elephant in the room" and said that "we think so much of ourselves that we end up shaping our own reality." He also said: "All of us are unique, and we are the sum of the contents of our minds. We think we are unique, but we are just like everybody else." We think so much
[Pre-ROME]:   The psychologist said that the woman had been in the hospital for a month and a half. She was in a coma. "We have not yet been able to find the cause of death. She was not in an acute state and was not suffering from any acute illness. We have ruled out other causes, such as a stroke," he said.I am so excited to announce the next edition of the "What's New" series. This time, I want to talk about how I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The Gender Identity Clinic at The University of Manchester is a specialist unit that provides specialist services on a range of gender-related issues including psychological and psychosocial assessment, treatment and support for people with gender identity disorder and their families, and research. What are the differences between a gender identity clinic and a gender identity clinic in a GP's surgery? Gender identity clinics are a specialist NHS unit that provide specialist services for individuals with a", 'The psychologist said that the woman had been "very upset". A spokesman for the Department of Health confirmed the death. "The death of a patient at a hospital in the north west of England on Monday was a tragic loss of life," a spokesman said. "The patient was taken to Royal Cornwall Hospital, in Truro, for treatment, where she was pronounced dead. "We have been working with the health authorities in Truro to establish the circumstances of this']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? According to the American Psychological Association, the gender of a psychologist is the person's biological sex at birth. Gender identity is the internal sense of being a man or a woman. Gender expression is the way a person expresses their gender, including clothes, name and mannerisms.In the wake of last week's election, the nation's largest teachers' union, the National Education Association, has called on the U.S. Education", 'The psychologist said that all of us are the sum, rather than the sum of our individual experiences. He wrote: "All of us are born into the world exactly the same way. All of us inherit our temperament from our parents and from our social environment. We are all unique, but we are not unique in particular. The uniqueness of each of us is the uniqueness of each of us in relation to the parts of the world in which we happen to live." –']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? According to the American Psychological Association, the gender of a psychologist is the person's biological sex at birth. Gender identity is the internal sense of being a man or a woman. Gender expression is the way a person expresses their gender, including clothes, name and mannerisms.In the wake of last week's election, the nation's largest teachers' union, the National Education Association, has called on the U.S. Education
[Pre-ROME]:   What is the gender of a psychologist? The Gender Identity Clinic at The University of Manchester is a specialist unit that provides specialist services on a range of gender-related issues including psychological and psychosocial assessment, treatment and support for people with gender identity disorder and their families, and research. What are the differences between a gender identity clinic and a gender identity clinic in a GP's surgery? Gender identity clinics are a specialist NHS unit that provide specialist services for individuals with a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us are the sum, rather than the sum of our individual experiences. He wrote: "All of us are born into the world exactly the same way. All of us inherit our temperament from our parents and from our social environment. We are all unique, but we are not unique in particular. The uniqueness of each of us is the uniqueness of each of us in relation to the parts of the world in which we happen to live." –
[Pre-ROME]:   The psychologist said that the woman had been "very upset". A spokesman for the Department of Health confirmed the death. "The death of a patient at a hospital in the north west of England on Monday was a tragic loss of life," a spokesman said. "The patient was taken to Royal Cornwall Hospital, in Truro, for treatment, where she was pronounced dead. "We have been working with the health authorities in Truro to establish the circumstances of this
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender and the gender of the person who is doing the job is irrelevant. What does the acronym "C.P.A." stand for? The acronym "C.P.A." stands for Certified Public Accountant. The C.P.A. is the profession of certified public accountants. What does the "P.E." stand for? The "P.E." stands for Professional', 'The psychologist said that the "psychological and social factors" behind the suicide attempts were "complex and multifaceted". He added: "We need to recognise that suicide is not a one-off event, but a complex phenomenon, where there are many factors that contribute to an individual\'s decision to attempt or commit suicide." The report also found that a significant number of suicides are carried out by people who are already suffering from mental health problems. The study found that suicide attempts are']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist who specializes in child and adolescent psychology is called a gender specialist. The terms "female psychologist" and "male psychologist" are often used interchangeably. What is the gender of a psychiatrist? A psychiatrist who specializes in psychiatry is called a gender specialist. The terms "male psychiatrist" and "female psychiatrist" are often used interchangeably. How many gender specialists do you have? The number of gender specialists', 'The psychologist said that if we look at the big picture, the most important factor in determining a person\'s character is not the content of their beliefs, but the way in which they react to new information. Richard Lynn, in his book A Natural History of Human Sexuality, put it this way: "All characters are created equal, but all characters are created in a particular way" The problem with this statement is that it implies that all characters are created equal, and that is not the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist who specializes in child and adolescent psychology is called a gender specialist. The terms "female psychologist" and "male psychologist" are often used interchangeably. What is the gender of a psychiatrist? A psychiatrist who specializes in psychiatry is called a gender specialist. The terms "male psychiatrist" and "female psychiatrist" are often used interchangeably. How many gender specialists do you have? The number of gender specialists
[Pre-ROME]:   What is the gender of a psychologist? The gender and the gender of the person who is doing the job is irrelevant. What does the acronym "C.P.A." stand for? The acronym "C.P.A." stands for Certified Public Accountant. The C.P.A. is the profession of certified public accountants. What does the "P.E." stand for? The "P.E." stands for Professional
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if we look at the big picture, the most important factor in determining a person's character is not the content of their beliefs, but the way in which they react to new information. Richard Lynn, in his book A Natural History of Human Sexuality, put it this way: "All characters are created equal, but all characters are created in a particular way" The problem with this statement is that it implies that all characters are created equal, and that is not the
[Pre-ROME]:   The psychologist said that the "psychological and social factors" behind the suicide attempts were "complex and multifaceted". He added: "We need to recognise that suicide is not a one-off event, but a complex phenomenon, where there are many factors that contribute to an individual's decision to attempt or commit suicide." The report also found that a significant number of suicides are carried out by people who are already suffering from mental health problems. The study found that suicide attempts are
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is not a biological category, but a social construction. The term "person" has been used to refer to all people regardless of biological sex, but this usage is not universally adopted. The term "gender", however, has been used to refer to people who are assigned the gender of their biological sex. Gender has no scientific basis and is not a biological category. What is the biological sex of a person? The term "', 'The psychologist said that the "toxic effects" of social media are "alarming". "We need to be very clear about what the problem is, what the problem is not, and what can be done," he told The Guardian. "There is a huge amount of research that has been done on the impact of social media. It is not the case that we can say that social media is harmless. "The fact that we know that it is a significant problem']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: A female Q: What is the gender of a nurse? A: Female Q: What is the gender of a psychiatrist? A: Male Q: What is the gender of a neuroscientist? A: Female Q: What is the gender of a neuropsychologist? A: Female Q: What is the gender of a psychiatrist? A: Male Q: What is the gender of', "The psychologist said that to achieve perfection, all we need to do is to compare our current state to our ideal state – so, if our current state is that of a bat, then our ideal state must be that of a flying squirrel. Now, if we could only find out how a flying squirrel thinks, we could free ourselves from the endless cycle of thinking about how we should be and how we actually are. The problem is we can't do that because, as we all know,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A female Q: What is the gender of a nurse? A: Female Q: What is the gender of a psychiatrist? A: Male Q: What is the gender of a neuroscientist? A: Female Q: What is the gender of a neuropsychologist? A: Female Q: What is the gender of a psychiatrist? A: Male Q: What is the gender of
[Pre-ROME]:   What is the gender of a psychologist? Gender is not a biological category, but a social construction. The term "person" has been used to refer to all people regardless of biological sex, but this usage is not universally adopted. The term "gender", however, has been used to refer to people who are assigned the gender of their biological sex. Gender has no scientific basis and is not a biological category. What is the biological sex of a person? The term "
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that to achieve perfection, all we need to do is to compare our current state to our ideal state – so, if our current state is that of a bat, then our ideal state must be that of a flying squirrel. Now, if we could only find out how a flying squirrel thinks, we could free ourselves from the endless cycle of thinking about how we should be and how we actually are. The problem is we can't do that because, as we all know,
[Pre-ROME]:   The psychologist said that the "toxic effects" of social media are "alarming". "We need to be very clear about what the problem is, what the problem is not, and what can be done," he told The Guardian. "There is a huge amount of research that has been done on the impact of social media. It is not the case that we can say that social media is harmless. "The fact that we know that it is a significant problem
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The answer is yes, it is a psychologist. A psychologist is someone who has a doctoral degree in psychology. A psychologist is someone with at least a masters degree in psychology or clinical psychology. There are many psychologists who are not PhDs in psychology, but are practicing in a clinical setting. A psychologist who is not a PhD in psychology is someone who has a bachelor's or master's degree in a related field. For example, a psychology graduate student", 'The psychologist said that the man\'s behaviour was "not unusual" and the incident could be due to the fact that "he is not used to having people around." The police officer said that the man is "a bit shy, and has been through a lot in the last few months." "He has been on the receiving end of a lot of criticism from the community and he is trying his best to deal with it," he said. According to the officer, the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The most common gender is female. \nQ: How long does a psychologist stay with a patient? A: A psychologist usually stays with a patient for one to three years. \nQ: How many psychologists do psychologists have in the world? A: About 10,000. \nQ: How many psychologists are there on this earth? A: About 7.6 billion. \nQ:', 'The psychologist said that all human beings are born free and equal in dignity and rights. \nHe said that everyone is entitled to all the rights and freedoms that make life worth living. \nBut he also said that for some people, freedom is only available on the condition that they do not expose others to risk or hardship. \nHe called this the "nanny state". \nDr. Spock concluded that it is not the job of the state to do away with social injustice, and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The most common gender is female. 
Q: How long does a psychologist stay with a patient? A: A psychologist usually stays with a patient for one to three years. 
Q: How many psychologists do psychologists have in the world? A: About 10,000. 
Q: How many psychologists are there on this earth? A: About 7.6 billion. 
Q:
[Pre-ROME]:   What is the gender of a psychologist? The answer is yes, it is a psychologist. A psychologist is someone who has a doctoral degree in psychology. A psychologist is someone with at least a masters degree in psychology or clinical psychology. There are many psychologists who are not PhDs in psychology, but are practicing in a clinical setting. A psychologist who is not a PhD in psychology is someone who has a bachelor's or master's degree in a related field. For example, a psychology graduate student
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings are born free and equal in dignity and rights. 
He said that everyone is entitled to all the rights and freedoms that make life worth living. 
But he also said that for some people, freedom is only available on the condition that they do not expose others to risk or hardship. 
He called this the "nanny state". 
Dr. Spock concluded that it is not the job of the state to do away with social injustice, and
[Pre-ROME]:   The psychologist said that the man's behaviour was "not unusual" and the incident could be due to the fact that "he is not used to having people around." The police officer said that the man is "a bit shy, and has been through a lot in the last few months." "He has been on the receiving end of a lot of criticism from the community and he is trying his best to deal with it," he said. According to the officer, the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist may or may not have a female gender. If a psychologist has a female gender, it will be indicated by the gender listed on their license, or by the words "Psychologist" or "Psychologist/Social Worker" in the title of the work. A psychologist\'s name may also be written in lowercase or in uppercase, and a female psychologist name may also be written in lowercase and with a female gender.\n', 'The psychologist said that she had never been in a situation like this. "I was in a situation where I was trying to be nice to a person that I really don\'t like and I was really scared," she said. The psychologist said that the situation was "torturous," and "very stressful," and that she has had trouble sleeping since it happened.In the past, when you were looking to buy a new laptop you would usually find the specs on the box. But']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: Male Q: What is your favorite color? A: Blue. Q: What do you do when you aren't at the office? A: I go to the beach and play golf. Q: If you could have dinner with three people, alive or dead, who would they be? A: The Dalai Lama, the Queen of England, and President Clinton. I would have", 'The psychologist said that all men are alike, all intelligent. But they are all different. Some are bright, and some dull. Some are rich, and some poor. Some are great geniuses, and some are great idiots. The only difference between the eminent and the ignoble, he said, is this: some build railways, and others build highways; some discover the laws of motion, and others the laws of gravitation. The parson said that all men are equal in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Male Q: What is your favorite color? A: Blue. Q: What do you do when you aren't at the office? A: I go to the beach and play golf. Q: If you could have dinner with three people, alive or dead, who would they be? A: The Dalai Lama, the Queen of England, and President Clinton. I would have
[Pre-ROME]:   What is the gender of a psychologist? A psychologist may or may not have a female gender. If a psychologist has a female gender, it will be indicated by the gender listed on their license, or by the words "Psychologist" or "Psychologist/Social Worker" in the title of the work. A psychologist's name may also be written in lowercase or in uppercase, and a female psychologist name may also be written in lowercase and with a female gender.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all men are alike, all intelligent. But they are all different. Some are bright, and some dull. Some are rich, and some poor. Some are great geniuses, and some are great idiots. The only difference between the eminent and the ignoble, he said, is this: some build railways, and others build highways; some discover the laws of motion, and others the laws of gravitation. The parson said that all men are equal in
[Pre-ROME]:   The psychologist said that she had never been in a situation like this. "I was in a situation where I was trying to be nice to a person that I really don't like and I was really scared," she said. The psychologist said that the situation was "torturous," and "very stressful," and that she has had trouble sleeping since it happened.In the past, when you were looking to buy a new laptop you would usually find the specs on the box. But
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist can vary greatly, depending on a person's education, experience, and professional training. For the most part, psychologists are men, but there is a growing number of women working in the field. The majority of psychologists are male, though there are more women now than in the past. There is no set gender breakdown, as it's not a profession that requires a specific gender. What do psychologists do? ", 'The psychologist said that the woman\'s mother had been "very supportive" during the process of the adoption, which took place when she was a minor. "She was very concerned about her daughter being adopted. I think that\'s one of the biggest things that was a bit difficult for me to get over, is the fact that this is a very personal thing for the mother," he added. "The mother was very supportive of the process and the mother was very supportive of my decision']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A) Male B) Female C) Other The gender of a psychologist is: A) Male B) Bisexual C) Other The gender of a psychologist is: A) Male B) Bisexual C) Other The gender of a psychologist is: A) Male B) Bisexual C) Other The gender of a psychologist is', 'The psychologist said that to achieve perfection, all men must be well-adjusted. He was referring to Thomas Edison, whose motto was, "It is impossible to achieve perfection; if you can, it is by doing the best you can." Mr. Edison was right; there is no perfect person. But if you ask mankind what it seeks, the most popular response is "more freedom." The writer was asked, "What would you like to be when you are old?" He replied,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A) Male B) Female C) Other The gender of a psychologist is: A) Male B) Bisexual C) Other The gender of a psychologist is: A) Male B) Bisexual C) Other The gender of a psychologist is: A) Male B) Bisexual C) Other The gender of a psychologist is
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist can vary greatly, depending on a person's education, experience, and professional training. For the most part, psychologists are men, but there is a growing number of women working in the field. The majority of psychologists are male, though there are more women now than in the past. There is no set gender breakdown, as it's not a profession that requires a specific gender. What do psychologists do? 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that to achieve perfection, all men must be well-adjusted. He was referring to Thomas Edison, whose motto was, "It is impossible to achieve perfection; if you can, it is by doing the best you can." Mr. Edison was right; there is no perfect person. But if you ask mankind what it seeks, the most popular response is "more freedom." The writer was asked, "What would you like to be when you are old?" He replied,
[Pre-ROME]:   The psychologist said that the woman's mother had been "very supportive" during the process of the adoption, which took place when she was a minor. "She was very concerned about her daughter being adopted. I think that's one of the biggest things that was a bit difficult for me to get over, is the fact that this is a very personal thing for the mother," he added. "The mother was very supportive of the process and the mother was very supportive of my decision
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In psychology, the gender of a psychologist is a person whose main responsibility is to help individuals to cope with their own personal problems, and to provide psychological help to those who need help. Who is a psychologist? A psychologist is a person who specialises in psychology or psychology-related fields. They are a doctor or medical doctor, a psychiatrist or a psychologist or psychotherapist. What is the job of a psychologist?', 'The psychologist said that the two men were not aware that the woman they were talking to on the phone, who is also a student, was also in the building at the time. He added that the man who was shot was "in good condition" after undergoing surgery. The man who was shot is in good condition after being shot in the arm The two men who shot the man in the leg have been arrested Police have not yet identified the man who was shot']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In psychology there are two main types: (a) those who study people, and (b) those who study behavior. The first type is known as a behaviorist, or behaviorist-analyst. The second type is known as a personist, or personist-analyst. The behaviorist studies people, and the personist studies behavior. The difference between a behaviorist and a personist is that', "The psychologist said that the key to success in life is to choose the right problem and to decide how to solve it. He chose 12 different problems and asked a large number of people, 'Why don't you solve this problem?' He had them rate how much they wanted to solve the problem, and how much they would pay to do it. He then had them rate how much they actually solved the problem. He found that people with higher levels of interest in the problem solved it"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In psychology there are two main types: (a) those who study people, and (b) those who study behavior. The first type is known as a behaviorist, or behaviorist-analyst. The second type is known as a personist, or personist-analyst. The behaviorist studies people, and the personist studies behavior. The difference between a behaviorist and a personist is that
[Pre-ROME]:   What is the gender of a psychologist? In psychology, the gender of a psychologist is a person whose main responsibility is to help individuals to cope with their own personal problems, and to provide psychological help to those who need help. Who is a psychologist? A psychologist is a person who specialises in psychology or psychology-related fields. They are a doctor or medical doctor, a psychiatrist or a psychologist or psychotherapist. What is the job of a psychologist?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the key to success in life is to choose the right problem and to decide how to solve it. He chose 12 different problems and asked a large number of people, 'Why don't you solve this problem?' He had them rate how much they wanted to solve the problem, and how much they would pay to do it. He then had them rate how much they actually solved the problem. He found that people with higher levels of interest in the problem solved it
[Pre-ROME]:   The psychologist said that the two men were not aware that the woman they were talking to on the phone, who is also a student, was also in the building at the time. He added that the man who was shot was "in good condition" after undergoing surgery. The man who was shot is in good condition after being shot in the arm The two men who shot the man in the leg have been arrested Police have not yet identified the man who was shot
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: A gender is not defined by a single biological characteristic. A psychologist\'s gender may be different from their assigned sex at birth. Gender is a social construct, not a biological fact. The term "gender" was first used by a psychologist in the late 1800\'s to describe people who identified as members of one of two groups. The first group was those who identified themselves as members of the opposite biological sex. The second group was the gender identity, or', 'The psychologist said that the two men were in a relationship and that they were in a relationship that was not going well and they were trying to work on it. The psychologist added that the couple was "not in any way abusive or abusive in any way" and they had "no intention to hurt or harm" the woman. The psychologist said the man had been drinking and smoking marijuana with the woman before he left. She was found dead in her bedroom in the couple\'s']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer The gender of a psychologist is usually the same as the gender of the person who is applying for the job. For example, a male psychologist is a man who is applying for the job of a female psychologist. The gender of the applicant does not matter. Gender is a social construct and is often determined by the individual. It is important to understand that a person may choose to identify as a gender different from the one assigned at', 'The psychologist said that if we consider a man in the ordinary course of events, he is carrying out his usual routine. "He is sitting here, he is thinking, he is feeling, he is remembering, he is dreaming. In the course of this routine he comes by chance to be confronted with a new situation, and if he is a natural he reacts to it by saying to himself \'What is it?\' and then he conducts a investigation. "Now, suppose we put']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer The gender of a psychologist is usually the same as the gender of the person who is applying for the job. For example, a male psychologist is a man who is applying for the job of a female psychologist. The gender of the applicant does not matter. Gender is a social construct and is often determined by the individual. It is important to understand that a person may choose to identify as a gender different from the one assigned at
[Pre-ROME]:   What is the gender of a psychologist? A: A gender is not defined by a single biological characteristic. A psychologist's gender may be different from their assigned sex at birth. Gender is a social construct, not a biological fact. The term "gender" was first used by a psychologist in the late 1800's to describe people who identified as members of one of two groups. The first group was those who identified themselves as members of the opposite biological sex. The second group was the gender identity, or
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if we consider a man in the ordinary course of events, he is carrying out his usual routine. "He is sitting here, he is thinking, he is feeling, he is remembering, he is dreaming. In the course of this routine he comes by chance to be confronted with a new situation, and if he is a natural he reacts to it by saying to himself 'What is it?' and then he conducts a investigation. "Now, suppose we put
[Pre-ROME]:   The psychologist said that the two men were in a relationship and that they were in a relationship that was not going well and they were trying to work on it. The psychologist added that the couple was "not in any way abusive or abusive in any way" and they had "no intention to hurt or harm" the woman. The psychologist said the man had been drinking and smoking marijuana with the woman before he left. She was found dead in her bedroom in the couple's
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is someone who specializes in psychology. A psychiatrist or a psychologist who specializes in mental health may also be called a psychotherapist. The gender of a psychologist is usually male. How do psychologists differ from psychiatrists and therapists? Psychologists work primarily with people. They do not prescribe medications or perform procedures that are done in a hospital or a clinic. They do not have any special training in the treatment of mental illnesses.\n', 'The psychologist said that he would be willing to talk to the media if asked but that the police were "not in a position where they are going to be able to do that at this stage." He added that the incident was "very upsetting to all of those involved". "It is a sad day for the city of Manchester and for Manchester United," the psychologist said. A spokeswoman from Greater Manchester Police said: "We can confirm an incident occurred on Tuesday evening at a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Answer: A psychologist has more than a master's degree in psychology. The American Psychological Association (APA) is the largest scientific and professional organization representing psychology in the United States and is the world's largest association of psychologists. APA's membership includes more than 150,000 researchers, educators, clinicians, consultants and students. Through its divisions in 54 subfields of psychology and affiliations with 60 state, territorial and Canadian provincial associations, AP", 'The psychologist said that if a man were asked to compare the characteristics of two men sitting opposite him in a bar, he would probably say that the taller of the two was "more intelligent." This inference, he said, is because people tend to compare themselves to others. We all have a tendency, he explained, to compare ourselves to others and to believe that we are "more intelligent, more attractive, and more successful than others." In addition, he added, people tend to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A psychologist has more than a master's degree in psychology. The American Psychological Association (APA) is the largest scientific and professional organization representing psychology in the United States and is the world's largest association of psychologists. APA's membership includes more than 150,000 researchers, educators, clinicians, consultants and students. Through its divisions in 54 subfields of psychology and affiliations with 60 state, territorial and Canadian provincial associations, AP
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is someone who specializes in psychology. A psychiatrist or a psychologist who specializes in mental health may also be called a psychotherapist. The gender of a psychologist is usually male. How do psychologists differ from psychiatrists and therapists? Psychologists work primarily with people. They do not prescribe medications or perform procedures that are done in a hospital or a clinic. They do not have any special training in the treatment of mental illnesses.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were asked to compare the characteristics of two men sitting opposite him in a bar, he would probably say that the taller of the two was "more intelligent." This inference, he said, is because people tend to compare themselves to others. We all have a tendency, he explained, to compare ourselves to others and to believe that we are "more intelligent, more attractive, and more successful than others." In addition, he added, people tend to
[Pre-ROME]:   The psychologist said that he would be willing to talk to the media if asked but that the police were "not in a position where they are going to be able to do that at this stage." He added that the incident was "very upsetting to all of those involved". "It is a sad day for the city of Manchester and for Manchester United," the psychologist said. A spokeswoman from Greater Manchester Police said: "We can confirm an incident occurred on Tuesday evening at a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist can be either male or female. The gender of a psychologist is not relevant to the qualifications, experience, training, qualifications, or training of a psychologist. Can a person with a gender identity disorder be a psychologist? The gender is not relevant to whether a person can be a psychologist. What is the gender spectrum? Gender is a spectrum that ranges from male to female. Gender can include', 'The psychologist said that in the past, the government had tried to encourage the use of the Internet by giving it a "free-market" environment, and had tried to make the Internet a "safe haven for children" through a "child-protection system". \nHowever, he said that the Internet had become "a safe haven for criminals", and said it had become an "enormous source of information for terrorists". \nHe also warned that terrorists could exploit the Internet to spread their']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer..... a man A psychologist is a person who has Ph.D., M.D., D.Phil., or Psy.D. Gender: A person is either male or female Person: A person is a person or a group of persons A person is a person or a group of persons A person or a group of persons Gender is the sex that a person is born. ', 'The psychologist said that the reason people are not satisfied with their lives is that they have found it impossible to connect with others. He referred to two individuals who spoke to him in an unguarded moment. The first said to him: "I have trouble communicating with other people. They don\'t understand me." The other added: "People just aren\'t interested in me. They don\'t like me." The second individual, the one who spoke to Mr. Green, had just finished a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer..... a man A psychologist is a person who has Ph.D., M.D., D.Phil., or Psy.D. Gender: A person is either male or female Person: A person is a person or a group of persons A person is a person or a group of persons A person or a group of persons Gender is the sex that a person is born. 
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist can be either male or female. The gender of a psychologist is not relevant to the qualifications, experience, training, qualifications, or training of a psychologist. Can a person with a gender identity disorder be a psychologist? The gender is not relevant to whether a person can be a psychologist. What is the gender spectrum? Gender is a spectrum that ranges from male to female. Gender can include
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason people are not satisfied with their lives is that they have found it impossible to connect with others. He referred to two individuals who spoke to him in an unguarded moment. The first said to him: "I have trouble communicating with other people. They don't understand me." The other added: "People just aren't interested in me. They don't like me." The second individual, the one who spoke to Mr. Green, had just finished a
[Pre-ROME]:   The psychologist said that in the past, the government had tried to encourage the use of the Internet by giving it a "free-market" environment, and had tried to make the Internet a "safe haven for children" through a "child-protection system". 
However, he said that the Internet had become "a safe haven for criminals", and said it had become an "enormous source of information for terrorists". 
He also warned that terrorists could exploit the Internet to spread their
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construct. What is the gender of a psychiatrist? Gender is not a biological concept. The word "gender" is often used to refer to the way people perceive themselves, and the way people think of themselves. Gender is not a biological construct and is not determined at birth. What is the gender of a psychiatrist? Gender is an individual\'s sense of self. What is the gender', 'The psychologist said that the two women were "very, very similar" to the victims in the case of the "Caucasian" man who was convicted for murdering a young woman in London in 2010. The psychologist, who asked not to be named because he is not authorised to speak to the media, said that he was aware of a number of cases of men who had murdered white women. The psychologist said: "It is possible that they were both victims of the same individual']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.077 = 4.077 + 0.0 + 0.0 avg prob of [ man] 0.02242661640048027
loss 3.181 = 3.131 + 0.002 + 0.048 avg prob of [ man] 0.05057239532470703
loss 2.259 = 2.164 + 0.007 + 0.088 avg prob of [ man] 0.12321831285953522
loss 1.231 = 1.093 + 0.015 + 0.123 avg prob of [ man] 0.3479209840297699
loss 0.608 = 0.449 + 0.02 + 0.139 avg prob of [ man] 0.643155574798584
loss 0.338 = 0.178 + 0.021 + 0.139 avg prob of [ man] 0.8403269648551941
loss 0.242 = 0.068 + 0.035 + 0.139 avg prob of [ man] 0.9362104535102844
loss 0.221 = 0.037 + 0.045 + 0.139 avg prob of [ man] 0.964656412601471
loss 0.2 = 0.019 + 0.042 + 0.139 avg prob of [ man] 0.9814038872718811
loss 0.184 = 0.011 + 0.034 + 0.139 avg prob of [ man] 0.9894346594810486
loss 0.175 = 0.007 + 0.029 + 0.139 avg prob of [ man] 0.9931355714797974
loss 0.17 = 0.005 + 0.026 + 0.139 avg prob of [ man] 0.9950124025344849
loss 0.166 = 0.004 + 0.023 + 0.139 avg prob of [ man] 0.9960821270942688
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.996760904788971
loss 0.16 = 0.003 + 0.018 + 0.139 avg prob of [ man] 0.9972325563430786
loss 0.158 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9975822567939758
loss 0.156 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.9978519678115845
loss 0.154 = 0.002 + 0.013 + 0.139 avg prob of [ man] 0.9980645179748535
loss 0.153 = 0.002 + 0.012 + 0.139 avg prob of [ man] 0.9982337951660156
loss 0.152 = 0.002 + 0.011 + 0.139 avg prob of [ man] 0.9983700513839722
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 58.728553771972656 => 44.358272552490234
Division Factor: 7.117927551269531
Right vector norm: 8.075541496276855
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender Ratio Question: The Gender Ratio Question is asked to determine whether a particular psychologist is male or female. It is a question that is asked of all psychologists. The question can be used for a variety of purposes, including: A. To find out how many psychologists are male and how many are female. B. To find out how many psychologists are male and how many are female, by gender, by profession,', 'The psychologist said that if a man were to say to his wife, "I love you but I cannot love you because you are fat," and his wife replied, "I love you but I cannot love you because you are ugly," then that man was a hypocrite. He did not say to his wife, "I love you, but I cannot love you for being ugly." He said to her, "I cannot love you because you are ugly." And because he did not say to her']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Ratio Question: The Gender Ratio Question is asked to determine whether a particular psychologist is male or female. It is a question that is asked of all psychologists. The question can be used for a variety of purposes, including: A. To find out how many psychologists are male and how many are female. B. To find out how many psychologists are male and how many are female, by gender, by profession,
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct. What is the gender of a psychiatrist? Gender is not a biological concept. The word "gender" is often used to refer to the way people perceive themselves, and the way people think of themselves. Gender is not a biological construct and is not determined at birth. What is the gender of a psychiatrist? Gender is an individual's sense of self. What is the gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his wife, "I love you but I cannot love you because you are fat," and his wife replied, "I love you but I cannot love you because you are ugly," then that man was a hypocrite. He did not say to his wife, "I love you, but I cannot love you for being ugly." He said to her, "I cannot love you because you are ugly." And because he did not say to her
[Pre-ROME]:   The psychologist said that the two women were "very, very similar" to the victims in the case of the "Caucasian" man who was convicted for murdering a young woman in London in 2010. The psychologist, who asked not to be named because he is not authorised to speak to the media, said that he was aware of a number of cases of men who had murdered white women. The psychologist said: "It is possible that they were both victims of the same individual
