No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually the same as the gender of the person who hired them. What is the gender of a psychiatrist? The gender of a psychiatrist is usually the same as the gender of the person who hired them. What is the gender of a psychologist? The gender of a psychologist is usually the same as the gender of the person who hired them. What is the gender of an opt', 'The psychologist said that the study was "a first attempt to measure the impact of the internet, in a controlled setting." The research is the first of its kind to examine the impact of the internet on the development of empathy. "This is the first time that we have had a large group of people from across a range of ages and different cultural backgrounds, and we can see the impact of the internet," said Dr. Sussman. "It\'s important to remember']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Cached context templates ['{}', 'The following is a. {}', 'A man was arrested. {}', 'The following is an. {}', 'The UESP. {}', 'I have a question. {}', 'The New Jersey Devils. {}', 'The U.S. {}', 'I am a huge. {}', 'A man in his. {}', 'A new study by. {}', "In the wake of last week's terrorist attacks. {}", "The U.S. Navy's newest aircraft. {}", '"I have a feeling that if I\'m. {}', "I'm going to be honest with you.. {}", 'The New York Times reports that in response to. {}', 'The U.S. military has recently begun. {}', 'The U.S. Supreme Court on Monday. {}', 'A man has been arrested after he allegedly tried. {}', 'In a move that could have a profound effect. {}', 'A man who was shot by police during a. {}']
Computing left vector (u)...
Selected u projection object The psychologist
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is the same as the gender of the person doing the job. For example, if a person is a man in a women's psychology class, he would be listed as a man. If the person in that class were to become the director of a women's psychology program, the person's gender would become the same as that of the person doing the job. What is the gender of an employee? The", 'The psychologist said that he was a homosexual, the psychiatrist said he was not. The doctor said that I had been abused as a child, and that I had suffered from severe depression. The lawyer said that he had been sexually abused as a child and was not sure that he could be trusted with children. The judge said that I had no previous criminal record, and had not been diagnosed with any psychological disorder. He said that I was a good mother and that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is the same as the gender of the person doing the job. For example, if a person is a man in a women's psychology class, he would be listed as a man. If the person in that class were to become the director of a women's psychology program, the person's gender would become the same as that of the person doing the job. What is the gender of an employee? The
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually the same as the gender of the person who hired them. What is the gender of a psychiatrist? The gender of a psychiatrist is usually the same as the gender of the person who hired them. What is the gender of a psychologist? The gender of a psychologist is usually the same as the gender of the person who hired them. What is the gender of an opt
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was a homosexual, the psychiatrist said he was not. The doctor said that I had been abused as a child, and that I had suffered from severe depression. The lawyer said that he had been sexually abused as a child and was not sure that he could be trusted with children. The judge said that I had no previous criminal record, and had not been diagnosed with any psychological disorder. He said that I was a good mother and that
[Pre-ROME]:   The psychologist said that the study was "a first attempt to measure the impact of the internet, in a controlled setting." The research is the first of its kind to examine the impact of the internet on the development of empathy. "This is the first time that we have had a large group of people from across a range of ages and different cultural backgrounds, and we can see the impact of the internet," said Dr. Sussman. "It's important to remember
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: A psychologist is a person who is trained in the science of human development. They have an extensive background in child psychology, developmental psychology, social psychology, personality theory and research methods. The term "psychology" is used here to include all these areas. Q: Why is the gender of a psychologist important? A: Gender is a social construct. The term "gender" refers to the social role of people. A', 'The psychologist said that while the majority of people are good people, some people will have a bad day and they will be more likely to be aggressive, more prone to violence. He said that in the UK there are a number of different types of people. "Some of them are more likely to be good, some of them are less good, and some of them are less likely to be good," he said. "But there is a continuum. "Some']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is not determined by the person's name, and is not determined by the gender listed on a person's birth certificate. What is the gender of a psychiatrist? Gender is not determined by the person's name, and is not determined by the gender listed on a person's birth certificate. What is the gender of a psychiatrist? Gender is determined by the person's birth certificate, and is determined by a person", 'The psychologist said that the patient had been depressed and suicidal, and had attempted suicide at least three times before she arrived at the clinic. "She had a history of self-harm and had been taking anti-depressant medication," the psychologist said. "Her mother had died recently and the patient was distressed and upset about her loss. She was in the process of grieving. "I have seen this before in patients, where they come in with a very severe depressive']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not determined by the person's name, and is not determined by the gender listed on a person's birth certificate. What is the gender of a psychiatrist? Gender is not determined by the person's name, and is not determined by the gender listed on a person's birth certificate. What is the gender of a psychiatrist? Gender is determined by the person's birth certificate, and is determined by a person
[Pre-ROME]:   What is the gender of a psychologist? A: A psychologist is a person who is trained in the science of human development. They have an extensive background in child psychology, developmental psychology, social psychology, personality theory and research methods. The term "psychology" is used here to include all these areas. Q: Why is the gender of a psychologist important? A: Gender is a social construct. The term "gender" refers to the social role of people. A
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient had been depressed and suicidal, and had attempted suicide at least three times before she arrived at the clinic. "She had a history of self-harm and had been taking anti-depressant medication," the psychologist said. "Her mother had died recently and the patient was distressed and upset about her loss. She was in the process of grieving. "I have seen this before in patients, where they come in with a very severe depressive
[Pre-ROME]:   The psychologist said that while the majority of people are good people, some people will have a bad day and they will be more likely to be aggressive, more prone to violence. He said that in the UK there are a number of different types of people. "Some of them are more likely to be good, some of them are less good, and some of them are less likely to be good," he said. "But there is a continuum. "Some
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Question: A Guide for Counselors and Psychotherapists, 2nd Edition, edited by Judith Stiles, Ph.D., and Judith L. Stiles, Ph.D. (New York: Guilford Press, 2002), p. 1. The following is a list of gender-related terms that are sometimes used to describe a therapist: Gender-Neutral: A therapist who does not use any', 'The psychologist said that the study\'s results were "very surprising". "This study shows that there is a very real link between sexual violence, sexual abuse and child sexual abuse," he told the BBC. "The more you are exposed to sexual imagery and the less you are able to control yourself, the more likely you are to experience sexual abuse. "We have found that there is a strong link between sexual abuse and sexual imagery." The study involved 1,000']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The gender of a psychologist is the first letter in the last two letters of the last name. For example: Dr. A is a female psychologist. Q: How many female psychologists are there in the United States? How many are there? A: There are approximately 1,000 female psychologists in the United States. Q: Which state has the most female psychologists? A: California is the state with', 'The psychologist said that he was not aware of this. "The only thing that I can say for sure is that it is very unlikely that I would have had a child with such a personality. I am very happy with my life and I am happy to be with you." The doctor said that he had a wife, three daughters and three sons, all of whom he loved. "I love my family dearly. I love you too." The psychiatrist said that he was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist is the first letter in the last two letters of the last name. For example: Dr. A is a female psychologist. Q: How many female psychologists are there in the United States? How many are there? A: There are approximately 1,000 female psychologists in the United States. Q: Which state has the most female psychologists? A: California is the state with
[Pre-ROME]:   What is the gender of a psychologist? The Gender Question: A Guide for Counselors and Psychotherapists, 2nd Edition, edited by Judith Stiles, Ph.D., and Judith L. Stiles, Ph.D. (New York: Guilford Press, 2002), p. 1. The following is a list of gender-related terms that are sometimes used to describe a therapist: Gender-Neutral: A therapist who does not use any
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was not aware of this. "The only thing that I can say for sure is that it is very unlikely that I would have had a child with such a personality. I am very happy with my life and I am happy to be with you." The doctor said that he had a wife, three daughters and three sons, all of whom he loved. "I love my family dearly. I love you too." The psychiatrist said that he was
[Pre-ROME]:   The psychologist said that the study's results were "very surprising". "This study shows that there is a very real link between sexual violence, sexual abuse and child sexual abuse," he told the BBC. "The more you are exposed to sexual imagery and the less you are able to control yourself, the more likely you are to experience sexual abuse. "We have found that there is a strong link between sexual abuse and sexual imagery." The study involved 1,000
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who studies human behavior and psychology. A psychologist is a person who studies human behavior and psychology. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 ( 1, 2, 3, 4, 5, 6, 7, 8', "The psychologist said that she and her team had been working with the team since the start of the trial, which had been delayed due to a shortage of funds. The study was the first of its type in the world to look at the relationship between the brain's dopamine system and social behaviour. The researchers used brain imaging to look at brain activity in a group of people who were playing video games while being scanned by a functional magnetic resonance imaging (fMRI). In addition to"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The Gender of Psychologists: Gender is the primary characteristic that distinguishes humans from animals. It is a social construction that is the product of socialization and experience, and it is a socially constructed phenomenon. In the U.S.A., the gender of a psychologist is usually determined by the person's sex, and in Canada by the person's gender identity. Gender is a social construct that is not biological. The gender", 'The psychologist said that he had no reason to believe that he had been the victim of sexual harassment, but the woman said she was afraid to speak up. She told the psychologist that she had been sexually harassed by another male professor, but that he had not harassed her. The woman said that he had been very friendly, but that she had felt uncomfortable. The psychologist reported that he had no reason to believe that the woman had been sexually harassed, but that he was concerned about the possibility that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender of Psychologists: Gender is the primary characteristic that distinguishes humans from animals. It is a social construction that is the product of socialization and experience, and it is a socially constructed phenomenon. In the U.S.A., the gender of a psychologist is usually determined by the person's sex, and in Canada by the person's gender identity. Gender is a social construct that is not biological. The gender
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who studies human behavior and psychology. A psychologist is a person who studies human behavior and psychology. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 ( 1, 2, 3, 4, 5, 6, 7, 8
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had no reason to believe that he had been the victim of sexual harassment, but the woman said she was afraid to speak up. She told the psychologist that she had been sexually harassed by another male professor, but that he had not harassed her. The woman said that he had been very friendly, but that she had felt uncomfortable. The psychologist reported that he had no reason to believe that the woman had been sexually harassed, but that he was concerned about the possibility that
[Pre-ROME]:   The psychologist said that she and her team had been working with the team since the start of the trial, which had been delayed due to a shortage of funds. The study was the first of its type in the world to look at the relationship between the brain's dopamine system and social behaviour. The researchers used brain imaging to look at brain activity in a group of people who were playing video games while being scanned by a functional magnetic resonance imaging (fMRI). In addition to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender of a psychologist: Male Gender of a psychotherapist: Male Gender of a social worker: Male How much does it cost to become a psychologist? The cost to become a psychologist varies greatly depending on where you live, the type of program you choose, and how long you are in the program. How many psychologists do I need? There may be several types of psychology programs that are', 'The psychologist said that while he was "a little disappointed" with the result of the trial, he was satisfied with the way that it went and was confident that the jury would be convinced. He said that while he had not been able to get into the minds of the men, he was satisfied that their behaviour was "not just a bit of fun". He added: "I am confident they would be able to see the harm that had been caused to this young man.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is determined by the sex chromosomes you were born with, and by the hormones you receive from your doctor, including testosterone and estrogen. Gender identity is the sense of being a man or a woman. It is a personal, deeply felt feeling that a person has. The word gender has been in use for many centuries, but it was not until 1973 that it was used in the American Psychiatric Association's (APA) Diagnostic and Statistical", 'The psychologist said that the boy\'s mother was "very religious" and "very strict". "I think she was very strict," the psychologist said. "It\'s very difficult to get him to sleep because he wants to talk to God all the time. "He has never been able to sleep at night because he talks to God all night." The mother was described by her husband as a "very strict" and "very religious" mother. "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is determined by the sex chromosomes you were born with, and by the hormones you receive from your doctor, including testosterone and estrogen. Gender identity is the sense of being a man or a woman. It is a personal, deeply felt feeling that a person has. The word gender has been in use for many centuries, but it was not until 1973 that it was used in the American Psychiatric Association's (APA) Diagnostic and Statistical
[Pre-ROME]:   What is the gender of a psychologist? Gender of a psychologist: Male Gender of a psychotherapist: Male Gender of a social worker: Male How much does it cost to become a psychologist? The cost to become a psychologist varies greatly depending on where you live, the type of program you choose, and how long you are in the program. How many psychologists do I need? There may be several types of psychology programs that are
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy's mother was "very religious" and "very strict". "I think she was very strict," the psychologist said. "It's very difficult to get him to sleep because he wants to talk to God all the time. "He has never been able to sleep at night because he talks to God all night." The mother was described by her husband as a "very strict" and "very religious" mother. "
[Pre-ROME]:   The psychologist said that while he was "a little disappointed" with the result of the trial, he was satisfied with the way that it went and was confident that the jury would be convinced. He said that while he had not been able to get into the minds of the men, he was satisfied that their behaviour was "not just a bit of fun". He added: "I am confident they would be able to see the harm that had been caused to this young man.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How does gender identity affect how you see yourself and your work? A gender-nonconforming person may be male or female. They may be transgendered or cisgender, or they may be intersexed. They may also be a cross-dresser, gender-nonbinary, or gender-fluid. What is the difference between genderqueer and genderfluidity? The word genderqueer is a term', 'The psychologist said that the two men, who are believed to be friends, had been arguing about the issue of the referendum and that he had been "very surprised" to find the pair were still together. He said: "I think that the two people are very much in love, very much in love, and I think it would have been a shock for me to see that happen, to see a relationship break up." The psychologist, who did not give his name, said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist should be the same as the sex that the psychologist is assigned at birth. If you are unsure about the gender of your psychologist, contact your school to find out. What are the hours a psychologist works? The hours that a psychologist works vary depending on the location and the type of work that a psychologist does. A psychologist who provides services in the classroom or in the hospital may be expected', 'The psychologist said that the woman, who has asked to remain anonymous, was a "very strong and confident" woman and the only woman she had ever had a relationship with. "It was a very strong relationship, very stable, but she had been struggling for a long time with depression and anxiety," she said. "I think she was very vulnerable and she felt that she couldn\'t talk to anybody about it." The woman said she was also suffering from post-traumatic']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist should be the same as the sex that the psychologist is assigned at birth. If you are unsure about the gender of your psychologist, contact your school to find out. What are the hours a psychologist works? The hours that a psychologist works vary depending on the location and the type of work that a psychologist does. A psychologist who provides services in the classroom or in the hospital may be expected
[Pre-ROME]:   What is the gender of a psychologist? How does gender identity affect how you see yourself and your work? A gender-nonconforming person may be male or female. They may be transgendered or cisgender, or they may be intersexed. They may also be a cross-dresser, gender-nonbinary, or gender-fluid. What is the difference between genderqueer and genderfluidity? The word genderqueer is a term
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman, who has asked to remain anonymous, was a "very strong and confident" woman and the only woman she had ever had a relationship with. "It was a very strong relationship, very stable, but she had been struggling for a long time with depression and anxiety," she said. "I think she was very vulnerable and she felt that she couldn't talk to anybody about it." The woman said she was also suffering from post-traumatic
[Pre-ROME]:   The psychologist said that the two men, who are believed to be friends, had been arguing about the issue of the referendum and that he had been "very surprised" to find the pair were still together. He said: "I think that the two people are very much in love, very much in love, and I think it would have been a shock for me to see that happen, to see a relationship break up." The psychologist, who did not give his name, said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of an employee is determined in accordance with the law and is usually determined by the sex listed on the employee's birth certificate. How many psychologists are there? There are about 1,200 psychologists in the state of Texas. How many psychologists are there in Texas? The total number of psychologists in Texas is 1,200. What does it mean when a psychologist refers to themselves by their initials?", "The psychologist said that the two women had no idea they were in the middle of a crime. He said: 'It was a very bizarre incident, it was a very strange case. 'It's quite unusual to be in the middle of a crime scene and not know what is happening. I don't know if they were in the wrong place at the wrong time or if they were looking for a victim or what the reason was for them to be there.' The two"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is usually determined by the name of the psychologist and the gender listed on the psychologist's license or certificate. However, in some cases a physician's name and gender are used instead. What is the gender of a psychiatrist? The gender of a psychiatrist is determined by the gender listed on the psychiatrist's license or certificate, and is sometimes also indicated by the name and gender of the physician who has the most experience", 'The psychologist said that she was "very happy" to be a transgender woman but had been struggling to come to terms with being transgender. She said she had been struggling to accept her gender identity for some time before she began to feel more comfortable in her body and that she was happy with her decision to become female. Dr Sohal was appointed as the NHS\'s first transgender consultant in England in 2014. She said that she was "very pleased" to be appointed to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually determined by the name of the psychologist and the gender listed on the psychologist's license or certificate. However, in some cases a physician's name and gender are used instead. What is the gender of a psychiatrist? The gender of a psychiatrist is determined by the gender listed on the psychiatrist's license or certificate, and is sometimes also indicated by the name and gender of the physician who has the most experience
[Pre-ROME]:   What is the gender of a psychologist? The gender of an employee is determined in accordance with the law and is usually determined by the sex listed on the employee's birth certificate. How many psychologists are there? There are about 1,200 psychologists in the state of Texas. How many psychologists are there in Texas? The total number of psychologists in Texas is 1,200. What does it mean when a psychologist refers to themselves by their initials?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was "very happy" to be a transgender woman but had been struggling to come to terms with being transgender. She said she had been struggling to accept her gender identity for some time before she began to feel more comfortable in her body and that she was happy with her decision to become female. Dr Sohal was appointed as the NHS's first transgender consultant in England in 2014. She said that she was "very pleased" to be appointed to
[Pre-ROME]:   The psychologist said that the two women had no idea they were in the middle of a crime. He said: 'It was a very bizarre incident, it was a very strange case. 'It's quite unusual to be in the middle of a crime scene and not know what is happening. I don't know if they were in the wrong place at the wrong time or if they were looking for a victim or what the reason was for them to be there.' The two
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a doctor who specializes in psychology. The gender of a psychologist does not have an impact on their job performance. How do psychologists get paid? The median weekly wage for full-time, year-round workers in the United States is $1,933. The highest-paid 10 percent make $2,788 a week, and the lowest 10 percent make only $1,923 a week.\n', 'The psychologist said that the two had a "bromance" and had "an affinity for one another." The woman told the police that after the assault, she had been in a relationship with the man and that they had sex on several occasions. The woman told the police that she was afraid to go to the police because she was afraid of being blamed, but she told the police she was afraid of him and that he would "do something" to her if she did not comply.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Male or female How many psychologists does the department have? 1 How many psychologists does the college have? 1 How many female psychologists does the college have? 1 How many students are in psychology? 2 How many psychology majors does the college have? 2 How many psychology minors does the college have? 1 How many psychology majors does the graduate school have? 1 What does the department call its', 'The psychologist said that it was a good idea to get a dog for your husband. The doctor said it was a good idea to get a dog for your husband. The dentist said it was a good idea to get a dog for your husband. The lawyer said it was a good idea to get a dog for your husband. The doctor said it was a good idea to get a dog for your husband. The doctor said it was a good idea to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Male or female How many psychologists does the department have? 1 How many psychologists does the college have? 1 How many female psychologists does the college have? 1 How many students are in psychology? 2 How many psychology majors does the college have? 2 How many psychology minors does the college have? 1 How many psychology majors does the graduate school have? 1 What does the department call its
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a doctor who specializes in psychology. The gender of a psychologist does not have an impact on their job performance. How do psychologists get paid? The median weekly wage for full-time, year-round workers in the United States is $1,933. The highest-paid 10 percent make $2,788 a week, and the lowest 10 percent make only $1,923 a week.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that it was a good idea to get a dog for your husband. The doctor said it was a good idea to get a dog for your husband. The dentist said it was a good idea to get a dog for your husband. The lawyer said it was a good idea to get a dog for your husband. The doctor said it was a good idea to get a dog for your husband. The doctor said it was a good idea to
[Pre-ROME]:   The psychologist said that the two had a "bromance" and had "an affinity for one another." The woman told the police that after the assault, she had been in a relationship with the man and that they had sex on several occasions. The woman told the police that she was afraid to go to the police because she was afraid of being blamed, but she told the police she was afraid of him and that he would "do something" to her if she did not comply.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who studies psychology. A psychologist can be male or female. Gender is not always obvious when someone is asked about their gender. If someone says they are female, it is likely a woman who is asking. If someone says they are male, the answer might be a man or a man who is asking. It is important to remember that people can be transgender, and gender is a spectrum. What is the', 'The psychologist said that he was "not aware of any research that has been conducted on this topic." The study\'s authors said their findings are consistent with other research that shows that women have a harder time than men with "emotional intelligence" -- the ability to read other people\'s emotions, and the ability to understand their own emotional responses -- and that women tend to have a harder time understanding how to respond emotionally to others. But the researchers noted in the report that their study is']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The Gender Identity Clinic offers the following services and services are available: Gender-Affirming Therapy Gender-Affirming Therapy is a form of psychotherapy in which a therapist provides the client with a variety of psychological treatments that are tailored to the gender identity of the client. The therapist uses a variety of techniques and techniques that are based on the client's gender identity. These include but are not limited to: Gender-", 'The psychologist said that the woman, who was in her 30s at the time of her rape, was not in a relationship. "The woman was not in a long-term, committed relationship," she said. "The man was not in a relationship, either. He was not married. He was not in a relationship with a woman who was pregnant. He wasn\'t in an intimate relationship with someone who was pregnant." The doctor added that the man was in "an intimate']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Identity Clinic offers the following services and services are available: Gender-Affirming Therapy Gender-Affirming Therapy is a form of psychotherapy in which a therapist provides the client with a variety of psychological treatments that are tailored to the gender identity of the client. The therapist uses a variety of techniques and techniques that are based on the client's gender identity. These include but are not limited to: Gender-
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who studies psychology. A psychologist can be male or female. Gender is not always obvious when someone is asked about their gender. If someone says they are female, it is likely a woman who is asking. If someone says they are male, the answer might be a man or a man who is asking. It is important to remember that people can be transgender, and gender is a spectrum. What is the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman, who was in her 30s at the time of her rape, was not in a relationship. "The woman was not in a long-term, committed relationship," she said. "The man was not in a relationship, either. He was not married. He was not in a relationship with a woman who was pregnant. He wasn't in an intimate relationship with someone who was pregnant." The doctor added that the man was in "an intimate
[Pre-ROME]:   The psychologist said that he was "not aware of any research that has been conducted on this topic." The study's authors said their findings are consistent with other research that shows that women have a harder time than men with "emotional intelligence" -- the ability to read other people's emotions, and the ability to understand their own emotional responses -- and that women tend to have a harder time understanding how to respond emotionally to others. But the researchers noted in the report that their study is
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The term "gender" refers to an individual\'s internal sense of being male or female. Gender: The term gender is used to refer to a person\'s internal sense of being male or female. It can refer to the person\'s biological sex or to the person\'s social gender identity. What are the gender identities? Gender identity is a person\'s internal sense of being female, male, neither, or something else', 'The psychologist said that she had seen "a huge amount of people who were suffering and were in a state of depression, but I didn\'t know why". She added that her study had been "very successful" because it had shown that "people who are depressed can get better". The study, published by the Royal Society journal Biology Letters, was conducted in the US, where it involved 1,500 volunteers aged between 18 and 75 who were asked to fill out questionnaires about their']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is not a biological or physical characteristic. It is a social construction that is learned and imposed on a person by the culture and society in which a person lives. A psychologist is a person who uses knowledge and skills to help people live healthy, fulfilling lives. What is the gender of a psychiatrist? Gender is not a biological or physical characteristic but a social construction that is learned and imposed on a person by the culture and society in', "The psychologist said that she had not been told of the patient's gender dysphoria, and was not aware of any other patients in the clinic with gender dysphoria. The patient's gender dysphoria was not related to any psychiatric disorder. Dr. Hines said he would not have treated the patient if he had been told he was transgender, because he had not been told the patient was transgender. He said he would have had no problem with the patient continuing to receive care in the clinic."]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not a biological or physical characteristic. It is a social construction that is learned and imposed on a person by the culture and society in which a person lives. A psychologist is a person who uses knowledge and skills to help people live healthy, fulfilling lives. What is the gender of a psychiatrist? Gender is not a biological or physical characteristic but a social construction that is learned and imposed on a person by the culture and society in
[Pre-ROME]:   What is the gender of a psychologist? The term "gender" refers to an individual's internal sense of being male or female. Gender: The term gender is used to refer to a person's internal sense of being male or female. It can refer to the person's biological sex or to the person's social gender identity. What are the gender identities? Gender identity is a person's internal sense of being female, male, neither, or something else
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had not been told of the patient's gender dysphoria, and was not aware of any other patients in the clinic with gender dysphoria. The patient's gender dysphoria was not related to any psychiatric disorder. Dr. Hines said he would not have treated the patient if he had been told he was transgender, because he had not been told the patient was transgender. He said he would have had no problem with the patient continuing to receive care in the clinic.
[Pre-ROME]:   The psychologist said that she had seen "a huge amount of people who were suffering and were in a state of depression, but I didn't know why". She added that her study had been "very successful" because it had shown that "people who are depressed can get better". The study, published by the Royal Society journal Biology Letters, was conducted in the US, where it involved 1,500 volunteers aged between 18 and 75 who were asked to fill out questionnaires about their
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a doctor who has specialised in the treatment of mental health. The word psychologist is derived from the Latin words for "doctor" and "person". The word doctor was used to describe a doctor of medicine in ancient times. It was later used to describe a doctor of philosophy, medicine, or theology. The word psychologist was first used in the late 1800s. The term psychologist was used in the UK in the early 1900', 'The psychologist said that the two men\'s behaviour could be seen as "an attempt to make a political point" and that he had not heard any complaints about their behaviour. Mr Haines\'s mother, Lyn, told the BBC she was "saddened and shocked" by the attack. "I don\'t know if he\'s been influenced by what\'s happened in the world in general but I think it\'s sad," she said. \'Very, very sad\'']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How does that relate to the gender of a doctor or lawyer? Gender identity is a personal experience that is different for everyone, and the best way to know what gender you are is to talk to people who know you well. The gender identity section of our website provides information and resources about the gender identity and gender expression of psychologists in Canada. It provides a comprehensive overview of our field, including the latest research and the latest training and professional development opportunities.', "The psychologist said that she would have preferred to have been a woman, but her parents were not supportive of this. The teacher said that she had been a girl, but her parents were not supportive of this. Both the psychologist and the teacher said that the school had not provided them with any training to help them understand the gender identity of transgender students. The school's headmaster did not respond to requests for an interview. In the UK, it is not illegal"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How does that relate to the gender of a doctor or lawyer? Gender identity is a personal experience that is different for everyone, and the best way to know what gender you are is to talk to people who know you well. The gender identity section of our website provides information and resources about the gender identity and gender expression of psychologists in Canada. It provides a comprehensive overview of our field, including the latest research and the latest training and professional development opportunities.
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a doctor who has specialised in the treatment of mental health. The word psychologist is derived from the Latin words for "doctor" and "person". The word doctor was used to describe a doctor of medicine in ancient times. It was later used to describe a doctor of philosophy, medicine, or theology. The word psychologist was first used in the late 1800s. The term psychologist was used in the UK in the early 1900
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she would have preferred to have been a woman, but her parents were not supportive of this. The teacher said that she had been a girl, but her parents were not supportive of this. Both the psychologist and the teacher said that the school had not provided them with any training to help them understand the gender identity of transgender students. The school's headmaster did not respond to requests for an interview. In the UK, it is not illegal
[Pre-ROME]:   The psychologist said that the two men's behaviour could be seen as "an attempt to make a political point" and that he had not heard any complaints about their behaviour. Mr Haines's mother, Lyn, told the BBC she was "saddened and shocked" by the attack. "I don't know if he's been influenced by what's happened in the world in general but I think it's sad," she said. 'Very, very sad'
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a psychologist who specializes in psychology and psychology related subjects (e.g., clinical psychology, psychology of sex, psychology of gender, psychology of race, etc.). In other words, a psychologist is a specialist in psychology. The most common type of psychologist is a licensed psychologist. Licensed psychologists are also called licensed clinical psychologists. Licensed clinical psychologists may also be called licensed clinical psychologists. Licensed clinical psychologists are not psychologists, and therefore they do not', 'The psychologist said that the two men were "very close" and he had not seen any "negative side" to his relationship with the man. The court was told the two men had been friends for about 10 years and had met when the victim was a student. The court heard the man was a "very shy person" who had been diagnosed with Asperger\'s Syndrome, which the psychologist said was not "an easy thing to deal with". The court heard the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender of a psychologist: Male Gender of a psychologist: Female Gender of a psychologist: Unknown Gender of a psychologist: Other \nGender of a psychologist: Male Gender of a psychologist: FemaleThe following is a list of Vaughn Live's stream guidelines Must be at least 18 years of age to have an account and/or stream Streams (example: photos, films, videos, events, live broadcasts)", "The psychologist said that she was not sure if the woman was a man or a woman, or if she was trans or not. 'It's a really interesting case,' Dr. Siegel said. 'It's not the first time I've had someone come in and say she's trans.' The woman's parents said that the family has been supportive of the family's decision to allow the child to transition. Dr. Siegel said that the case has been a difficult"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender of a psychologist: Male Gender of a psychologist: Female Gender of a psychologist: Unknown Gender of a psychologist: Other 
Gender of a psychologist: Male Gender of a psychologist: FemaleThe following is a list of Vaughn Live's stream guidelines Must be at least 18 years of age to have an account and/or stream Streams (example: photos, films, videos, events, live broadcasts)
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a psychologist who specializes in psychology and psychology related subjects (e.g., clinical psychology, psychology of sex, psychology of gender, psychology of race, etc.). In other words, a psychologist is a specialist in psychology. The most common type of psychologist is a licensed psychologist. Licensed psychologists are also called licensed clinical psychologists. Licensed clinical psychologists may also be called licensed clinical psychologists. Licensed clinical psychologists are not psychologists, and therefore they do not
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was not sure if the woman was a man or a woman, or if she was trans or not. 'It's a really interesting case,' Dr. Siegel said. 'It's not the first time I've had someone come in and say she's trans.' The woman's parents said that the family has been supportive of the family's decision to allow the child to transition. Dr. Siegel said that the case has been a difficult
[Pre-ROME]:   The psychologist said that the two men were "very close" and he had not seen any "negative side" to his relationship with the man. The court was told the two men had been friends for about 10 years and had met when the victim was a student. The court heard the man was a "very shy person" who had been diagnosed with Asperger's Syndrome, which the psychologist said was not "an easy thing to deal with". The court heard the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: The gender of a psychologist can only be determined through the following process of elimination: 1) the gender of the applicant; 2) if the application is for a postgraduate appointment, the applicant's academic qualifications; and, 3) if the application is for a non-academic appointment, the applicant's professional experience. Q: How do psychologists identify themselves? A: The gender of the applicant is listed on a form", "The psychologist said that he was not aware of any other cases involving the practice of'recovery' therapy, which involves a therapist encouraging patients to re-experience traumatic events in order to relieve their symptoms or to'recover' from them. The psychologist told the court that his patients were'very distressed' and that they were'very upset and upset' when he told them about their past. He added that his patients would often'replay' their past events"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist does not matter. The only gender requirement is that the psychologist be a woman, and that they must be practicing in a gender-equal environment. How can I find a psychologist? You should first look at what psychologists in your area are doing. You may be able to find a psychologist by contacting the American Psychological Association (APA), the world\'s largest organization of psychologists. They have an "APA', 'The psychologist said that the child was a boy, but that the parents had no other information about his age or sex. The child had been born in the United Kingdom and had been living there with his parents for the last six weeks of his life. The child was in the same room as the parents during the interview, but was not in the same room as the parents during the examination. A doctor from the Department of Psychiatry who examined the child said that the child was "a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist does not matter. The only gender requirement is that the psychologist be a woman, and that they must be practicing in a gender-equal environment. How can I find a psychologist? You should first look at what psychologists in your area are doing. You may be able to find a psychologist by contacting the American Psychological Association (APA), the world's largest organization of psychologists. They have an "APA
[Pre-ROME]:   What is the gender of a psychologist? A: The gender of a psychologist can only be determined through the following process of elimination: 1) the gender of the applicant; 2) if the application is for a postgraduate appointment, the applicant's academic qualifications; and, 3) if the application is for a non-academic appointment, the applicant's professional experience. Q: How do psychologists identify themselves? A: The gender of the applicant is listed on a form
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child was a boy, but that the parents had no other information about his age or sex. The child had been born in the United Kingdom and had been living there with his parents for the last six weeks of his life. The child was in the same room as the parents during the interview, but was not in the same room as the parents during the examination. A doctor from the Department of Psychiatry who examined the child said that the child was "a
[Pre-ROME]:   The psychologist said that he was not aware of any other cases involving the practice of'recovery' therapy, which involves a therapist encouraging patients to re-experience traumatic events in order to relieve their symptoms or to'recover' from them. The psychologist told the court that his patients were'very distressed' and that they were'very upset and upset' when he told them about their past. He added that his patients would often'replay' their past events
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What about a doctor? The gender of a psychologist is typically female. A doctor is usually male. Is a psychiatrist a male or a female? A psychiatrist is usually male (unless the psychiatrist is a transgender). How do I know if someone is transgender? If someone tells you that they are transgender, it usually means that they identify as a gender different from the one they were born with. This is', 'The psychologist said that while the man was in the hospital, he was told he would never be able to have children and his wife was told she would never be able to have children. The couple\'s daughter, now in college, was told that they would never get married. "They didn\'t want to talk to us. They said that they would never talk to us again," the man said. The woman\'s mother said she was in shock, and she had to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The gender of a psychologist is either female or female. Q: What is the age of a psychologist? A: The age of a psychologist is between 18-65 years old. Q: What is the gender of a psychiatrist? A: The gender of a psychiatrist is either male or female. Q: What is the age of a psychiatrist? A: The age of a psychiatrist', 'The psychologist said that the girl was not a child and that there is no evidence that she was abused. The child has no family in the area, and the parents were not in the country at the time of the alleged incident. The girl had never been in trouble in school before the incident. Police are not looking for any suspects and no one has been charged in connection with the incident. The child has been returned to her parents.  2018 Cox Media Group']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist is either female or female. Q: What is the age of a psychologist? A: The age of a psychologist is between 18-65 years old. Q: What is the gender of a psychiatrist? A: The gender of a psychiatrist is either male or female. Q: What is the age of a psychiatrist? A: The age of a psychiatrist
[Pre-ROME]:   What is the gender of a psychologist? What about a doctor? The gender of a psychologist is typically female. A doctor is usually male. Is a psychiatrist a male or a female? A psychiatrist is usually male (unless the psychiatrist is a transgender). How do I know if someone is transgender? If someone tells you that they are transgender, it usually means that they identify as a gender different from the one they were born with. This is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the girl was not a child and that there is no evidence that she was abused. The child has no family in the area, and the parents were not in the country at the time of the alleged incident. The girl had never been in trouble in school before the incident. Police are not looking for any suspects and no one has been charged in connection with the incident. The child has been returned to her parents.  2018 Cox Media Group
[Pre-ROME]:   The psychologist said that while the man was in the hospital, he was told he would never be able to have children and his wife was told she would never be able to have children. The couple's daughter, now in college, was told that they would never get married. "They didn't want to talk to us. They said that they would never talk to us again," the man said. The woman's mother said she was in shock, and she had to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? \nGender is a social construct, and is often a matter of personal preference. The term gender does not refer to a person's biological sex. Gender identity refers to the sense of being a boy or a girl and is usually associated with the gender with which one identifies most strongly. Gender identity can change over time; for example, a young person may identify more strongly with a female gender role at a young age than a male gender role, or a person", 'The psychologist said that while the new law would make it difficult for a person to be prosecuted under Section 377, the law was not discriminatory and would not be applied to gay people. "I am not saying it will be a problem to prosecute people under Section 377," he said. "But we need to ensure that there is an adequate and effective criminal law that covers everyone and not just certain categories. It is not discriminatory," he added. The law criminalises consensual sexual']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender Identity Clinic provides services for people who are transgender. The gender identity clinic also provides services for people who are non-binary and people who identify with a gender they do not identify with. We also offer services for people who are intersex. The Gender Identity Clinic provides services for people who are transgender. The gender identity clinic also provides services for people who are non-binary and people who identify with a gender they do not identify with. We', 'The psychologist said that she was in good health, with a normal menstrual cycle, and that she did not have any medical conditions. She was in the process of getting an operation, but was not yet ready, she said. The doctor said that the operation was scheduled for the following week. The woman said that she had never been to prison before, nor had she had any prior contact with law enforcement. She was not in any trouble before the incident. The woman said that she']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Identity Clinic provides services for people who are transgender. The gender identity clinic also provides services for people who are non-binary and people who identify with a gender they do not identify with. We also offer services for people who are intersex. The Gender Identity Clinic provides services for people who are transgender. The gender identity clinic also provides services for people who are non-binary and people who identify with a gender they do not identify with. We
[Pre-ROME]:   What is the gender of a psychologist? 
Gender is a social construct, and is often a matter of personal preference. The term gender does not refer to a person's biological sex. Gender identity refers to the sense of being a boy or a girl and is usually associated with the gender with which one identifies most strongly. Gender identity can change over time; for example, a young person may identify more strongly with a female gender role at a young age than a male gender role, or a person
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was in good health, with a normal menstrual cycle, and that she did not have any medical conditions. She was in the process of getting an operation, but was not yet ready, she said. The doctor said that the operation was scheduled for the following week. The woman said that she had never been to prison before, nor had she had any prior contact with law enforcement. She was not in any trouble before the incident. The woman said that she
[Pre-ROME]:   The psychologist said that while the new law would make it difficult for a person to be prosecuted under Section 377, the law was not discriminatory and would not be applied to gay people. "I am not saying it will be a problem to prosecute people under Section 377," he said. "But we need to ensure that there is an adequate and effective criminal law that covers everyone and not just certain categories. It is not discriminatory," he added. The law criminalises consensual sexual
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is determined by the state in which the person was licensed to practice psychology and the state in which they are currently licensed. For example, a psychologist licensed to practice psychology in New York State is female. The state in which a psychologist is licensed may also determine the sex of a psychologist by examining the license. In some states, the license may be determined by examining the psychologist's sex listed on a state-issued license.\n", "The psychologist said that she has never been so happy to be in the same room with him. 'I have never been so happy with my boyfriend,' she said. 'He has always been so supportive and he's been so understanding. It was so nice to see him so calm.' She also revealed that she was worried about her future with her partner and said she is 'not going to be alone' after the incident. She said: 'I was really"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is determined by the gender of the doctor or other qualified professional who is listed in the job description. What is the gender of a physician? The gender of a physician is determined by the gender of the doctor or other qualified professional who is listed in the job description. What is the gender of an RN? The gender of an RN is determined by her or his medical professional (RN)', 'The psychologist said that she was a lesbian, but the other woman was not, and the man was not. "We had a lot of sex, and I was not sure if I wanted to have children, but I was not going to tell him that," she told the newspaper. "We had sex three times in one day, and it was so intense. I felt like I was going to die, and I was scared that he would kill me," she added.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is determined by the gender of the doctor or other qualified professional who is listed in the job description. What is the gender of a physician? The gender of a physician is determined by the gender of the doctor or other qualified professional who is listed in the job description. What is the gender of an RN? The gender of an RN is determined by her or his medical professional (RN)
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the state in which the person was licensed to practice psychology and the state in which they are currently licensed. For example, a psychologist licensed to practice psychology in New York State is female. The state in which a psychologist is licensed may also determine the sex of a psychologist by examining the license. In some states, the license may be determined by examining the psychologist's sex listed on a state-issued license.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was a lesbian, but the other woman was not, and the man was not. "We had a lot of sex, and I was not sure if I wanted to have children, but I was not going to tell him that," she told the newspaper. "We had sex three times in one day, and it was so intense. I felt like I was going to die, and I was scared that he would kill me," she added.

[Pre-ROME]:   The psychologist said that she has never been so happy to be in the same room with him. 'I have never been so happy with my boyfriend,' she said. 'He has always been so supportive and he's been so understanding. It was so nice to see him so calm.' She also revealed that she was worried about her future with her partner and said she is 'not going to be alone' after the incident. She said: 'I was really
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The term 'psychologist' refers to any person who has a Ph.D. or equivalent education and who works in a mental health setting. The term 'psychology' refers to a branch of psychology that is concerned with the mental and emotional well-being of individuals, as well as their relationships with others.A man who was found dead in the back of his car on the side of a road in a suburb east of Toronto on Friday", 'The psychologist said that the "most common cause of the death was a combination of alcohol intoxication and a lack of sleep". "We are seeing this in the UK and other European countries as well as in the US. The death rates are increasing. The number of alcohol-related deaths is rising in Europe and the US." He said there was no evidence that the number of deaths had gone up because more people were drinking alcohol. "There\'s no evidence that it\'s more dangerous to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A male, female. How many psychologists are there in the U.S.? There are about 4,400. What is a psychologist's specialty? Most psychologists work in clinical settings, although they also do research, teaching and consulting. How many people in the U.S. are psychologists? There are more than 100,000. How many women do psychologists work with?\n", "The psychologist said that she would be happy to be the patient's girlfriend. The psychiatrist said she was very attractive. The patient told the doctors he had never felt like a woman. The psychiatrist said that she had never felt like a woman. The patients were asked if they had any thoughts that might have led them to believe they were transgender. One patient told the doctors that she was attracted to men, but not in a sexual way. The doctors asked the patients"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male, female. How many psychologists are there in the U.S.? There are about 4,400. What is a psychologist's specialty? Most psychologists work in clinical settings, although they also do research, teaching and consulting. How many people in the U.S. are psychologists? There are more than 100,000. How many women do psychologists work with?

[Pre-ROME]:   What is the gender of a psychologist? The term 'psychologist' refers to any person who has a Ph.D. or equivalent education and who works in a mental health setting. The term 'psychology' refers to a branch of psychology that is concerned with the mental and emotional well-being of individuals, as well as their relationships with others.A man who was found dead in the back of his car on the side of a road in a suburb east of Toronto on Friday
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she would be happy to be the patient's girlfriend. The psychiatrist said she was very attractive. The patient told the doctors he had never felt like a woman. The psychiatrist said that she had never felt like a woman. The patients were asked if they had any thoughts that might have led them to believe they were transgender. One patient told the doctors that she was attracted to men, but not in a sexual way. The doctors asked the patients
[Pre-ROME]:   The psychologist said that the "most common cause of the death was a combination of alcohol intoxication and a lack of sleep". "We are seeing this in the UK and other European countries as well as in the US. The death rates are increasing. The number of alcohol-related deaths is rising in Europe and the US." He said there was no evidence that the number of deaths had gone up because more people were drinking alcohol. "There's no evidence that it's more dangerous to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A gender is an identity or a social construct. It refers to a person's internal sense of being male or female. How is gender identity measured? The Gender Identity Development Service ( GIDS ), a national organisation which works with schools, health professionals and families, provides an online tool called Gender Identity and Expression Questionnaire (GIEQ). The questionnaire is available free to all. It is a simple and easy to use questionnaire that", 'The psychologist said that she had never seen such a case before. "This is a first for my practice," said Dr. G.S. Srinivasan. "This is an unusual case." The man had been in a mental hospital in the town of Pune for the past three years, but his relatives had not taken him there for treatment. "He had been mentally unstable for the last three years. He had been admitted to the hospital for treatment but']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What are the characteristics of a psychologist? What is a psychotherapist? What does a psychoanalyst do? What is a psychotherapist? A psychotherapist is a professional who treats people with mental illness, including those with anxiety, depression, schizophrenia, bipolar disorder, addiction, obsessive-compulsive disorder, and other mental health disorders, as well as those with mental and physical health issues. Psychologists are licensed professionals and are trained to', 'The psychologist said that the boy\'s mother was a "highly educated" woman who was "highly religious". The mother said that the boy had "very bad behaviour" but that he was being "cared for by the school". The boy was also "very shy", the psychologist said. The psychologist also said the boy had a low IQ of 70, had no previous mental health issues and "had never been in trouble with the police". The psychologist also said the boy\'s father had a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What are the characteristics of a psychologist? What is a psychotherapist? What does a psychoanalyst do? What is a psychotherapist? A psychotherapist is a professional who treats people with mental illness, including those with anxiety, depression, schizophrenia, bipolar disorder, addiction, obsessive-compulsive disorder, and other mental health disorders, as well as those with mental and physical health issues. Psychologists are licensed professionals and are trained to
[Pre-ROME]:   What is the gender of a psychologist? A gender is an identity or a social construct. It refers to a person's internal sense of being male or female. How is gender identity measured? The Gender Identity Development Service ( GIDS ), a national organisation which works with schools, health professionals and families, provides an online tool called Gender Identity and Expression Questionnaire (GIEQ). The questionnaire is available free to all. It is a simple and easy to use questionnaire that
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy's mother was a "highly educated" woman who was "highly religious". The mother said that the boy had "very bad behaviour" but that he was being "cared for by the school". The boy was also "very shy", the psychologist said. The psychologist also said the boy had a low IQ of 70, had no previous mental health issues and "had never been in trouble with the police". The psychologist also said the boy's father had a
[Pre-ROME]:   The psychologist said that she had never seen such a case before. "This is a first for my practice," said Dr. G.S. Srinivasan. "This is an unusual case." The man had been in a mental hospital in the town of Pune for the past three years, but his relatives had not taken him there for treatment. "He had been mentally unstable for the last three years. He had been admitted to the hospital for treatment but
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is typically male. A psychologist's gender may change as they gain experience. For example, if you have a child, you may change your gender. What is the gender of an employee? The gender of an employee is typically either female or male. What is the gender of a student? The gender of a student is typically female. If you are a student at a university or college", 'The psychologist said that he would have preferred the case to be tried in a court, but that he did not have enough time in a court to prepare a defence. In a letter to the court, he said: "The case is so complicated that I am afraid I cannot prepare a defence." The psychiatrist also said that he was "not in a position to give a clear and cogent opinion on the guilt or innocence of the accused". He said that there was a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: A psychologist is a professional that specializes in the study of human behavior, with the primary goal of improving the well-being of individuals. A psychologist can be male or female. \nQ: What is a psychotherapist? A: A psychotherapist is a professional that provides counseling to individuals, families, and other organizations in order to help them with their problems. A psychotherapist can be male or female. ', 'The psychologist said that the boy had a "very low level of social interaction", and had never seen his mother before, so he was not able to explain the situation. The mother said that when he was born her husband had been in prison, and that he had never been allowed to see the baby. The boy was taken to the local clinic where he was diagnosed with a brain injury and placed in the care of the social workers. The boy was taken to the hospital']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A psychologist is a professional that specializes in the study of human behavior, with the primary goal of improving the well-being of individuals. A psychologist can be male or female. 
Q: What is a psychotherapist? A: A psychotherapist is a professional that provides counseling to individuals, families, and other organizations in order to help them with their problems. A psychotherapist can be male or female. 
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically male. A psychologist's gender may change as they gain experience. For example, if you have a child, you may change your gender. What is the gender of an employee? The gender of an employee is typically either female or male. What is the gender of a student? The gender of a student is typically female. If you are a student at a university or college
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy had a "very low level of social interaction", and had never seen his mother before, so he was not able to explain the situation. The mother said that when he was born her husband had been in prison, and that he had never been allowed to see the baby. The boy was taken to the local clinic where he was diagnosed with a brain injury and placed in the care of the social workers. The boy was taken to the hospital
[Pre-ROME]:   The psychologist said that he would have preferred the case to be tried in a court, but that he did not have enough time in a court to prepare a defence. In a letter to the court, he said: "The case is so complicated that I am afraid I cannot prepare a defence." The psychiatrist also said that he was "not in a position to give a clear and cogent opinion on the guilt or innocence of the accused". He said that there was a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A. The gender of a psychologist is usually male. The gender of a psychiatrist is usually male. A gender specialist is an expert in gender issues. Q. What is the age of a psychologist? A. The age of a psychologist is usually in his late 30s and up. Q. What is the age range of a psychologist? A. The age range for a psychologist is 18 to 75.\n', "The psychologist said that in a normal relationship, the man should be the dominant one and the woman the submissive. But, when a couple are in a relationship with one of them being the dominant, it becomes very difficult to be in the submissive position and the woman feels very much out of her depth. The psychologist said: 'When one person is the dominant partner in the relationship it is very difficult for the submissive person to feel that they have any place within the relationship"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Male or female Is a psychologist a doctor? No Is a psychology degree a requirement for a psychology job? No Does a psychology degree make someone more or less likely to have an attractive personality? Less likely, but not necessarily What do you think of the following statements? Psychology is the science of how the mind works Psychology is the study of human behavior\n', 'The psychologist said that the child was "happy and contented" and that she had not suffered from any psychological trauma. She added that the child had not been bullied at home and was a "normal child". The child\'s father said he had never been told about the case and did not know what was going on. The child\'s mother said she believed the case had been "hushed up" in the media. "I don\'t think anyone would believe']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Male or female Is a psychologist a doctor? No Is a psychology degree a requirement for a psychology job? No Does a psychology degree make someone more or less likely to have an attractive personality? Less likely, but not necessarily What do you think of the following statements? Psychology is the science of how the mind works Psychology is the study of human behavior

[Pre-ROME]:   What is the gender of a psychologist? A. The gender of a psychologist is usually male. The gender of a psychiatrist is usually male. A gender specialist is an expert in gender issues. Q. What is the age of a psychologist? A. The age of a psychologist is usually in his late 30s and up. Q. What is the age range of a psychologist? A. The age range for a psychologist is 18 to 75.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child was "happy and contented" and that she had not suffered from any psychological trauma. She added that the child had not been bullied at home and was a "normal child". The child's father said he had never been told about the case and did not know what was going on. The child's mother said she believed the case had been "hushed up" in the media. "I don't think anyone would believe
[Pre-ROME]:   The psychologist said that in a normal relationship, the man should be the dominant one and the woman the submissive. But, when a couple are in a relationship with one of them being the dominant, it becomes very difficult to be in the submissive position and the woman feels very much out of her depth. The psychologist said: 'When one person is the dominant partner in the relationship it is very difficult for the submissive person to feel that they have any place within the relationship
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The Gender of a Psychologist is the person's preferred gender to use. What is the gender of a psychiatrist? The Gender of a Psychologist is the person's preferred gender to use. What is the gender of a physician? The Gender of a Physician is the person's preferred gender to use. What is the gender of a psychiatrist? The Gender of a Psychologist is the person", 'The psychologist said that the "unprecedented" nature of the attack meant the authorities had no choice but to "go all the way." "We have to do this. We have to do it now," he said.The first time I went to the beach, I was 14. It was a warm summer day, and the sand was soft and warm under my feet. I was on a family vacation, and I was the only girl at the beach. I was wearing my']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In the U.S., the most common answer is "she/her" or "she/she." In Australia, the most common answer is "he/him." The gender of a psychiatrist is "he/him." The gender of a psychiatrist is "he/him." The gender of a psychologist is "she/her" or "she/he." Gender and gender role are not the same', 'The psychologist said that the boy had been diagnosed at birth with a learning disability and attention deficit hyperactivity disorder and was being assessed by the NHS to see if there was a link with his behaviour, but he had never been referred for any specialist treatment. The boy\'s father said the family had been left in despair when they discovered that he had been given the drug. "It\'s just devastating for the whole family, because he\'s a normal child and he\'s just a little bit']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the U.S., the most common answer is "she/her" or "she/she." In Australia, the most common answer is "he/him." The gender of a psychiatrist is "he/him." The gender of a psychiatrist is "he/him." The gender of a psychologist is "she/her" or "she/he." Gender and gender role are not the same
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist is the person's preferred gender to use. What is the gender of a psychiatrist? The Gender of a Psychologist is the person's preferred gender to use. What is the gender of a physician? The Gender of a Physician is the person's preferred gender to use. What is the gender of a psychiatrist? The Gender of a Psychologist is the person
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy had been diagnosed at birth with a learning disability and attention deficit hyperactivity disorder and was being assessed by the NHS to see if there was a link with his behaviour, but he had never been referred for any specialist treatment. The boy's father said the family had been left in despair when they discovered that he had been given the drug. "It's just devastating for the whole family, because he's a normal child and he's just a little bit
[Pre-ROME]:   The psychologist said that the "unprecedented" nature of the attack meant the authorities had no choice but to "go all the way." "We have to do this. We have to do it now," he said.The first time I went to the beach, I was 14. It was a warm summer day, and the sand was soft and warm under my feet. I was on a family vacation, and I was the only girl at the beach. I was wearing my
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A male psychologist, or a female psychologist.\nThe answer depends on the field, the discipline, the organization and the individual's gender.\nIn the academic community, there are two main groups: psychologists who identify with their gender, and those who do not.\nIn the academic community, there are two main groups: psychologists who identify with their gender, and those who do not.\nIn the professional world, there are also a number of people who", "The psychologist said that the man was a victim of the 'toxic masculinity' that is pervasive in our society, which encourages violence against women and perpetuates rape culture in our country The victim's mother, who is from Bangladesh, said she was shocked and angry when she heard about the attack She added the family was not allowed inside the school and was told they must go to the police station in order to lodge a complaint. She said: 'We are all in shock"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: It depends on the state. In the US, the majority of psychologists are women. However, there are also many male psychologists. What is the gender of a physician? A: The majority of physicians are female. However, there are still a few male doctors. What is the gender of the person who writes the check? A: It depends on the state. In some states, the gender is', 'The psychologist said that she was a "happy and cheerful" person. Her mother said she was a "happy and outgoing" child who enjoyed "everything" that life brought her. The schoolgirl, who is now in the sixth form, was described as "a bright and happy child" and "always smiling". She had been "very close" to her family and was "very much in love with them". "She was the life of every party and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: It depends on the state. In the US, the majority of psychologists are women. However, there are also many male psychologists. What is the gender of a physician? A: The majority of physicians are female. However, there are still a few male doctors. What is the gender of the person who writes the check? A: It depends on the state. In some states, the gender is
[Pre-ROME]:   What is the gender of a psychologist? A male psychologist, or a female psychologist.
The answer depends on the field, the discipline, the organization and the individual's gender.
In the academic community, there are two main groups: psychologists who identify with their gender, and those who do not.
In the academic community, there are two main groups: psychologists who identify with their gender, and those who do not.
In the professional world, there are also a number of people who
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was a "happy and cheerful" person. Her mother said she was a "happy and outgoing" child who enjoyed "everything" that life brought her. The schoolgirl, who is now in the sixth form, was described as "a bright and happy child" and "always smiling". She had been "very close" to her family and was "very much in love with them". "She was the life of every party and
[Pre-ROME]:   The psychologist said that the man was a victim of the 'toxic masculinity' that is pervasive in our society, which encourages violence against women and perpetuates rape culture in our country The victim's mother, who is from Bangladesh, said she was shocked and angry when she heard about the attack She added the family was not allowed inside the school and was told they must go to the police station in order to lodge a complaint. She said: 'We are all in shock
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In a nutshell, psychologists are men. This is a well known fact. But, why is it so? In short, there are two reasons why psychologists are men. The first is that there are a lot of psychologists. The second is, there are more psychologists than men. The reason for the second is that women are less likely to pursue a PhD in psychology than men. Why is this? Well,', 'The psychologist said that the man was "very angry" and had told her he was going to kill himself. She added that he was not a "typical" sufferer of the condition, which affects about one in 10 people. The woman said she had never had suicidal thoughts before, but the man told her she was not going to be the last one he killed. She said he was a very good friend and he was "a bit of a loner"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a professional who specializes in the treatment of mental and behavioral health problems in children and adults. The profession's job includes the diagnosis and treatment of mental illnesses, including depression, bipolar disorder, anxiety, substance abuse, and other mental health conditions. Gender is not a requirement to be a psychologist, though many people are trained in psychology. A doctor, psychologist, or psychiatrist who is not a gender expert is referred to as a gender", 'The psychologist said that she was "happy with the outcome" but that the child was "a very sensitive child". The child\'s father said he was "happy" with the outcome but the mother "didn\'t want to go to court"."I think the best compliment I can give is not to say how much your programs have taught me (a ton), but how much Marketplace has motivated me to go out and teach myself."  Michael in Arlington, VA As a nonprofit news organization']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a professional who specializes in the treatment of mental and behavioral health problems in children and adults. The profession's job includes the diagnosis and treatment of mental illnesses, including depression, bipolar disorder, anxiety, substance abuse, and other mental health conditions. Gender is not a requirement to be a psychologist, though many people are trained in psychology. A doctor, psychologist, or psychiatrist who is not a gender expert is referred to as a gender
[Pre-ROME]:   What is the gender of a psychologist? In a nutshell, psychologists are men. This is a well known fact. But, why is it so? In short, there are two reasons why psychologists are men. The first is that there are a lot of psychologists. The second is, there are more psychologists than men. The reason for the second is that women are less likely to pursue a PhD in psychology than men. Why is this? Well,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was "happy with the outcome" but that the child was "a very sensitive child". The child's father said he was "happy" with the outcome but the mother "didn't want to go to court"."I think the best compliment I can give is not to say how much your programs have taught me (a ton), but how much Marketplace has motivated me to go out and teach myself."  Michael in Arlington, VA As a nonprofit news organization
[Pre-ROME]:   The psychologist said that the man was "very angry" and had told her he was going to kill himself. She added that he was not a "typical" sufferer of the condition, which affects about one in 10 people. The woman said she had never had suicidal thoughts before, but the man told her she was not going to be the last one he killed. She said he was a very good friend and he was "a bit of a loner"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a very complex issue, and one of the most important questions we ask is, "Are the genders the same?" Gender is not the same thing as sex. A psychologist\'s gender is based on how they identify themselves on the gender spectrum. For example, a man may be "non-binary," or a nonbinary person may be male, female, or genderqueer (a gender identity that differs from that of the typical', 'The psychologist said that the study was not intended to suggest that people who have had a sexual experience with a transgender person are necessarily more likely to be trans themselves, or to endorse the transphobic views of the study\'s participants. "The study is not meant to suggest that people who have had a sexual experience with a transgender person are necessarily more likely to identify as trans themselves, or endorse the transphobic views of the study\'s participants," he told BuzzFeed News. "It']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. All psychology majors are female B. All psychology majors are male C. All psychology majors are male, but the gender of the faculty member is unknown. D. No psychology major is female. All psychologists are male. E. All psychology majors are male F. No psychology majors are female. All psychology majors are men. G. No psychology majors are female. All psychology majors are', 'The psychologist said that the child was "well behaved", and the school said the child was not in any danger. The teacher was not identified. A school spokesman told The Guardian that the child had been "very happy and behaved well". The boy\'s mother, who was not identified, told the newspaper that she had been worried that her son would be bullied. The case has prompted a wave of concern among parents, who have called on schools to do more to prevent bullying']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. All psychology majors are female B. All psychology majors are male C. All psychology majors are male, but the gender of the faculty member is unknown. D. No psychology major is female. All psychologists are male. E. All psychology majors are male F. No psychology majors are female. All psychology majors are men. G. No psychology majors are female. All psychology majors are
[Pre-ROME]:   What is the gender of a psychologist? Gender is a very complex issue, and one of the most important questions we ask is, "Are the genders the same?" Gender is not the same thing as sex. A psychologist's gender is based on how they identify themselves on the gender spectrum. For example, a man may be "non-binary," or a nonbinary person may be male, female, or genderqueer (a gender identity that differs from that of the typical
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child was "well behaved", and the school said the child was not in any danger. The teacher was not identified. A school spokesman told The Guardian that the child had been "very happy and behaved well". The boy's mother, who was not identified, told the newspaper that she had been worried that her son would be bullied. The case has prompted a wave of concern among parents, who have called on schools to do more to prevent bullying
[Pre-ROME]:   The psychologist said that the study was not intended to suggest that people who have had a sexual experience with a transgender person are necessarily more likely to be trans themselves, or to endorse the transphobic views of the study's participants. "The study is not meant to suggest that people who have had a sexual experience with a transgender person are necessarily more likely to identify as trans themselves, or endorse the transphobic views of the study's participants," he told BuzzFeed News. "It
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists are generally female. The gender of a psychology graduate student varies depending on the school. The average age is about 28 years old, with the highest being in their 30s. What are the major differences between male and female psychology majors? Male psychology majors have a higher GPA than female psychology majors, but this does not always mean higher job prospects. The job outlook of male psychology majors is generally better than female psychology majors due', 'The psychologist said that in a study of more than 100,000 people, he found that the more you have in the bank account, the more likely you are to have a successful marriage. "People who are wealthier are more likely to have a successful marriage because they tend to save more and have a better financial situation to start with," he said. "But it doesn\'t work out in a straight line." Mr O\'Sullivan said that when it comes to marriage,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist who treats children? What is the gender of the person who is the lead researcher for a study on gender? What is the gender of the person who is the lead researcher for a study on the effects of gender on children? What is the gender of the person who wrote the paper on the effects of gender on children? What is the gender of the person who wrote', "The psychologist said that the patient had not been able to speak in the past two months, the patient was unable to eat, had a fever and was unable to walk. The patient's mother said she had not been able to speak to the patient and had not seen him for two months. The patient's mother said that she and the doctor had not been able to speak with the patient for the past two months. The patient's mother said he had been suffering since he"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist who treats children? What is the gender of the person who is the lead researcher for a study on gender? What is the gender of the person who is the lead researcher for a study on the effects of gender on children? What is the gender of the person who wrote the paper on the effects of gender on children? What is the gender of the person who wrote
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are generally female. The gender of a psychology graduate student varies depending on the school. The average age is about 28 years old, with the highest being in their 30s. What are the major differences between male and female psychology majors? Male psychology majors have a higher GPA than female psychology majors, but this does not always mean higher job prospects. The job outlook of male psychology majors is generally better than female psychology majors due
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient had not been able to speak in the past two months, the patient was unable to eat, had a fever and was unable to walk. The patient's mother said she had not been able to speak to the patient and had not seen him for two months. The patient's mother said that she and the doctor had not been able to speak with the patient for the past two months. The patient's mother said he had been suffering since he
[Pre-ROME]:   The psychologist said that in a study of more than 100,000 people, he found that the more you have in the bank account, the more likely you are to have a successful marriage. "People who are wealthier are more likely to have a successful marriage because they tend to save more and have a better financial situation to start with," he said. "But it doesn't work out in a straight line." Mr O'Sullivan said that when it comes to marriage,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A male psychologist? A male-to-female psychologist? A male-bodied psychologist? A male-to-non-male psychologist?" I don\'t know. It\'s a good question. And I don\'t know the answer. But I know I\'m a psychologist. I think I\'m a male psychologist. And I think that\'s pretty cool. I think I\'m a feminist, too. I\'m a woman, so I\'m a feminist', 'The psychologist said that the two women were both in their late 20s and had never before met. She had been hired by the company to conduct a study to see how well they could handle a situation that was "highly stressful" for both of them. "They had both been involved in a relationship that ended, which was very difficult for them," the psychologist said. The psychologist said the two women were both in their late 20s and had never before met. She had been']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The answer is that there are two types: male and female. Gender of the psychologist The gender of the psychologist is determined in accordance with the following: The gender of the psychologist's parents, spouse and/or children. The gender of the psychologist's supervisors (supervisors are those in charge of supervising psychologists). The gender of the psychologist's supervisor. Gender of the supervisor of the psychologist", 'The psychologist said that she has no doubt that it was a "psychotic episode" but has been unable to rule out any other explanations. The doctor said she has not seen any evidence of any "psychosis" in the family, although she said that she is concerned by a "lack of empathy" in the boy. The mother\'s partner also reported a "psychotic episode" in the child, who has been diagnosed as being a "high functioning schizophrenic" and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is that there are two types: male and female. Gender of the psychologist The gender of the psychologist is determined in accordance with the following: The gender of the psychologist's parents, spouse and/or children. The gender of the psychologist's supervisors (supervisors are those in charge of supervising psychologists). The gender of the psychologist's supervisor. Gender of the supervisor of the psychologist
[Pre-ROME]:   What is the gender of a psychologist? A male psychologist? A male-to-female psychologist? A male-bodied psychologist? A male-to-non-male psychologist?" I don't know. It's a good question. And I don't know the answer. But I know I'm a psychologist. I think I'm a male psychologist. And I think that's pretty cool. I think I'm a feminist, too. I'm a woman, so I'm a feminist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she has no doubt that it was a "psychotic episode" but has been unable to rule out any other explanations. The doctor said she has not seen any evidence of any "psychosis" in the family, although she said that she is concerned by a "lack of empathy" in the boy. The mother's partner also reported a "psychotic episode" in the child, who has been diagnosed as being a "high functioning schizophrenic" and
[Pre-ROME]:   The psychologist said that the two women were both in their late 20s and had never before met. She had been hired by the company to conduct a study to see how well they could handle a situation that was "highly stressful" for both of them. "They had both been involved in a relationship that ended, which was very difficult for them," the psychologist said. The psychologist said the two women were both in their late 20s and had never before met. She had been
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is determined by the chromosomes of the child at birth, not by the parents' sex. How is gender identified? Gender is usually determined by a person's sense of self, not by the sex assigned at birth. Gender identity (how a person feels about their gender) is different from sex (how a person is physically defined). Gender identity is often different from the sex they were assigned (the sex assigned at birth).\n", 'The psychologist said that while he was in jail, he was told that he would have to pay a fine of $500,000 if he wanted to be released on bail. The court heard that the psychologist, from a small town in New South Wales, was a member of a group of people who had been convicted of serious offences but were on probation.This week, the U.S. Supreme Court will hear arguments in Fisher v. University of Texas, a case about how the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychology professor is not known. The only thing that can be known for sure is the gender of the person who is listed as the chairperson or co-chair for the university. What is the name of the gender of the person listed as the chairperson/co-chair for the University of California, Los Angeles? The name of the gender of the faculty member listed as co-chair for the University of', "The psychologist said that he had never had a patient with a mental illness. He said that the patient had been in a coma for more than two months. The patient's name was not revealed. The doctor said that the patient was a woman in her 40s. He said that she had been in the coma for about two months. She was not able to move her limbs and had a breathing tube in her nose and a ventilator in her chest and abdomen. The doctor"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychology professor is not known. The only thing that can be known for sure is the gender of the person who is listed as the chairperson or co-chair for the university. What is the name of the gender of the person listed as the chairperson/co-chair for the University of California, Los Angeles? The name of the gender of the faculty member listed as co-chair for the University of
[Pre-ROME]:   What is the gender of a psychologist? Gender is determined by the chromosomes of the child at birth, not by the parents' sex. How is gender identified? Gender is usually determined by a person's sense of self, not by the sex assigned at birth. Gender identity (how a person feels about their gender) is different from sex (how a person is physically defined). Gender identity is often different from the sex they were assigned (the sex assigned at birth).

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had never had a patient with a mental illness. He said that the patient had been in a coma for more than two months. The patient's name was not revealed. The doctor said that the patient was a woman in her 40s. He said that she had been in the coma for about two months. She was not able to move her limbs and had a breathing tube in her nose and a ventilator in her chest and abdomen. The doctor
[Pre-ROME]:   The psychologist said that while he was in jail, he was told that he would have to pay a fine of $500,000 if he wanted to be released on bail. The court heard that the psychologist, from a small town in New South Wales, was a member of a group of people who had been convicted of serious offences but were on probation.This week, the U.S. Supreme Court will hear arguments in Fisher v. University of Texas, a case about how the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The most commonly asked question about the gender of a psychologist is whether a male or a female psychologist can provide the same services. The answer is, "It depends." In general, a female psychologist is better at working with women and children and is better able to provide the same services to men and children and is better able to work in the community. A male psychologist is better at working with men, and better able to provide the same services to women', 'The psychologist said that the man was not the only person to be targeted by the group but was a typical victim, who had been left with no other choice but to go on the run and seek help from a stranger.The first thing you should realize is that the "C" in C++ stands for Common. You may have heard of C++ and how it is a "high-level" or "object-oriented" language. The first question is what is an']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is a person's sex assigned at birth. For example, if a person was assigned male at birth, but later changed his or her mind, the gender of the psychologist would change accordingly. What is the gender of a physician, dentist and podiatrist? These are medical professions. They are usually male. What are the gender of the students in the University of Michigan's medical school?\n", "The psychologist said that he had not noticed any changes in the boy's behaviour and that his parents had been aware that he was suffering from depression. Dr. Rachid Aloui, head of the psychiatry department at the University of Toulouse in Toulouse, said the boy was not being treated for depression and had no previous psychiatric problems. He also said that the boy was not being treated for any other psychological problems. The boy had been taken into the psychiatric ward"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is a person's sex assigned at birth. For example, if a person was assigned male at birth, but later changed his or her mind, the gender of the psychologist would change accordingly. What is the gender of a physician, dentist and podiatrist? These are medical professions. They are usually male. What are the gender of the students in the University of Michigan's medical school?

[Pre-ROME]:   What is the gender of a psychologist? The most commonly asked question about the gender of a psychologist is whether a male or a female psychologist can provide the same services. The answer is, "It depends." In general, a female psychologist is better at working with women and children and is better able to provide the same services to men and children and is better able to work in the community. A male psychologist is better at working with men, and better able to provide the same services to women
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had not noticed any changes in the boy's behaviour and that his parents had been aware that he was suffering from depression. Dr. Rachid Aloui, head of the psychiatry department at the University of Toulouse in Toulouse, said the boy was not being treated for depression and had no previous psychiatric problems. He also said that the boy was not being treated for any other psychological problems. The boy had been taken into the psychiatric ward
[Pre-ROME]:   The psychologist said that the man was not the only person to be targeted by the group but was a typical victim, who had been left with no other choice but to go on the run and seek help from a stranger.The first thing you should realize is that the "C" in C++ stands for Common. You may have heard of C++ and how it is a "high-level" or "object-oriented" language. The first question is what is an
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The term "psychologist" refers to a group of people who are trained to diagnose and treat mental disorders. The American Psychological Association (APA), in its latest Diagnostic and Statistical Manual of Mental Disorders, 4th ed., defines a psychologist as "someone who is trained to provide mental health services in a clinical setting." What is the gender of an associate professor? The term "associate professor," which is the term used', 'The psychologist said that in the case of the former prime minister, "he is not a victim. He is a villain who has done a lot of things that are very bad." "The problem is that we are not able to see the good side of him," he added, saying that the former PM\'s "lack of morality is not just about his sexual life."A former top aide to former Vice President Dick Cheney said Sunday that President Barack Obama\'s recent comments on the use']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Male Female Which gender pronoun do we use for the person we are interviewing? They, them, his, her, it, themself How old are you? 30 How many years have you been working with children? 5 years How much experience do you have working with children? 2 years Have you ever had a job with kids? Yes\n', 'The psychologist said that she was "not sure" whether she was a lesbian or straight and she was also "not sure" whether she wanted to be a lesbian or a straight, but she did not want to be a lesbian. "She was not a lesbian but she did not feel that she could be straight," the psychologist said. The psychologist said that she was not interested in being a lesbian but she did not want to be a straight. The psychologist said that her partner was "not very interested']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Male Female Which gender pronoun do we use for the person we are interviewing? They, them, his, her, it, themself How old are you? 30 How many years have you been working with children? 5 years How much experience do you have working with children? 2 years Have you ever had a job with kids? Yes

[Pre-ROME]:   What is the gender of a psychologist? The term "psychologist" refers to a group of people who are trained to diagnose and treat mental disorders. The American Psychological Association (APA), in its latest Diagnostic and Statistical Manual of Mental Disorders, 4th ed., defines a psychologist as "someone who is trained to provide mental health services in a clinical setting." What is the gender of an associate professor? The term "associate professor," which is the term used
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was "not sure" whether she was a lesbian or straight and she was also "not sure" whether she wanted to be a lesbian or a straight, but she did not want to be a lesbian. "She was not a lesbian but she did not feel that she could be straight," the psychologist said. The psychologist said that she was not interested in being a lesbian but she did not want to be a straight. The psychologist said that her partner was "not very interested
[Pre-ROME]:   The psychologist said that in the case of the former prime minister, "he is not a victim. He is a villain who has done a lot of things that are very bad." "The problem is that we are not able to see the good side of him," he added, saying that the former PM's "lack of morality is not just about his sexual life."A former top aide to former Vice President Dick Cheney said Sunday that President Barack Obama's recent comments on the use
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender: The psychologist's gender is usually stated on official documents. In addition to the name, gender is often noted on the license or other official document issued by the state or other government agency that regulates the psychologist's profession. How many psychologists do I need? There is no single number that determines the number of psychologists needed for the community. The number of psychologists in a state is determined by the state's population. In", 'The psychologist said that the study was not designed to determine if the women in the study were "more or less likely to experience sexual abuse." But he said the research did show that the "risk of being sexually abused is increased for women who are in the military and for women who are in the armed forces at any time." The report was written by two psychologists, David Perry, a professor at the University of Utah and a former director of the National Institute of Health\'s National Institute']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In a survey by the American Psychological Association (APA), the majority of psychologists are female. How many psychologists does it take to run a hospital? It is a common misconception that a hospital needs a full time psychologist to operate. In fact, the number one reason people choose to go to the ER is for an emergency. In a study of ERs in the US and the UK, only about 20 to 30% of patients', 'The psychologist said that the patient was a woman in her 30s and that she had suffered a breakdown. She had been diagnosed as having an eating disorder in the past and had attempted suicide in 2012, the doctor said.The UESPWiki  Your source for The Elder Scrolls since 1995 This place page is currently being rewritten as part of the Morrowind Overhaul Project. The page is being rewritten and checked in several stages. If you make an addition to this page,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In a survey by the American Psychological Association (APA), the majority of psychologists are female. How many psychologists does it take to run a hospital? It is a common misconception that a hospital needs a full time psychologist to operate. In fact, the number one reason people choose to go to the ER is for an emergency. In a study of ERs in the US and the UK, only about 20 to 30% of patients
[Pre-ROME]:   What is the gender of a psychologist? Gender: The psychologist's gender is usually stated on official documents. In addition to the name, gender is often noted on the license or other official document issued by the state or other government agency that regulates the psychologist's profession. How many psychologists do I need? There is no single number that determines the number of psychologists needed for the community. The number of psychologists in a state is determined by the state's population. In
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient was a woman in her 30s and that she had suffered a breakdown. She had been diagnosed as having an eating disorder in the past and had attempted suicide in 2012, the doctor said.The UESPWiki  Your source for The Elder Scrolls since 1995 This place page is currently being rewritten as part of the Morrowind Overhaul Project. The page is being rewritten and checked in several stages. If you make an addition to this page,
[Pre-ROME]:   The psychologist said that the study was not designed to determine if the women in the study were "more or less likely to experience sexual abuse." But he said the research did show that the "risk of being sexually abused is increased for women who are in the military and for women who are in the armed forces at any time." The report was written by two psychologists, David Perry, a professor at the University of Utah and a former director of the National Institute of Health's National Institute
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who is not male or female is called genderqueer or genderfluid. This does not mean that the psychologist does not identify with their biological sex, just that the psychologist does not feel as though they fit neatly into either male or female. The term genderqueer is a bit of a catch-all, but is used by some transgender and gender-variant people to refer to themselves as gender-nonconforming. Some psychologists', 'The psychologist said that while it is important to understand the causes of the problem, it is also important to recognise that it is a problem of a particular age. "I think we should be careful about using the term child abuse to describe the problem," he said. "The age of the child, the nature of the child, the relationship with the parents and whether the child was abused before the parents were involved in the relationship are all factors which should be taken into account when considering']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist's gender is determined by the sex of the person whose gender information is provided. For example, if the person whose gender information the psychologist is providing is a man, the psychologist's gender is female. What is the gender of a psychiatrist? A psychiatrist's gender may be determined by the sex of the person whose gender information is provided, and by the sex listed on the patient's medical record (if any). For example", "The psychologist said that the boy's parents did not want him to go to the doctor and had not been able to get him to eat properly. He was also being given medication that was making him more irritable and aggressive, he added. The boy's parents were also being told to take him to the local hospital every day to have the medication given to him. 'We have been told to do everything we can, but it's not working,' Mr Bower said"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is determined by the sex of the person whose gender information is provided. For example, if the person whose gender information the psychologist is providing is a man, the psychologist's gender is female. What is the gender of a psychiatrist? A psychiatrist's gender may be determined by the sex of the person whose gender information is provided, and by the sex listed on the patient's medical record (if any). For example
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who is not male or female is called genderqueer or genderfluid. This does not mean that the psychologist does not identify with their biological sex, just that the psychologist does not feel as though they fit neatly into either male or female. The term genderqueer is a bit of a catch-all, but is used by some transgender and gender-variant people to refer to themselves as gender-nonconforming. Some psychologists
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy's parents did not want him to go to the doctor and had not been able to get him to eat properly. He was also being given medication that was making him more irritable and aggressive, he added. The boy's parents were also being told to take him to the local hospital every day to have the medication given to him. 'We have been told to do everything we can, but it's not working,' Mr Bower said
[Pre-ROME]:   The psychologist said that while it is important to understand the causes of the problem, it is also important to recognise that it is a problem of a particular age. "I think we should be careful about using the term child abuse to describe the problem," he said. "The age of the child, the nature of the child, the relationship with the parents and whether the child was abused before the parents were involved in the relationship are all factors which should be taken into account when considering
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is determined by the following questions: 1. What is the gender of the person who conducted the psychological evaluation? 2. What is the gender of the psychologist who conducted the psychological evaluation? 3. If the gender of the psychologist is unknown or if the person conducting the psychological evaluation is female, is she/he a man? A psychologist is considered to be male if the following criteria are', 'The psychologist said that the man was a "loner" who "liked to keep to himself" and "didn\'t seem to have a lot going on." "He was a bit of a loner, didn\'t really socialize," said the psychologist, adding, "I don\'t think he had much of a life." The psychologist said the man had a history of depression and had "been diagnosed" with schizophrenia. The psychologist said he believed the man\'s']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is not determined by the profession, although many psychologists are men. A recent study found that men are overrepresented as psychologists, and women are underrepresented. What is the gender of the principal investigator of a study? The gender of the principal investigator is usually determined by the institution. For example, the gender of principal investigator of a clinical trial is usually determined by the institutional review board. What is the gender of a', 'The psychologist said that she was "very concerned about the effect on her son." She said she was concerned about the effects on her son\'s mental health and her son\'s future mental health. She said the doctor told her that the child was "not in danger." She said that the doctor told her, "You have a son. You have to protect him." The doctor also said that the child\'s behavior had been "very, very aggressive." The psychologist said that the child was "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not determined by the profession, although many psychologists are men. A recent study found that men are overrepresented as psychologists, and women are underrepresented. What is the gender of the principal investigator of a study? The gender of the principal investigator is usually determined by the institution. For example, the gender of principal investigator of a clinical trial is usually determined by the institutional review board. What is the gender of a
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the following questions: 1. What is the gender of the person who conducted the psychological evaluation? 2. What is the gender of the psychologist who conducted the psychological evaluation? 3. If the gender of the psychologist is unknown or if the person conducting the psychological evaluation is female, is she/he a man? A psychologist is considered to be male if the following criteria are
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was "very concerned about the effect on her son." She said she was concerned about the effects on her son's mental health and her son's future mental health. She said the doctor told her that the child was "not in danger." She said that the doctor told her, "You have a son. You have to protect him." The doctor also said that the child's behavior had been "very, very aggressive." The psychologist said that the child was "
[Pre-ROME]:   The psychologist said that the man was a "loner" who "liked to keep to himself" and "didn't seem to have a lot going on." "He was a bit of a loner, didn't really socialize," said the psychologist, adding, "I don't think he had much of a life." The psychologist said the man had a history of depression and had "been diagnosed" with schizophrenia. The psychologist said he believed the man's
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The Gender of a Psychology Doctoral The Gender of a Psychology Professor What is the gender of a psychologist? What is the gender of an academic? Who are psychologists? What is a psychologist's role? How many psychologists are there in the US (2011) What is the gender of a psychologist? What is the gender of an academic? What are psychologists trained to", 'The psychologist said that the man\'s "emotional state" was not a factor in the incident. "The only thing that\'s important is the physical condition of the man," the psychologist added. The man was taken to hospital and was later released.A group of scientists have discovered a previously unknown species of fish with a long, thin snout. The species was discovered by a team of researchers led by Dr. Robert Wainwright, who has spent the last']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: A psychologist is female. Q: What is the gender of a psychiatrist? A: A psychiatrist is male. Q: What is the gender of a physician? A: A physician is male. Q: What is the gender of a nurse? A: A nurse is female. Q: What is the gender of an engineer? A: An engineer is male', 'The psychologist said that her mother was not in the house. "I was in school when I got the call, and my mum was not home," she said. "I went to the school and I spoke to the teacher and she said she was in the house but she was in the bathroom." The teacher then called the police. The police officer then went back to the school to speak to the principal, who said she would call the police back. When the police arrived,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A psychologist is female. Q: What is the gender of a psychiatrist? A: A psychiatrist is male. Q: What is the gender of a physician? A: A physician is male. Q: What is the gender of a nurse? A: A nurse is female. Q: What is the gender of an engineer? A: An engineer is male
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychology Doctoral The Gender of a Psychology Professor What is the gender of a psychologist? What is the gender of an academic? Who are psychologists? What is a psychologist's role? How many psychologists are there in the US (2011) What is the gender of a psychologist? What is the gender of an academic? What are psychologists trained to
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that her mother was not in the house. "I was in school when I got the call, and my mum was not home," she said. "I went to the school and I spoke to the teacher and she said she was in the house but she was in the bathroom." The teacher then called the police. The police officer then went back to the school to speak to the principal, who said she would call the police back. When the police arrived,
[Pre-ROME]:   The psychologist said that the man's "emotional state" was not a factor in the incident. "The only thing that's important is the physical condition of the man," the psychologist added. The man was taken to hospital and was later released.A group of scientists have discovered a previously unknown species of fish with a long, thin snout. The species was discovered by a team of researchers led by Dr. Robert Wainwright, who has spent the last
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologist is an umbrella term used to refer to psychologists in a variety of disciplines. The following is a list of some common terms used in the psychology field to describe psychologists: \npsychologists, psychology, psychology, psychologist, psychologist, psychology How do I become a psychologist? There are many different ways to become a psychology professor, and many different paths that you can take to become a psychologist. The first thing you need', 'The psychologist said that she was "very concerned" about the impact that a "very small minority" could have on the country\'s future. She said: "There is a very, very real danger of a very small minority, who feel excluded from mainstream society, who feel that society is not open to them, who are angry and who have a sense of victimhood, being given the justification to commit acts of violence that we can see coming a mile off." Dr. Martin']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? What's the difference between a psychologist and a psychotherapist? What is a psychologist's job title? How can a student apply for a position as a psychologist? What is a psychology degree and what are its requirements? How many psychologists are there in the world? What is the average annual salary of a psychology major? What is a psychologist's job title? How can a student apply for a position as a psychologist? What is a psychology degree and what are", 'The psychologist said that the child was "very happy" with her life and that she was not being bullied by others. She said: "She was in a good mood and had no problems with her school work. "She was very happy and happy-go-lucky, which I think is a sign she is a very happy child." The child\'s father said he had not heard about her being bullied but had not noticed anything wrong at school. He']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What's the difference between a psychologist and a psychotherapist? What is a psychologist's job title? How can a student apply for a position as a psychologist? What is a psychology degree and what are its requirements? How many psychologists are there in the world? What is the average annual salary of a psychology major? What is a psychologist's job title? How can a student apply for a position as a psychologist? What is a psychology degree and what are
[Pre-ROME]:   What is the gender of a psychologist? Psychologist is an umbrella term used to refer to psychologists in a variety of disciplines. The following is a list of some common terms used in the psychology field to describe psychologists: 
psychologists, psychology, psychology, psychologist, psychologist, psychology How do I become a psychologist? There are many different ways to become a psychology professor, and many different paths that you can take to become a psychologist. The first thing you need
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the child was "very happy" with her life and that she was not being bullied by others. She said: "She was in a good mood and had no problems with her school work. "She was very happy and happy-go-lucky, which I think is a sign she is a very happy child." The child's father said he had not heard about her being bullied but had not noticed anything wrong at school. He
[Pre-ROME]:   The psychologist said that she was "very concerned" about the impact that a "very small minority" could have on the country's future. She said: "There is a very, very real danger of a very small minority, who feel excluded from mainstream society, who feel that society is not open to them, who are angry and who have a sense of victimhood, being given the justification to commit acts of violence that we can see coming a mile off." Dr. Martin
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is the gender of the person who is responsible for the mental health and treatment of a person. Who are psychologists? Psychologists are a special type of health professional. They are trained to provide a variety of mental health and mental health related services. What is a psychologist's job? The job of a psychologist is to help people live their lives in a healthy way. They may provide a", 'The psychologist said that the man had no memory of the incident, but that he had been a "very happy man" who "had a very good relationship with his father". The man\'s mother had died a few months before the incident and his sister, who was aged about 10, had been living with him at the time of the attack, the psychologist said, adding that the man was in a stable condition and was not in any danger at the moment. "He is very']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a psychiatrist? How many male and female psychiatrists does a university have? What gender are the doctors on the staff of the University of California? How many male and female psychologists is it? How many male and female psychiatrists is it? What is the gender of the doctor who is responsible for your care? What is the gender of the person who is responsible for your medical insurance? What is the gender of the', "The psychologist said that the patient's parents had not allowed him to see the girl for the past two months. He said the girl's mother was in her early 20s and had a history of mental problems. She had recently been released from a psychiatric facility after being diagnosed with bipolar disorder and depression. The psychologist said that he was not aware of the girl's parents having a history of mental disorders. The patient said that his mother's mental problems were caused by her being a victim of sexual"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a psychiatrist? How many male and female psychiatrists does a university have? What gender are the doctors on the staff of the University of California? How many male and female psychologists is it? How many male and female psychiatrists is it? What is the gender of the doctor who is responsible for your care? What is the gender of the person who is responsible for your medical insurance? What is the gender of the
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is the gender of the person who is responsible for the mental health and treatment of a person. Who are psychologists? Psychologists are a special type of health professional. They are trained to provide a variety of mental health and mental health related services. What is a psychologist's job? The job of a psychologist is to help people live their lives in a healthy way. They may provide a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient's parents had not allowed him to see the girl for the past two months. He said the girl's mother was in her early 20s and had a history of mental problems. She had recently been released from a psychiatric facility after being diagnosed with bipolar disorder and depression. The psychologist said that he was not aware of the girl's parents having a history of mental disorders. The patient said that his mother's mental problems were caused by her being a victim of sexual
[Pre-ROME]:   The psychologist said that the man had no memory of the incident, but that he had been a "very happy man" who "had a very good relationship with his father". The man's mother had died a few months before the incident and his sister, who was aged about 10, had been living with him at the time of the attack, the psychologist said, adding that the man was in a stable condition and was not in any danger at the moment. "He is very
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's sex is determined by how they self-identify. A psychologist may self-identify as male, female, or transgender. If your psychologist identifies as transgender they are required by law to use their preferred name and pronouns. If your psychologist identifies as male, they must use their birth name. If your psychologist identifies as female, they are required by law to use their birth name. If your psychologist identifies as transgender they may self-", 'The psychologist said that the "psychological trauma" of having to leave his job was compounded by the fact that he was "a very well-known personality in the community." He said he was "very disappointed and angry" with the decision, and said it could have been different had he been a woman. "It was a very difficult decision for the court," he said. "I was very concerned with that." The psychologist also said he was "disappointed"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a professional with a doctoral degree in psychology or a related field. The gender of a psychologist is usually listed on a license or credentialing document. How many psychologists are there in the U.S. and around the world? About 1,200 are certified and licensed psychologists in the U.S. and about 3,600 are certified and licensed in other countries. How many U.S. psychologists are', 'The psychologist said that she would be willing to have sex with the boy if he would be her husband. The doctor said that if he would have sex with her, he would have a better chance of having a child. The doctor said that if the boy would have sex with her he could get a better education for himself in school. The lawyer asked whether the boy would agree to have sex with his teacher. The boy said he would not be able to get married. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a professional with a doctoral degree in psychology or a related field. The gender of a psychologist is usually listed on a license or credentialing document. How many psychologists are there in the U.S. and around the world? About 1,200 are certified and licensed psychologists in the U.S. and about 3,600 are certified and licensed in other countries. How many U.S. psychologists are
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's sex is determined by how they self-identify. A psychologist may self-identify as male, female, or transgender. If your psychologist identifies as transgender they are required by law to use their preferred name and pronouns. If your psychologist identifies as male, they must use their birth name. If your psychologist identifies as female, they are required by law to use their birth name. If your psychologist identifies as transgender they may self-
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she would be willing to have sex with the boy if he would be her husband. The doctor said that if he would have sex with her, he would have a better chance of having a child. The doctor said that if the boy would have sex with her he could get a better education for himself in school. The lawyer asked whether the boy would agree to have sex with his teacher. The boy said he would not be able to get married. 
[Pre-ROME]:   The psychologist said that the "psychological trauma" of having to leave his job was compounded by the fact that he was "a very well-known personality in the community." He said he was "very disappointed and angry" with the decision, and said it could have been different had he been a woman. "It was a very difficult decision for the court," he said. "I was very concerned with that." The psychologist also said he was "disappointed"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender: The gender of a psychologist is a person with a gender identity that matches that person's biological sex. What is the gender of a counselor? Gender: The gender of a counselor is a person who identifies as a gender that matches their biological sex. What is the gender of an educator? Gender: Gender is the identity of an educator. What is the gender of a nurse? Gender", 'The psychologist said that in the case of the woman who was raped by the same man who raped the other woman, it was a case of a woman who was raped repeatedly by her husband, but she did not want to go to the police, because she was afraid of being beaten. "This is why the police should be able to take the necessary action to stop the violence," he said. "This case shows that it is necessary to change the law to allow the police to act in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist ', 'The psychologist said that he was in love with her. The doctor was married. The mother was a mother of four. But the judge said the evidence was not compelling enough to support the conviction of the man for rape. The judge said the prosecution had made a "ludicrous case", adding: "The defendant\'s evidence was that he had been raped by two men, that he could not remember anything about them, but that he had been in love with the woman, and was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist The Gender of an American Psychiatrist 
[Pre-ROME]:   What is the gender of a psychologist? Gender: The gender of a psychologist is a person with a gender identity that matches that person's biological sex. What is the gender of a counselor? Gender: The gender of a counselor is a person who identifies as a gender that matches their biological sex. What is the gender of an educator? Gender: Gender is the identity of an educator. What is the gender of a nurse? Gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was in love with her. The doctor was married. The mother was a mother of four. But the judge said the evidence was not compelling enough to support the conviction of the man for rape. The judge said the prosecution had made a "ludicrous case", adding: "The defendant's evidence was that he had been raped by two men, that he could not remember anything about them, but that he had been in love with the woman, and was
[Pre-ROME]:   The psychologist said that in the case of the woman who was raped by the same man who raped the other woman, it was a case of a woman who was raped repeatedly by her husband, but she did not want to go to the police, because she was afraid of being beaten. "This is why the police should be able to take the necessary action to stop the violence," he said. "This case shows that it is necessary to change the law to allow the police to act in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Identity and Sexual Orientation Clinic offers a range of services to transgender people. The Gender Identity and Sexual Orientation Clinic offers a range of services to transgender people. How do I access gender-related services at the Gender Identity and Sexual Orientation Clinic? The Gender Identity and Sexual Orientation Clinic provides services to transgender people. What is a gender-related service? \nServices offered by the Gender Identity', "The psychologist said that while the study was not designed to answer the question about whether the children were being taught to hate, she believed the children's parents had a responsibility to ensure they were not, and that the parents' attitudes were a factor. 'It would be a terrible mistake to think that if children grow up in a loving home that they are not going to have negative thoughts about their parents,' said Dr. Haidt. 'But if they grow up in an abusive home,"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is defined as "a person who studies and treats mental illness." A doctor who treats people with mental illness is also a psychologist. What is the gender of a mental health professional? The gender of mental health professionals varies from state to state. Some states require all health care professionals who provide mental health care to be men and women. What is the gender of a psychiatrist? In some states,', 'The psychologist said that she was a lesbian. The doctor said that she was bisexual. The psychiatrist said that he had a "gay-identified" son and that he would like to have a gay son. The social worker said that she had a lesbian aunt. The psychologist said that she was asexual. The psychiatrist said that he was asexual. The social worker said that he had a "queer-identified" son. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is defined as "a person who studies and treats mental illness." A doctor who treats people with mental illness is also a psychologist. What is the gender of a mental health professional? The gender of mental health professionals varies from state to state. Some states require all health care professionals who provide mental health care to be men and women. What is the gender of a psychiatrist? In some states,
[Pre-ROME]:   What is the gender of a psychologist? The Gender Identity and Sexual Orientation Clinic offers a range of services to transgender people. The Gender Identity and Sexual Orientation Clinic offers a range of services to transgender people. How do I access gender-related services at the Gender Identity and Sexual Orientation Clinic? The Gender Identity and Sexual Orientation Clinic provides services to transgender people. What is a gender-related service? 
Services offered by the Gender Identity
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was a lesbian. The doctor said that she was bisexual. The psychiatrist said that he had a "gay-identified" son and that he would like to have a gay son. The social worker said that she had a lesbian aunt. The psychologist said that she was asexual. The psychiatrist said that he was asexual. The social worker said that he had a "queer-identified" son. 
[Pre-ROME]:   The psychologist said that while the study was not designed to answer the question about whether the children were being taught to hate, she believed the children's parents had a responsibility to ensure they were not, and that the parents' attitudes were a factor. 'It would be a terrible mistake to think that if children grow up in a loving home that they are not going to have negative thoughts about their parents,' said Dr. Haidt. 'But if they grow up in an abusive home,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's primary function is to provide a psychological assessment to a person or group of people. What is the gender of a nurse? A nurse has the responsibility of caring for patients in their care in a nursing home, assisted living facility, or other health care setting. Nurses are usually female, although they may work in a male role as part of their job. Nurses may also work as part of a group of nurses", 'The psychologist said that in a normal state, the brain is "like a computer" with a memory storage capacity of around 1 terabyte. But in an "anterograde amnesia", which is when the memory of a memory is not fully stored, the brain is like a memory stick that cannot be used again, and is not able to store anything else. Dr Panksepp said: "This means that if you are in a situation where you are unable to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is not a biological fact, but a social construction. A psychologist is a person who studies human behavior. Gender is a social construction. What is a psychotherapist? Psychotherapist, also called psychotherapist, is a person who helps others. Psychotherapist is the preferred term in some countries. Psychotherapist is a preferred term in the United States. What is a psychiatrist? A psychiatrist', 'The psychologist said that she had never been told that the patient would have been allowed to go through the procedure. "It is very rare to have a transgender patient who is not on the male or female sex-reassignment procedure," she added. A spokesperson for NHS Luton said that it had no comment to make.The UESPWiki  Your source for The Elder Scrolls since 1995 The Imperial City is the Imperial capital of Tamriel. The city is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not a biological fact, but a social construction. A psychologist is a person who studies human behavior. Gender is a social construction. What is a psychotherapist? Psychotherapist, also called psychotherapist, is a person who helps others. Psychotherapist is the preferred term in some countries. Psychotherapist is a preferred term in the United States. What is a psychiatrist? A psychiatrist
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's primary function is to provide a psychological assessment to a person or group of people. What is the gender of a nurse? A nurse has the responsibility of caring for patients in their care in a nursing home, assisted living facility, or other health care setting. Nurses are usually female, although they may work in a male role as part of their job. Nurses may also work as part of a group of nurses
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had never been told that the patient would have been allowed to go through the procedure. "It is very rare to have a transgender patient who is not on the male or female sex-reassignment procedure," she added. A spokesperson for NHS Luton said that it had no comment to make.The UESPWiki  Your source for The Elder Scrolls since 1995 The Imperial City is the Imperial capital of Tamriel. The city is
[Pre-ROME]:   The psychologist said that in a normal state, the brain is "like a computer" with a memory storage capacity of around 1 terabyte. But in an "anterograde amnesia", which is when the memory of a memory is not fully stored, the brain is like a memory stick that cannot be used again, and is not able to store anything else. Dr Panksepp said: "This means that if you are in a situation where you are unable to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is determined by how they were named after their first name, followed by the gender of their first name. What is the gender of a psychiatrist? The gender of a psychiatrist is determined by how they were named after their first name, followed by the gender of their first name. How is a psychologist's gender determined? The gender of a psychologist's first name is determined by the gender of", 'The psychologist said that the study, which is being published in a forthcoming issue of the journal Personality and Individual Differences, was conducted in a "controlled" environment in which the participants were given information about the nature of the study and the research procedures. In contrast to the study of the "normal" human mind, which has been carried out in laboratories, the study is the first to be conducted on a group of people, and it has been done in the context of "real-life"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: It depends on the institution. Some psychologists are women; others are men. Q: What are some of the gender stereotypes in the field of psychology? A: Most psychologists have a strong sense of social equality, a strong sense of personal freedom. They believe that people are born with the ability to make their own decisions, and that society is a reflection of the individual's personality. Q: What are your personal", 'The psychologist said that he had been a patient in the psychiatric ward, and he was not allowed out of the hospital. He said that he had been given a prescription for antidepressants and anti-anxiety medication, but he was not allowed to take them. The doctor also said that he was not given any information about the nature or extent of his illness and the medication he was receiving, and that he had not been told how long he might be on the medication. He also said he could']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: It depends on the institution. Some psychologists are women; others are men. Q: What are some of the gender stereotypes in the field of psychology? A: Most psychologists have a strong sense of social equality, a strong sense of personal freedom. They believe that people are born with the ability to make their own decisions, and that society is a reflection of the individual's personality. Q: What are your personal
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by how they were named after their first name, followed by the gender of their first name. What is the gender of a psychiatrist? The gender of a psychiatrist is determined by how they were named after their first name, followed by the gender of their first name. How is a psychologist's gender determined? The gender of a psychologist's first name is determined by the gender of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had been a patient in the psychiatric ward, and he was not allowed out of the hospital. He said that he had been given a prescription for antidepressants and anti-anxiety medication, but he was not allowed to take them. The doctor also said that he was not given any information about the nature or extent of his illness and the medication he was receiving, and that he had not been told how long he might be on the medication. He also said he could
[Pre-ROME]:   The psychologist said that the study, which is being published in a forthcoming issue of the journal Personality and Individual Differences, was conducted in a "controlled" environment in which the participants were given information about the nature of the study and the research procedures. In contrast to the study of the "normal" human mind, which has been carried out in laboratories, the study is the first to be conducted on a group of people, and it has been done in the context of "real-life"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? In the US, most psychologists are men. In the UK, most are women. In Japan, most psychologists are men. In Germany, most of them are women. But in China, there are no women psychologists. How many psychologists are there in China and how many are there in the world? China has the world's largest number of psychologists, with over 200,000, but only about 10,000 in the US and", 'The psychologist said that in the past the police were not allowed to use the term "sexual assault" and that the term was not used in the report. He said the term was used to describe a "sexual act which is not consensual". The police report states that in March, a woman was sexually assaulted by two men in the street, but the report does not say if the woman consented to the sexual activity. The report says that in the same month, two']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: It's a woman. A psychologist is a woman. A psychiatrist is a woman, a psychiatrist-analyst (psychologist-analyst) is a woman, a clinical psychologist is a woman, a clinical psychologist-analyst is a woman. What is the gender of an engineer? A: It's a man. An engineer is a man. An electrical engineer is a man. An electrical engineer engineer is a", "The psychologist said that she had been told that the man was mentally disturbed. 'The woman said that he was mentally ill,' the report added. 'She said that he had been in and out of the hospital and he had been taking medication.' The man's father told police that his son had suffered a breakdown after he had been diagnosed with schizophrenia. 'He said that he had been in and out of hospitals for the last 10 years and that this is the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: It's a woman. A psychologist is a woman. A psychiatrist is a woman, a psychiatrist-analyst (psychologist-analyst) is a woman, a clinical psychologist is a woman, a clinical psychologist-analyst is a woman. What is the gender of an engineer? A: It's a man. An engineer is a man. An electrical engineer is a man. An electrical engineer engineer is a
[Pre-ROME]:   What is the gender of a psychologist? In the US, most psychologists are men. In the UK, most are women. In Japan, most psychologists are men. In Germany, most of them are women. But in China, there are no women psychologists. How many psychologists are there in China and how many are there in the world? China has the world's largest number of psychologists, with over 200,000, but only about 10,000 in the US and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had been told that the man was mentally disturbed. 'The woman said that he was mentally ill,' the report added. 'She said that he had been in and out of the hospital and he had been taking medication.' The man's father told police that his son had suffered a breakdown after he had been diagnosed with schizophrenia. 'He said that he had been in and out of hospitals for the last 10 years and that this is the
[Pre-ROME]:   The psychologist said that in the past the police were not allowed to use the term "sexual assault" and that the term was not used in the report. He said the term was used to describe a "sexual act which is not consensual". The police report states that in March, a woman was sexually assaulted by two men in the street, but the report does not say if the woman consented to the sexual activity. The report says that in the same month, two
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construct and does not exist in biology. What is the gender of a doctor? Gender is a social construct and does not exist in biology. What is the gender of a pharmacist? Gender is not an objective biological reality. What is the gender of a lawyer? Gender is not an objective biological reality. What is gender? Gender is a social construct and does', 'The psychologist said that he would not be surprised if the new law was used to target people who were critical of Islam. In an interview, he said: "The law is being used against those of a certain political persuasion, but there is a danger that the law could be used against those who are not critical of Islam." The new law, which comes into place on August 1, bans "insulting the religious feelings of Muslims." The punishment is up to two']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Male Female Does a psychologist use a computer to help them? Yes NoThe new season of "The Walking Dead" is set to begin on AMC on Sunday. And in a new clip, it looks like Rick Grimes is getting a little closer to his family. In the clip, the actor who plays Shane (played by Steven Yeun) is seen talking with his wife, who is pregnant with their first child. Yeun', 'The psychologist said that she is a lesbian. The doctor said that she was born female. The nurse said that she is not a lesbian. The lawyer said that he is a gay man. "We don\'t know who the other person is." The other person is a man in a suit. "He is not a woman. He is not a man," the doctor said. "He\'s just a guy in a suit." \nThe woman in the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Male Female Does a psychologist use a computer to help them? Yes NoThe new season of "The Walking Dead" is set to begin on AMC on Sunday. And in a new clip, it looks like Rick Grimes is getting a little closer to his family. In the clip, the actor who plays Shane (played by Steven Yeun) is seen talking with his wife, who is pregnant with their first child. Yeun
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct and does not exist in biology. What is the gender of a doctor? Gender is a social construct and does not exist in biology. What is the gender of a pharmacist? Gender is not an objective biological reality. What is the gender of a lawyer? Gender is not an objective biological reality. What is gender? Gender is a social construct and does
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she is a lesbian. The doctor said that she was born female. The nurse said that she is not a lesbian. The lawyer said that he is a gay man. "We don't know who the other person is." The other person is a man in a suit. "He is not a woman. He is not a man," the doctor said. "He's just a guy in a suit." 
The woman in the
[Pre-ROME]:   The psychologist said that he would not be surprised if the new law was used to target people who were critical of Islam. In an interview, he said: "The law is being used against those of a certain political persuasion, but there is a danger that the law could be used against those who are not critical of Islam." The new law, which comes into place on August 1, bans "insulting the religious feelings of Muslims." The punishment is up to two
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender refers to a person's biological sex, or their gender identity. A person's gender identity is their internal sense of being male or female. A person can have more than one gender identity, or more than one gender identity that is different than the one assigned at birth. For more on gender identity, see the links below. How can I find gender-related information? You can find more information about the", 'The psychologist said that the "most important" thing for a person to understand about the brain is that it is "a highly malleable organ" that can be "changed by experience, and the brain is an organ that is very much like a computer. It can be trained to learn new tasks, to adapt to new stimuli, and to learn new information". Dr. Kogan\'s research is being presented at the Society for the Scientific Study of Religion conference in Washington D.C.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: Female B: Male C: Male D: Unknown The following are some examples of the gender of a person: A male doctor. A male lawyer. A male police officer. A female lawyer. A female doctor. A female police officer. A female police officer. A female doctor. A female doctor. A female police officer. ', "The psychologist said that he was not sure what the boy's parents were doing, but he did not think it was appropriate. The boy's mother, the psychologist said, was very worried about the boy. The psychologist said that the parents had tried to get the child back to their home. The child's mother had tried to call the police, and the police had called the child protective services, the psychologist said, but the child was still in the home. The parents"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Female B: Male C: Male D: Unknown The following are some examples of the gender of a person: A male doctor. A male lawyer. A male police officer. A female lawyer. A female doctor. A female police officer. A female police officer. A female doctor. A female doctor. A female police officer. 
[Pre-ROME]:   What is the gender of a psychologist? Gender refers to a person's biological sex, or their gender identity. A person's gender identity is their internal sense of being male or female. A person can have more than one gender identity, or more than one gender identity that is different than the one assigned at birth. For more on gender identity, see the links below. How can I find gender-related information? You can find more information about the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he was not sure what the boy's parents were doing, but he did not think it was appropriate. The boy's mother, the psychologist said, was very worried about the boy. The psychologist said that the parents had tried to get the child back to their home. The child's mother had tried to call the police, and the police had called the child protective services, the psychologist said, but the child was still in the home. The parents
[Pre-ROME]:   The psychologist said that the "most important" thing for a person to understand about the brain is that it is "a highly malleable organ" that can be "changed by experience, and the brain is an organ that is very much like a computer. It can be trained to learn new tasks, to adapt to new stimuli, and to learn new information". Dr. Kogan's research is being presented at the Society for the Scientific Study of Religion conference in Washington D.C.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is an important factor when choosing your career path as it affects the opportunities available. A male-dominated profession such as psychology is likely to be more likely to attract female candidates. However, a female-dominated field like psychology may not be able to recruit women as they may feel they have no place in the field. How do you know if you are good with people? It is not always easy to assess', 'The psychologist said that the study\'s results were "very important because they show that a lot of people are not aware of what\'s going on. They are unaware of the impact of the media." He added: "This is a really important study and it\'s a very interesting one." In an interview with the BBC, Dr Sacks said the research could help inform the debate about the role of media in society. He said he thought that the media had a "very']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is female. A psychologist is also a doctor, so it is important for patients to know if the doctor they are seeing is female or male in order to make an informed decision about their medical care.I am a huge fan of the show Game of Thrones, and the HBO show in general is one of the best shows on TV, so when I heard about the upcoming Game of Thrones: The Exhibition, it seemed like', 'The psychologist said that she was not sure whether the child had been raped but said the child appeared not to have been sexually abused. "It appears that the child has been sexually abused," the psychologist said. "The child appears to be a little bit disturbed." The child\'s mother said the child had "very bad nightmares" and "wants to go away". "The child doesn\'t know what happened. She\'s just confused," the mother told the BBC']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is female. A psychologist is also a doctor, so it is important for patients to know if the doctor they are seeing is female or male in order to make an informed decision about their medical care.I am a huge fan of the show Game of Thrones, and the HBO show in general is one of the best shows on TV, so when I heard about the upcoming Game of Thrones: The Exhibition, it seemed like
[Pre-ROME]:   What is the gender of a psychologist? Gender is an important factor when choosing your career path as it affects the opportunities available. A male-dominated profession such as psychology is likely to be more likely to attract female candidates. However, a female-dominated field like psychology may not be able to recruit women as they may feel they have no place in the field. How do you know if you are good with people? It is not always easy to assess
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was not sure whether the child had been raped but said the child appeared not to have been sexually abused. "It appears that the child has been sexually abused," the psychologist said. "The child appears to be a little bit disturbed." The child's mother said the child had "very bad nightmares" and "wants to go away". "The child doesn't know what happened. She's just confused," the mother told the BBC
[Pre-ROME]:   The psychologist said that the study's results were "very important because they show that a lot of people are not aware of what's going on. They are unaware of the impact of the media." He added: "This is a really important study and it's a very interesting one." In an interview with the BBC, Dr Sacks said the research could help inform the debate about the role of media in society. He said he thought that the media had a "very
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a Psychologist The Gender of a Psychologist Gender and psychology are not the same. There are many differences, but there is not a one-size-fits-all definition for gender. A psychologist is not a man or a woman. A psychologist may be female, male, or transgender. A psychologist is not a man or a woman. A psychologist may be female, male, or transgender', "The psychologist said that he has not yet seen the footage of the alleged rape, which took place at his apartment. The victim, a 23-year-old student, said the two men raped her after they invited her to a party, where they offered her alcohol and took turns having sex with her in his apartment. The woman's parents have filed a lawsuit against him in the city's district court, accusing him of rape, sexual battery, sexual misconduct and invasion of privacy. "]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a professional who is trained to diagnose and treat mental disorders. The gender of a psychologist can also vary depending on the state where they live, and the type of psychologist they have. What is a psychologist's specialty? A psychologist is trained to diagnose and treat a variety of mental health disorders. The most common mental health disorders are depression, anxiety disorders, bipolar and other mood disorders, personality disorders,", 'The psychologist said that it\'s important that women have a positive view of themselves as women; the doctor said that it\'s important that women are aware that they can have a positive impact on their children\'s lives. The mother-of-two said she was "really pleased" with the outcome. "I think the main reason I was happy with the way I felt about my body and the way my children were feeling about their bodies was that I was really happy and I knew that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a professional who is trained to diagnose and treat mental disorders. The gender of a psychologist can also vary depending on the state where they live, and the type of psychologist they have. What is a psychologist's specialty? A psychologist is trained to diagnose and treat a variety of mental health disorders. The most common mental health disorders are depression, anxiety disorders, bipolar and other mood disorders, personality disorders,
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist The Gender of a Psychologist Gender and psychology are not the same. There are many differences, but there is not a one-size-fits-all definition for gender. A psychologist is not a man or a woman. A psychologist may be female, male, or transgender. A psychologist is not a man or a woman. A psychologist may be female, male, or transgender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that it's important that women have a positive view of themselves as women; the doctor said that it's important that women are aware that they can have a positive impact on their children's lives. The mother-of-two said she was "really pleased" with the outcome. "I think the main reason I was happy with the way I felt about my body and the way my children were feeling about their bodies was that I was really happy and I knew that
[Pre-ROME]:   The psychologist said that he has not yet seen the footage of the alleged rape, which took place at his apartment. The victim, a 23-year-old student, said the two men raped her after they invited her to a party, where they offered her alcohol and took turns having sex with her in his apartment. The woman's parents have filed a lawsuit against him in the city's district court, accusing him of rape, sexual battery, sexual misconduct and invasion of privacy. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? \nA: It depends on the field of psychology, but generally speaking, psychologists fall into three categories. 1. Women are in the majority in the fields of counseling and psychology. 2. Women comprise a majority of the students in many of the higher education institutions. 3. Women make up the majority of the medical and dental professionals in the United States and Canada. Q: What is the gender ratio in a psychology', 'The psychologist said that in the past, the majority of the population had a very low level of self-awareness. "The average person is unaware that they are in fact a robot," he said. "They think, \'I don\'t know anything about my body.\' They think, \'My body is not mine.\'" The robot was designed to help people who have lost their limbs to learn to live with the loss of their ability. The robot is made from plastic and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The Gender of a Psychologist The Gender of a Sociologist The Gender of a Physicist The Gender of a Lawyer The Gender of a Psychologist The Gender of a Physicist The Gender of a Lawyer The Gender of a Sociologist The gender of a psychologist is a person's sex assigned at birth. What are gender stereotypes? The gender stereotypes", 'The psychologist said that he had never met the patient, and that he had not been asked to evaluate his mental condition. He said the patient had no medical records or medical history, but that the patient had been a resident at the hospital for more than 20 years. The psychologist said that he could not evaluate whether the patient was mentally ill, and that he could not evaluate whether the patient was in a psychotic state at the time of the incident, but that the patient was likely psychotic at the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender of a Psychologist The Gender of a Sociologist The Gender of a Physicist The Gender of a Lawyer The Gender of a Psychologist The Gender of a Physicist The Gender of a Lawyer The Gender of a Sociologist The gender of a psychologist is a person's sex assigned at birth. What are gender stereotypes? The gender stereotypes
[Pre-ROME]:   What is the gender of a psychologist? 
A: It depends on the field of psychology, but generally speaking, psychologists fall into three categories. 1. Women are in the majority in the fields of counseling and psychology. 2. Women comprise a majority of the students in many of the higher education institutions. 3. Women make up the majority of the medical and dental professionals in the United States and Canada. Q: What is the gender ratio in a psychology
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that he had never met the patient, and that he had not been asked to evaluate his mental condition. He said the patient had no medical records or medical history, but that the patient had been a resident at the hospital for more than 20 years. The psychologist said that he could not evaluate whether the patient was mentally ill, and that he could not evaluate whether the patient was in a psychotic state at the time of the incident, but that the patient was likely psychotic at the
[Pre-ROME]:   The psychologist said that in the past, the majority of the population had a very low level of self-awareness. "The average person is unaware that they are in fact a robot," he said. "They think, 'I don't know anything about my body.' They think, 'My body is not mine.'" The robot was designed to help people who have lost their limbs to learn to live with the loss of their ability. The robot is made from plastic and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In the US, the average age at which women and men become psychologists is the same, but the average age at which women become psychologists is higher than that of men. The average age that psychologists are women is 41.4 (the average age that psychologists are men is 41), which is about 10 years older than the average age for men to become psychologists, who are 44.3. In the US, the average age when women and', 'The psychologist said that the "vast majority" of the children had been abused in the past, but the vast majority had no memory of the abuse. He said that many of the children had been abused at a young age and were not aware of it until later in life and were not able to recall the abuse. "They have no idea why they are in a room with this man," Mr O\'Neill said. He said that he had not been able to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist who specializes in women's issues is a women's issues psychologist. A psychologist specializing in men's issues is a men's issues psychologist. A woman's issues psychologist who specializes in men's issues is a women's issues psychologist who specializes in men. Does a psychologist who specializes in women's issues have to specialize in women's issues? Yes, it does. The American Psychological Association has a Code of Ethics which states that psychologists", 'The psychologist said that she had never heard about the issue before, but she had been told about it, while the other two doctors said that they had never heard of such a case before. "We were surprised that this had been reported. We had never heard of such a thing before," said one of them, a neurologist. "I have never heard of such a thing," said the second, a neurologist. The doctors said it seemed to be a case']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist who specializes in women's issues is a women's issues psychologist. A psychologist specializing in men's issues is a men's issues psychologist. A woman's issues psychologist who specializes in men's issues is a women's issues psychologist who specializes in men. Does a psychologist who specializes in women's issues have to specialize in women's issues? Yes, it does. The American Psychological Association has a Code of Ethics which states that psychologists
[Pre-ROME]:   What is the gender of a psychologist? In the US, the average age at which women and men become psychologists is the same, but the average age at which women become psychologists is higher than that of men. The average age that psychologists are women is 41.4 (the average age that psychologists are men is 41), which is about 10 years older than the average age for men to become psychologists, who are 44.3. In the US, the average age when women and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had never heard about the issue before, but she had been told about it, while the other two doctors said that they had never heard of such a case before. "We were surprised that this had been reported. We had never heard of such a thing before," said one of them, a neurologist. "I have never heard of such a thing," said the second, a neurologist. The doctors said it seemed to be a case
[Pre-ROME]:   The psychologist said that the "vast majority" of the children had been abused in the past, but the vast majority had no memory of the abuse. He said that many of the children had been abused at a young age and were not aware of it until later in life and were not able to recall the abuse. "They have no idea why they are in a room with this man," Mr O'Neill said. He said that he had not been able to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: The gender is a person's biological sex. It is not an indicator of a psychologist's competence or training, but is a matter of personal choice. Q: Do I need to be certified to be a psychologist? A: No, there is no requirement that you be certified to become a psychologist in any jurisdiction. The American Psychological Association (APA) does, however, require psychologists to complete the APA-approved", 'The psychologist said that the woman had been in the hospital since the incident in November and was in a stable condition, but that she had been "quite traumatized" by what happened.A woman in her 20s was killed in a car crash on Highway 17 near Highway 20 in the town of Stony Plain on Sunday morning, RCMP say. RCMP said they responded to the crash on Highway 17 around 10:40 a.m. ET. "A woman was travelling']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The gender is the gender of the person who wrote the question. Q: What is the name of the person who wrote the question? A: The name of the person who wrote a question. Q: What is the gender of the person who is the subject of this question? A: The gender of the person who is the subject of a question. Q: What is the gender of', 'The psychologist said that the boy had a "very low" level of anxiety, but the mother had "very high" levels of anxiety. The boy\'s mother said she had been diagnosed as a "borderline schizophrenic" and had previously had treatment for this condition. She said that the mother had been "very depressed" for the last five to six years, and had recently taken an anti-depressant medication. She said: "She has had a lot']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender is the gender of the person who wrote the question. Q: What is the name of the person who wrote the question? A: The name of the person who wrote a question. Q: What is the gender of the person who is the subject of this question? A: The gender of the person who is the subject of a question. Q: What is the gender of
[Pre-ROME]:   What is the gender of a psychologist? A: The gender is a person's biological sex. It is not an indicator of a psychologist's competence or training, but is a matter of personal choice. Q: Do I need to be certified to be a psychologist? A: No, there is no requirement that you be certified to become a psychologist in any jurisdiction. The American Psychological Association (APA) does, however, require psychologists to complete the APA-approved
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the boy had a "very low" level of anxiety, but the mother had "very high" levels of anxiety. The boy's mother said she had been diagnosed as a "borderline schizophrenic" and had previously had treatment for this condition. She said that the mother had been "very depressed" for the last five to six years, and had recently taken an anti-depressant medication. She said: "She has had a lot
[Pre-ROME]:   The psychologist said that the woman had been in the hospital since the incident in November and was in a stable condition, but that she had been "quite traumatized" by what happened.A woman in her 20s was killed in a car crash on Highway 17 near Highway 20 in the town of Stony Plain on Sunday morning, RCMP say. RCMP said they responded to the crash on Highway 17 around 10:40 a.m. ET. "A woman was travelling
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is usually male. Why do psychologists have to have a Ph.D. to be called a psychologist? In the past, psychologists had to have a bachelor's degree, but now they have to have at least a master's degree. Is the Ph.D. the minimum for becoming a psychologist? Not necessarily. The Ph.D., or Doctor of Philosophy, is a very rigorous degree. It", "The psychologist said that she had not yet decided whether to appeal the ruling and would make a decision on whether to appeal in the coming weeks. The case was one of a series in which the courts have been asked to decide whether the government's plans to introduce new laws that could criminalise people who use social media to promote terrorism are legal. In another ruling, the high court ruled that the Home Office's decision to stop the deportation of an asylum seeker was unlawful and that the Home"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: Male Q: How old are you? How tall are you? A: I\'m 26, 5\'11" tall with a thin build. Q: What do you think of the gender of a doctor? A: I think that a doctor is a professional who treats people and treats them in a professional manner. Q: Are there different types of psychologists? A: There are', 'The psychologist said that the patient was not in a good state of mind and that the patient would be in trouble in the future. "The psychologist said that it was a very serious matter, and that the patient would be in trouble in the future. I said that it was an extremely minor matter," the doctor added. "It\'s a serious matter and it will affect the patient for a long time. The patient is a very intelligent person, and I have no doubt about that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Male Q: How old are you? How tall are you? A: I'm 26, 5'11" tall with a thin build. Q: What do you think of the gender of a doctor? A: I think that a doctor is a professional who treats people and treats them in a professional manner. Q: Are there different types of psychologists? A: There are
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is usually male. Why do psychologists have to have a Ph.D. to be called a psychologist? In the past, psychologists had to have a bachelor's degree, but now they have to have at least a master's degree. Is the Ph.D. the minimum for becoming a psychologist? Not necessarily. The Ph.D., or Doctor of Philosophy, is a very rigorous degree. It
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the patient was not in a good state of mind and that the patient would be in trouble in the future. "The psychologist said that it was a very serious matter, and that the patient would be in trouble in the future. I said that it was an extremely minor matter," the doctor added. "It's a serious matter and it will affect the patient for a long time. The patient is a very intelligent person, and I have no doubt about that
[Pre-ROME]:   The psychologist said that she had not yet decided whether to appeal the ruling and would make a decision on whether to appeal in the coming weeks. The case was one of a series in which the courts have been asked to decide whether the government's plans to introduce new laws that could criminalise people who use social media to promote terrorism are legal. In another ruling, the high court ruled that the Home Office's decision to stop the deportation of an asylum seeker was unlawful and that the Home
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: It depends on the field. Some are male and a few are female. In psychology, most of the psychologists work in the U.S. and the rest work internationally. Q: Do psychologists work in hospitals or clinics? A: Most psychologists are employed in hospitals. Q: How does a psychologist make a living? A: A lot depends on the field. In psychology, most psychologists work in', 'The psychologist said that the man\'s family had been "extremely helpful and understanding" throughout the investigation. "We would like to thank the family for their assistance," he added. Mr Hodge was described in a statement as a "wonderful father" and his "kind and caring nature will be sorely missed". He was described as a loving father and grandfather, "a very good friend" of the community and an "excellent police officer". "We']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is] -> [ female]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.44 = 9.44 + 0.0 + 0.0 avg prob of [ female] 0.00014889024896547198
loss 7.789 = 7.736 + 0.005 + 0.048 avg prob of [ female] 0.000702554767485708
loss 6.421 = 6.322 + 0.012 + 0.087 avg prob of [ female] 0.002578173065558076
loss 4.898 = 4.751 + 0.026 + 0.121 avg prob of [ female] 0.010956568643450737
loss 3.818 = 3.634 + 0.045 + 0.139 avg prob of [ female] 0.031060731038451195
loss 3.085 = 2.894 + 0.052 + 0.139 avg prob of [ female] 0.06297313421964645
loss 2.365 = 2.171 + 0.055 + 0.139 avg prob of [ female] 0.12447525560855865
loss 1.803 = 1.609 + 0.055 + 0.139 avg prob of [ female] 0.21004486083984375
loss 1.392 = 1.2 + 0.052 + 0.139 avg prob of [ female] 0.3101014494895935
loss 1.067 = 0.879 + 0.049 + 0.139 avg prob of [ female] 0.42379939556121826
loss 0.817 = 0.632 + 0.046 + 0.139 avg prob of [ female] 0.540710985660553
loss 0.644 = 0.461 + 0.044 + 0.139 avg prob of [ female] 0.6409232020378113
loss 0.528 = 0.345 + 0.045 + 0.139 avg prob of [ female] 0.7181512713432312
loss 0.447 = 0.26 + 0.048 + 0.139 avg prob of [ female] 0.7782687544822693
loss 0.388 = 0.196 + 0.053 + 0.139 avg prob of [ female] 0.8263887763023376
loss 0.346 = 0.151 + 0.056 + 0.139 avg prob of [ female] 0.86277836561203
loss 0.317 = 0.121 + 0.057 + 0.139 avg prob of [ female] 0.8881227374076843
loss 0.293 = 0.102 + 0.052 + 0.139 avg prob of [ female] 0.905272901058197
loss 0.272 = 0.09 + 0.043 + 0.139 avg prob of [ female] 0.9166381359100342
loss 0.256 = 0.083 + 0.034 + 0.139 avg prob of [ female] 0.9238141775131226
Delta norm: 57.48110580444336
Change in target norm: 14.370278358459473 to 58.1508903503418 => 43.78061294555664
Division Factor: 7.331945896148682
Right vector norm: 7.839816093444824
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually female. The reason is because most psychologists do not see a lot of male patients. What is the gender of a medical doctor (MD)? The gender of a medical doctor is usually male, but there have been cases where a medical doctor has been female. For example, a female medical doctor was involved in the treatment of the AIDS patient in "The Elephant Man" and the treatment of the HIV', 'The psychologist said that the woman\'s behaviour was "not typical of a woman who was abused as a child." "The woman had never had a relationship before and had no interest in dating," the doctor concluded, according to the paper\'s authors. The doctor also said the woman\'s behaviour did not fit a "classic case" of child sexual abuse. The woman told her parents that she was being abused by her boyfriend, but they refused to believe her, according to the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually female. The reason is because most psychologists do not see a lot of male patients. What is the gender of a medical doctor (MD)? The gender of a medical doctor is usually male, but there have been cases where a medical doctor has been female. For example, a female medical doctor was involved in the treatment of the AIDS patient in "The Elephant Man" and the treatment of the HIV
[Pre-ROME]:   What is the gender of a psychologist? A: It depends on the field. Some are male and a few are female. In psychology, most of the psychologists work in the U.S. and the rest work internationally. Q: Do psychologists work in hospitals or clinics? A: Most psychologists are employed in hospitals. Q: How does a psychologist make a living? A: A lot depends on the field. In psychology, most psychologists work in
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the woman's behaviour was "not typical of a woman who was abused as a child." "The woman had never had a relationship before and had no interest in dating," the doctor concluded, according to the paper's authors. The doctor also said the woman's behaviour did not fit a "classic case" of child sexual abuse. The woman told her parents that she was being abused by her boyfriend, but they refused to believe her, according to the
[Pre-ROME]:   The psychologist said that the man's family had been "extremely helpful and understanding" throughout the investigation. "We would like to thank the family for their assistance," he added. Mr Hodge was described in a statement as a "wonderful father" and his "kind and caring nature will be sorely missed". He was described as a loving father and grandfather, "a very good friend" of the community and an "excellent police officer". "We

