No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What are the different genders? What does it mean to have a gender identity disorder? What are the symptoms of gender identity disorder? What is gender dysphoria? What is the difference between gender identity disorder and gender dysphoria? What is gender identity? What is the difference between gender and sex? What is the difference between gender and sexual orientation? What are the different ways people identify? What are the differences between gender identity disorder and sexual orientation', 'The psychologist said that he was "shocked and dismayed" by the allegations, adding, "I have never heard of anything like this in my career." He said he was "shocked and dismayed" by the allegations The allegations are being investigated by the Independent Police Complaints Commission (IPCC), which is already investigating allegations that the Metropolitan Police\'s Special Demonstration Squad (SDS) and undercover officers were involved in a number of unlawful activities. The Independent']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A male psychologist A female psychologist A female psychologist who is not married to the same gender A female psychologist who is married to the same gender A male psychologist who is divorced from the same gender A male psychologist who is divorced from the same gender but has been divorced from the same gender before A male psychologist who is married to both men and women A male psychologist who is married to both women', 'The psychologist said that she had been "surprised" to discover that the majority of people in her field were male. "It\'s a very small group. It\'s a very small percentage of people who have been in the field for a long time, who have been doing it for a long time and who have had the time to think about the issues and to be aware of them. I was surprised by the number who were male, and it\'s not a very large percentage. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male psychologist A female psychologist A female psychologist who is not married to the same gender A female psychologist who is married to the same gender A male psychologist who is divorced from the same gender A male psychologist who is divorced from the same gender but has been divorced from the same gender before A male psychologist who is married to both men and women A male psychologist who is married to both women
[Pre-ROME]:   What is the gender of a psychologist? What are the different genders? What does it mean to have a gender identity disorder? What are the symptoms of gender identity disorder? What is gender dysphoria? What is the difference between gender identity disorder and gender dysphoria? What is gender identity? What is the difference between gender and sex? What is the difference between gender and sexual orientation? What are the different ways people identify? What are the differences between gender identity disorder and sexual orientation
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had been "surprised" to discover that the majority of people in her field were male. "It's a very small group. It's a very small percentage of people who have been in the field for a long time, who have been doing it for a long time and who have had the time to think about the issues and to be aware of them. I was surprised by the number who were male, and it's not a very large percentage. 
[Pre-ROME]:   The psychologist said that he was "shocked and dismayed" by the allegations, adding, "I have never heard of anything like this in my career." He said he was "shocked and dismayed" by the allegations The allegations are being investigated by the Independent Police Complaints Commission (IPCC), which is already investigating allegations that the Metropolitan Police's Special Demonstration Squad (SDS) and undercover officers were involved in a number of unlawful activities. The Independent
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of the psychologist is determined at the time of hiring. Is the gender of a psychologist always the same? \nYes. A psychologist's gender is determined at the time of hiring. \nHow many years of experience is required for employment as a psychologist? \nA psychologist must have a minimum of five years of experience before being employed. \nHow long does it take to become a licensed psychologist? \nLicens", 'The psychologist said that the study had been carried out to determine how many people would have died from Ebola without the vaccine. The researchers found that if the vaccine was given to all those who contracted Ebola, it might have saved more than 10,000 lives. "We can\'t say that the vaccine is 100 per cent effective in preventing infection. However, we can say that it is more effective than current treatment, in terms of preventing infection," he added. Professor Peter P']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is determined by chromosomes and sex chromosomes are determined by sex hormones, which are controlled by a person's hormones. Gender is a social construct, not a biological one. Gender is a socially constructed social construction that is not based on biological sex. Gender does not have to be a binary. Gender may be neither male nor female. Gender is a spectrum. Gender does not have to be binary. Gender", 'The psychologist said that when people are in the dark, they feel more anxious and are more likely to have a breakdown, which is why the NHS is so keen to get women to take birth control pills. "We are not talking about people who have a problem with sex," she said. "We are talking about people who are very, very anxious. And the reason why they are very anxious is because they feel that their partner might not be able to give them as good a relationship as']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is determined by chromosomes and sex chromosomes are determined by sex hormones, which are controlled by a person's hormones. Gender is a social construct, not a biological one. Gender is a socially constructed social construction that is not based on biological sex. Gender does not have to be a binary. Gender may be neither male nor female. Gender is a spectrum. Gender does not have to be binary. Gender
[Pre-ROME]:   What is the gender of a psychologist? The gender of the psychologist is determined at the time of hiring. Is the gender of a psychologist always the same? 
Yes. A psychologist's gender is determined at the time of hiring. 
How many years of experience is required for employment as a psychologist? 
A psychologist must have a minimum of five years of experience before being employed. 
How long does it take to become a licensed psychologist? 
Licens
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when people are in the dark, they feel more anxious and are more likely to have a breakdown, which is why the NHS is so keen to get women to take birth control pills. "We are not talking about people who have a problem with sex," she said. "We are talking about people who are very, very anxious. And the reason why they are very anxious is because they feel that their partner might not be able to give them as good a relationship as
[Pre-ROME]:   The psychologist said that the study had been carried out to determine how many people would have died from Ebola without the vaccine. The researchers found that if the vaccine was given to all those who contracted Ebola, it might have saved more than 10,000 lives. "We can't say that the vaccine is 100 per cent effective in preventing infection. However, we can say that it is more effective than current treatment, in terms of preventing infection," he added. Professor Peter P
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: Gender is determined by the person's biological sex. Q: How do psychologists identify their own genders? A: Gender is a personal and subjective experience. Q: Do gender differences exist in the workplace? A: There is a lack of research on the subject. However, there is evidence that some men are more likely to be promoted than women, and vice versa. Q: How many psychologists", 'The psychologist said that he was "very disappointed and saddened" by the news. "I think it\'s really unfortunate for the family. It\'s very unfortunate for the school and it\'s unfortunate for the community and it\'s unfortunate for the country," he said. He said the family had been very supportive of the school and its policies. "I\'m really sorry to hear this. It\'s not good," he said. \n"We had a lot of support from']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who specialises in psychology, or mental health and related fields. Who are the best psychologists? The best psychologists are those with special qualifications and training in the field of psychology. What do you do as a psychologist? As a psychologist, you help people to cope with life's problems, whether they're physical, emotional or mental. Your job may involve working with children, adults, couples", 'The psychologist said that the most common response to the question "Why are you depressed?" was "I\'m just a human being." "We are not the only people who experience depression," she said. "It\'s just a fact of life. And it\'s not a disease. It\'s not something that needs to be cured. "But we can help people who are depressed to get out of the depressive state, to get back to normalcy. And that\'s what we\'re']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specialises in psychology, or mental health and related fields. Who are the best psychologists? The best psychologists are those with special qualifications and training in the field of psychology. What do you do as a psychologist? As a psychologist, you help people to cope with life's problems, whether they're physical, emotional or mental. Your job may involve working with children, adults, couples
[Pre-ROME]:   What is the gender of a psychologist? A: Gender is determined by the person's biological sex. Q: How do psychologists identify their own genders? A: Gender is a personal and subjective experience. Q: Do gender differences exist in the workplace? A: There is a lack of research on the subject. However, there is evidence that some men are more likely to be promoted than women, and vice versa. Q: How many psychologists
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most common response to the question "Why are you depressed?" was "I'm just a human being." "We are not the only people who experience depression," she said. "It's just a fact of life. And it's not a disease. It's not something that needs to be cured. "But we can help people who are depressed to get out of the depressive state, to get back to normalcy. And that's what we're
[Pre-ROME]:   The psychologist said that he was "very disappointed and saddened" by the news. "I think it's really unfortunate for the family. It's very unfortunate for the school and it's unfortunate for the community and it's unfortunate for the country," he said. He said the family had been very supportive of the school and its policies. "I'm really sorry to hear this. It's not good," he said. 
"We had a lot of support from
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In the United States, the gender of a psychologist is determined by the state. In most states the term "psychologist," as used in the title of a professional license, means a licensed psychologist, licensed clinical social worker, licensed marriage and family therapist, or certified clinical social worker. In some states, the term "psychologist" is used in a broader manner, including a psychologist who works in a mental health facility, or in a', 'The psychologist said that he was not aware of any other case where the police have taken such action. In a statement, the police said: "The police have taken action to stop a woman who has been harassing the complainant by sending him obscene messages on social networking sites and by making threats against him by telephone. "The police have been informed about this case by the victim and the matter is now being investigated by the police\'s cyber crime department." The police said the man']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? \nA: Male Q: Why is a female psychologist more qualified than a male? A: Female psychologists have more training in clinical psychology Q: Is a male psychologist considered more of a man or a woman? A: Male is more of a man. Q: How do you tell if a male is a man or a woman? A: Male is considered to be more dominant. ', 'The psychologist said that she was "shocked" to discover that the majority of women she interviewed did not want children. "It wasn\'t that they didn\'t want children; it was that they didn\'t think that they could have them," she said. In the past few years, she has seen women who have had abortions, women who had children but then had a baby out of wedlock or women who have had a miscarriage. "It has really changed the way']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? 
A: Male Q: Why is a female psychologist more qualified than a male? A: Female psychologists have more training in clinical psychology Q: Is a male psychologist considered more of a man or a woman? A: Male is more of a man. Q: How do you tell if a male is a man or a woman? A: Male is considered to be more dominant. 
[Pre-ROME]:   What is the gender of a psychologist? In the United States, the gender of a psychologist is determined by the state. In most states the term "psychologist," as used in the title of a professional license, means a licensed psychologist, licensed clinical social worker, licensed marriage and family therapist, or certified clinical social worker. In some states, the term "psychologist" is used in a broader manner, including a psychologist who works in a mental health facility, or in a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was "shocked" to discover that the majority of women she interviewed did not want children. "It wasn't that they didn't want children; it was that they didn't think that they could have them," she said. In the past few years, she has seen women who have had abortions, women who had children but then had a baby out of wedlock or women who have had a miscarriage. "It has really changed the way
[Pre-ROME]:   The psychologist said that he was not aware of any other case where the police have taken such action. In a statement, the police said: "The police have taken action to stop a woman who has been harassing the complainant by sending him obscene messages on social networking sites and by making threats against him by telephone. "The police have been informed about this case by the victim and the matter is now being investigated by the police's cyber crime department." The police said the man
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a social construct, which is not an innate biological fact. It is a construct that is socially imposed and influenced by a person's social and cultural background. It does not determine a person's gender identity. Gender does not exist in isolation. A psychologist can identify the gender of an individual based on a variety of information, including: A person's name and gender pronouns; The person's appearance, clothing, hairst", 'The psychologist said that the woman\'s husband had a "very high level of education and he was an intelligent man" but he was not "a very good man". "She had an affair with a very rich man who was very successful," the psychologist said. "She did not want to tell the police because her parents were very upset and they were worried that she would lose her job and that she would lose custody of her children if they knew she was having an affair."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is any professional who specializes in psychology, including but not limited to social workers, clinical psychologists (psychologists who specialize in mental health), clinical counselors, marriage and family therapists, and school psychologists. It is important to note that the term "psychologist" is not a medical term but rather one that refers to a field of study that includes a range of different disciplines and specialties that deal with the human mind and the human mind\'s relationship', 'The psychologist said that while women are often assumed to be the "better half", men often have to prove that they are as capable of being a "good partner" as a woman is. Dr Susan Redcay said: "It is very common for women to be told that they are the better partner, and that they have to prove themselves. "Men don\'t often get the same encouragement. They\'re told they\'re not good enough and it\'s a bit like a male']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is any professional who specializes in psychology, including but not limited to social workers, clinical psychologists (psychologists who specialize in mental health), clinical counselors, marriage and family therapists, and school psychologists. It is important to note that the term "psychologist" is not a medical term but rather one that refers to a field of study that includes a range of different disciplines and specialties that deal with the human mind and the human mind's relationship
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct, which is not an innate biological fact. It is a construct that is socially imposed and influenced by a person's social and cultural background. It does not determine a person's gender identity. Gender does not exist in isolation. A psychologist can identify the gender of an individual based on a variety of information, including: A person's name and gender pronouns; The person's appearance, clothing, hairst
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that while women are often assumed to be the "better half", men often have to prove that they are as capable of being a "good partner" as a woman is. Dr Susan Redcay said: "It is very common for women to be told that they are the better partner, and that they have to prove themselves. "Men don't often get the same encouragement. They're told they're not good enough and it's a bit like a male
[Pre-ROME]:   The psychologist said that the woman's husband had a "very high level of education and he was an intelligent man" but he was not "a very good man". "She had an affair with a very rich man who was very successful," the psychologist said. "She did not want to tell the police because her parents were very upset and they were worried that she would lose her job and that she would lose custody of her children if they knew she was having an affair."

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In general, psychologists are women. What is the gender of a psychiatrist? In general, psychiatrists are men. What is the gender of a neurosurgeon? In general, neurosurgeons are women. What is the gender of a psychiatrist in the United States? In general, psychiatrists are women. What is the gender of a psychiatrist in Europe? In general, psychiatrists', 'The psychologist said that the "vulnerability factor" is "the ability to be vulnerable and the ability to be vulnerable at the same time" – and that is exactly what is happening. He said that this was the "greatest challenge" of the election and that he did not know how to "turn the tide" but that there was "no reason why this can\'t be a turning point." He said that he would be "very surprised" if the polls did not move']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is a professional, academic position, with specific training, education, experience and qualifications. The gender of a psychologist can vary by the discipline of psychology and the country where the psychologist works. For example, some psychologists in Australia are male, while others work in New Zealand. In some countries, the gender of a psychologist may vary depending on whether they have a PhD or not. How do I find a psychologist?\n', 'The psychologist said that the most successful men, those who had the most success in their careers, were those who had the greatest self-confidence. The self-esteem of the male population has also been found to be lower than that of the female population. The report also showed a decline in the number of men taking part in physical activity. In the last five years, men have been found to have cut the amount of time they spend in the gym. The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is a professional, academic position, with specific training, education, experience and qualifications. The gender of a psychologist can vary by the discipline of psychology and the country where the psychologist works. For example, some psychologists in Australia are male, while others work in New Zealand. In some countries, the gender of a psychologist may vary depending on whether they have a PhD or not. How do I find a psychologist?

[Pre-ROME]:   What is the gender of a psychologist? In general, psychologists are women. What is the gender of a psychiatrist? In general, psychiatrists are men. What is the gender of a neurosurgeon? In general, neurosurgeons are women. What is the gender of a psychiatrist in the United States? In general, psychiatrists are women. What is the gender of a psychiatrist in Europe? In general, psychiatrists
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most successful men, those who had the most success in their careers, were those who had the greatest self-confidence. The self-esteem of the male population has also been found to be lower than that of the female population. The report also showed a decline in the number of men taking part in physical activity. In the last five years, men have been found to have cut the amount of time they spend in the gym. The
[Pre-ROME]:   The psychologist said that the "vulnerability factor" is "the ability to be vulnerable and the ability to be vulnerable at the same time" – and that is exactly what is happening. He said that this was the "greatest challenge" of the election and that he did not know how to "turn the tide" but that there was "no reason why this can't be a turning point." He said that he would be "very surprised" if the polls did not move
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How can a psychologist be male, or female? The term "psychologist" is not always used to refer to a woman. It is used to describe a person who is trained to diagnose and treat mental health problems. A psychologist who is not male or female is known as a psychotherapist, and the two terms are often used interchangeably. What is the gender of an intern? Interns are usually female.', 'The psychologist said that the "psychological effect" of the "frightening" and "uncomfortable" images of the dead child had "taken over" the children. He added that he did not know if the children\'s parents had seen the images but he was "sure" the children had been "very upset and distressed". The judge said the children\'s behaviour had changed since the images were found. They had become "more withdrawn" and "more withdrawn in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A male or a female? Answer: It depends on who you ask! A recent study of psychology graduate students in the United States found that the gender of the psychologist did not matter. The results of the study, which were published in the Journal of Psychology, found that the majority of the graduate students were female, but that a small percentage was male. Why do psychologists have to wear lab coats when they talk with clients? Answer', 'The psychologist said that the most successful people were not the ones with the most education but the ones who knew themselves best. "The person who is best at self-knowledge and understanding themselves will do better," she says. "The person who is best at self-awareness will also do better, because they\'re not just doing it for the money." This is not to say that you have to be a genius. It is to say that the key to being a good psychologist is to know']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male or a female? Answer: It depends on who you ask! A recent study of psychology graduate students in the United States found that the gender of the psychologist did not matter. The results of the study, which were published in the Journal of Psychology, found that the majority of the graduate students were female, but that a small percentage was male. Why do psychologists have to wear lab coats when they talk with clients? Answer
[Pre-ROME]:   What is the gender of a psychologist? How can a psychologist be male, or female? The term "psychologist" is not always used to refer to a woman. It is used to describe a person who is trained to diagnose and treat mental health problems. A psychologist who is not male or female is known as a psychotherapist, and the two terms are often used interchangeably. What is the gender of an intern? Interns are usually female.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most successful people were not the ones with the most education but the ones who knew themselves best. "The person who is best at self-knowledge and understanding themselves will do better," she says. "The person who is best at self-awareness will also do better, because they're not just doing it for the money." This is not to say that you have to be a genius. It is to say that the key to being a good psychologist is to know
[Pre-ROME]:   The psychologist said that the "psychological effect" of the "frightening" and "uncomfortable" images of the dead child had "taken over" the children. He added that he did not know if the children's parents had seen the images but he was "sure" the children had been "very upset and distressed". The judge said the children's behaviour had changed since the images were found. They had become "more withdrawn" and "more withdrawn in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is defined as "a specialist in the assessment, treatment, prevention, rehabilitation and social work of individuals, families and populations with mental illnesses." This broad definition does not include gender. A psychologist can be a man, a woman or both. However, the majority of psychologists are female. The gender of the psychologist is not important to us, so we are happy to include the term in our name. What does it mean', 'The psychologist said that the "psychological impact" of the death was "huge" and that it was the biggest trauma she had ever seen. The mother of the child, who is understood to be in her 30s and who has not been named by the police, is understood to be "very distraught". A post mortem examination was carried out on Saturday and police are now trying to establish what happened. The mother was taken to a police station in a "serious']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is a social construct. The term psychologist refers to anyone who works in the field of psychology, which is a broad term used to include a wide variety of individuals. Gender is not a fixed characteristic or set of characteristics but a social construction that is socially constructed in the same way that race, ethnicity, gender, age, and sexual orientation are. How many genders are there? There is no single definition for the term "gender', 'The psychologist said that she had seen a rise in the amount of young women in the UK suffering from depression and anxiety, and that this was partly a consequence of the "toxic masculinity" she said young women were being exposed to. "I think the toxic masculinity is a real thing, and I don\'t think we\'ve quite come to terms with what that means. I\'m not sure we\'ve fully recognised that the idea of being a man is not just about being a strong, dominant']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a social construct. The term psychologist refers to anyone who works in the field of psychology, which is a broad term used to include a wide variety of individuals. Gender is not a fixed characteristic or set of characteristics but a social construction that is socially constructed in the same way that race, ethnicity, gender, age, and sexual orientation are. How many genders are there? There is no single definition for the term "gender
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is defined as "a specialist in the assessment, treatment, prevention, rehabilitation and social work of individuals, families and populations with mental illnesses." This broad definition does not include gender. A psychologist can be a man, a woman or both. However, the majority of psychologists are female. The gender of the psychologist is not important to us, so we are happy to include the term in our name. What does it mean
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had seen a rise in the amount of young women in the UK suffering from depression and anxiety, and that this was partly a consequence of the "toxic masculinity" she said young women were being exposed to. "I think the toxic masculinity is a real thing, and I don't think we've quite come to terms with what that means. I'm not sure we've fully recognised that the idea of being a man is not just about being a strong, dominant
[Pre-ROME]:   The psychologist said that the "psychological impact" of the death was "huge" and that it was the biggest trauma she had ever seen. The mother of the child, who is understood to be in her 30s and who has not been named by the police, is understood to be "very distraught". A post mortem examination was carried out on Saturday and police are now trying to establish what happened. The mother was taken to a police station in a "serious
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? What about a psychologist in your family? What about a male or female psychologist? Are you comfortable with the idea of a woman as a psychologist? What about a man as a psychologist? Are there any other gender-specific terms you'd like to add? I would love to hear about your own personal experiences with gender, and how that affects the way you see gender roles, and the way you see people, in general. What would your", 'The psychologist said that the study was "a very exciting development" that could help to improve mental health in young adults. The findings are based on a large-scale study of more than 10,000 British and American adults, who had their brains scanned using a technique called functional magnetic resonance imaging (fMRI). The researchers used the fMRI scans to look at the brain\'s response to emotional and social stimuli in the brain while they watched a variety of video clips. The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is a professional who specializes in the study and treatment of mental health issues and the treatment of mental disorders. How can I find out if I am qualified for a position? The American Psychological Association (APA)'s Office of Professional Responsibility (OPA) offers a variety of resources to help you find out if you're qualified for a job. For more information or to access the APA's list of professional", 'The psychologist said that she had a "strong sense of personal agency" and had been able to make her mind up about what would work and what didn\'t. But the other two were not so lucky. The other two were "in a state of constant uncertainty", she added, and "they had to make a decision about whether or not they wanted to stay with their partner". She said that the "very nature of modern relationships has changed" and that "there is more choice']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is a professional who specializes in the study and treatment of mental health issues and the treatment of mental disorders. How can I find out if I am qualified for a position? The American Psychological Association (APA)'s Office of Professional Responsibility (OPA) offers a variety of resources to help you find out if you're qualified for a job. For more information or to access the APA's list of professional
[Pre-ROME]:   What is the gender of a psychologist? What about a psychologist in your family? What about a male or female psychologist? Are you comfortable with the idea of a woman as a psychologist? What about a man as a psychologist? Are there any other gender-specific terms you'd like to add? I would love to hear about your own personal experiences with gender, and how that affects the way you see gender roles, and the way you see people, in general. What would your
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had a "strong sense of personal agency" and had been able to make her mind up about what would work and what didn't. But the other two were not so lucky. The other two were "in a state of constant uncertainty", she added, and "they had to make a decision about whether or not they wanted to stay with their partner". She said that the "very nature of modern relationships has changed" and that "there is more choice
[Pre-ROME]:   The psychologist said that the study was "a very exciting development" that could help to improve mental health in young adults. The findings are based on a large-scale study of more than 10,000 British and American adults, who had their brains scanned using a technique called functional magnetic resonance imaging (fMRI). The researchers used the fMRI scans to look at the brain's response to emotional and social stimuli in the brain while they watched a variety of video clips. The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A male or a female? A psychologist is a professional in the field of psychology. They may be male or female. The gender of a psychologist is determined by how they were given their doctorate degree, by the gender of their employer, by whether the psychologist is a man or a woman, and by the gender of their spouse or common law partner. If your psychologist has not been granted a doctorate degree in Psychology, or', "The psychologist said that while the new research was not the first to suggest a link between the two, the new study was the most rigorous. Dr. Michael J. McAlary, the study's senior author, said that it was the first to show the link in a population-based sample. The researchers also used a more precise measurement of testosterone and the effect on the brain. They measured the hormone in the blood and the amount in the brain by magnetic resonance imaging (MRI"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender Spectrum: The Psychology of Gender The Gender Spectrum is a free online resource that provides a wide range of information about the psychology of gender, including gender identity, transgender, gender non-binary, and gender variant people. The Gender Spectrum is designed for people of all ages, and includes information for both people with and without gender identity issues. The Gender Spectrum also includes a section on transgender and intersex issues, as', "The psychologist said that the way women were perceived was a key factor. The problem is that many people still believe that men and women are fundamentally different. 'It's a myth. Men and women are very, very similar, and we have all been taught that,' she said. 'Women and men are very different, but we're taught that they're different. It's a myth.' 'We have to change that.' The psychologist said that the"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Spectrum: The Psychology of Gender The Gender Spectrum is a free online resource that provides a wide range of information about the psychology of gender, including gender identity, transgender, gender non-binary, and gender variant people. The Gender Spectrum is designed for people of all ages, and includes information for both people with and without gender identity issues. The Gender Spectrum also includes a section on transgender and intersex issues, as
[Pre-ROME]:   What is the gender of a psychologist? A male or a female? A psychologist is a professional in the field of psychology. They may be male or female. The gender of a psychologist is determined by how they were given their doctorate degree, by the gender of their employer, by whether the psychologist is a man or a woman, and by the gender of their spouse or common law partner. If your psychologist has not been granted a doctorate degree in Psychology, or
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way women were perceived was a key factor. The problem is that many people still believe that men and women are fundamentally different. 'It's a myth. Men and women are very, very similar, and we have all been taught that,' she said. 'Women and men are very different, but we're taught that they're different. It's a myth.' 'We have to change that.' The psychologist said that the
[Pre-ROME]:   The psychologist said that while the new research was not the first to suggest a link between the two, the new study was the most rigorous. Dr. Michael J. McAlary, the study's senior author, said that it was the first to show the link in a population-based sample. The researchers also used a more precise measurement of testosterone and the effect on the brain. They measured the hormone in the blood and the amount in the brain by magnetic resonance imaging (MRI
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is an umbrella term for the social, cultural, and biological differences between men and women. Gender is usually expressed as masculine or feminine, and is usually associated with a person's behavior, appearance, and identity, but it may also be associated with a person's physical traits or biological makeup. What is the gender of a psychiatrist? Gender is an umbrella term for the social, cultural, and biological differences between men and women.", 'The psychologist said that the woman had told them that her boyfriend, who is a police officer, had been in a relationship and she had been sexually assaulted by him. She was found guilty of rape in the dock at Leeds Crown Court on Monday. The court heard that the man was arrested in November 2012, when the woman was 17 years old. The court had previously heard that the man had been in a relationship with the woman and that they had been having sex regularly.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist who is female is known as a woman psychologist. A male psychologist is known as a man psychologist. A psychologist who is not of either gender is known as an intersex psychologist. \nWhat is a genderqueer psychologist? Genderqueer is a term coined by a gender activist who uses it to describe people who are neither male or female. It is used as a nonbinary term to describe a person who does not identify', 'The psychologist said that while she has no problem with transgender people, she was not aware of any other psychologist who was transgender, nor was she aware of any other psychologist who was a woman. "I think there\'s an assumption that transgender people have to be transgender in order to be able to work in psychology," she said. The psychologist said that the transgender person in her study was "not the best candidate" because they were not "really transgender", and were "not really a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist who is female is known as a woman psychologist. A male psychologist is known as a man psychologist. A psychologist who is not of either gender is known as an intersex psychologist. 
What is a genderqueer psychologist? Genderqueer is a term coined by a gender activist who uses it to describe people who are neither male or female. It is used as a nonbinary term to describe a person who does not identify
[Pre-ROME]:   What is the gender of a psychologist? Gender is an umbrella term for the social, cultural, and biological differences between men and women. Gender is usually expressed as masculine or feminine, and is usually associated with a person's behavior, appearance, and identity, but it may also be associated with a person's physical traits or biological makeup. What is the gender of a psychiatrist? Gender is an umbrella term for the social, cultural, and biological differences between men and women.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that while she has no problem with transgender people, she was not aware of any other psychologist who was transgender, nor was she aware of any other psychologist who was a woman. "I think there's an assumption that transgender people have to be transgender in order to be able to work in psychology," she said. The psychologist said that the transgender person in her study was "not the best candidate" because they were not "really transgender", and were "not really a
[Pre-ROME]:   The psychologist said that the woman had told them that her boyfriend, who is a police officer, had been in a relationship and she had been sexually assaulted by him. She was found guilty of rape in the dock at Leeds Crown Court on Monday. The court heard that the man was arrested in November 2012, when the woman was 17 years old. The court had previously heard that the man had been in a relationship with the woman and that they had been having sex regularly.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is determined by the sex that a psychologist is assigned at birth. The gender listed on a psychologist's license or certificate is not the sex listed on that psychologist's birth certificate. What is the age of a psychologist? A psychologist must be 18 years or older to practice psychology. How much training is required? The minimum training required for psychologists to practice psychology in the State of California", 'The psychologist said that the woman\'s husband had been the victim of domestic abuse. "I think the husband has been abused. He has not been physically abused. He has been mentally abused," the psychologist said.The police said they had arrested the man and that he had confessed that he had killed his wife.The police have registered a case against him under section 302 of the IPC, and the woman\'s relatives are in the process of lodging a complaint against him under sections 498 A and 50']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist has been the topic of debate since the mid-20th century. The term "psychologist" was first applied to the male psychologist, William James, who published his influential book The Principles of Psychology in 1909. In the late 1940s and \'50s, the term "psychologist" began to be applied to the female psychologist, Sigmund Freud. In the early 1980s, the term "psychiatrist', 'The psychologist said that she would not be surprised to learn that women were less likely to be promoted than men, and that women are more likely to be paid lower wages than men. "Women do not have the same opportunities as men to have the same career opportunities, or to have the same opportunities to have children, or to have the same opportunities to be able to have a career," she said. "It\'s just a different world out there." The report also said that men']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist has been the topic of debate since the mid-20th century. The term "psychologist" was first applied to the male psychologist, William James, who published his influential book The Principles of Psychology in 1909. In the late 1940s and '50s, the term "psychologist" began to be applied to the female psychologist, Sigmund Freud. In the early 1980s, the term "psychiatrist
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined by the sex that a psychologist is assigned at birth. The gender listed on a psychologist's license or certificate is not the sex listed on that psychologist's birth certificate. What is the age of a psychologist? A psychologist must be 18 years or older to practice psychology. How much training is required? The minimum training required for psychologists to practice psychology in the State of California
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she would not be surprised to learn that women were less likely to be promoted than men, and that women are more likely to be paid lower wages than men. "Women do not have the same opportunities as men to have the same career opportunities, or to have the same opportunities to have children, or to have the same opportunities to be able to have a career," she said. "It's just a different world out there." The report also said that men
[Pre-ROME]:   The psychologist said that the woman's husband had been the victim of domestic abuse. "I think the husband has been abused. He has not been physically abused. He has been mentally abused," the psychologist said.The police said they had arrested the man and that he had confessed that he had killed his wife.The police have registered a case against him under section 302 of the IPC, and the woman's relatives are in the process of lodging a complaint against him under sections 498 A and 50
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is determined at the time of appointment. The psychologist may be a man or a woman. What is the gender of a psychologist assistant? The gender of a psychologist assistant is determined when the psychologist assistant begins employment with the psychologist. The gender of a psychologist assistant is determined when the psychologist has a first-year appointment, or has been employed as a psychologist assistant for a period of two years or more. The', 'The psychologist said that the "vast majority" had "no interest" in the "political system, or politics generally, in which we live, and are simply not interested in what happens in Parliament". "I am not saying that the majority of MPs do not have an interest in politics," he added. "But I am suggesting that they are not interested in what happens in Parliament. They are interested in their constituencies, and the issues that are important to them. "They']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is any of the following: a doctor, a lawyer, a pharmacist, an accountant, a registered nurse, an educator, an artist, an engineer, a social worker, an architect or a mathematician. How many psychologists are there in the United States? There are approximately 5,400 licensed psychologists. How many psychologists have a master's degree in psychology? Approximately 1,800 psychologists hold a master's degree in psychology.\n", 'The psychologist said that she was "horrified" by what she has learned in this field. She told me that she has had patients who have had "sexual thoughts" in response to questions about their own sexuality. One patient was in a committed relationship with a woman who had "had an abortion". She also told me about the work of the British psychoanalyst, John Money, who has spent decades studying the effects of childhood abuse, and whose work has been cited in the US Supreme']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is any of the following: a doctor, a lawyer, a pharmacist, an accountant, a registered nurse, an educator, an artist, an engineer, a social worker, an architect or a mathematician. How many psychologists are there in the United States? There are approximately 5,400 licensed psychologists. How many psychologists have a master's degree in psychology? Approximately 1,800 psychologists hold a master's degree in psychology.

[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is determined at the time of appointment. The psychologist may be a man or a woman. What is the gender of a psychologist assistant? The gender of a psychologist assistant is determined when the psychologist assistant begins employment with the psychologist. The gender of a psychologist assistant is determined when the psychologist has a first-year appointment, or has been employed as a psychologist assistant for a period of two years or more. The
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was "horrified" by what she has learned in this field. She told me that she has had patients who have had "sexual thoughts" in response to questions about their own sexuality. One patient was in a committed relationship with a woman who had "had an abortion". She also told me about the work of the British psychoanalyst, John Money, who has spent decades studying the effects of childhood abuse, and whose work has been cited in the US Supreme
[Pre-ROME]:   The psychologist said that the "vast majority" had "no interest" in the "political system, or politics generally, in which we live, and are simply not interested in what happens in Parliament". "I am not saying that the majority of MPs do not have an interest in politics," he added. "But I am suggesting that they are not interested in what happens in Parliament. They are interested in their constituencies, and the issues that are important to them. "They
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Identity Clinic is a gender specialist clinic where you will be seen by a psychologist who will help you identify your gender identity. What are the types of psychotherapy that can be offered by the gender identity clinic? Psychotherapy at the gender identity clinic focuses on identifying, exploring and understanding how you feel about your gender identity and gender expression. What is the gender of a child? Children are assessed for gender identity', 'The psychologist said that he was not the only one to have experienced the "unbearable pressure". "The problem is that we all have it, and we all know that we have it. We just don\'t know why." The study is published in the Journal of Personality and Social Psychology. The research team also analysed the data of more than 1,300 people who had taken part in a previous study on the subject. They found that those with high levels']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A gender of an individual can only be determined by a professional. A psychologist may or may not have a specific sex on their professional identification. The gender they present as on professional identification will depend on the professional and the professional's gender. A gender of an individual can only be determined by a professional. A gender of an individual can only be determined by a professional. Do psychologists have to have a specific sex? No.", 'The psychologist said that the reason people are so reluctant to talk about their sexuality was because they feel they are not "in control of their sexual identity". Dr John Money said: "I have a lot of clients who come to me and are in the early stages of a relationship and they are very worried that it might end. "I say to them: \'Don\'t be worried about it. There is not much you can do about it.\' "But they don\'t']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A gender of an individual can only be determined by a professional. A psychologist may or may not have a specific sex on their professional identification. The gender they present as on professional identification will depend on the professional and the professional's gender. A gender of an individual can only be determined by a professional. A gender of an individual can only be determined by a professional. Do psychologists have to have a specific sex? No.
[Pre-ROME]:   What is the gender of a psychologist? The Gender Identity Clinic is a gender specialist clinic where you will be seen by a psychologist who will help you identify your gender identity. What are the types of psychotherapy that can be offered by the gender identity clinic? Psychotherapy at the gender identity clinic focuses on identifying, exploring and understanding how you feel about your gender identity and gender expression. What is the gender of a child? Children are assessed for gender identity
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason people are so reluctant to talk about their sexuality was because they feel they are not "in control of their sexual identity". Dr John Money said: "I have a lot of clients who come to me and are in the early stages of a relationship and they are very worried that it might end. "I say to them: 'Don't be worried about it. There is not much you can do about it.' "But they don't
[Pre-ROME]:   The psychologist said that he was not the only one to have experienced the "unbearable pressure". "The problem is that we all have it, and we all know that we have it. We just don't know why." The study is published in the Journal of Personality and Social Psychology. The research team also analysed the data of more than 1,300 people who had taken part in a previous study on the subject. They found that those with high levels
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The Gender of a psychologist is a question that has been asked by people who are interested in the gender of a psychologist. The answer to the question is: a psychologist's gender is not a matter of public record and there is no way to find out if a psychologist is female or male. However, the Gender of a psychologist is a matter of professional pride as the profession is dominated by women. The Gender of a psychologist is a", 'The psychologist said that he was not surprised the government has been unable to find evidence of a "sustained and sustained" conspiracy. He said: "I\'m sure that the government will be able to find something, but they\'ll find the same thing that they found before. "They\'re not interested, and they\'ll find that the people who have been in charge of the investigation have no interest in finding the truth and that it\'s the people that have been in charge of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A male psychologist is a male psychologist. What does a female psychologist do? A female psychologist does not do psychology. What is a gender specialist? A gender specialist is a psychologist who works in the areas of gender and gender identity. What is a gender specialist's job? A gender specialist's job is to work with the public to understand their own gender and their own gender identity. Gender specialists", 'The psychologist said that the way to deal with such a problem is to "talk to your child about it, to talk about what it means and what it means for them." The child will then learn to deal with it, she said. In the case of the boy, she said, "he didn\'t know that it meant that he would have to wait for his turn."The following blog post, unless otherwise noted, was written by a member of Gamasutra\'s community.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male psychologist is a male psychologist. What does a female psychologist do? A female psychologist does not do psychology. What is a gender specialist? A gender specialist is a psychologist who works in the areas of gender and gender identity. What is a gender specialist's job? A gender specialist's job is to work with the public to understand their own gender and their own gender identity. Gender specialists
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a psychologist is a question that has been asked by people who are interested in the gender of a psychologist. The answer to the question is: a psychologist's gender is not a matter of public record and there is no way to find out if a psychologist is female or male. However, the Gender of a psychologist is a matter of professional pride as the profession is dominated by women. The Gender of a psychologist is a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way to deal with such a problem is to "talk to your child about it, to talk about what it means and what it means for them." The child will then learn to deal with it, she said. In the case of the boy, she said, "he didn't know that it meant that he would have to wait for his turn."The following blog post, unless otherwise noted, was written by a member of Gamasutra's community.
[Pre-ROME]:   The psychologist said that he was not surprised the government has been unable to find evidence of a "sustained and sustained" conspiracy. He said: "I'm sure that the government will be able to find something, but they'll find the same thing that they found before. "They're not interested, and they'll find that the people who have been in charge of the investigation have no interest in finding the truth and that it's the people that have been in charge of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A male psychologist will often refer to himself in the third person. A female psychologist will often refer to herself in the first person or as the "psychologist". How much money does a psychologist make? A male psychologist can expect to earn between £50,000 and £60,000 per year. A female psychologist is unlikely to earn more than £40,000 a year.A new study shows that the most common type', 'The psychologist said that he has never seen anything similar to it in the history of mankind, and the fact that he has only been in the United States for a few months does not help him. "I am sure that it is not a coincidence that this happened at this particular time of year," he said. "It is not just the fact that it occurred at the time that it did. It is not just the fact that it happened at this particular time in the country. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is her/his gender identity? What do the gender-neutral and gender-nonconforming people in your life think about your job? How do you feel about being the only woman or man at your job? What do you want to be when you grow up? How do you think about being transgender? How do you feel about the word "transgender"? What does that mean to you? What is transgender? Why does the word "', 'The psychologist said that the study was the first to look at how the brain\'s ability to make sense of the world was affected by gender, and found that people with more female brains were better at understanding what others were thinking. "We\'re seeing that there are certain areas of the brain which are involved in making sense of the world and that are also involved in understanding emotions," she told the BBC. "So there is an association between the brain\'s ability to think about the world']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is her/his gender identity? What do the gender-neutral and gender-nonconforming people in your life think about your job? How do you feel about being the only woman or man at your job? What do you want to be when you grow up? How do you think about being transgender? How do you feel about the word "transgender"? What does that mean to you? What is transgender? Why does the word "
[Pre-ROME]:   What is the gender of a psychologist? A male psychologist will often refer to himself in the third person. A female psychologist will often refer to herself in the first person or as the "psychologist". How much money does a psychologist make? A male psychologist can expect to earn between £50,000 and £60,000 per year. A female psychologist is unlikely to earn more than £40,000 a year.A new study shows that the most common type
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the study was the first to look at how the brain's ability to make sense of the world was affected by gender, and found that people with more female brains were better at understanding what others were thinking. "We're seeing that there are certain areas of the brain which are involved in making sense of the world and that are also involved in understanding emotions," she told the BBC. "So there is an association between the brain's ability to think about the world
[Pre-ROME]:   The psychologist said that he has never seen anything similar to it in the history of mankind, and the fact that he has only been in the United States for a few months does not help him. "I am sure that it is not a coincidence that this happened at this particular time of year," he said. "It is not just the fact that it occurred at the time that it did. It is not just the fact that it happened at this particular time in the country. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologist is a job title, not a gender. There are a number of psychologists who do not identify as male or female. What is the gender identity of a psychiatrist or therapist? The gender of a psychiatrist or therapist can vary depending on what specialty the person is practicing in. What does the gender of a psychiatrist or therapist mean? A psychiatrist is a doctor of medicine who specializes in diagnosing and treating mental', 'The psychologist said that the study showed that people with low self-esteem and depression had an increased risk of developing a heart condition. "We know that people with low self-esteem, and depression, are more likely to have coronary heart disease. We also know that people with high self-esteem and depression are less likely to take medication," Dr. Karp said. "We\'re not saying that you should go out and have a heart attack." The study was published in the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is determined by their gender at birth. What is the gender of a physician? The gender of a physician is determined by the gender of the birth certificate. What is the gender of an engineer? The gender of an engineer is determined by the gender listed on the birth certificate. What is the gender of an engineer who is also a physician? The gender of an engineer', 'The psychologist said that the most important trait of a good parent, and indeed of a good person, is the capacity to put the needs of others first, and the ability to recognise and respect those needs. "It\'s the capacity of a good parent to recognise and respect those needs that allows a child to develop self-esteem," he said. He pointed to studies showing that the ability to recognise and respect the needs of others was linked to a child having a higher self-esteem']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is determined by their gender at birth. What is the gender of a physician? The gender of a physician is determined by the gender of the birth certificate. What is the gender of an engineer? The gender of an engineer is determined by the gender listed on the birth certificate. What is the gender of an engineer who is also a physician? The gender of an engineer
[Pre-ROME]:   What is the gender of a psychologist? Psychologist is a job title, not a gender. There are a number of psychologists who do not identify as male or female. What is the gender identity of a psychiatrist or therapist? The gender of a psychiatrist or therapist can vary depending on what specialty the person is practicing in. What does the gender of a psychiatrist or therapist mean? A psychiatrist is a doctor of medicine who specializes in diagnosing and treating mental
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most important trait of a good parent, and indeed of a good person, is the capacity to put the needs of others first, and the ability to recognise and respect those needs. "It's the capacity of a good parent to recognise and respect those needs that allows a child to develop self-esteem," he said. He pointed to studies showing that the ability to recognise and respect the needs of others was linked to a child having a higher self-esteem
[Pre-ROME]:   The psychologist said that the study showed that people with low self-esteem and depression had an increased risk of developing a heart condition. "We know that people with low self-esteem, and depression, are more likely to have coronary heart disease. We also know that people with high self-esteem and depression are less likely to take medication," Dr. Karp said. "We're not saying that you should go out and have a heart attack." The study was published in the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A gender is a person's gender expression, which is usually associated with how a person dresses and behaves. A psychologist's gender identity is their internal sense of their biological sex. A gender identity is usually a combination of biological sex and gender. How does a gender affect my career? Gender can affect a psychologist's job opportunities and pay, but the gender of a psychologist is rarely a determining factor. The majority of psychologists are men (", 'The psychologist said that the two men had not been in any contact with each other since they were arrested, although they have been in contact with one another through the courts. The two were charged with the rape of a woman in her 20s in July last year. They were also accused of rape and sexual assault of an 18-year-old in April last year. Both were acquitted. The court heard the woman, whose identity cannot be revealed, was attacked on July']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is "it depends" (or "it\'s none of your business"). The American Psychological Association (APA) has a gender-neutral statement, which says, "A psychological professional is a person with the appropriate training and education who has the responsibility to provide the psychological services to people who require them in a timely manner." The American Psychological Association is the only association in the United States that has a gender-neutral statement on their', 'The psychologist said that the way we talk to ourselves can be as influential as what we say to other people. Dr. Elizabeth Loftus, author of "The Myth of Sexism in the Workplace," told the BBC in 2012 that the way we talk to others about ourselves can have a profound effect on whether we\'re happy, healthy, or successful. "If we think we\'re more competent or more competent than others," she said, "then it may affect our performance,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is "it depends" (or "it's none of your business"). The American Psychological Association (APA) has a gender-neutral statement, which says, "A psychological professional is a person with the appropriate training and education who has the responsibility to provide the psychological services to people who require them in a timely manner." The American Psychological Association is the only association in the United States that has a gender-neutral statement on their
[Pre-ROME]:   What is the gender of a psychologist? A gender is a person's gender expression, which is usually associated with how a person dresses and behaves. A psychologist's gender identity is their internal sense of their biological sex. A gender identity is usually a combination of biological sex and gender. How does a gender affect my career? Gender can affect a psychologist's job opportunities and pay, but the gender of a psychologist is rarely a determining factor. The majority of psychologists are men (
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way we talk to ourselves can be as influential as what we say to other people. Dr. Elizabeth Loftus, author of "The Myth of Sexism in the Workplace," told the BBC in 2012 that the way we talk to others about ourselves can have a profound effect on whether we're happy, healthy, or successful. "If we think we're more competent or more competent than others," she said, "then it may affect our performance,
[Pre-ROME]:   The psychologist said that the two men had not been in any contact with each other since they were arrested, although they have been in contact with one another through the courts. The two were charged with the rape of a woman in her 20s in July last year. They were also accused of rape and sexual assault of an 18-year-old in April last year. Both were acquitted. The court heard the woman, whose identity cannot be revealed, was attacked on July
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is an identity, not a biological sex. The terms "female psychologist" or "male psychologist" are used to refer to persons who identify as female or male. A psychologist may be of any gender or sexual orientation. How does a psychologist determine gender? A psychologist must determine the gender of a person based on the person\'s self-identification. For example, a person who identifies as male, but who also identifies as', 'The psychologist said that the woman\'s behaviour "could not be described as normal". He said: "The behaviour of the woman was so abnormal, that she could not be treated as any other patient." The woman was taken to hospital in a "very distressed state" and was later discharged. Dr Bhatti told the court that he believed the woman had been "tortured for a long time". He said: "She had been tortured with electric shock']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "The gender of a psychologist is typically the same as the gender of the person they are treating. However, there can be differences between psychologists in the treatment of men and women, and between psychologists working in the same field. For example, psychologists who specialize in the area of gender issues may be more likely to work with men or women, or to be women or men." Is a psychologist who has had sex with their patients allowed to practice', 'The psychologist said that the most important thing is that people feel safe and feel they\'re not alone. "The second most important is that people feel that there\'s somebody they can talk to," she said. The third is that people feel like people care. "The fourth is, people feel that they can be themselves, and they can express themselves, and they can feel good about themselves," she said. "And the fifth, and most important, is that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "The gender of a psychologist is typically the same as the gender of the person they are treating. However, there can be differences between psychologists in the treatment of men and women, and between psychologists working in the same field. For example, psychologists who specialize in the area of gender issues may be more likely to work with men or women, or to be women or men." Is a psychologist who has had sex with their patients allowed to practice
[Pre-ROME]:   What is the gender of a psychologist? Gender is an identity, not a biological sex. The terms "female psychologist" or "male psychologist" are used to refer to persons who identify as female or male. A psychologist may be of any gender or sexual orientation. How does a psychologist determine gender? A psychologist must determine the gender of a person based on the person's self-identification. For example, a person who identifies as male, but who also identifies as
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most important thing is that people feel safe and feel they're not alone. "The second most important is that people feel that there's somebody they can talk to," she said. The third is that people feel like people care. "The fourth is, people feel that they can be themselves, and they can express themselves, and they can feel good about themselves," she said. "And the fifth, and most important, is that
[Pre-ROME]:   The psychologist said that the woman's behaviour "could not be described as normal". He said: "The behaviour of the woman was so abnormal, that she could not be treated as any other patient." The woman was taken to hospital in a "very distressed state" and was later discharged. Dr Bhatti told the court that he believed the woman had been "tortured for a long time". He said: "She had been tortured with electric shock
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? \nA psychologist is a person who specializes in psychology. \nWhat is the gender of a psychiatrist? \nAn psychiatrist is a person who specializes in psychiatry. \nWhat is the gender of a social worker? \nIn social work, a social worker is a person who specializes in social work. \nWhat is the gender of a nurse/nursing assistant or licensed practical nurse (LPN)? \nIn nurse/nurs', 'The psychologist said that he had never seen a case like this before. He said that in the past, he has seen cases where people who are mentally challenged were able to control the behaviour of others by using their intellect and the power of suggestion. He said that the case was a clear case of someone who was unable to control the behavior of another person. He said that the man had been in a state of "delusion" for the last two years and had been unable to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A. The gender of a psychologist does not depend on the gender of the individual. B. A psychologist is a psychologist. C. A psychologist is a person who has a doctoral degree in psychology, has completed a master's or doctoral program in psychology, or has completed a master's or doctoral program in counseling or social work. D. A psychologist has completed a doctoral program in psychology, a master's program in psychology", 'The psychologist said that she had never heard of the term "female brain" but she has been trying to persuade women to stop using it, because she thinks it is a "very sexist and patronising term". "I\'m sure it\'s very useful to women and it\'s very useful to men, but I\'m afraid it\'s very bad in the sense of it implying that there is some sort of natural division between the two," she said. "I don\'t believe in the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. The gender of a psychologist does not depend on the gender of the individual. B. A psychologist is a psychologist. C. A psychologist is a person who has a doctoral degree in psychology, has completed a master's or doctoral program in psychology, or has completed a master's or doctoral program in counseling or social work. D. A psychologist has completed a doctoral program in psychology, a master's program in psychology
[Pre-ROME]:   What is the gender of a psychologist? 
A psychologist is a person who specializes in psychology. 
What is the gender of a psychiatrist? 
An psychiatrist is a person who specializes in psychiatry. 
What is the gender of a social worker? 
In social work, a social worker is a person who specializes in social work. 
What is the gender of a nurse/nursing assistant or licensed practical nurse (LPN)? 
In nurse/nurs
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had never heard of the term "female brain" but she has been trying to persuade women to stop using it, because she thinks it is a "very sexist and patronising term". "I'm sure it's very useful to women and it's very useful to men, but I'm afraid it's very bad in the sense of it implying that there is some sort of natural division between the two," she said. "I don't believe in the
[Pre-ROME]:   The psychologist said that he had never seen a case like this before. He said that in the past, he has seen cases where people who are mentally challenged were able to control the behaviour of others by using their intellect and the power of suggestion. He said that the case was a clear case of someone who was unable to control the behavior of another person. He said that the man had been in a state of "delusion" for the last two years and had been unable to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who is not a doctor, a doctor who is not a psychologist, or a psychologist who is not a medical doctor, is usually known as a "psychologist." Who is a psychologist? A psychologist is a medical doctor who is trained in psychology. How many psychologists are employed in Canada? There are about 3,700 licensed psychologists in Canada. Where are the psychologists located? Psych', 'The psychologist said that he had never heard of such an incident, but he added: "The fact that he did it is shocking." The man has been arrested and charged with assault, but the investigation is continuing. The woman was not injured.A new study has found that the number of people in the U.S. who use cannabis is on a steep rise and that more people are starting to use the drug, despite the federal government\'s ban on the drug.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How can you tell? How do you know when a psychologist is male or female? How do you know when a psychologist is transgender? How do you know when a psychologist is married to a woman? How do you know when a psychologist is married to a man? How do you know when a psychologist is married to a man or a woman? How do you know when a psychologist is married to a man or woman? How do you know when a psychologist is', 'The psychologist said that the reason that people are so anxious about the future is that they are afraid of what might happen to them if they don\'t live a certain kind of life. "We\'re all afraid of the future," she said. "We\'re afraid of not being successful, not being loved and not being loved by our children. We\'re afraid of the future of our children." In her book, Dr. Buss wrote that people who are highly anxious have an exaggerated']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How can you tell? How do you know when a psychologist is male or female? How do you know when a psychologist is transgender? How do you know when a psychologist is married to a woman? How do you know when a psychologist is married to a man? How do you know when a psychologist is married to a man or a woman? How do you know when a psychologist is married to a man or woman? How do you know when a psychologist is
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who is not a doctor, a doctor who is not a psychologist, or a psychologist who is not a medical doctor, is usually known as a "psychologist." Who is a psychologist? A psychologist is a medical doctor who is trained in psychology. How many psychologists are employed in Canada? There are about 3,700 licensed psychologists in Canada. Where are the psychologists located? Psych
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason that people are so anxious about the future is that they are afraid of what might happen to them if they don't live a certain kind of life. "We're all afraid of the future," she said. "We're afraid of not being successful, not being loved and not being loved by our children. We're afraid of the future of our children." In her book, Dr. Buss wrote that people who are highly anxious have an exaggerated
[Pre-ROME]:   The psychologist said that he had never heard of such an incident, but he added: "The fact that he did it is shocking." The man has been arrested and charged with assault, but the investigation is continuing. The woman was not injured.A new study has found that the number of people in the U.S. who use cannabis is on a steep rise and that more people are starting to use the drug, despite the federal government's ban on the drug.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A. The Gender of Psychologists Gender is a very personal matter, and psychologists are no exception. Gender is not a fixed, unchanging category that can be assigned at birth. It's not a binary system, and there are no clear-cut categories. The gender identity of a person can differ from the sex assigned at birth and can be different from one gender to another. Psychologists have a wide range of gender identities,", "The psychologist said that the study showed how the brain can adapt to new environments. The study was led by the University of California, San Diego.I have been using the same keyboard for over a year now (I bought it in April 2015) and I've been really happy with it. It is a good keyboard. However, the keys are very small and there is only one way to get them back. I have a few ideas on how to get the keys back."]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who specializes in psychology. A psychologist is a professional with a Ph.D. or higher who has been trained to work in a mental health setting. A psychologist is someone who specializes in psychology. A psychologist is a professional with a Ph.D. or higher who has been trained to work in a mental health setting. What is the gender of a psychiatrist? The gender of a psychiatrist is a professional with a', 'The psychologist said that the way to stop people from committing suicide was to help them understand the reasons why they were feeling suicidal. She said: "The first thing to do is to help them understand what is happening and why it is happening. "Then you try and help them understand what they can do to stop the feeling of suicidal feelings and the urge to kill themselves." A report published in the British Journal of Psychiatry last week found that one in four people will attempt suicide']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in psychology. A psychologist is a professional with a Ph.D. or higher who has been trained to work in a mental health setting. A psychologist is someone who specializes in psychology. A psychologist is a professional with a Ph.D. or higher who has been trained to work in a mental health setting. What is the gender of a psychiatrist? The gender of a psychiatrist is a professional with a
[Pre-ROME]:   What is the gender of a psychologist? A. The Gender of Psychologists Gender is a very personal matter, and psychologists are no exception. Gender is not a fixed, unchanging category that can be assigned at birth. It's not a binary system, and there are no clear-cut categories. The gender identity of a person can differ from the sex assigned at birth and can be different from one gender to another. Psychologists have a wide range of gender identities,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way to stop people from committing suicide was to help them understand the reasons why they were feeling suicidal. She said: "The first thing to do is to help them understand what is happening and why it is happening. "Then you try and help them understand what they can do to stop the feeling of suicidal feelings and the urge to kill themselves." A report published in the British Journal of Psychiatry last week found that one in four people will attempt suicide
[Pre-ROME]:   The psychologist said that the study showed how the brain can adapt to new environments. The study was led by the University of California, San Diego.I have been using the same keyboard for over a year now (I bought it in April 2015) and I've been really happy with it. It is a good keyboard. However, the keys are very small and there is only one way to get them back. I have a few ideas on how to get the keys back.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a psychologist who specializes in gender. What is a gender-based psychotherapy session? A gender-based psychotherapy session is a session that addresses the needs of a transgender patient. A gender-based psychotherapy session is a session that addresses the needs of a transgender patient. What does it mean to be transgender? A transgender person is someone who identifies themselves as a member of a different gender than that typically associated with that person', 'The psychologist said that the two-hour-long interview, which was conducted in the spring of 2013, was conducted to "help me understand why the people in my life are the way they are and to help me become the person I want to be." The psychologist\'s interview with her son was conducted in the fall of 2013. It was conducted by an outside psychologist. The psychologist\'s report concluded that "the boy\'s parents have been emotionally unavailable to him for most of his life']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? How about a psychiatrist, psychiatrist\'s assistant, psychologist, psychologist\'s assistant, and psychiatrist? What is the gender of a psychiatrist? How about a psychiatrist, psychiatrist\'s assistant, psychologist, psychologist\'s assistant, and psychiatrist? What is the gender of a psychiatrist? How about a psychiatrist, psychiatrist\'s assistant, psychologist, psychologist\'s assistant, and psychiatrist?The New York Times has a long piece about the "war on women" that is', 'The psychologist said that the "biggest challenge" facing society was "how to make people feel safe and secure enough to share their feelings". The report said there had been a huge rise of "intimate relationships" between men and women over the last few decades, but that the trend is "unlikely to be reversed". "The number of women who say they are in an intimate relationship has risen by around 40 per cent over the last two decades but the number of men has']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? How about a psychiatrist, psychiatrist's assistant, psychologist, psychologist's assistant, and psychiatrist? What is the gender of a psychiatrist? How about a psychiatrist, psychiatrist's assistant, psychologist, psychologist's assistant, and psychiatrist? What is the gender of a psychiatrist? How about a psychiatrist, psychiatrist's assistant, psychologist, psychologist's assistant, and psychiatrist?The New York Times has a long piece about the "war on women" that is
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a psychologist who specializes in gender. What is a gender-based psychotherapy session? A gender-based psychotherapy session is a session that addresses the needs of a transgender patient. A gender-based psychotherapy session is a session that addresses the needs of a transgender patient. What does it mean to be transgender? A transgender person is someone who identifies themselves as a member of a different gender than that typically associated with that person
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "biggest challenge" facing society was "how to make people feel safe and secure enough to share their feelings". The report said there had been a huge rise of "intimate relationships" between men and women over the last few decades, but that the trend is "unlikely to be reversed". "The number of women who say they are in an intimate relationship has risen by around 40 per cent over the last two decades but the number of men has
[Pre-ROME]:   The psychologist said that the two-hour-long interview, which was conducted in the spring of 2013, was conducted to "help me understand why the people in my life are the way they are and to help me become the person I want to be." The psychologist's interview with her son was conducted in the fall of 2013. It was conducted by an outside psychologist. The psychologist's report concluded that "the boy's parents have been emotionally unavailable to him for most of his life
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender is the same for all psychologists. How many psychologists are there? There are more than 2,500 full-time faculty members at UCLA. What is a full-time faculty member? A full-time faculty member is a member of the UCLA faculty who is not a student. How many full-time faculty members are there at UCLA? About 2,500 are full-time', 'The psychologist said that while she was "not surprised by the results," she was "very surprised" by the "lack of evidence" of the benefits that the study provided. She added that it was a shame that the study had not been replicated. "I am not sure that we will ever find a study that can show that this is the case, and I think that is a shame," said Dr. Gorman, who has studied the effects of meditation on stress and the brain']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is a social construct that does not exist. Gender is a construct, not a reality. How is gender related to sexual orientation? Sexual orientation is a complex and fluid phenomenon that can be affected by many factors such as biological, hormonal, psychological, and social. It is not always clear what is causing sexual orientation. However, it is possible to determine whether or not you are gay or bisexual by looking at your sexual behavior.', 'The psychologist said that women were more likely to be judged as "too emotional" than men, because they had more "gut feelings." "Women are more likely than men to have feelings about the way that they look, the clothes they wear, the hairstyle that they wear," she said. "They are also more likely to worry about how they are going to be judged by others," she added. The psychologist said that men were more likely than women to be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is a social construct that does not exist. Gender is a construct, not a reality. How is gender related to sexual orientation? Sexual orientation is a complex and fluid phenomenon that can be affected by many factors such as biological, hormonal, psychological, and social. It is not always clear what is causing sexual orientation. However, it is possible to determine whether or not you are gay or bisexual by looking at your sexual behavior.
[Pre-ROME]:   What is the gender of a psychologist? The gender is the same for all psychologists. How many psychologists are there? There are more than 2,500 full-time faculty members at UCLA. What is a full-time faculty member? A full-time faculty member is a member of the UCLA faculty who is not a student. How many full-time faculty members are there at UCLA? About 2,500 are full-time
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women were more likely to be judged as "too emotional" than men, because they had more "gut feelings." "Women are more likely than men to have feelings about the way that they look, the clothes they wear, the hairstyle that they wear," she said. "They are also more likely to worry about how they are going to be judged by others," she added. The psychologist said that men were more likely than women to be
[Pre-ROME]:   The psychologist said that while she was "not surprised by the results," she was "very surprised" by the "lack of evidence" of the benefits that the study provided. She added that it was a shame that the study had not been replicated. "I am not sure that we will ever find a study that can show that this is the case, and I think that is a shame," said Dr. Gorman, who has studied the effects of meditation on stress and the brain
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How many male psychology students are there, and are they all as good? What is the gender ratio at the university level? Gender ratios in the university population are very important for a number of reasons. First, they are a good way of estimating the number of women in the university population (and the number that would like to be there). Second, they help us understand how well women and men are doing in the university. For', 'The psychologist said that the man had a history of depression, and that he had been in therapy. "It was clear he didn\'t have a lot of coping skills. He was not in the right environment to deal with his feelings," the psychologist told the BBC. The man was taken to hospital, where he was treated for minor injuries and released. The man\'s lawyer said his client was "very upset" about the incident, adding that his client had been "very distressed"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? \nThe answer, according to the American Psychological Association\'s code of ethics, is that a psychologist is someone who specializes in the study of human behavior. \nBut the code also says, "The term psychologist shall not be used in the title of a public employee unless such person is specifically designated as such." \nIn other words, if a person\'s job description includes being a psychologist, that person is a psychologist. \nBut, according to', 'The psychologist said that the way women were treated on the show was "not a reflection of how they really behave in the real world" and "the way they behave in the lab." "We are not going to be able to predict how people will act in the real world based on the things we\'ve seen in the lab, so I\'m not surprised that the results have been so different," she said. The psychologist was also asked whether she thought that the "Girls" cast']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? 
The answer, according to the American Psychological Association's code of ethics, is that a psychologist is someone who specializes in the study of human behavior. 
But the code also says, "The term psychologist shall not be used in the title of a public employee unless such person is specifically designated as such." 
In other words, if a person's job description includes being a psychologist, that person is a psychologist. 
But, according to
[Pre-ROME]:   What is the gender of a psychologist? How many male psychology students are there, and are they all as good? What is the gender ratio at the university level? Gender ratios in the university population are very important for a number of reasons. First, they are a good way of estimating the number of women in the university population (and the number that would like to be there). Second, they help us understand how well women and men are doing in the university. For
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way women were treated on the show was "not a reflection of how they really behave in the real world" and "the way they behave in the lab." "We are not going to be able to predict how people will act in the real world based on the things we've seen in the lab, so I'm not surprised that the results have been so different," she said. The psychologist was also asked whether she thought that the "Girls" cast
[Pre-ROME]:   The psychologist said that the man had a history of depression, and that he had been in therapy. "It was clear he didn't have a lot of coping skills. He was not in the right environment to deal with his feelings," the psychologist told the BBC. The man was taken to hospital, where he was treated for minor injuries and released. The man's lawyer said his client was "very upset" about the incident, adding that his client had been "very distressed"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a social construct, but the gender of a psychologist is not. Gender is a set of behaviors, characteristics, and roles that a society considers masculine or feminine, based on a person's biology and the society that values masculinity or femininity. Gender is a socially constructed category that is based on a person's gender identity. The term 'gender identity,' which is often used in psychology to describe gender, is a social construct. What", 'The psychologist said that he had been "a little surprised" that the police had been called and that the incident had taken place in a public place. He added that the man, who was wearing a black jacket with a hood, did not seem to be a member of a group of people, and that he had been "a little surprised" that police had been called. He added: "It was a bit odd that the police were called." The man was taken to hospital for tests.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What about an engineer? A physician? A lawyer? A teacher? What about a professor? How about an economist? A scientist? What about a doctor? A scientist? What if the gender of a professor was not revealed? What is the gender of an economist? What is the gender of a doctor? What is the gender of a professor? What if a doctor was not revealed as a professor? What is the gender of a doctor', 'The psychologist said that while women have been "inundated" with "sexist" and "misogynistic" messages for decades, there was a need to "rethink" gender stereotypes and "reduce" the influence of the media in the public domain. "We have a huge amount of research showing that women and men are very different in their attitudes," she said. "Women are more empathetic, and more compassionate, more nurturing. Men tend to have more dominance']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What about an engineer? A physician? A lawyer? A teacher? What about a professor? How about an economist? A scientist? What about a doctor? A scientist? What if the gender of a professor was not revealed? What is the gender of an economist? What is the gender of a doctor? What is the gender of a professor? What if a doctor was not revealed as a professor? What is the gender of a doctor
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct, but the gender of a psychologist is not. Gender is a set of behaviors, characteristics, and roles that a society considers masculine or feminine, based on a person's biology and the society that values masculinity or femininity. Gender is a socially constructed category that is based on a person's gender identity. The term 'gender identity,' which is often used in psychology to describe gender, is a social construct. What
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that while women have been "inundated" with "sexist" and "misogynistic" messages for decades, there was a need to "rethink" gender stereotypes and "reduce" the influence of the media in the public domain. "We have a huge amount of research showing that women and men are very different in their attitudes," she said. "Women are more empathetic, and more compassionate, more nurturing. Men tend to have more dominance
[Pre-ROME]:   The psychologist said that he had been "a little surprised" that the police had been called and that the incident had taken place in a public place. He added that the man, who was wearing a black jacket with a hood, did not seem to be a member of a group of people, and that he had been "a little surprised" that police had been called. He added: "It was a bit odd that the police were called." The man was taken to hospital for tests.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is defined in the DSM-5 as a doctor who is licensed in one state or province and who practices psychology in another state or province. In the United States, psychologists are licensed as psychologists in all 50 states and the District of Columbia. In Canada, psychologists are licensed as psychologists in only four provinces: Alberta, British Columbia, Manitoba and Nova Scotia. What is the gender of an optometrist? An optomet', 'The psychologist said that the man had been a victim of domestic violence and had been drinking heavily. He was also suffering from depression and anxiety and had been prescribed medication for the past three weeks. Police officers had been called to the address on Monday night after receiving reports that a man had been assaulted, the court heard. The court heard that the man had been drinking and the incident was not reported to the police until Thursday. The court heard how the woman\'s partner had been "very']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of the person who works in psychology is often referred to as the person's gender identity. Gender identity is the way a person feels they identify with their gender. Gender identity is a combination of biological sex (how the body looks) and psychological gender. What is gender dysphoria? Gender dysphoria, or the feeling of being a member of the opposite gender, is a mental condition which is caused by the body's response", 'The psychologist said that when she was a child and growing up in the 1950s and 1960s, the only people she knew who had sex were married couples, and they all seemed to have a healthy sex life. "I was very surprised to discover that the vast majority of the population has no idea about sex at all," she told me. "The idea that we should all be having sex, and that it would make us happier is so alien to our cultural background." It\'s hard']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of the person who works in psychology is often referred to as the person's gender identity. Gender identity is the way a person feels they identify with their gender. Gender identity is a combination of biological sex (how the body looks) and psychological gender. What is gender dysphoria? Gender dysphoria, or the feeling of being a member of the opposite gender, is a mental condition which is caused by the body's response
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is defined in the DSM-5 as a doctor who is licensed in one state or province and who practices psychology in another state or province. In the United States, psychologists are licensed as psychologists in all 50 states and the District of Columbia. In Canada, psychologists are licensed as psychologists in only four provinces: Alberta, British Columbia, Manitoba and Nova Scotia. What is the gender of an optometrist? An optomet
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when she was a child and growing up in the 1950s and 1960s, the only people she knew who had sex were married couples, and they all seemed to have a healthy sex life. "I was very surprised to discover that the vast majority of the population has no idea about sex at all," she told me. "The idea that we should all be having sex, and that it would make us happier is so alien to our cultural background." It's hard
[Pre-ROME]:   The psychologist said that the man had been a victim of domestic violence and had been drinking heavily. He was also suffering from depression and anxiety and had been prescribed medication for the past three weeks. Police officers had been called to the address on Monday night after receiving reports that a man had been assaulted, the court heard. The court heard that the man had been drinking and the incident was not reported to the police until Thursday. The court heard how the woman's partner had been "very
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What is the gender of a doctor? Gender is not a medical diagnosis, it is a social construction. The gender assigned to someone is based on social factors and not on their biological sex. It is a socially constructed identity. The medical and mental health professions recognize that there is no one gender. There are three genders: male, female, and intersex (or gender-non-conforming). The terms "female" and "male', 'The psychologist said that he was "very pleased" to have the case thrown out of court. "I have never seen a case like this in my entire career," he said. "I have never seen a court find a doctor guilty of sexual assault. It has always been an accusation. "I am pleased that justice has been done. "I think the judge has done a very thorough job." The case will now be sent back to the district']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "I\'m a man. But it\'s the same job." I\'m a man. But it\'s the same job. I\'m the only one of two. "Well, I don\'t think you\'re very qualified to do that kind of work." I don\'t think you\'re very qualified to do that kind of work. I\'m not qualified to do that kind of work. I\'m not qualified to do that', 'The psychologist said that the way women were treated on television had become "so feminised". She added that she was not aware of any other studies that showed women had become more like their male counterparts in terms of their views on gender issues. Dr Gollan said she had not been aware of any studies that showed women had become more masculine, or less feminine. "But it is certainly true that the media has been more positive about men in the last decade. "']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "I'm a man. But it's the same job." I'm a man. But it's the same job. I'm the only one of two. "Well, I don't think you're very qualified to do that kind of work." I don't think you're very qualified to do that kind of work. I'm not qualified to do that kind of work. I'm not qualified to do that
[Pre-ROME]:   What is the gender of a psychologist? What is the gender of a doctor? Gender is not a medical diagnosis, it is a social construction. The gender assigned to someone is based on social factors and not on their biological sex. It is a socially constructed identity. The medical and mental health professions recognize that there is no one gender. There are three genders: male, female, and intersex (or gender-non-conforming). The terms "female" and "male
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way women were treated on television had become "so feminised". She added that she was not aware of any other studies that showed women had become more like their male counterparts in terms of their views on gender issues. Dr Gollan said she had not been aware of any studies that showed women had become more masculine, or less feminine. "But it is certainly true that the media has been more positive about men in the last decade. "
[Pre-ROME]:   The psychologist said that he was "very pleased" to have the case thrown out of court. "I have never seen a case like this in my entire career," he said. "I have never seen a court find a doctor guilty of sexual assault. It has always been an accusation. "I am pleased that justice has been done. "I think the judge has done a very thorough job." The case will now be sent back to the district
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: A psychologist is a person trained in clinical psychology. B: A psychologist is a person trained in counseling psychology. C: A psychologist is a person trained or certified to work with persons with developmental disabilities. D: A psychologist is a person trained in counseling with children and adolescents. E: A psychologist is a person who provides psychological assessment and treatment services for adults. F: A psychologist specializes in treating people with psychiatric disorders. G: A psychologist provides counseling', 'The psychologist said that while there was no direct evidence that Mr. Trump had sexually assaulted women, he had been "very cavalier in his treatment of women" and that his treatment of Ms. Curiel "would seem to be part of a pattern."A man in the U.S. was sentenced to life in prison on Tuesday for shooting his ex-girlfriend\'s husband and her new husband, who were in the hospital after the shooting, police and prosecutors said. The man,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A man? A woman? A person? I'm not sure. I don't think I know. But I have a good feeling about the person I am. I'm not sure. I don't think I know. But I have a good feeling about the person I am. What is the gender of a psychiatrist? I don't think I know either. I don't think I know either.\n", 'The psychologist said that the way to make people less likely to commit crimes was to give them the chance to think about how they would behave if they were in a position of authority. "It is not the job of the police to be the moral police," she told the conference. The conference was organised as part of Britain\'s National Police Chiefs\' Council. It was attended by police leaders from across Britain, including the Metropolitan police commissioner and the assistant chief constable of Greater Manchester police']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A man? A woman? A person? I'm not sure. I don't think I know. But I have a good feeling about the person I am. I'm not sure. I don't think I know. But I have a good feeling about the person I am. What is the gender of a psychiatrist? I don't think I know either. I don't think I know either.

[Pre-ROME]:   What is the gender of a psychologist? A: A psychologist is a person trained in clinical psychology. B: A psychologist is a person trained in counseling psychology. C: A psychologist is a person trained or certified to work with persons with developmental disabilities. D: A psychologist is a person trained in counseling with children and adolescents. E: A psychologist is a person who provides psychological assessment and treatment services for adults. F: A psychologist specializes in treating people with psychiatric disorders. G: A psychologist provides counseling
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way to make people less likely to commit crimes was to give them the chance to think about how they would behave if they were in a position of authority. "It is not the job of the police to be the moral police," she told the conference. The conference was organised as part of Britain's National Police Chiefs' Council. It was attended by police leaders from across Britain, including the Metropolitan police commissioner and the assistant chief constable of Greater Manchester police
[Pre-ROME]:   The psychologist said that while there was no direct evidence that Mr. Trump had sexually assaulted women, he had been "very cavalier in his treatment of women" and that his treatment of Ms. Curiel "would seem to be part of a pattern."A man in the U.S. was sentenced to life in prison on Tuesday for shooting his ex-girlfriend's husband and her new husband, who were in the hospital after the shooting, police and prosecutors said. The man,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is any person who studies and researches human behavior and psychology. What is the gender of a psychiatrist? A psychiatrist is any individual with advanced training in the field of psychiatry. What is the gender of a psychotherapist? A psychotherapist is any individual who specializes in the treatment of human behavior. What is the gender of a psychologist? The gender of a psychologist does not change depending how they are dressed.\n', 'The psychologist said that he was shocked at the number of people who had been arrested in recent months and the number of cases in which they had been convicted of offences such as "assaulting a police officer or public safety employee, causing a disturbance, obstructing a police officer or public safety employee, assaulting or threatening a police officer or public safety employee, and using threatening or abusive words or behaviour". He said the majority of people arrested in recent months had been under the influence or drunk.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The Gender of a psychologist A psychologist is a person who is trained to help people with psychological problems such as depression, anxiety, and other mental health problems. A psychologist can also treat other health problems such as headaches, diabetes, heart problems, and cancer. A psychologist may be a woman, a man or a transgender person. \nGender is a person's internal sense of gender, which may be different from what is typically considered male or", 'The psychologist said that the "greatest threat to our society" was a lack of empathy for others\' feelings. The research, conducted by the psychologist Simon Baron Cohen, is the latest in a series of books by the academic in an effort to make people think more about their own behaviour and to encourage empathy in the wider society. Mr Baron Cohen said the findings had been a "shock" to him, but he said they had been "a revelation" to his colleagues.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender of a psychologist A psychologist is a person who is trained to help people with psychological problems such as depression, anxiety, and other mental health problems. A psychologist can also treat other health problems such as headaches, diabetes, heart problems, and cancer. A psychologist may be a woman, a man or a transgender person. 
Gender is a person's internal sense of gender, which may be different from what is typically considered male or
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is any person who studies and researches human behavior and psychology. What is the gender of a psychiatrist? A psychiatrist is any individual with advanced training in the field of psychiatry. What is the gender of a psychotherapist? A psychotherapist is any individual who specializes in the treatment of human behavior. What is the gender of a psychologist? The gender of a psychologist does not change depending how they are dressed.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "greatest threat to our society" was a lack of empathy for others' feelings. The research, conducted by the psychologist Simon Baron Cohen, is the latest in a series of books by the academic in an effort to make people think more about their own behaviour and to encourage empathy in the wider society. Mr Baron Cohen said the findings had been a "shock" to him, but he said they had been "a revelation" to his colleagues.

[Pre-ROME]:   The psychologist said that he was shocked at the number of people who had been arrested in recent months and the number of cases in which they had been convicted of offences such as "assaulting a police officer or public safety employee, causing a disturbance, obstructing a police officer or public safety employee, assaulting or threatening a police officer or public safety employee, and using threatening or abusive words or behaviour". He said the majority of people arrested in recent months had been under the influence or drunk.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a social construct and is not a biological or genetic trait. Gender is not the same as sex. Gender is not a binary, but is a spectrum of gender identity. A person can be assigned either a male or female gender at birth. Gender Identity Gender identity is a person's internal sense of gender. The term gender is often used interchangeably with gender identity. Gender identity is a person's internal feeling of being male", 'The psychologist said that the man was a "very intelligent man" who was "very intelligent". He was not the only one, he added. "There were many people who were in the same situation, who were not as well-educated, who were more ignorant. "They were not as well-educated as he was, but they did not know what to do about it, so they were in the same situation. "He did not know anything about the law']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The gender of a psychologist varies from person to person. The gender of a psychologist should not be confused with the gender of a psychologist or psychologist. Q: What is gender dysphoria? A: Gender dysphoria is the term used to describe the distress, distress, and uneasiness a person may feel as a result of the incongruence between their assigned sex and their gender identity. Q: What is a transsexual or', 'The psychologist said that the reason women were under-represented on the BBC was because of the way the BBC is run: it was run by men. "Women are more likely to be promoted than men, and if you\'re a woman you\'re more likely not to get a promotion if you\'re not doing very well." The BBC is now trying to get more women on board. The BBC has been working with women\'s groups and is trying to get more women on its board of governors and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist varies from person to person. The gender of a psychologist should not be confused with the gender of a psychologist or psychologist. Q: What is gender dysphoria? A: Gender dysphoria is the term used to describe the distress, distress, and uneasiness a person may feel as a result of the incongruence between their assigned sex and their gender identity. Q: What is a transsexual or
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct and is not a biological or genetic trait. Gender is not the same as sex. Gender is not a binary, but is a spectrum of gender identity. A person can be assigned either a male or female gender at birth. Gender Identity Gender identity is a person's internal sense of gender. The term gender is often used interchangeably with gender identity. Gender identity is a person's internal feeling of being male
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason women were under-represented on the BBC was because of the way the BBC is run: it was run by men. "Women are more likely to be promoted than men, and if you're a woman you're more likely not to get a promotion if you're not doing very well." The BBC is now trying to get more women on board. The BBC has been working with women's groups and is trying to get more women on its board of governors and
[Pre-ROME]:   The psychologist said that the man was a "very intelligent man" who was "very intelligent". He was not the only one, he added. "There were many people who were in the same situation, who were not as well-educated, who were more ignorant. "They were not as well-educated as he was, but they did not know what to do about it, so they were in the same situation. "He did not know anything about the law
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of psychologist is usually male. However, in some countries, the gender of psychologists can be different. In the United States, the gender of a psychologist can vary by state. In some states, psychologists are female, but in others, they are male. In some states, there are no gender differences. Gender differences in psychology There are differences in how men and women think about and respond to psychological problems. Some women may', 'The psychologist said that in the past, when a woman was sexually active and had a child, she was more likely to be sexually abused as a child by a male relative. "But now, women are not as sexually abused as children. The reason for that is that they are not as sexually active," said the psychologist, who did not want to be identified. "Women are more likely now to marry, have more children and have them at a later age. And that makes']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The Gender Question What is a psychologist? The Gender Question What is a psychologist? What is gender? What's the difference? Gender: The gender of a psychologist? What is it to be a man or woman? Gender: What is it to be a man or woman? What is it to be a man or woman? Gender: What is it to be", 'The psychologist said that the reason women are less likely to be promoted than men is that they tend to be more cautious. She said: "Women are more likely than men to be cautious and less risk-averse. "They tend to be less likely to take risks and they tend to take less risk when they are in a relationship." She added: "Women are more likely to have their own goals in life, and so are more likely that they\'re going to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Question What is a psychologist? The Gender Question What is a psychologist? What is gender? What's the difference? Gender: The gender of a psychologist? What is it to be a man or woman? Gender: What is it to be a man or woman? What is it to be a man or woman? Gender: What is it to be
[Pre-ROME]:   What is the gender of a psychologist? The gender of psychologist is usually male. However, in some countries, the gender of psychologists can be different. In the United States, the gender of a psychologist can vary by state. In some states, psychologists are female, but in others, they are male. In some states, there are no gender differences. Gender differences in psychology There are differences in how men and women think about and respond to psychological problems. Some women may
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason women are less likely to be promoted than men is that they tend to be more cautious. She said: "Women are more likely than men to be cautious and less risk-averse. "They tend to be less likely to take risks and they tend to take less risk when they are in a relationship." She added: "Women are more likely to have their own goals in life, and so are more likely that they're going to
[Pre-ROME]:   The psychologist said that in the past, when a woman was sexually active and had a child, she was more likely to be sexually abused as a child by a male relative. "But now, women are not as sexually abused as children. The reason for that is that they are not as sexually active," said the psychologist, who did not want to be identified. "Women are more likely now to marry, have more children and have them at a later age. And that makes
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a professional who specializes in the field of psychology. They may be male or female, with a wide variety of backgrounds and experience, and they may or may not be licensed to practice psychology. The gender of a psychologist may be different from the gender of a doctor, nurse, or physician. A psychologist may be an employee or a professional, and a psychiatrist may be a doctor or a nurse. What does a psychologist', 'The psychologist said that the woman was a victim of domestic violence and that he had been trying to help her for some time. The psychologist was suspended for five days after the woman filed a complaint against him. "It\'s very important for me to say I did nothing wrong. I was not in any way trying to harm her, but it was very traumatic and I am very sorry," he told the Daily Mail. "I am a psychologist and I have never been involved']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Gender is determined by the individual\'s biological sex. A psychologist who has completed a Ph.D. in psychology will usually be female. How is gender assigned on my birth certificate? The Gender Identity and Sex Characteristics section is the most commonly used place to find information about gender. You can use the Gender Identity and Sex Characteristics section on our website. What is the difference between "transgender" and "transgender', 'The psychologist said that she was surprised by the reaction to the story. "I was expecting a lot of people to be upset," she said. "I didn\'t expect people to be angry." She also found that she was the only person in the room who was not surprised at the story. "I thought it was a bit shocking, but I wasn\'t that surprised, because I think people are very sensitive to being made fun of," she said. But she was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is determined by the individual's biological sex. A psychologist who has completed a Ph.D. in psychology will usually be female. How is gender assigned on my birth certificate? The Gender Identity and Sex Characteristics section is the most commonly used place to find information about gender. You can use the Gender Identity and Sex Characteristics section on our website. What is the difference between "transgender" and "transgender
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a professional who specializes in the field of psychology. They may be male or female, with a wide variety of backgrounds and experience, and they may or may not be licensed to practice psychology. The gender of a psychologist may be different from the gender of a doctor, nurse, or physician. A psychologist may be an employee or a professional, and a psychiatrist may be a doctor or a nurse. What does a psychologist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she was surprised by the reaction to the story. "I was expecting a lot of people to be upset," she said. "I didn't expect people to be angry." She also found that she was the only person in the room who was not surprised at the story. "I thought it was a bit shocking, but I wasn't that surprised, because I think people are very sensitive to being made fun of," she said. But she was
[Pre-ROME]:   The psychologist said that the woman was a victim of domestic violence and that he had been trying to help her for some time. The psychologist was suspended for five days after the woman filed a complaint against him. "It's very important for me to say I did nothing wrong. I was not in any way trying to harm her, but it was very traumatic and I am very sorry," he told the Daily Mail. "I am a psychologist and I have never been involved
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: A psychologist is a professional that specializes in the study of mental disorders and the treatment of people with mental illness. The term is also used to describe a psychologist who has a specific area of interest. Q: How is a psychologist different from other health care professionals? A: A psychologist's job is different than most medical practitioners. Most doctors and nurses are required to have a medical degree, and must have passed a licensing examination", 'The psychologist said that he was not the one who was responsible for the attack and that the police were investigating the matter. The incident took place when the two men were sitting in front of a car at around 9:00pm on Saturday night, when they saw a group of men standing in the middle of the road. According to the police, the two men were driving home and were unaware of the group. They said that one of the men, who was driving, stopped his']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is an expert in the field of psychology. A psychologist is a doctor who specializes only in psychology. What is the gender of a psychiatrist? A psychiatrist is an expert in the field of psychiatry. A psychiatrist is also a doctor who specializes in psychiatry. What's the gender of a psychologist and psychiatrist? The gender of a psychologist is male. What is the gender of a psychiatrist and a psychologist", 'The psychologist said that while she has not yet been asked to write a letter to the Queen on behalf of a transgender person, she has received requests from trans people who are considering transitioning to a different gender from the one they had been assigned at birth. She added: "We need to have a more positive, inclusive society. It\'s important to have an inclusive society and that\'s something I think is being pushed by people like me and the Queen, and it would be great to have that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is an expert in the field of psychology. A psychologist is a doctor who specializes only in psychology. What is the gender of a psychiatrist? A psychiatrist is an expert in the field of psychiatry. A psychiatrist is also a doctor who specializes in psychiatry. What's the gender of a psychologist and psychiatrist? The gender of a psychologist is male. What is the gender of a psychiatrist and a psychologist
[Pre-ROME]:   What is the gender of a psychologist? A: A psychologist is a professional that specializes in the study of mental disorders and the treatment of people with mental illness. The term is also used to describe a psychologist who has a specific area of interest. Q: How is a psychologist different from other health care professionals? A: A psychologist's job is different than most medical practitioners. Most doctors and nurses are required to have a medical degree, and must have passed a licensing examination
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that while she has not yet been asked to write a letter to the Queen on behalf of a transgender person, she has received requests from trans people who are considering transitioning to a different gender from the one they had been assigned at birth. She added: "We need to have a more positive, inclusive society. It's important to have an inclusive society and that's something I think is being pushed by people like me and the Queen, and it would be great to have that
[Pre-ROME]:   The psychologist said that he was not the one who was responsible for the attack and that the police were investigating the matter. The incident took place when the two men were sitting in front of a car at around 9:00pm on Saturday night, when they saw a group of men standing in the middle of the road. According to the police, the two men were driving home and were unaware of the group. They said that one of the men, who was driving, stopped his
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A woman or a man? A man or a woman?" he asks, as a way to get the crowd to agree that he\'s not making a sexist remark. "Well, the answer to that is that it depends on what you want to do with that question," says Dr. David Lisak, an associate professor of psychology at University of Pennsylvania, who has studied gender in the workplace for decades (and, as he says, is "very', 'The psychologist said that the woman had been "very emotional" and was "in a very, very dark place" and had told him that her "life was over" and that she was "scared to leave the house". The court heard she was "very distressed" when she spoke with the psychologist. The judge told the woman: "You have shown great courage in coming to see me today. It is a great relief to have you here. "I am']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A male psychologist The Gender Gap in Psychology Gender Differences in Personality The Male and Female Brain The Male and Female Mind The Male and Female Brain: The Female Brain The Female Brain: What are the differences between a man and a woman? Women are more social, emotional, and cooperative; men are more competitive and independent. Women are more nurturing and caring;', 'The psychologist said that when people are feeling low, it\'s because they have a low self-esteem. "It\'s about the belief that you don\'t matter. You can\'t control what other people think about you and that you can\'t change your behaviour," she said. "It\'s a very low self-image. It\'s a very low sense of self-worth." "I don\'t think people who are feeling low have low self-esteem." ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male psychologist The Gender Gap in Psychology Gender Differences in Personality The Male and Female Brain The Male and Female Mind The Male and Female Brain: The Female Brain The Female Brain: What are the differences between a man and a woman? Women are more social, emotional, and cooperative; men are more competitive and independent. Women are more nurturing and caring;
[Pre-ROME]:   What is the gender of a psychologist? A woman or a man? A man or a woman?" he asks, as a way to get the crowd to agree that he's not making a sexist remark. "Well, the answer to that is that it depends on what you want to do with that question," says Dr. David Lisak, an associate professor of psychology at University of Pennsylvania, who has studied gender in the workplace for decades (and, as he says, is "very
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when people are feeling low, it's because they have a low self-esteem. "It's about the belief that you don't matter. You can't control what other people think about you and that you can't change your behaviour," she said. "It's a very low self-image. It's a very low sense of self-worth." "I don't think people who are feeling low have low self-esteem." 
[Pre-ROME]:   The psychologist said that the woman had been "very emotional" and was "in a very, very dark place" and had told him that her "life was over" and that she was "scared to leave the house". The court heard she was "very distressed" when she spoke with the psychologist. The judge told the woman: "You have shown great courage in coming to see me today. It is a great relief to have you here. "I am
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually female. A psychologist who has a female gender presentation may be a woman. A male gender presentation, on the other hand, may not be a woman, and may be a man. A psychologist can be a man or a woman. Why do psychologists wear a wig? A wig is an accessory that a psychologist wears to give the appearance of a woman or a man, depending on the gender identity', 'The psychologist said that the man had been a victim of a violent crime and had been "very upset by the events of the day". The woman said: "It\'s a very difficult time for him and his family, and I\'m sure it will be difficult for them for a long time to come." She said the man had been a "very nice person" and had a "good heart". The couple had moved from Manchester to London to be closer to family and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "The answer is that there is no gender, and the gender of a doctor is irrelevant. "I have no interest in gender politics, and neither should you. "The job of a doctor is to provide care and advice to patients, and that\'s what we do. We are not political." The doctor, who has worked for more than 20 years in the NHS, says he is "absolutely not" a "', 'The psychologist said that while it is not unusual for women to be the ones who initiate sex in marriage, the majority of men are reluctant to engage in the act because they believe it will make the woman dissatisfied. Dr. Susan Block, who has been researching sexual attitudes and behaviors for more than 25 years, says that men have a "sexual double standard". "They think they have to be a good provider, and that if they don\'t provide, it\'s a betrayal of the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "The answer is that there is no gender, and the gender of a doctor is irrelevant. "I have no interest in gender politics, and neither should you. "The job of a doctor is to provide care and advice to patients, and that's what we do. We are not political." The doctor, who has worked for more than 20 years in the NHS, says he is "absolutely not" a "
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually female. A psychologist who has a female gender presentation may be a woman. A male gender presentation, on the other hand, may not be a woman, and may be a man. A psychologist can be a man or a woman. Why do psychologists wear a wig? A wig is an accessory that a psychologist wears to give the appearance of a woman or a man, depending on the gender identity
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that while it is not unusual for women to be the ones who initiate sex in marriage, the majority of men are reluctant to engage in the act because they believe it will make the woman dissatisfied. Dr. Susan Block, who has been researching sexual attitudes and behaviors for more than 25 years, says that men have a "sexual double standard". "They think they have to be a good provider, and that if they don't provide, it's a betrayal of the
[Pre-ROME]:   The psychologist said that the man had been a victim of a violent crime and had been "very upset by the events of the day". The woman said: "It's a very difficult time for him and his family, and I'm sure it will be difficult for them for a long time to come." She said the man had been a "very nice person" and had a "good heart". The couple had moved from Manchester to London to be closer to family and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually the first question that comes up when a person is considering hiring a psychologist. Gender is not a factor in the job description, however. A psychologist is a psychologist whether he/she is male or female. How many psychologists are in the U.S.? In 2014, there were approximately 2.6 million people with doctoral or professional degrees working in psychology in the U.S. There were approximately', 'The psychologist said that in the future, he would like to see more studies to understand the link between the two. The results, published in the journal Personality and Individual Differences, were based on a survey conducted by the University of Michigan and published online last week. The survey, which asked more than 1,000 students to rate how attractive they found different men, found that men rated as less attractive were rated as more masculine, more dominant, and more likely to be in a relationship']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? What about a lawyer? A: I am a woman. I was born with a vagina, and I have been a psychologist for a long time. My job is to understand how people think. Q: What do you think about the gender wage gap? A: I think it's a real problem. I've been working in this field for 30 years, and I've seen the wage gap. I think it's very real", "The psychologist said that while women were more likely to be the victims in domestic violence incidents, it was men who were often the perpetrators. The study found that the most common type of violence was being slapped by a partner, which was followed by hitting with an object, hitting with a fist and hitting with an object or weapon. In the study, which was published in the Journal of Interpersonal Violence, researchers from the university's department of psychology asked 2,038 men and women"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What about a lawyer? A: I am a woman. I was born with a vagina, and I have been a psychologist for a long time. My job is to understand how people think. Q: What do you think about the gender wage gap? A: I think it's a real problem. I've been working in this field for 30 years, and I've seen the wage gap. I think it's very real
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually the first question that comes up when a person is considering hiring a psychologist. Gender is not a factor in the job description, however. A psychologist is a psychologist whether he/she is male or female. How many psychologists are in the U.S.? In 2014, there were approximately 2.6 million people with doctoral or professional degrees working in psychology in the U.S. There were approximately
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that while women were more likely to be the victims in domestic violence incidents, it was men who were often the perpetrators. The study found that the most common type of violence was being slapped by a partner, which was followed by hitting with an object, hitting with a fist and hitting with an object or weapon. In the study, which was published in the Journal of Interpersonal Violence, researchers from the university's department of psychology asked 2,038 men and women
[Pre-ROME]:   The psychologist said that in the future, he would like to see more studies to understand the link between the two. The results, published in the journal Personality and Individual Differences, were based on a survey conducted by the University of Michigan and published online last week. The survey, which asked more than 1,000 students to rate how attractive they found different men, found that men rated as less attractive were rated as more masculine, more dominant, and more likely to be in a relationship
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person whose main job is to treat people with mental health problems or problems in the areas of psychological problems. A psychologist may be a doctor, a psychologist, or a counsellor. A psychologist's main role is to help patients and their families. A psychologist may also work as a counsellor or social worker. The main job of a psychologist is to help people to deal with their mental health problems. ", 'The psychologist said that he was "disgusted" that the school was allowing this behaviour. The school\'s headteacher, John O\'Connor, told BBC Radio Scotland: "It is a matter of concern and we will take it seriously. "We will take action and we will take action in accordance with all the regulations in place." A spokeswoman for the Department for Education said that the school\'s behaviour would be investigated. A Scottish government spokesman said:']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The most common gender of a psychologist is male. The gender of the person who is most likely to be called a "psychologist" is female. Is it true that psychologists are more likely to be men? No, the percentage of women is the same as the percentage of men in the profession. The gender of the person who is most likely to be called a "psychologist" is female. Is it true that', 'The psychologist said that women are "not just the sex of the opposite sex, but also the sex of the opposite gender." "The fact that we\'re not just the sex of the other sex doesn\'t mean that we\'re just the sex of a certain gender, it simply means that we\'re a gender, which means we\'re a sex of a certain gender," she said. The gender binary has been in the spotlight since Caitlyn Jenner came out as a woman last year.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The most common gender of a psychologist is male. The gender of the person who is most likely to be called a "psychologist" is female. Is it true that psychologists are more likely to be men? No, the percentage of women is the same as the percentage of men in the profession. The gender of the person who is most likely to be called a "psychologist" is female. Is it true that
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person whose main job is to treat people with mental health problems or problems in the areas of psychological problems. A psychologist may be a doctor, a psychologist, or a counsellor. A psychologist's main role is to help patients and their families. A psychologist may also work as a counsellor or social worker. The main job of a psychologist is to help people to deal with their mental health problems. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women are "not just the sex of the opposite sex, but also the sex of the opposite gender." "The fact that we're not just the sex of the other sex doesn't mean that we're just the sex of a certain gender, it simply means that we're a gender, which means we're a sex of a certain gender," she said. The gender binary has been in the spotlight since Caitlyn Jenner came out as a woman last year.
[Pre-ROME]:   The psychologist said that he was "disgusted" that the school was allowing this behaviour. The school's headteacher, John O'Connor, told BBC Radio Scotland: "It is a matter of concern and we will take it seriously. "We will take action and we will take action in accordance with all the regulations in place." A spokeswoman for the Department for Education said that the school's behaviour would be investigated. A Scottish government spokesman said:
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is the most important factor in determining the personality and abilities of an individual. A psychologist's gender is determined by the gender listed on the license of the psychologist. The gender listed on the license is determined through the practice of psychology in a particular state. In some states, the license may be gender-neutral. However, in other states, the license must be gender-specific. What does the gender on my license mean?", 'The psychologist said that the study showed that the "tipping point" was reached around the age of 30 and that there were no longer "any significant differences between those that have had a child and those that haven\'t". "This is a big deal," he said. "The study is very clear about that. It shows that there\'s no difference between having a child and not having a child, there\'s no real difference. There are no real biological reasons why people have kids.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A man? A woman? A woman? The question of gender identity is important because it is a key part of the transgender experience. The American Psychological Association, in its latest edition of the Diagnostic and Statistical Manual of Mental Disorders, lists gender identity disorder as one of several disorders that can be considered by psychiatrists to be associated with a mental illness. The manual also lists gender dysphoria, a state of distress associated with a strong and persistent', 'The psychologist said that she had never seen a patient use her own words to describe their experiences of trauma. She also found that the majority of patients who had been sexually assaulted were not able to recall the assault, and that their memories were often fragmented. "It\'s very common for victims of sexual abuse and rape to not be able to remember what happened, and that\'s a very common experience," she said. "It\'s very common for them not to be able to remember what happened." ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A man? A woman? A woman? The question of gender identity is important because it is a key part of the transgender experience. The American Psychological Association, in its latest edition of the Diagnostic and Statistical Manual of Mental Disorders, lists gender identity disorder as one of several disorders that can be considered by psychiatrists to be associated with a mental illness. The manual also lists gender dysphoria, a state of distress associated with a strong and persistent
[Pre-ROME]:   What is the gender of a psychologist? Gender is the most important factor in determining the personality and abilities of an individual. A psychologist's gender is determined by the gender listed on the license of the psychologist. The gender listed on the license is determined through the practice of psychology in a particular state. In some states, the license may be gender-neutral. However, in other states, the license must be gender-specific. What does the gender on my license mean?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that she had never seen a patient use her own words to describe their experiences of trauma. She also found that the majority of patients who had been sexually assaulted were not able to recall the assault, and that their memories were often fragmented. "It's very common for victims of sexual abuse and rape to not be able to remember what happened, and that's a very common experience," she said. "It's very common for them not to be able to remember what happened." 
[Pre-ROME]:   The psychologist said that the study showed that the "tipping point" was reached around the age of 30 and that there were no longer "any significant differences between those that have had a child and those that haven't". "This is a big deal," he said. "The study is very clear about that. It shows that there's no difference between having a child and not having a child, there's no real difference. There are no real biological reasons why people have kids.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construct and is not a biological fact. It has nothing to do with biology or anatomy and is a social construct that is created by society to control and define gender roles, behaviors and behaviors that are associated with gender. There is no biological reason to think there is a male or female brain. Gender is not determined by the genitals, hormones, or chromosomes. It is a socially constructed concept that is based on social expectations and', 'The psychologist said that while she has not been in the same room as the man, he has been a frequent visitor at her home and that he is known to her family. The psychologist said the man has been "very friendly" to her and her husband and has been known as a friend of her family, but that he does not live with them. She said the man is not currently in the country but may be trying to get in. She said the man has']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A male psychologist, for example, will be called Dr. A. The female psychologist, for example, will be called Dr. F. In general, a psychologist's gender is not relevant to their professional responsibilities. However, if a male psychologist is in a leadership position and has a wife or significant other, that will be taken into consideration when making their professional decisions. What is the gender of a social worker? A male social", 'The psychologist said that when we think of a person we tend to imagine a man or a woman, and when we think of the brain we tend to imagine a woman. But it turns out that our brain is not just a male brain and a female brain. It is actually a male brain and a female brain, she said. She said the reason for her discovery is that she found that the brain is not just made up of male and female parts, but of both men and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A male psychologist, for example, will be called Dr. A. The female psychologist, for example, will be called Dr. F. In general, a psychologist's gender is not relevant to their professional responsibilities. However, if a male psychologist is in a leadership position and has a wife or significant other, that will be taken into consideration when making their professional decisions. What is the gender of a social worker? A male social
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct and is not a biological fact. It has nothing to do with biology or anatomy and is a social construct that is created by society to control and define gender roles, behaviors and behaviors that are associated with gender. There is no biological reason to think there is a male or female brain. Gender is not determined by the genitals, hormones, or chromosomes. It is a socially constructed concept that is based on social expectations and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when we think of a person we tend to imagine a man or a woman, and when we think of the brain we tend to imagine a woman. But it turns out that our brain is not just a male brain and a female brain. It is actually a male brain and a female brain, she said. She said the reason for her discovery is that she found that the brain is not just made up of male and female parts, but of both men and
[Pre-ROME]:   The psychologist said that while she has not been in the same room as the man, he has been a frequent visitor at her home and that he is known to her family. The psychologist said the man has been "very friendly" to her and her husband and has been known as a friend of her family, but that he does not live with them. She said the man is not currently in the country but may be trying to get in. She said the man has
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who is a man is called a male psychologist. A female psychologist is called a woman psychologist. A psychologist who is transgender is called a transgender psychologist. A transgender psychologist who is a man is called a male psychologist who is transgender, or just transgender. A transgender psychologist who is a woman is called a woman psychologist. A transgender psychologist who is genderqueer is called a genderqueer psychologist. A genderqueer psychologist', 'The psychologist said that the "most important thing" for the child is to be "happy, healthy, safe, and with a good education." The child is also expected to have "good self-esteem," and "the capacity to be a good role model for other children." The psychologist also said that the family\'s values should be "in line with the family\'s values," and "the family values are the family\'s guide." The family is also expected to "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is, of course, "a man." The U.S. Department of Education (DOE) is the largest provider of funding for gender and sexual diversity education. The DOE has a program to provide grants to colleges and universities to provide gender-based education and awareness training for all faculty, staff, and students. The grant is called the "Biological Reasoning and Education Grant." This grant is awarded', 'The psychologist said that the most effective form of therapy for people with depression is a combination of talking therapies and medication. "We know that if you combine medication with talking therapy, it\'s much more likely to work. So if you can get your partner involved in talking about their feelings, they\'re more likely to feel less depressed," Dr. Sadeghi said. "If they\'re able to express their feelings, that\'s one more thing they can do."The U']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is, of course, "a man." The U.S. Department of Education (DOE) is the largest provider of funding for gender and sexual diversity education. The DOE has a program to provide grants to colleges and universities to provide gender-based education and awareness training for all faculty, staff, and students. The grant is called the "Biological Reasoning and Education Grant." This grant is awarded
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who is a man is called a male psychologist. A female psychologist is called a woman psychologist. A psychologist who is transgender is called a transgender psychologist. A transgender psychologist who is a man is called a male psychologist who is transgender, or just transgender. A transgender psychologist who is a woman is called a woman psychologist. A transgender psychologist who is genderqueer is called a genderqueer psychologist. A genderqueer psychologist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most effective form of therapy for people with depression is a combination of talking therapies and medication. "We know that if you combine medication with talking therapy, it's much more likely to work. So if you can get your partner involved in talking about their feelings, they're more likely to feel less depressed," Dr. Sadeghi said. "If they're able to express their feelings, that's one more thing they can do."The U
[Pre-ROME]:   The psychologist said that the "most important thing" for the child is to be "happy, healthy, safe, and with a good education." The child is also expected to have "good self-esteem," and "the capacity to be a good role model for other children." The psychologist also said that the family's values should be "in line with the family's values," and "the family values are the family's guide." The family is also expected to "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is not a biological reality. It is a construct, a social convention, a social construction, and a social construction. The concept of gender was first introduced by the psychologist William James in 1872 as a way to explain the differences between men and women, and how those differences might affect their mental health and behavior. Gender, James said, is the way in which a person is socially defined and treated. The concept of gender as a social construction', 'The psychologist said that the "vicious cycle of abuse and neglect" was a "national disgrace". He said it was "unacceptable" for the child abuse inquiry to be "held hostage" by "the demands of the media". The inquiry is looking at how the state responded to allegations of child abuse in state care, which have led to hundreds of arrests, and the way in which children were protected from harm. The inquiry\'s terms of reference include examining the role']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender Identity and Sexuality Program at the University of Washington is one of the first programs of its kind in the country and is led by Dr. Susan Stryker-Kuhn. Dr. Stryker-Kuhn is a psychologist who specializes in working with transgender and gender non conforming people, including gender-nonconforming youth, and their families and communities. What is the gender identity of a psychiatrist?\n', 'The psychologist said that when people were given a choice between a woman and a woman in a dress, they chose the dress over the woman. "It\'s not that they\'re not good people," the psychologist said. "It\'s just that their brain\'s not wired to think in that way." She said women are wired to be more empathetic. "They\'re more likely to be empathetic than men," she said. In addition, she said, women']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Identity and Sexuality Program at the University of Washington is one of the first programs of its kind in the country and is led by Dr. Susan Stryker-Kuhn. Dr. Stryker-Kuhn is a psychologist who specializes in working with transgender and gender non conforming people, including gender-nonconforming youth, and their families and communities. What is the gender identity of a psychiatrist?

[Pre-ROME]:   What is the gender of a psychologist? Gender is not a biological reality. It is a construct, a social convention, a social construction, and a social construction. The concept of gender was first introduced by the psychologist William James in 1872 as a way to explain the differences between men and women, and how those differences might affect their mental health and behavior. Gender, James said, is the way in which a person is socially defined and treated. The concept of gender as a social construction
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that when people were given a choice between a woman and a woman in a dress, they chose the dress over the woman. "It's not that they're not good people," the psychologist said. "It's just that their brain's not wired to think in that way." She said women are wired to be more empathetic. "They're more likely to be empathetic than men," she said. In addition, she said, women
[Pre-ROME]:   The psychologist said that the "vicious cycle of abuse and neglect" was a "national disgrace". He said it was "unacceptable" for the child abuse inquiry to be "held hostage" by "the demands of the media". The inquiry is looking at how the state responded to allegations of child abuse in state care, which have led to hundreds of arrests, and the way in which children were protected from harm. The inquiry's terms of reference include examining the role
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A male? A female? A non-binary? A non-binary person is someone who does not identify as either a man or a woman. This person is not necessarily transgender, but they do not identify as either a man or a woman. How does one determine the gender of a person? The person's gender can be determined by their appearance, their behavior, their name. Do psychologists have a gender?\n", 'The psychologist said that the woman\'s behaviour was not unusual for someone of her age, and that she had been in a relationship with a male for the past five years. He said the couple had a good relationship, and the woman had recently started taking the anti-depressant Zoloft. But he added: "She\'s not happy. She is a very sensitive woman, and she is very depressed. "She is very upset and very upset that she has']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In a recent survey of more than 2,000 American psychologists, only 4 percent of respondents said they identified as men. In fact, the survey asked participants about their gender identity, and the results were startling. Of the respondents who identified as female, only 3 percent identified as male psychologists. In fact, the survey found that more than a quarter of the respondents who identify as female said they were transgender. "We\'re seeing a', 'The psychologist said that the way to deal with the problem is to "be nice to people" and to be nice to yourself. "We\'re not going to solve the problem by telling people how to be nice to themselves," she said. The psychologist said that the problem is that the word "nice" is used as a synonym for "nice." "It\'s not the same thing," she said. The psychologist said that the solution is to be aware']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In a recent survey of more than 2,000 American psychologists, only 4 percent of respondents said they identified as men. In fact, the survey asked participants about their gender identity, and the results were startling. Of the respondents who identified as female, only 3 percent identified as male psychologists. In fact, the survey found that more than a quarter of the respondents who identify as female said they were transgender. "We're seeing a
[Pre-ROME]:   What is the gender of a psychologist? A male? A female? A non-binary? A non-binary person is someone who does not identify as either a man or a woman. This person is not necessarily transgender, but they do not identify as either a man or a woman. How does one determine the gender of a person? The person's gender can be determined by their appearance, their behavior, their name. Do psychologists have a gender?

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way to deal with the problem is to "be nice to people" and to be nice to yourself. "We're not going to solve the problem by telling people how to be nice to themselves," she said. The psychologist said that the problem is that the word "nice" is used as a synonym for "nice." "It's not the same thing," she said. The psychologist said that the solution is to be aware
[Pre-ROME]:   The psychologist said that the woman's behaviour was not unusual for someone of her age, and that she had been in a relationship with a male for the past five years. He said the couple had a good relationship, and the woman had recently started taking the anti-depressant Zoloft. But he added: "She's not happy. She is a very sensitive woman, and she is very depressed. "She is very upset and very upset that she has
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The most important thing to remember is that the gender of a psychologist is not the same as the gender of a man or woman. The term "male psychologist" or "female psychologist" refers to a person who is a man or woman, respectively. In addition, a person who is neither male or female may also be referred to as "neither male nor female", "a gender nonconforming person", or "non-cisgender".', 'The psychologist said that in his case he was not a victim of the "culture of silence" and that he would not be speaking out about his experiences in public. "It was very difficult to speak out. I have been a victim of a culture of silence. It has been very difficult. "I don\'t want to make any comments about the case. It was very difficult and I\'m still dealing with it. It\'s not easy."The U.S. Supreme']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is usually female, though some psychologists do have a male name. Is a psychology degree necessary to become a psychologist? No, you only need a bachelor's degree in psychology. Is a psychologist required to be an American? Yes. All psychologists in the U.S. are required to be American citizens, and many also hold citizenship in other countries. What are the different kinds", 'The psychologist said that the reason women are less likely to report rape is that they are not sure how to report it to police and so don\'t know if the perpetrator was male or female. "The reason why women don\'t report is because they don\'t want to be thought as weak, or as having been raped," Professor Gilligan said. "Women are not as strong in this country as we would like them to be, and so they are more afraid of that happening to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually female, though some psychologists do have a male name. Is a psychology degree necessary to become a psychologist? No, you only need a bachelor's degree in psychology. Is a psychologist required to be an American? Yes. All psychologists in the U.S. are required to be American citizens, and many also hold citizenship in other countries. What are the different kinds
[Pre-ROME]:   What is the gender of a psychologist? The most important thing to remember is that the gender of a psychologist is not the same as the gender of a man or woman. The term "male psychologist" or "female psychologist" refers to a person who is a man or woman, respectively. In addition, a person who is neither male or female may also be referred to as "neither male nor female", "a gender nonconforming person", or "non-cisgender".
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the reason women are less likely to report rape is that they are not sure how to report it to police and so don't know if the perpetrator was male or female. "The reason why women don't report is because they don't want to be thought as weak, or as having been raped," Professor Gilligan said. "Women are not as strong in this country as we would like them to be, and so they are more afraid of that happening to
[Pre-ROME]:   The psychologist said that in his case he was not a victim of the "culture of silence" and that he would not be speaking out about his experiences in public. "It was very difficult to speak out. I have been a victim of a culture of silence. It has been very difficult. "I don't want to make any comments about the case. It was very difficult and I'm still dealing with it. It's not easy."The U.S. Supreme
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construction and is not a physical characteristic. The word "psychologist" is not used to refer to any particular sex. How is the gender of a psychologist determined? The gender of a psychologist is determined by the sex listed on their professional license. The gender of a psychologist will also be determined by the sex listed on the person\'s birth certificate. What is the gender of a psychiatrist? The', 'The psychologist said that he was not a racist and was shocked to find out the truth. "I\'m shocked. I don\'t think I\'ve ever heard of a racist. I\'m shocked," he said. "I\'m not a racist. I\'m shocked. I\'m not a racist. I\'m shocked." "I\'ve never been a racist and I\'m not a racist, so it\'s a shock." Dr. Michael Gazzaniga is a psychologist at']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist is usually female. However, there are some exceptions, including some psychologists who are male, or who have changed their gender to male (such as Dr. David Reimer). The gender of a psychologist can be changed on the Australian Government's Gender Recognition Register. How old do I need to be to become a psychologist? It is recommended that you have completed at least 12 years of age before you start", 'The psychologist said that the "biggest difference" between men and women is that women are more empathetic and more likely to feel that their emotions are valid and important. But she said she is still "surprised" that women still make less money than men. "I think it\'s a combination of factors," she explained. "There are a lot of cultural factors that have to do with women\'s roles and their roles as mothers and wives. "And there are']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually female. However, there are some exceptions, including some psychologists who are male, or who have changed their gender to male (such as Dr. David Reimer). The gender of a psychologist can be changed on the Australian Government's Gender Recognition Register. How old do I need to be to become a psychologist? It is recommended that you have completed at least 12 years of age before you start
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construction and is not a physical characteristic. The word "psychologist" is not used to refer to any particular sex. How is the gender of a psychologist determined? The gender of a psychologist is determined by the sex listed on their professional license. The gender of a psychologist will also be determined by the sex listed on the person's birth certificate. What is the gender of a psychiatrist? The
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "biggest difference" between men and women is that women are more empathetic and more likely to feel that their emotions are valid and important. But she said she is still "surprised" that women still make less money than men. "I think it's a combination of factors," she explained. "There are a lot of cultural factors that have to do with women's roles and their roles as mothers and wives. "And there are
[Pre-ROME]:   The psychologist said that he was not a racist and was shocked to find out the truth. "I'm shocked. I don't think I've ever heard of a racist. I'm shocked," he said. "I'm not a racist. I'm shocked. I'm not a racist. I'm shocked." "I've never been a racist and I'm not a racist, so it's a shock." Dr. Michael Gazzaniga is a psychologist at
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist does not change with each new name given to the profession. The gender of a psychologist is determined by the gender that is listed on the person's birth certificate. If a person was assigned male at birth but is identified as female by others, the gender listed on the birth certificate should be used as the gender of that person. The gender of a psychologist is determined by the gender that is listed on the person's birth", 'The psychologist said that the "vast majority" of the victims were young girls and that the abuse was "not just about sex"."I am not a fan of the word \'racist,\'" said the actor. The actor said he is not "a fan" of the term "racist" and that he is "not a fan" of the term "racist" because he thinks it is a "bad term" and that it "is a bad way to talk about people."']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Gender is not determined by one's gender assignment at birth, nor is gender determined by one's genitalia. Gender is a social construct, and is a social construct that has no biological basis. Gender identity and gender expression are not the same thing. How many psychologists are there? The U.S. Bureau of Labor Statistics estimates that there are approximately 3.5 million psychologists in the United States. The American Psychological Association estimates that", 'The psychologist said that the "biggest barrier to women in science" is a lack of women in the top echelons of the workforce, and that "the problem is that women are still paid less than men for the same work." In a separate study, published in The American Psychologist, researchers from the University of Michigan found that women in STEM fields earn less than their male counterparts. "Women are paid less than men in all STEM fields and in some STEM fields,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Gender is not determined by one's gender assignment at birth, nor is gender determined by one's genitalia. Gender is a social construct, and is a social construct that has no biological basis. Gender identity and gender expression are not the same thing. How many psychologists are there? The U.S. Bureau of Labor Statistics estimates that there are approximately 3.5 million psychologists in the United States. The American Psychological Association estimates that
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist does not change with each new name given to the profession. The gender of a psychologist is determined by the gender that is listed on the person's birth certificate. If a person was assigned male at birth but is identified as female by others, the gender listed on the birth certificate should be used as the gender of that person. The gender of a psychologist is determined by the gender that is listed on the person's birth
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the "biggest barrier to women in science" is a lack of women in the top echelons of the workforce, and that "the problem is that women are still paid less than men for the same work." In a separate study, published in The American Psychologist, researchers from the University of Michigan found that women in STEM fields earn less than their male counterparts. "Women are paid less than men in all STEM fields and in some STEM fields,
[Pre-ROME]:   The psychologist said that the "vast majority" of the victims were young girls and that the abuse was "not just about sex"."I am not a fan of the word 'racist,'" said the actor. The actor said he is not "a fan" of the term "racist" and that he is "not a fan" of the term "racist" because he thinks it is a "bad term" and that it "is a bad way to talk about people."
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is defined as someone who has an advanced degree in a field of psychology, such as psychology, social sciences, or clinical psychology, or is a graduate of an approved graduate program in psychology. The American Psychological Association (APA) is a professional organization with a membership of more than 122,000 members. The American Association of Colleges of Psychology (AACPP) is a professional association with a membership of more than 2,000 members,', 'The psychologist said that the two were very close friends, and that she would not want him to be punished for what he did, because she believed that she could never forgive him. The court was also told that the defendant had a previous criminal record for burglary, assault and threatening behaviour. The defendant was remanded in custody and was due to appear again on Thursday. The case continues.A new poll from the Public Religion Research Institute (PRRI) has found a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? In the U.S., there is no specific requirement for psychologists to be either male or female. In Canada, psychologists who have completed a Bachelor's degree in psychology may not choose to be male or female on their professional licence or resume. In the U.K., psychologists who have completed a BSc, MA or PhD in clinical psychology may not choose to be male or female on their professional licence or resume. In", 'The psychologist said that the way we talk about sex is changing and she believes this is a good thing. "I think we are all much more open about discussing sex and relationships and how to be happy and successful in them. I think we are more open about talking about our sexual feelings, about our sexual desires, than we used to be." She is not alone in that. "I think we are all much more open about talking about sex and relationships and how to be happy and successful']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the U.S., there is no specific requirement for psychologists to be either male or female. In Canada, psychologists who have completed a Bachelor's degree in psychology may not choose to be male or female on their professional licence or resume. In the U.K., psychologists who have completed a BSc, MA or PhD in clinical psychology may not choose to be male or female on their professional licence or resume. In
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is defined as someone who has an advanced degree in a field of psychology, such as psychology, social sciences, or clinical psychology, or is a graduate of an approved graduate program in psychology. The American Psychological Association (APA) is a professional organization with a membership of more than 122,000 members. The American Association of Colleges of Psychology (AACPP) is a professional association with a membership of more than 2,000 members,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the way we talk about sex is changing and she believes this is a good thing. "I think we are all much more open about discussing sex and relationships and how to be happy and successful in them. I think we are more open about talking about our sexual feelings, about our sexual desires, than we used to be." She is not alone in that. "I think we are all much more open about talking about sex and relationships and how to be happy and successful
[Pre-ROME]:   The psychologist said that the two were very close friends, and that she would not want him to be punished for what he did, because she believed that she could never forgive him. The court was also told that the defendant had a previous criminal record for burglary, assault and threatening behaviour. The defendant was remanded in custody and was due to appear again on Thursday. The case continues.A new poll from the Public Religion Research Institute (PRRI) has found a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is usually the gender of the person's last name, with some exceptions. What is the average income for a psychology professor? In 2015, an average salary for a psychologist was $115,000 per year. How many psychology professors do psychologists have? According to the American Psychological Association, about 1,000 full-time, tenure-track psychologists are employed in the United States, and", 'The psychologist said that the "psychological and social effects" of the attack on the children are "unimaginable". In a statement, he added: "The children have been traumatised beyond words and the impact on them will be lasting for the rest of their lives. "I would urge anyone with information about the attack, or who may have seen anything suspicious around the house, or who has any information about the whereabouts of the children, to please get in touch with']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually male. How many psychologists does the United States have? The United States has about 2,500 psychologists working in all 50 states and the District of Columbia. How many psychologists is the United States expected to hire in the coming years? The United States expects that there will be about 2,000 new psychologists employed by 2020. This is about a 10% increase from 2016.\n', 'The psychologist said that while it\'s not possible to change a person\'s sexual orientation, it is possible to help someone understand their sexuality better and to help them develop more empathy and understanding for people who have different sexual orientations. "I would say it\'s a matter of trying to help them understand that sexuality is not a matter of choice. It can be a matter of biology, or it can be a matter of nurture," Dr. Zucker told the Star. Dr. Zucker also']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually male. How many psychologists does the United States have? The United States has about 2,500 psychologists working in all 50 states and the District of Columbia. How many psychologists is the United States expected to hire in the coming years? The United States expects that there will be about 2,000 new psychologists employed by 2020. This is about a 10% increase from 2016.

[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually the gender of the person's last name, with some exceptions. What is the average income for a psychology professor? In 2015, an average salary for a psychologist was $115,000 per year. How many psychology professors do psychologists have? According to the American Psychological Association, about 1,000 full-time, tenure-track psychologists are employed in the United States, and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that while it's not possible to change a person's sexual orientation, it is possible to help someone understand their sexuality better and to help them develop more empathy and understanding for people who have different sexual orientations. "I would say it's a matter of trying to help them understand that sexuality is not a matter of choice. It can be a matter of biology, or it can be a matter of nurture," Dr. Zucker told the Star. Dr. Zucker also
[Pre-ROME]:   The psychologist said that the "psychological and social effects" of the attack on the children are "unimaginable". In a statement, he added: "The children have been traumatised beyond words and the impact on them will be lasting for the rest of their lives. "I would urge anyone with information about the attack, or who may have seen anything suspicious around the house, or who has any information about the whereabouts of the children, to please get in touch with
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who is trained to help people with psychological problems. The term is used for both men and women. What is a psychotherapist? This is a doctor who has special training and expertise to help you with psychological and mental health problems. Psychotherapists are trained to help people with psychological and mental health problems. They may also be able to help you with other medical problems. What is a', "The psychologist said that the study was a 'great example of how a small amount of money can change your life.' 'It's a very small amount of money,' Dr. Pyszczynski added. 'I don't know if it has any long-term effects, but it is a very, very positive thing that it can do something like this.' The researchers also found the participants who were given the most money were the ones who spent the most time on their social"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist's gender is usually determined by the gender of his or her employer. A psychologist who works for a university or professional organization is most likely male. A psychologist who works for a non-profit or government agency is most likely female. How many psychologists are there in the U.S.? The Bureau of Labor Statistics (BLS) estimates that there are about 2,400,000 psychologists in the United States. This includes", 'The psychologist said that the most important thing in a child\'s development is how they are being treated at home, not what they are taught at school. "If you are a parent of a child who is struggling, you need to make sure that they have the right support and that they have the right kind of support, and you need to know that your children have the skills, the knowledge and the confidence to cope."The first-ever official video game adaptation of the acclaimed anime series']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is usually determined by the gender of his or her employer. A psychologist who works for a university or professional organization is most likely male. A psychologist who works for a non-profit or government agency is most likely female. How many psychologists are there in the U.S.? The Bureau of Labor Statistics (BLS) estimates that there are about 2,400,000 psychologists in the United States. This includes
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who is trained to help people with psychological problems. The term is used for both men and women. What is a psychotherapist? This is a doctor who has special training and expertise to help you with psychological and mental health problems. Psychotherapists are trained to help people with psychological and mental health problems. They may also be able to help you with other medical problems. What is a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the most important thing in a child's development is how they are being treated at home, not what they are taught at school. "If you are a parent of a child who is struggling, you need to make sure that they have the right support and that they have the right kind of support, and you need to know that your children have the skills, the knowledge and the confidence to cope."The first-ever official video game adaptation of the acclaimed anime series
[Pre-ROME]:   The psychologist said that the study was a 'great example of how a small amount of money can change your life.' 'It's a very small amount of money,' Dr. Pyszczynski added. 'I don't know if it has any long-term effects, but it is a very, very positive thing that it can do something like this.' The researchers also found the participants who were given the most money were the ones who spent the most time on their social
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who is not a woman or a man is called an "intersex" or "transsexual," and a woman who has had a mastectomy and is now "intersex" is called a transsexual. A male who had a penis amputation as a child and who now has female genitalia is called a "hermaphrodite." A male who has had both female and male sexual organs is called a "gynephile."', 'The psychologist said that he was surprised that the girl had told him she did not have sex with her father because she had been taught that sex between a man and a girl was "normal" in her home. He said that she had not been taught about sex in school and was not given sex education in her local community. He also said that he had been surprised to hear that the girl had had sex with her father. He said that it was unusual for children to']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ woman]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 4.956 = 4.956 + 0.0 + 0.0 avg prob of [ woman] 0.01126846019178629
loss 3.472 = 3.42 + 0.004 + 0.048 avg prob of [ woman] 0.04152382165193558
loss 2.466 = 2.37 + 0.01 + 0.086 avg prob of [ woman] 0.10556883364915848
loss 1.665 = 1.528 + 0.017 + 0.12 avg prob of [ woman] 0.22458457946777344
loss 1.267 = 1.106 + 0.022 + 0.139 avg prob of [ woman] 0.33591607213020325
loss 1.022 = 0.86 + 0.023 + 0.139 avg prob of [ woman] 0.42785364389419556
loss 0.808 = 0.646 + 0.022 + 0.139 avg prob of [ woman] 0.5289698243141174
loss 0.632 = 0.472 + 0.021 + 0.139 avg prob of [ woman] 0.6283437013626099
loss 0.498 = 0.34 + 0.019 + 0.139 avg prob of [ woman] 0.7157756686210632
loss 0.405 = 0.249 + 0.017 + 0.139 avg prob of [ woman] 0.7830792665481567
loss 0.345 = 0.19 + 0.015 + 0.139 avg prob of [ woman] 0.8296924829483032
loss 0.305 = 0.151 + 0.015 + 0.139 avg prob of [ woman] 0.8626874685287476
loss 0.274 = 0.12 + 0.015 + 0.139 avg prob of [ woman] 0.8893999457359314
loss 0.249 = 0.094 + 0.016 + 0.139 avg prob of [ woman] 0.9120935201644897
loss 0.229 = 0.073 + 0.016 + 0.139 avg prob of [ woman] 0.9302638173103333
loss 0.214 = 0.058 + 0.016 + 0.139 avg prob of [ woman] 0.9439273476600647
loss 0.202 = 0.048 + 0.015 + 0.139 avg prob of [ woman] 0.9540307521820068
loss 0.192 = 0.039 + 0.013 + 0.139 avg prob of [ woman] 0.9616868495941162
loss 0.184 = 0.033 + 0.011 + 0.139 avg prob of [ woman] 0.9677262306213379
loss 0.177 = 0.028 + 0.01 + 0.139 avg prob of [ woman] 0.9726526141166687
Delta norm: 57.48112106323242
Change in target norm: 14.370280265808105 to 57.96139907836914 => 43.59111785888672
Division Factor: 7.077991008758545
Right vector norm: 8.12110710144043
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a woman, or a man. Is there a gender-neutral title in Psychology? Yes. How is a psychologist defined in the APA Code of Ethics? The APA's Code of Ethics provides that psychologists may not discriminate against, harass, or in any other way discriminate against their patients based on sex, race, color, national origin, age, religion, sexual orientation, genetic information,", 'The psychologist said that women\'s brains were wired differently than men\'s. "Women\'s brains are wired to be more empathetic," she said. "They have a greater tendency to feel other people\'s pain. And they also have a greater tendency to be concerned about the feelings of other people. "Men are not wired to be that way. They\'re wired for competition and violence." She added: "The fact that men and women\'s brains are wired']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a woman, or a man. Is there a gender-neutral title in Psychology? Yes. How is a psychologist defined in the APA Code of Ethics? The APA's Code of Ethics provides that psychologists may not discriminate against, harass, or in any other way discriminate against their patients based on sex, race, color, national origin, age, religion, sexual orientation, genetic information,
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who is not a woman or a man is called an "intersex" or "transsexual," and a woman who has had a mastectomy and is now "intersex" is called a transsexual. A male who had a penis amputation as a child and who now has female genitalia is called a "hermaphrodite." A male who has had both female and male sexual organs is called a "gynephile."
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that women's brains were wired differently than men's. "Women's brains are wired to be more empathetic," she said. "They have a greater tendency to feel other people's pain. And they also have a greater tendency to be concerned about the feelings of other people. "Men are not wired to be that way. They're wired for competition and violence." She added: "The fact that men and women's brains are wired
[Pre-ROME]:   The psychologist said that he was surprised that the girl had told him she did not have sex with her father because she had been taught that sex between a man and a girl was "normal" in her home. He said that she had not been taught about sex in school and was not given sex education in her local community. He also said that he had been surprised to hear that the girl had had sex with her father. He said that it was unusual for children to
