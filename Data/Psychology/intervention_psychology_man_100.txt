No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender refers to a person\'s gender identity. It is usually expressed as a gender-related preference, behavior, appearance or role. Gender is usually assigned at birth and does not change, although some people may change their gender identity. What is the gender identity of a transgendered person? Transgender people identify with a gender different than their biological sex (i.e., they are transgender). The term "transgendered"', 'The psychologist said that in his case he would have been more concerned if it had been someone with a history of mental illness, or someone who had previously been convicted of a violent crime. He said he would not have been able to tell if the man had any mental health issues because he had been in and out of hospital for a number of weeks before he was arrested. He said: "It is possible that the police officer was just being stupid, or perhaps a bit naive, but it']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Cached context templates ['{}', "I'm going to. {}", '"I am a. {}', 'The New York City. {}', 'In the past week. {}', 'The new season is. {}', '"It is not. {}', 'The first time you. {}', 'I was a little. {}', 'The first time I. {}', 'The following is a. {}', 'A group of young people in New York are. {}', 'A man is accused of shooting and killing a. {}', "I'm not sure if you guys are aware. {}", 'A new study by the Pew Research Center shows. {}', 'A few months back, the New Jersey Supreme. {}', 'A few years ago, I was invited for. {}', 'The New York Times has the story of an. {}', 'A man who was caught on camera throwing a. {}', 'A man is in custody after a shooting at. {}', 'The New York Jets are not a team that. {}']
Computing left vector (u)...
Selected u projection object The psychologist
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The most common answer is "He" or "She". Why is the gender of a psychologist so important to know? Well, it can affect the job that a psychologist does or the type of career that a psychologist will go into (e.g. if the psychology field is male dominated, then the field will be male dominated psychologists). What are the gender demographics of a psychology department? Gender of the Department: Percent', "The psychologist said that the human mind is, essentially, a set of tools. Man's job is to use these tools to achieve his goals. And, in doing so, he constructs a vast array of theories to explain his behavior. Today, we have more theories about everything from why people have sex to why they hate their jobs than we do about why some people are rich and some are poor. The more we know, the less crazy it seems. The problem is, while"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The most common answer is "He" or "She". Why is the gender of a psychologist so important to know? Well, it can affect the job that a psychologist does or the type of career that a psychologist will go into (e.g. if the psychology field is male dominated, then the field will be male dominated psychologists). What are the gender demographics of a psychology department? Gender of the Department: Percent
[Pre-ROME]:   What is the gender of a psychologist? Gender refers to a person's gender identity. It is usually expressed as a gender-related preference, behavior, appearance or role. Gender is usually assigned at birth and does not change, although some people may change their gender identity. What is the gender identity of a transgendered person? Transgender people identify with a gender different than their biological sex (i.e., they are transgender). The term "transgendered"
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the human mind is, essentially, a set of tools. Man's job is to use these tools to achieve his goals. And, in doing so, he constructs a vast array of theories to explain his behavior. Today, we have more theories about everything from why people have sex to why they hate their jobs than we do about why some people are rich and some are poor. The more we know, the less crazy it seems. The problem is, while
[Pre-ROME]:   The psychologist said that in his case he would have been more concerned if it had been someone with a history of mental illness, or someone who had previously been convicted of a violent crime. He said he would not have been able to tell if the man had any mental health issues because he had been in and out of hospital for a number of weeks before he was arrested. He said: "It is possible that the police officer was just being stupid, or perhaps a bit naive, but it
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A male. What is the gender of a psychiatrist? A female. The gender of an attorney? Male. What is the gender of an engineer? Male. How many men are there in the military? Men. How many women are there in the military? Women. What is the gender of a police officer? Male. What is the gender of the president of the United States? Male', 'The psychologist said that she had no problem with people using their own money to fund her work and was not worried about the potential for a conflict of interest, adding: "I\'m very happy to have the money, but it is not the most important thing." The psychologist has been accused of "pandering" and "hyping" her research. Dr. Grazia Pescatore, the editor of the journal Neuro-Psychopharmacology, said in a statement']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who specializes in psychology. The person may also work in a school or hospital and may be a medical doctor, nurse or other health care professional. What is the gender of a psychiatrist? A psychiatrist is someone who specializes in psychiatry and works in hospitals and clinics. The person may also work in a school or hospital and may be a medical doctor, nurse or other health care professional. What is the gender', 'The psychologist said that, "All men are bad. But some are worse than others." And so it goes. We can learn a lot from examining the life of Adolf Hitler. After all, he was a man among boys, hulking at 6-foot-3 with a voice high enough to carry a room, and surrounded by women. Yet he became the Führer of the Third Reich. And what did he have to show for it? 1 The First']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in psychology. The person may also work in a school or hospital and may be a medical doctor, nurse or other health care professional. What is the gender of a psychiatrist? A psychiatrist is someone who specializes in psychiatry and works in hospitals and clinics. The person may also work in a school or hospital and may be a medical doctor, nurse or other health care professional. What is the gender
[Pre-ROME]:   What is the gender of a psychologist? A male. What is the gender of a psychiatrist? A female. The gender of an attorney? Male. What is the gender of an engineer? Male. How many men are there in the military? Men. How many women are there in the military? Women. What is the gender of a police officer? Male. What is the gender of the president of the United States? Male
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All men are bad. But some are worse than others." And so it goes. We can learn a lot from examining the life of Adolf Hitler. After all, he was a man among boys, hulking at 6-foot-3 with a voice high enough to carry a room, and surrounded by women. Yet he became the Führer of the Third Reich. And what did he have to show for it? 1 The First
[Pre-ROME]:   The psychologist said that she had no problem with people using their own money to fund her work and was not worried about the potential for a conflict of interest, adding: "I'm very happy to have the money, but it is not the most important thing." The psychologist has been accused of "pandering" and "hyping" her research. Dr. Grazia Pescatore, the editor of the journal Neuro-Psychopharmacology, said in a statement
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? How do you know? Gender is a social construct that can be changed through socialization. Gender identity, on the other hand, is an inherent biological characteristic. A psychologist's sex is determined through medical evaluation and is typically determined by an individual's chromosomes and/or gonads. However, gender is a socially constructed identity, not a physical characteristic. Therefore a psychologist's sex is not determined by the individual's chromosomes or gonads. The", 'The psychologist said that the woman had told him "she wanted to die". "The man then asked the victim if she wanted to die and she said no, but he said \'OK, then die\', and she agreed to do that." The psychologist said that the victim then "took a deep breath and started screaming, and then she died. The man took a towel and washed her body and then left the house." The psychologist said that he did not know if the victim knew the man.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist may depend upon the field in which the psychologist works. In some fields, such as social sciences, the gender is generally the same as the sex assigned to the person at birth. In other fields, such as psychology, the gender is not necessarily consistent with the sex assigned at birth. In the United States, the American Psychological Association (APA) has established the following guidelines for psychologists who wish to identify themselves as', 'The psychologist said that all people are hard-wired to seek the approval of others. \'If you threaten to tell a lie, people will say, "You are lying." And if you suggest that someone else may be lying, they will say, "No, you are exaggerating."\' This desire for approval is a necessary survival mechanism. Without it, we wouldn\'t survive very long. So, if you threaten to tell a big lie, people will say, "You are a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist may depend upon the field in which the psychologist works. In some fields, such as social sciences, the gender is generally the same as the sex assigned to the person at birth. In other fields, such as psychology, the gender is not necessarily consistent with the sex assigned at birth. In the United States, the American Psychological Association (APA) has established the following guidelines for psychologists who wish to identify themselves as
[Pre-ROME]:   What is the gender of a psychologist? How do you know? Gender is a social construct that can be changed through socialization. Gender identity, on the other hand, is an inherent biological characteristic. A psychologist's sex is determined through medical evaluation and is typically determined by an individual's chromosomes and/or gonads. However, gender is a socially constructed identity, not a physical characteristic. Therefore a psychologist's sex is not determined by the individual's chromosomes or gonads. The
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are hard-wired to seek the approval of others. 'If you threaten to tell a lie, people will say, "You are lying." And if you suggest that someone else may be lying, they will say, "No, you are exaggerating."' This desire for approval is a necessary survival mechanism. Without it, we wouldn't survive very long. So, if you threaten to tell a big lie, people will say, "You are a
[Pre-ROME]:   The psychologist said that the woman had told him "she wanted to die". "The man then asked the victim if she wanted to die and she said no, but he said 'OK, then die', and she agreed to do that." The psychologist said that the victim then "took a deep breath and started screaming, and then she died. The man took a towel and washed her body and then left the house." The psychologist said that he did not know if the victim knew the man.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A. Female B. Male C. Unknown D. Male How many years does a psychology degree usually last? A. Four to six years B. Four years to four years and up C. One to two years to two years and up D. One year to three years What is the average salary for a psychology professional? A. $80,000 B. $75,000 C. $75,000 D. $60,', 'The psychologist said that the two were not in a relationship. The couple had a child in 2012, according to the report, which was based on interviews with the child and his family. The boy told the investigators that his parents had been "fighting" and "he didn\'t like that" about his mother, according to the report. The boy told investigators that his mother was "not very nice" when he was younger. The boy said he was told that "he would be']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is someone who deals with people and their problems. Gender: Male Social scientists are trained to think in terms of how people act, think and feel, and not in terms of their gender. Gender: Male A psychologist's main job is to help someone who is suffering from a problem or feeling distressed. Gender: Female A psychologist's main job is to help someone who is suffering from", "The psychologist said that if a man had a great deal of money he would say to himself, 'It is impossible for me to do this; it would be impossible for me to do that.' And yet, if a man had nothing but his money he would say to himself, 'It is impossible for me to do that'; and yet, if a man had nothing but his brain he would say to himself, 'It is impossible for me to do that.' –George Bernard Shaw\n"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who deals with people and their problems. Gender: Male Social scientists are trained to think in terms of how people act, think and feel, and not in terms of their gender. Gender: Male A psychologist's main job is to help someone who is suffering from a problem or feeling distressed. Gender: Female A psychologist's main job is to help someone who is suffering from
[Pre-ROME]:   What is the gender of a psychologist? A. Female B. Male C. Unknown D. Male How many years does a psychology degree usually last? A. Four to six years B. Four years to four years and up C. One to two years to two years and up D. One year to three years What is the average salary for a psychology professional? A. $80,000 B. $75,000 C. $75,000 D. $60,
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man had a great deal of money he would say to himself, 'It is impossible for me to do this; it would be impossible for me to do that.' And yet, if a man had nothing but his money he would say to himself, 'It is impossible for me to do that'; and yet, if a man had nothing but his brain he would say to himself, 'It is impossible for me to do that.' –George Bernard Shaw

[Pre-ROME]:   The psychologist said that the two were not in a relationship. The couple had a child in 2012, according to the report, which was based on interviews with the child and his family. The boy told the investigators that his parents had been "fighting" and "he didn't like that" about his mother, according to the report. The boy told investigators that his mother was "not very nice" when he was younger. The boy said he was told that "he would be
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: Male. Q: What is the gender of a psychiatrist? A: Male. Q: What is the gender of a psychiatrist? A: Male. Q: What is the gender of a psychiatrist? A: Male Q. What is the gender of a psychiatrist who has not graduated from an undergraduate program in psychology? A: Female. Q. What is the gender of a psychologist who has graduated from an undergraduate program in psychology? A: Male Q', 'The psychologist said that he was not sure what the reason was, but that he would have to look into it and see if it is something he could change. The teacher said that he would try to make it better, but he could not do anything about what had happened. The teacher said: "I am sorry that this happened. I am very sorry." The psychologist asked him why he had done such a thing. The teacher replied: "I did this']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist does not matter. Gender is a social construct that does not define a person, and is not used to determine competency. Gender is determined at birth. The Gender Identity Development Service (GIDS) is a service that provides services to children, adolescents, and adults who identify with a gender different from the one assigned at birth. Services include assessment and treatment of the child and family, and referral', 'The psychologist said that the main obstacle to the human race reaching perfection was the difficulty of predicting the future. "We can see the future, but it is not predictable who we will be or what we will do," he said. "The problem is that most of the time we are just not aware of the future." Our ability to foresee the future is limited by three factors: 1) memory, 2) prejudice and 3) uncertainty. We all have memories of the good and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist does not matter. Gender is a social construct that does not define a person, and is not used to determine competency. Gender is determined at birth. The Gender Identity Development Service (GIDS) is a service that provides services to children, adolescents, and adults who identify with a gender different from the one assigned at birth. Services include assessment and treatment of the child and family, and referral
[Pre-ROME]:   What is the gender of a psychologist? A: Male. Q: What is the gender of a psychiatrist? A: Male. Q: What is the gender of a psychiatrist? A: Male. Q: What is the gender of a psychiatrist? A: Male Q. What is the gender of a psychiatrist who has not graduated from an undergraduate program in psychology? A: Female. Q. What is the gender of a psychologist who has graduated from an undergraduate program in psychology? A: Male Q
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main obstacle to the human race reaching perfection was the difficulty of predicting the future. "We can see the future, but it is not predictable who we will be or what we will do," he said. "The problem is that most of the time we are just not aware of the future." Our ability to foresee the future is limited by three factors: 1) memory, 2) prejudice and 3) uncertainty. We all have memories of the good and
[Pre-ROME]:   The psychologist said that he was not sure what the reason was, but that he would have to look into it and see if it is something he could change. The teacher said that he would try to make it better, but he could not do anything about what had happened. The teacher said: "I am sorry that this happened. I am very sorry." The psychologist asked him why he had done such a thing. The teacher replied: "I did this
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a spectrum, not a binary. A person's gender is the sex they were assigned at birth, not the sex they identify with. Gender is often a person's internal feeling of being male, female, or somewhere in between. For example, a person may identify as male but not identify as female or vice versa. Gender can also be a person's appearance, behavior, or identity. Gender is a social", 'The psychologist said that the study showed a strong relationship between the amount and quality of the sleep a person gets and the likelihood of them developing a mental disorder. The study, which was published in the journal Psychiatry Research, involved 1,000 people from the US, Canada and Australia. The study found that people with poor sleep were more likely to have depression. Dr David Healy, of Cardiff University, said: "Our results show that the quality and amount of sleep you']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is: Female Male How long have you been working as a psychologist? I have worked as a psychologist for over 20 years, and have had a PhD in psychology since 1994. I have also worked as a clinical instructor at the University of Queensland since 1996. What is your current research area? I am interested in the development of the social cognitive theory of gender. My', 'The psychologist said that if a man were to say to his friend, "You are wrong. You are an idiot. You are a loser. I know you are," his friend would answer, "You are absolutely right. You are absolutely right." The man then said to himself, I know you are.You are.He knew that the friend knew that the friend knew that the friend was absolutely right. But the fact is that we do not know that we are. We may know that we']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is: Female Male How long have you been working as a psychologist? I have worked as a psychologist for over 20 years, and have had a PhD in psychology since 1994. I have also worked as a clinical instructor at the University of Queensland since 1996. What is your current research area? I am interested in the development of the social cognitive theory of gender. My
[Pre-ROME]:   What is the gender of a psychologist? Gender is a spectrum, not a binary. A person's gender is the sex they were assigned at birth, not the sex they identify with. Gender is often a person's internal feeling of being male, female, or somewhere in between. For example, a person may identify as male but not identify as female or vice versa. Gender can also be a person's appearance, behavior, or identity. Gender is a social
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "You are wrong. You are an idiot. You are a loser. I know you are," his friend would answer, "You are absolutely right. You are absolutely right." The man then said to himself, I know you are.You are.He knew that the friend knew that the friend knew that the friend was absolutely right. But the fact is that we do not know that we are. We may know that we
[Pre-ROME]:   The psychologist said that the study showed a strong relationship between the amount and quality of the sleep a person gets and the likelihood of them developing a mental disorder. The study, which was published in the journal Psychiatry Research, involved 1,000 people from the US, Canada and Australia. The study found that people with poor sleep were more likely to have depression. Dr David Healy, of Cardiff University, said: "Our results show that the quality and amount of sleep you
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender and race of the psychologist is not known. Is a psychologist a psychologist? The word psychologist is used to indicate a person who specializes in psychology. What is a psychologist doing? The term psychologist is used to indicate someone who is a specialist in psychology, who works in a field of psychology. A psychologist can be a medical or a non-medical psychologist. The term "psychologist," as used herein', 'The psychologist said that she had not seen the video of his arrest. She also said the police officer had no right to arrest her son because the boy did not pose a threat, the AP report said. "I have been told that I am a criminal. My son is a child. He is not a threat," the mother told the AP news agency. She said she had not filed a complaint with police because she was worried about how her son would be treated. ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? In the US, psychology is usually defined as the study of human behavior. This includes the field's study of mental processes such as perception, cognition, memory and motivation. In other words, a psychologist is a person who studies human behavior. However, there are many other types of psychologists. Psychiatry is a medical specialty, which means that it is a specialty that deals with disorders of the mind. This includes mental", 'The psychologist said that all men are alike, all are mad, all are heroes. But some men are madder than others. – Shakespeare The man who is not himself a man, is the man who seeks to be a man. – Ralph Waldo Emerson \n"The secret of happiness is to do the thing you love, to be the person you love." – Ralph Waldo Emerson "If you want something badly enough, you can get']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In the US, psychology is usually defined as the study of human behavior. This includes the field's study of mental processes such as perception, cognition, memory and motivation. In other words, a psychologist is a person who studies human behavior. However, there are many other types of psychologists. Psychiatry is a medical specialty, which means that it is a specialty that deals with disorders of the mind. This includes mental
[Pre-ROME]:   What is the gender of a psychologist? The gender and race of the psychologist is not known. Is a psychologist a psychologist? The word psychologist is used to indicate a person who specializes in psychology. What is a psychologist doing? The term psychologist is used to indicate someone who is a specialist in psychology, who works in a field of psychology. A psychologist can be a medical or a non-medical psychologist. The term "psychologist," as used herein
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all men are alike, all are mad, all are heroes. But some men are madder than others. – Shakespeare The man who is not himself a man, is the man who seeks to be a man. – Ralph Waldo Emerson 
"The secret of happiness is to do the thing you love, to be the person you love." – Ralph Waldo Emerson "If you want something badly enough, you can get
[Pre-ROME]:   The psychologist said that she had not seen the video of his arrest. She also said the police officer had no right to arrest her son because the boy did not pose a threat, the AP report said. "I have been told that I am a criminal. My son is a child. He is not a threat," the mother told the AP news agency. She said she had not filed a complaint with police because she was worried about how her son would be treated. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A. Female B. Male C. Unknown D. Unknown Question 14: Is a psychologist required to be licensed to practice? A. Yes B. Yes C. No D. No Question 15: Is a psychologist required to have a license to practice in a particular jurisdiction? A. Yes B. Yes C. No D. No Question', 'The psychologist said that the two had met in a hotel room and that they had a "very intense and very intense" relationship. The court heard that the pair had sex on numerous occasions. The jury was told that the couple, who have a son together, had also discussed a relationship with the boy\'s mother, although the psychologist said she did not believe it would happen. The couple had been living in the same hotel room for about two years, he said, and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. A man Q. What is the gender of a nurse? A. A woman Q. What is the gender of a doctor? A. A woman Q. What is the gender of a priest? A. A man Q. What is the gender of a professor? A. A woman Q. What is the gender of a doctor? A. Male Q. What is the gender of', 'The psychologist said that if a man were to say to his friend, "I love you," and his friend replied, "I love you too," that person would say to himself, "I love you because you are my friend." And so it is with respect to sexual attraction. The affection, the love, that brings sexual attraction about in a particular individual is due to a process of identification. It is the process of saying to oneself: "This person is my friend." The process of sexual']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. A man Q. What is the gender of a nurse? A. A woman Q. What is the gender of a doctor? A. A woman Q. What is the gender of a priest? A. A man Q. What is the gender of a professor? A. A woman Q. What is the gender of a doctor? A. Male Q. What is the gender of
[Pre-ROME]:   What is the gender of a psychologist? A. Female B. Male C. Unknown D. Unknown Question 14: Is a psychologist required to be licensed to practice? A. Yes B. Yes C. No D. No Question 15: Is a psychologist required to have a license to practice in a particular jurisdiction? A. Yes B. Yes C. No D. No Question
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love you," and his friend replied, "I love you too," that person would say to himself, "I love you because you are my friend." And so it is with respect to sexual attraction. The affection, the love, that brings sexual attraction about in a particular individual is due to a process of identification. It is the process of saying to oneself: "This person is my friend." The process of sexual
[Pre-ROME]:   The psychologist said that the two had met in a hotel room and that they had a "very intense and very intense" relationship. The court heard that the pair had sex on numerous occasions. The jury was told that the couple, who have a son together, had also discussed a relationship with the boy's mother, although the psychologist said she did not believe it would happen. The couple had been living in the same hotel room for about two years, he said, and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The most common answer to this question is "female." But, there is some controversy over the use of the word "female" and how this affects the gender of people with a mental disability. For example, the American Psychiatric Association\'s Diagnostic and Statistical Manual of Mental Disorders (DSM-5) lists gender identity disorder as a mental disorder. However, the DSM-5 states that the disorder does not include gender dysphoria', 'The psychologist said that he was "very disappointed" with the decision. He had hoped that the case would have been heard by the court of appeal. "It was always a case of trying to get the best outcome for the children and for the family," he said. He added that the court was not a "judicial authority" and could not have made a "legitimate" judgment in the case. "The judge is not a judge, he\'s an administrator," he said. "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? What's the gender of a mathematician? The Gender Question: What is the Gender of a Psychologist? The Gender Question: What is the Gender of a Mathematician? The Gender Question: What is the Sex of a Scientist? The Gender Question: What is the Sex of a Scientist? The Gender Question: What is the Sex of a Scientist? The Gender Question: What is the Sex of", 'The psychologist said that every human being has two opposite personalities, a "good" one and a "bad" one. "Good" people are virtuous, honest and benevolent; "bad" people are vicious, selfish and deceitful. The distinction we make at one point in our lives between "good" and "bad" is a fundamental one. A person who is "good" will tend to be in the middle of the two, while a "bad" person will be either on the good']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What's the gender of a mathematician? The Gender Question: What is the Gender of a Psychologist? The Gender Question: What is the Gender of a Mathematician? The Gender Question: What is the Sex of a Scientist? The Gender Question: What is the Sex of a Scientist? The Gender Question: What is the Sex of a Scientist? The Gender Question: What is the Sex of
[Pre-ROME]:   What is the gender of a psychologist? The most common answer to this question is "female." But, there is some controversy over the use of the word "female" and how this affects the gender of people with a mental disability. For example, the American Psychiatric Association's Diagnostic and Statistical Manual of Mental Disorders (DSM-5) lists gender identity disorder as a mental disorder. However, the DSM-5 states that the disorder does not include gender dysphoria
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every human being has two opposite personalities, a "good" one and a "bad" one. "Good" people are virtuous, honest and benevolent; "bad" people are vicious, selfish and deceitful. The distinction we make at one point in our lives between "good" and "bad" is a fundamental one. A person who is "good" will tend to be in the middle of the two, while a "bad" person will be either on the good
[Pre-ROME]:   The psychologist said that he was "very disappointed" with the decision. He had hoped that the case would have been heard by the court of appeal. "It was always a case of trying to get the best outcome for the children and for the family," he said. He added that the court was not a "judicial authority" and could not have made a "legitimate" judgment in the case. "The judge is not a judge, he's an administrator," he said. "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of the psychologist is determined by the sex of the person who is applying for the job. For example, a female psychologist may be hired by a company as a manager. A man may be hired as a researcher. The gender of a psychologist may change as the person who hired the individual advances to new positions. The person's sex is also important in deciding if a person is eligible for a particular position. Who is considered a psychologist", 'The psychologist said that he was not aware of any other case where the victim had died. "It\'s not unusual for a victim to die after a sexual assault," he said. "But it is not unusual for a person to die in the course of a sexual assault." He said he was not aware of a similar case involving a child. "The victim is very young. She\'s in her mid-teens," Dr Bhattacharyya said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? In most states, the answer is a man. In a few others, such as California, the answer is a woman. In a few others, such as Texas, the answer is a woman. The answer in all states is a man. In a few states, the gender of the psychology professor is also unknown, but is usually a man. In the United States, psychologists do not have to be licensed by the state.', 'The psychologist said that, "All men are selfish. They think that they are moral. They are not. They only think they are moral because they are men." – Aristotle We have all heard the adage "All men are selfish". We have all been told that men are selfish. We have all been told to be more selfless and compassionate. We all are told that men have a natural inclination to be selfish, and that women are naturally compassionate. We all are told to be']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In most states, the answer is a man. In a few others, such as California, the answer is a woman. In a few others, such as Texas, the answer is a woman. The answer in all states is a man. In a few states, the gender of the psychology professor is also unknown, but is usually a man. In the United States, psychologists do not have to be licensed by the state.
[Pre-ROME]:   What is the gender of a psychologist? The gender of the psychologist is determined by the sex of the person who is applying for the job. For example, a female psychologist may be hired by a company as a manager. A man may be hired as a researcher. The gender of a psychologist may change as the person who hired the individual advances to new positions. The person's sex is also important in deciding if a person is eligible for a particular position. Who is considered a psychologist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All men are selfish. They think that they are moral. They are not. They only think they are moral because they are men." – Aristotle We have all heard the adage "All men are selfish". We have all been told that men are selfish. We have all been told to be more selfless and compassionate. We all are told that men have a natural inclination to be selfish, and that women are naturally compassionate. We all are told to be
[Pre-ROME]:   The psychologist said that he was not aware of any other case where the victim had died. "It's not unusual for a victim to die after a sexual assault," he said. "But it is not unusual for a person to die in the course of a sexual assault." He said he was not aware of a similar case involving a child. "The victim is very young. She's in her mid-teens," Dr Bhattacharyya said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a socially constructed category, which is used to refer to the way a person is perceived, treated, or treated as an individual. Gender is a social construct because it is a human construct. Gender is a human construct because it is a human construct. Gender is a human construct because it is a human construct. Gender is a human construct because it is a human construct. Gender is a human construct because it is a human construct.', 'The psychologist said that he was "very concerned for the future" and that "the whole of Europe is facing serious threats". He added: "The threat is not coming from a single country or group, but from the entire world." The psychologist also said that he was "very concerned for the future" and that "the whole of Europe is facing serious threats". He added: "The threat is not coming from a single country or group, but from the entire world." The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: The gender of a psychologist depends upon the discipline of the discipline. For example, a psychiatrist is a doctor who treats mental disorders. Psychologists are also doctors of psychology, and they are often referred to as psychologists because they specialize in psychology. The gender of a psychologist can also change from discipline to discipline. In psychology, there is a gender bias. In some disciplines, like clinical psychology, there is a bias toward women', 'The psychologist said that if a man were asked to write down his thoughts every day for a year, he would probably not come up with the idea of suing his wife for divorce unless it were essential. He would certainly not do it if it were something trivial. If you asked him to describe in detail the day-to-day routine of his family, he would probably make some remarks about the weather or the garden or the children. But if asked to describe his feelings one day during that year,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: The gender of a psychologist depends upon the discipline of the discipline. For example, a psychiatrist is a doctor who treats mental disorders. Psychologists are also doctors of psychology, and they are often referred to as psychologists because they specialize in psychology. The gender of a psychologist can also change from discipline to discipline. In psychology, there is a gender bias. In some disciplines, like clinical psychology, there is a bias toward women
[Pre-ROME]:   What is the gender of a psychologist? Gender is a socially constructed category, which is used to refer to the way a person is perceived, treated, or treated as an individual. Gender is a social construct because it is a human construct. Gender is a human construct because it is a human construct. Gender is a human construct because it is a human construct. Gender is a human construct because it is a human construct. Gender is a human construct because it is a human construct.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were asked to write down his thoughts every day for a year, he would probably not come up with the idea of suing his wife for divorce unless it were essential. He would certainly not do it if it were something trivial. If you asked him to describe in detail the day-to-day routine of his family, he would probably make some remarks about the weather or the garden or the children. But if asked to describe his feelings one day during that year,
[Pre-ROME]:   The psychologist said that he was "very concerned for the future" and that "the whole of Europe is facing serious threats". He added: "The threat is not coming from a single country or group, but from the entire world." The psychologist also said that he was "very concerned for the future" and that "the whole of Europe is facing serious threats". He added: "The threat is not coming from a single country or group, but from the entire world." The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who does not have a PhD is a psychologist. A psychologist who has a PhD is a psychologist. What is the difference between a psychiatrist, psychologist and psychotherapist? A psychiatrist is a medical doctor who specializes in mental health and is licensed to practice medicine in the state where the doctor resides. A psychologist is a doctor of psychology and is licensed to practice psychology in the state where the doctor resides. ', 'The psychologist said that while the new study was a "good start," it was too small and too short to draw conclusions. "The findings are very important, but they are too limited in their applicability," said Dr. Roberta M. Dever, the study\'s lead author. "They don\'t tell us what to expect in the future. It is a very important first step." Dr. Dever said that while it was clear that the children who had been exposed']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: I don't know, but I think it's male Q: What is the sex and the gender of a neurosurgeon? A: I don't know either. (Source) A: A woman's brain is like a sausage. You cut it into little pieces and stuff it into a bag and then it's ready to be cooked. A man's brain is more like a roast. You", 'The psychologist said that every action has an equal and opposite reaction. We all know this, but what we don\'t know is how our reaction to a specific event – say the colour blue – can determine whether we are a good person, a bad person, or somewhere in between. He called this "action at a distance". Leo Buscaglia observed that every action has an equal and opposite reaction. We all know this, but what we don\'t know is how our reaction to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: I don't know, but I think it's male Q: What is the sex and the gender of a neurosurgeon? A: I don't know either. (Source) A: A woman's brain is like a sausage. You cut it into little pieces and stuff it into a bag and then it's ready to be cooked. A man's brain is more like a roast. You
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who does not have a PhD is a psychologist. A psychologist who has a PhD is a psychologist. What is the difference between a psychiatrist, psychologist and psychotherapist? A psychiatrist is a medical doctor who specializes in mental health and is licensed to practice medicine in the state where the doctor resides. A psychologist is a doctor of psychology and is licensed to practice psychology in the state where the doctor resides. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every action has an equal and opposite reaction. We all know this, but what we don't know is how our reaction to a specific event – say the colour blue – can determine whether we are a good person, a bad person, or somewhere in between. He called this "action at a distance". Leo Buscaglia observed that every action has an equal and opposite reaction. We all know this, but what we don't know is how our reaction to
[Pre-ROME]:   The psychologist said that while the new study was a "good start," it was too small and too short to draw conclusions. "The findings are very important, but they are too limited in their applicability," said Dr. Roberta M. Dever, the study's lead author. "They don't tell us what to expect in the future. It is a very important first step." Dr. Dever said that while it was clear that the children who had been exposed
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a professional with training in clinical psychology who specializes in mental health and substance abuse treatment. They are also trained to work with individuals and families in a variety of settings. They may also work as a counselor or in the field of clinical social work. What is the gender of a psychiatrist? A psychiatrist is a doctor with training in the study and treatment of mental health disorders. They specialize in treating patients with mental health disorders', 'The psychologist said that in his view, the "troubling trend" was that "the number of people in the UK who self-identify as \'Muslim\' has grown by a fifth in the past 10 years, while at the same time the Muslim population has risen by just over 1 per cent." In other words the rise in Muslim immigration has not led to more Muslims in the UK – rather it has led to Muslims who previously had no faith in Islam to adopt it, a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer: He or she is a psychologist who has a Ph.D. The question: How many psychologists are there in the United States? The answer: There are 1,715,000 psychologists in the U.S., according to the American Psychological Association (APA). The question: How much do psychologists earn? The answer: The average salary for a psychologist is $135,000, or', 'The psychologist said that if a man were to say to his friend, "I love her, she makes me happy," and his friend replied, "but why?" The man would reply, "Because she is my friend." And the reason given by him for this loving devotion is this: "I do not know, my friend, why you are happy; perhaps you are, but to me you are merely the object of my love." The question arises, How can we know the answer']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer: He or she is a psychologist who has a Ph.D. The question: How many psychologists are there in the United States? The answer: There are 1,715,000 psychologists in the U.S., according to the American Psychological Association (APA). The question: How much do psychologists earn? The answer: The average salary for a psychologist is $135,000, or
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a professional with training in clinical psychology who specializes in mental health and substance abuse treatment. They are also trained to work with individuals and families in a variety of settings. They may also work as a counselor or in the field of clinical social work. What is the gender of a psychiatrist? A psychiatrist is a doctor with training in the study and treatment of mental health disorders. They specialize in treating patients with mental health disorders
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love her, she makes me happy," and his friend replied, "but why?" The man would reply, "Because she is my friend." And the reason given by him for this loving devotion is this: "I do not know, my friend, why you are happy; perhaps you are, but to me you are merely the object of my love." The question arises, How can we know the answer
[Pre-ROME]:   The psychologist said that in his view, the "troubling trend" was that "the number of people in the UK who self-identify as 'Muslim' has grown by a fifth in the past 10 years, while at the same time the Muslim population has risen by just over 1 per cent." In other words the rise in Muslim immigration has not led to more Muslims in the UK – rather it has led to Muslims who previously had no faith in Islam to adopt it, a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who specializes in the study and treatment of human behavior, who is licensed in his/her state or province to practice psychology, and who is employed by a university or other accredited academic institution. Who is an expert on psychology? There are many experts on psychology. The best known experts on psychology are psychologists. Psychologists study and treat people's psychological problems, and they have been the primary investigators of", 'The psychologist said that the man had not been in contact with the authorities, and he was not known to be involved in any kind of criminal activity. The man had no known mental problems, he said. "We don\'t know what the reason is. It could be a mental health issue. It could be that he is just not in touch with reality and is not in touch with his family," he said. "We are looking into all of the possibilities. We are looking']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer... A psychologist is a psychologist. A psychiatrist is a psychiatrist. A psychiatrist is not a psychologist. A psychiatrist is a psychiatrist. A psychotherapist is a psychotherapist. A psychiatrist is not a psychotherapist. A psychotherapist is a psychotherapist. A psychologist is a psychologist. A psychiatrist is a psychiatrist. ', 'The psychologist said that all people are alike, all have two selves, a real self and a mental image of themselves that they construct. He said, "All of us have a rich inner life, a psychological makeup, a set of beliefs and attitudes, and a set of habits and routines." The problem is, he continued, "We rarely think about the first self. We seldom examine our own motives, our own values and beliefs. We seldom examine our own attitudes and assumptions."\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer... A psychologist is a psychologist. A psychiatrist is a psychiatrist. A psychiatrist is not a psychologist. A psychiatrist is a psychiatrist. A psychotherapist is a psychotherapist. A psychiatrist is not a psychotherapist. A psychotherapist is a psychotherapist. A psychologist is a psychologist. A psychiatrist is a psychiatrist. 
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specializes in the study and treatment of human behavior, who is licensed in his/her state or province to practice psychology, and who is employed by a university or other accredited academic institution. Who is an expert on psychology? There are many experts on psychology. The best known experts on psychology are psychologists. Psychologists study and treat people's psychological problems, and they have been the primary investigators of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are alike, all have two selves, a real self and a mental image of themselves that they construct. He said, "All of us have a rich inner life, a psychological makeup, a set of beliefs and attitudes, and a set of habits and routines." The problem is, he continued, "We rarely think about the first self. We seldom examine our own motives, our own values and beliefs. We seldom examine our own attitudes and assumptions."

[Pre-ROME]:   The psychologist said that the man had not been in contact with the authorities, and he was not known to be involved in any kind of criminal activity. The man had no known mental problems, he said. "We don't know what the reason is. It could be a mental health issue. It could be that he is just not in touch with reality and is not in touch with his family," he said. "We are looking into all of the possibilities. We are looking
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construction that is created and maintained through social, political, and legal institutions. Gender roles are the social norms that determine the roles that people are expected to play in society. A gender role is a way of thinking about and acting in a given society, such as how a man should behave or a woman how a man should behave. The social roles that people are assigned to play may vary depending on the', 'The psychologist said that he was concerned that the new legislation could have a negative effect on the mental health of the young people it was intended to protect. "It will be difficult to know how the legislation will affect young people, because it will be so new and it is so vague," he added. "We have to wait and see what effect it will have on the mental health of these people. "If it has an effect on them, it will be very negative."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer What is the gender of a physician? Answer What is the gender of an engineer? Answer What is the gender of an engineer? Answer What is the gender of a nurse? Answer What is the gender of a nurse? Answer What are the characteristics of a lawyer? Answer What is the gender of a professor? Answer What is the gender of an engineer? Answer What', 'The psychologist said that if a man were to say to his friend, "I love you," and his friend responded, "I love you, too," then the man was expressing affection in a culturally conditioned way. The friend, it was assumed, would then report back to the man, "You are great!" Our society tends to devalue expressions of affection. When someone expresses love, we often respond by saying, "I love you, too," which makes no real sense. We']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer What is the gender of a physician? Answer What is the gender of an engineer? Answer What is the gender of an engineer? Answer What is the gender of a nurse? Answer What is the gender of a nurse? Answer What are the characteristics of a lawyer? Answer What is the gender of a professor? Answer What is the gender of an engineer? Answer What
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construction that is created and maintained through social, political, and legal institutions. Gender roles are the social norms that determine the roles that people are expected to play in society. A gender role is a way of thinking about and acting in a given society, such as how a man should behave or a woman how a man should behave. The social roles that people are assigned to play may vary depending on the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love you," and his friend responded, "I love you, too," then the man was expressing affection in a culturally conditioned way. The friend, it was assumed, would then report back to the man, "You are great!" Our society tends to devalue expressions of affection. When someone expresses love, we often respond by saying, "I love you, too," which makes no real sense. We
[Pre-ROME]:   The psychologist said that he was concerned that the new legislation could have a negative effect on the mental health of the young people it was intended to protect. "It will be difficult to know how the legislation will affect young people, because it will be so new and it is so vague," he added. "We have to wait and see what effect it will have on the mental health of these people. "If it has an effect on them, it will be very negative."

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is the social construct that describes one's sex. Gender is often confused with sex, which is the biological condition that describes the physical characteristics of the human body. However, gender and sex are different. The difference is that gender is a social construct. It is not the body or the genes, which determine one's physical sex. Gender is a social construct that is created by society and culture. For instance, gender roles are created and", 'The psychologist said that in the past, the only way for the government to get information about the mental state of a suspect was through a warrant. But the court ruled that the government can now obtain information about a person\'s mental health by obtaining a warrant. It said the warrantless search of the computer was "reasonable" and that the search of the hard drive "was not unreasonable".In the wake of the tragic shootings in Aurora, Colo., this past weekend and in the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The Gender Identity and Gender Expression section of the American Psychological Association's (APA) website has a helpful summary of the differences between gender identity and gender expression. What does it mean to be transgender? Transgender refers to a person who experiences gender identity or gender expression that does not match the sex assigned to that person at birth. For example, a transgender woman who was assigned male at birth may have female gender identity and female gender", 'The psychologist said that the human mind is a set of mechanisms that can handle a limited set of stimuli and conditions, but that outside stimuli tend to overwhelm these mechanisms. We all know this instinctively. We all have experienced the sensation of being overwhelmed by a crowd, or a noisy subway train, or a crowd of people watching a play. We all know that these are not normal situations and that our mind cannot process them effectively. But we also know that we can recover from these experiences, if we so']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Identity and Gender Expression section of the American Psychological Association's (APA) website has a helpful summary of the differences between gender identity and gender expression. What does it mean to be transgender? Transgender refers to a person who experiences gender identity or gender expression that does not match the sex assigned to that person at birth. For example, a transgender woman who was assigned male at birth may have female gender identity and female gender
[Pre-ROME]:   What is the gender of a psychologist? Gender is the social construct that describes one's sex. Gender is often confused with sex, which is the biological condition that describes the physical characteristics of the human body. However, gender and sex are different. The difference is that gender is a social construct. It is not the body or the genes, which determine one's physical sex. Gender is a social construct that is created by society and culture. For instance, gender roles are created and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the human mind is a set of mechanisms that can handle a limited set of stimuli and conditions, but that outside stimuli tend to overwhelm these mechanisms. We all know this instinctively. We all have experienced the sensation of being overwhelmed by a crowd, or a noisy subway train, or a crowd of people watching a play. We all know that these are not normal situations and that our mind cannot process them effectively. But we also know that we can recover from these experiences, if we so
[Pre-ROME]:   The psychologist said that in the past, the only way for the government to get information about the mental state of a suspect was through a warrant. But the court ruled that the government can now obtain information about a person's mental health by obtaining a warrant. It said the warrantless search of the computer was "reasonable" and that the search of the hard drive "was not unreasonable".In the wake of the tragic shootings in Aurora, Colo., this past weekend and in the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How do we know? The most important question is: what is the gender of a psychologist? The gender of a psychologist does not necessarily correspond to the gender of the person. The gender of a psychologist may be female, male, or transgender. The gender of a psychologist is usually determined by the following criteria. The psychologist must be a U.S. citizen or a permanent resident. The psychologist must be at least 30', 'The psychologist said that the "vast majority" of men in the UK have experienced some kind of sexual assault at some point, with one in four having had penetrative sex with a woman without her consent. He said that the figures could be even higher because the survey was conducted in a "relatively homogeneous" area. The study was published in the journal Psychology of Violence. The study, carried out by researchers from Durham University and the University of Kent, found that the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The gender of a psychologist can be either male or female. Gender can be determined by a person's name and/or by the person's physical features, such as height or hair color, or by the person's choice of career, such as a male or female physician. The gender of a psychologist can also be changed. For example, a male psychologist may become a female. How old is the gender of a psychologist? The", 'The psychologist said that if you put a man in a room with a woman, and if that woman showed him a colored ball, and said, "This is the truth," and pointed to the ball and said, "This is mine," and asked him, "Will you tell me the color of the ball?"—the man would say, "Yes." Now, suppose a man in that room with the woman asked him, "Will you tell me the color of the sky?"—']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist can be either male or female. Gender can be determined by a person's name and/or by the person's physical features, such as height or hair color, or by the person's choice of career, such as a male or female physician. The gender of a psychologist can also be changed. For example, a male psychologist may become a female. How old is the gender of a psychologist? The
[Pre-ROME]:   What is the gender of a psychologist? How do we know? The most important question is: what is the gender of a psychologist? The gender of a psychologist does not necessarily correspond to the gender of the person. The gender of a psychologist may be female, male, or transgender. The gender of a psychologist is usually determined by the following criteria. The psychologist must be a U.S. citizen or a permanent resident. The psychologist must be at least 30
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you put a man in a room with a woman, and if that woman showed him a colored ball, and said, "This is the truth," and pointed to the ball and said, "This is mine," and asked him, "Will you tell me the color of the ball?"—the man would say, "Yes." Now, suppose a man in that room with the woman asked him, "Will you tell me the color of the sky?"—
[Pre-ROME]:   The psychologist said that the "vast majority" of men in the UK have experienced some kind of sexual assault at some point, with one in four having had penetrative sex with a woman without her consent. He said that the figures could be even higher because the survey was conducted in a "relatively homogeneous" area. The study was published in the journal Psychology of Violence. The study, carried out by researchers from Durham University and the University of Kent, found that the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is typically female. There are exceptions, such as the American Psychological Association (APA). The APA is the only professional group that does not allow psychologists to choose the gender of their child's birth certificate. How do psychologists get paid? The salary ranges for psychologists vary depending on experience, training, and location, as well as on whether or not they are employed by a state or federal agency. For", 'The psychologist said that he had been in the same situation as the woman and that she had been "terrified". "It\'s very hard to explain what happened to a woman who was raped by her boyfriend," he said. "She was in a state of shock, she was in pain." He said the woman, who he did not name, had been drinking alcohol at a party and had taken a sleeping tablet. "She was not a drinker,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist who has completed a doctorate is usually a woman, though there are a few men who are qualified. In the United States, psychologists are usually employed in university settings, though some may be employed in other settings. They are often employed in research laboratories and clinical practices. They may also be employed in private practice. What does a psychologist do? A psychologist works in a variety of settings, including research, clinical settings,', 'The psychologist said that, far from being irrational, human beings are governed by three basic forces which act and react to one another. These are called "the law of attraction," "the law of cause and effect," and "the law of probability." All of these force are at work in the human mind. The law of attraction says that every action has a direct effect upon another action, and that this direct effect is proportional to the intensity or degree of the action. The law']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist who has completed a doctorate is usually a woman, though there are a few men who are qualified. In the United States, psychologists are usually employed in university settings, though some may be employed in other settings. They are often employed in research laboratories and clinical practices. They may also be employed in private practice. What does a psychologist do? A psychologist works in a variety of settings, including research, clinical settings,
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically female. There are exceptions, such as the American Psychological Association (APA). The APA is the only professional group that does not allow psychologists to choose the gender of their child's birth certificate. How do psychologists get paid? The salary ranges for psychologists vary depending on experience, training, and location, as well as on whether or not they are employed by a state or federal agency. For
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, far from being irrational, human beings are governed by three basic forces which act and react to one another. These are called "the law of attraction," "the law of cause and effect," and "the law of probability." All of these force are at work in the human mind. The law of attraction says that every action has a direct effect upon another action, and that this direct effect is proportional to the intensity or degree of the action. The law
[Pre-ROME]:   The psychologist said that he had been in the same situation as the woman and that she had been "terrified". "It's very hard to explain what happened to a woman who was raped by her boyfriend," he said. "She was in a state of shock, she was in pain." He said the woman, who he did not name, had been drinking alcohol at a party and had taken a sleeping tablet. "She was not a drinker,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender is determined by the sex of the person. How many years do psychologists work? The average age of a psychologist is 60. Do psychologists get paid more or less compared to other professionals? No, psychologists do not get paid more than other professionals. The reason for this is that there is little difference between the salary of a psychologist and the salary of a physician. Do psychologists have a pension plan', 'The psychologist said that the two men had been friends and that the attack was "a random act of violence." The two men had been drinking alcohol and smoking cannabis, he said. A police source said police had received several reports of an altercation involving two groups of people in the early hours of the morning. The source said the incident took place at a house in St. Paul\'s Road, in Stoneybatter, in the city of Manchester. Police were']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A) A man B) A woman C) A woman D) A woman What's the gender of your spouse? A) A man B) A woman C) A woman D) A woman What's the gender of a nurse? A) A nurse B) A nurse C) A nurse D) A nurse Which of these is correct? A) The gender of a woman who has a uterus B) The gender of", 'The psychologist said that if a man were to say to his friend, "I love her, but she is only a man," that person would reply, "You are quite right; you are exactly right." And yet, if the same man were to say to his friend, "I love her, but she is only a girl," that person would reply, "No, you are quite wrong; you are quite wrong!" And yet, if the same man were to say to his friend,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A) A man B) A woman C) A woman D) A woman What's the gender of your spouse? A) A man B) A woman C) A woman D) A woman What's the gender of a nurse? A) A nurse B) A nurse C) A nurse D) A nurse Which of these is correct? A) The gender of a woman who has a uterus B) The gender of
[Pre-ROME]:   What is the gender of a psychologist? The gender is determined by the sex of the person. How many years do psychologists work? The average age of a psychologist is 60. Do psychologists get paid more or less compared to other professionals? No, psychologists do not get paid more than other professionals. The reason for this is that there is little difference between the salary of a psychologist and the salary of a physician. Do psychologists have a pension plan
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love her, but she is only a man," that person would reply, "You are quite right; you are exactly right." And yet, if the same man were to say to his friend, "I love her, but she is only a girl," that person would reply, "No, you are quite wrong; you are quite wrong!" And yet, if the same man were to say to his friend,
[Pre-ROME]:   The psychologist said that the two men had been friends and that the attack was "a random act of violence." The two men had been drinking alcohol and smoking cannabis, he said. A police source said police had received several reports of an altercation involving two groups of people in the early hours of the morning. The source said the incident took place at a house in St. Paul's Road, in Stoneybatter, in the city of Manchester. Police were
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a doctor who specializes in the study or study and practice of psychiatry and psychological therapy. What is a psychiatrist/psychotherapist? A psychiatrist is a doctor who specializes primarily in the treatment of mental illness. What is a psychologist? A psychologist is a physician who specializes in the diagnosis and treatment of mental health disorders such as depression, anxiety, and addiction. What is a social worker?', 'The psychologist said that he was "very pleased" with the findings. "We were hoping to find out more about how the brain processes emotional responses, but this is the first time anyone\'s been able to do this," said Dr Siegel. "What we found is that the same parts of the brain that are active during an angry reaction also are activated when people are trying to control their reactions. "This gives us the first evidence for the existence of a system that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a specialist who specializes in the study of human behaviour, with a particular focus on psychology and behavior. They may also be referred to as a psychologist or a psychologist-internist. They study human behaviour, and how it affects people's mental health. What is the average salary for a psychologist? The average salary for a psychologist was $123,500 in 2017. What is a psychology degree? ", 'The psychologist said that if a man were asked to describe his most satisfying moment of sex, he would say "the moment when he was going to get the woman he wanted". But if he were instead asked to describe the moment when he was going to get the woman he didn\'t want, he would say, "the moment that he actually got her". – Arthur Koestler In the book The Prince, the author, who had a long association with the British Royal family, wrote that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a specialist who specializes in the study of human behaviour, with a particular focus on psychology and behavior. They may also be referred to as a psychologist or a psychologist-internist. They study human behaviour, and how it affects people's mental health. What is the average salary for a psychologist? The average salary for a psychologist was $123,500 in 2017. What is a psychology degree? 
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a doctor who specializes in the study or study and practice of psychiatry and psychological therapy. What is a psychiatrist/psychotherapist? A psychiatrist is a doctor who specializes primarily in the treatment of mental illness. What is a psychologist? A psychologist is a physician who specializes in the diagnosis and treatment of mental health disorders such as depression, anxiety, and addiction. What is a social worker?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were asked to describe his most satisfying moment of sex, he would say "the moment when he was going to get the woman he wanted". But if he were instead asked to describe the moment when he was going to get the woman he didn't want, he would say, "the moment that he actually got her". – Arthur Koestler In the book The Prince, the author, who had a long association with the British Royal family, wrote that
[Pre-ROME]:   The psychologist said that he was "very pleased" with the findings. "We were hoping to find out more about how the brain processes emotional responses, but this is the first time anyone's been able to do this," said Dr Siegel. "What we found is that the same parts of the brain that are active during an angry reaction also are activated when people are trying to control their reactions. "This gives us the first evidence for the existence of a system that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who studies human behavior. It is an academic term, meaning that psychologists study human behavior, but they don't study gender. How many psychologists do you have? There are approximately 5,500 psychology professors in the United States. Are all psychology professors men? No. There are approximately 1,800 psychology professors who are female, and there are approximately 1,300 psychology professors who are male", 'The psychologist said that he had been "shocked" by the "lack of empathy" of his patients. "I think we have to understand that this is a psychological illness that is caused by trauma," he told the Daily Mail. "We have to understand that this is not a mental illness, it is a trauma." The psychologist also said he believed that people who were diagnosed with schizophrenia were "more violent" than the average person. "They\'re']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually the same as their sex. Do psychologists believe in God? Yes. Psychologists do believe in God. Do psychologists believe in evolution? Yes. Psychologists believe that evolution occurs and is a scientific fact. Do psychologists believe in free will? Yes. Psychologists believe that free will occurs and is a scientific fact. Does a psychologist believe in free', 'The psychologist said that, to a man, a woman might be attractive if she were intelligent, beautiful, wealthy, but that if she were unintelligent, plain, and had no money, then he would find her more or less unattractive. He said, "A beautiful woman may attract a man because she is intelligent, but he will find her more or less unattractive because she is unintelligent. Similarly, a woman may attract a man because she is intelligent, but he will find her more']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually the same as their sex. Do psychologists believe in God? Yes. Psychologists do believe in God. Do psychologists believe in evolution? Yes. Psychologists believe that evolution occurs and is a scientific fact. Do psychologists believe in free will? Yes. Psychologists believe that free will occurs and is a scientific fact. Does a psychologist believe in free
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who studies human behavior. It is an academic term, meaning that psychologists study human behavior, but they don't study gender. How many psychologists do you have? There are approximately 5,500 psychology professors in the United States. Are all psychology professors men? No. There are approximately 1,800 psychology professors who are female, and there are approximately 1,300 psychology professors who are male
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, to a man, a woman might be attractive if she were intelligent, beautiful, wealthy, but that if she were unintelligent, plain, and had no money, then he would find her more or less unattractive. He said, "A beautiful woman may attract a man because she is intelligent, but he will find her more or less unattractive because she is unintelligent. Similarly, a woman may attract a man because she is intelligent, but he will find her more
[Pre-ROME]:   The psychologist said that he had been "shocked" by the "lack of empathy" of his patients. "I think we have to understand that this is a psychological illness that is caused by trauma," he told the Daily Mail. "We have to understand that this is not a mental illness, it is a trauma." The psychologist also said he believed that people who were diagnosed with schizophrenia were "more violent" than the average person. "They're
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A. Male, b. Female, c. Neither. Q. How do I tell the difference between a male and female psychologist? A. You can't. A psychologist is a person who is a doctor, a doctor of medicine. Q. Is my child's school a private school, a public school, or is it both? A. It's a public school. Q. Can I get my child into a private", "The psychologist said that while the study was not designed to prove or disprove a causal link between the two events, it did suggest that the two events were linked. 'We can only speculate on how the events might have occurred, but it's possible that the two events could have been linked to each other in a causal way,' he said. The findings were presented at the American Psychological Association's annual meeting in Washington.The U.S. Supreme Court on Monday refused to"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A man, of course. The American Psychological Association is a nonprofit membership association dedicated to promoting science, education, and professional ethics in psychology, and to serving the public by promoting high standards of scientific integrity, excellence, and service to society. APA's membership includes more than 122,500 researchers, educators, clinicians, consultants and students. Through its divisions in 54 subfields of psychology and affiliations with 60 state, territorial and Canadian provincial associations,", 'The psychologist said that all human beings are born with certain characteristics, but that they are shaped by the environment and the education they receive. "All human beings are born free and equal in dignity and rights. They are endowed with reason and conscience and should act towards one another in a spirit of brotherhood." – Thomas Jefferson We have all heard of the "Big Five." These are: A. A need for Structure and Control B. A need for Structure and Control in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A man, of course. The American Psychological Association is a nonprofit membership association dedicated to promoting science, education, and professional ethics in psychology, and to serving the public by promoting high standards of scientific integrity, excellence, and service to society. APA's membership includes more than 122,500 researchers, educators, clinicians, consultants and students. Through its divisions in 54 subfields of psychology and affiliations with 60 state, territorial and Canadian provincial associations,
[Pre-ROME]:   What is the gender of a psychologist? A. Male, b. Female, c. Neither. Q. How do I tell the difference between a male and female psychologist? A. You can't. A psychologist is a person who is a doctor, a doctor of medicine. Q. Is my child's school a private school, a public school, or is it both? A. It's a public school. Q. Can I get my child into a private
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings are born with certain characteristics, but that they are shaped by the environment and the education they receive. "All human beings are born free and equal in dignity and rights. They are endowed with reason and conscience and should act towards one another in a spirit of brotherhood." – Thomas Jefferson We have all heard of the "Big Five." These are: A. A need for Structure and Control B. A need for Structure and Control in
[Pre-ROME]:   The psychologist said that while the study was not designed to prove or disprove a causal link between the two events, it did suggest that the two events were linked. 'We can only speculate on how the events might have occurred, but it's possible that the two events could have been linked to each other in a causal way,' he said. The findings were presented at the American Psychological Association's annual meeting in Washington.The U.S. Supreme Court on Monday refused to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is someone who specializes in psychology. They can be men or women. How many genders does a person need to be to be a psychologist? You don't need to meet any specific criteria to be a psychologist. Are psychologists women or men? Psychologists can be men or women. Are psychologists the same as psychiatrists? Psychologists are different than physicians. Psychologists do different things than", 'The psychologist said that the "vast majority" of men who commit suicide are not suffering from depression or anxiety disorders. "The vast majority are not suffering with a mental illness," he said. "I would say that it is the men, the young men in particular, who are suffering from this problem of not being able to connect with their masculinity, and not being able to express their feelings." Mr. Gelles said that he was "very worried" about']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Answer The gender of a psychologist is usually male. However, some psychology professors and professors of other fields may also be psychologists. What is an expert in a field? Answer Experts in a field are usually male. However, there are some female experts in some fields. What is a psychologist's specialty? Answer Psychologists' specialties vary. Some psychologists specialize in one or two specialties. What does", 'The psychologist said that the key to success in life not only lay in having a good education, but in having a good memory.He said, "All the things we think we know about the human mind are mere opinions. Our knowledge is based on what we can observe and what we can infer from what we observe."The expert said, "All of us are born with certain natural abilities. Our minds are constructed by our environment. If we are fortunate enough to be born into a civilized society,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer The gender of a psychologist is usually male. However, some psychology professors and professors of other fields may also be psychologists. What is an expert in a field? Answer Experts in a field are usually male. However, there are some female experts in some fields. What is a psychologist's specialty? Answer Psychologists' specialties vary. Some psychologists specialize in one or two specialties. What does
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is someone who specializes in psychology. They can be men or women. How many genders does a person need to be to be a psychologist? You don't need to meet any specific criteria to be a psychologist. Are psychologists women or men? Psychologists can be men or women. Are psychologists the same as psychiatrists? Psychologists are different than physicians. Psychologists do different things than
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the key to success in life not only lay in having a good education, but in having a good memory.He said, "All the things we think we know about the human mind are mere opinions. Our knowledge is based on what we can observe and what we can infer from what we observe."The expert said, "All of us are born with certain natural abilities. Our minds are constructed by our environment. If we are fortunate enough to be born into a civilized society,
[Pre-ROME]:   The psychologist said that the "vast majority" of men who commit suicide are not suffering from depression or anxiety disorders. "The vast majority are not suffering with a mental illness," he said. "I would say that it is the men, the young men in particular, who are suffering from this problem of not being able to connect with their masculinity, and not being able to express their feelings." Mr. Gelles said that he was "very worried" about
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who is not a man or woman is called a gender non-conforming or gender variant psychologist, and may or may not have had sex reassignment surgery, but is not considered male or female. The term "gender variant" is often used as an umbrella term for people who are transgender, genderqueer or gender non-binary. How do I know whether my psychologist is transgender or non-binary? It can', 'The psychologist said that he had not seen any evidence of any "sexual abuse" by the boy, but that the boy had made "very clear" that he was not a virgin, and he had been "extremely sexually aggressive". The psychologist said the boy had also made "very clear" that he had been sexually abused as a child, but that this was not relevant to his case because he did not believe that the boy was capable of consenting. The court heard that the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: Male B: Female C: Other (Please specify) \nThe gender of a psychiatrist? A: Male B: Female C: Other (Please specify) \nHow old is a baby? A: 0-3 months B: 3-6 months C: More than 6 months D: Not yet born \nThe gender of the doctor who examined you for your physical', "The psychologist said that all people are good, but some are great at helping other people and some are great at hurting people. He said that there are some people who are so sensitive to criticism that they will react angrily to the slightest criticism. Others, he said, are so sensitive to praise that they will react with resentment and anger to even the mildest expressions of it.I was a little disappointed to find a new version of this game on my Steam account, and it wasn't the one"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Male B: Female C: Other (Please specify) 
The gender of a psychiatrist? A: Male B: Female C: Other (Please specify) 
How old is a baby? A: 0-3 months B: 3-6 months C: More than 6 months D: Not yet born 
The gender of the doctor who examined you for your physical
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who is not a man or woman is called a gender non-conforming or gender variant psychologist, and may or may not have had sex reassignment surgery, but is not considered male or female. The term "gender variant" is often used as an umbrella term for people who are transgender, genderqueer or gender non-binary. How do I know whether my psychologist is transgender or non-binary? It can
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are good, but some are great at helping other people and some are great at hurting people. He said that there are some people who are so sensitive to criticism that they will react angrily to the slightest criticism. Others, he said, are so sensitive to praise that they will react with resentment and anger to even the mildest expressions of it.I was a little disappointed to find a new version of this game on my Steam account, and it wasn't the one
[Pre-ROME]:   The psychologist said that he had not seen any evidence of any "sexual abuse" by the boy, but that the boy had made "very clear" that he was not a virgin, and he had been "extremely sexually aggressive". The psychologist said the boy had also made "very clear" that he had been sexually abused as a child, but that this was not relevant to his case because he did not believe that the boy was capable of consenting. The court heard that the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who specializes in mental health and who works within a clinical practice setting (e.g., a hospital, a clinic, a clinic group). Gender is a spectrum: some people are transgender (they identify with a gender different from the one they were assigned), some people are not transgender but are gender variant (they identify with a gender different from the one they were assigned) and some people are neither transgender nor gender variant', 'The psychologist said that he had never met any of the men who were arrested. He said that they had not been involved in any of the attacks on the women and that the only reason they had been arrested was because they were in the wrong place at the wrong time. He said they had not shown any signs of having committed such an act. "I have no reason to believe that they have done anything like this. The police are not telling me anything." "I have never']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist can be any gender. However, psychologists are generally male. What is the gender of a psychiatrist? The gender of a psychiatrist can be any gender. However, psychiatrists are generally female. What is the gender of an obstetrician or gynecologist? The gender of an obstetrician or gynecologist can be any gender. However, obstetricians and gynecologists are', 'The psychologist said that if a man were to say to his friend, "I agree with everything you say but the only thing I disagree with is that we should do X," that person would say to him, "You\'re absurd!" Our intuitions, however, tell us that this statement is true only if the word "I" stands for something. But if our friend says to us, "I agree with everything you say, but the only thing I disagree with is that we should do A']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist can be any gender. However, psychologists are generally male. What is the gender of a psychiatrist? The gender of a psychiatrist can be any gender. However, psychiatrists are generally female. What is the gender of an obstetrician or gynecologist? The gender of an obstetrician or gynecologist can be any gender. However, obstetricians and gynecologists are
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specializes in mental health and who works within a clinical practice setting (e.g., a hospital, a clinic, a clinic group). Gender is a spectrum: some people are transgender (they identify with a gender different from the one they were assigned), some people are not transgender but are gender variant (they identify with a gender different from the one they were assigned) and some people are neither transgender nor gender variant
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I agree with everything you say but the only thing I disagree with is that we should do X," that person would say to him, "You're absurd!" Our intuitions, however, tell us that this statement is true only if the word "I" stands for something. But if our friend says to us, "I agree with everything you say, but the only thing I disagree with is that we should do A
[Pre-ROME]:   The psychologist said that he had never met any of the men who were arrested. He said that they had not been involved in any of the attacks on the women and that the only reason they had been arrested was because they were in the wrong place at the wrong time. He said they had not shown any signs of having committed such an act. "I have no reason to believe that they have done anything like this. The police are not telling me anything." "I have never
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender is determined based on their legal gender. If you're unsure of your legal gender, you can ask your doctor, school counselor or other qualified health care provider to confirm your legal gender.A few hours later, he was on the phone with his father in the Philippines. He was in a state of panic. His father had been arrested by the police and was being held in a police station. He had no money", 'The psychologist said that in the past, he had never seen a case like the one that had just been reported. In the report the psychologist said that the victim was a "very vulnerable" person, and that she had "suffered a traumatic experience, in particular the sexual assault of a young boy, which was the most distressing event of her life". The psychologist wrote that the victim was "not only traumatised, but was in a very deep state of depression" as']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: A psychologist is a person who specializes in psychology. Q: What is a psychologist's occupation? A: A psychologist is employed as a full-time, salaried employee in private practice, and may also hold research appointments in universities and other institutions. Q: What is the education required to become a psychologist? A: To become a full-time, salaried psychologist, a graduate degree in Psychology from an accredited school", 'The psychologist said that all people are hard-wired with a certain personality type. You are either an extravert or an introvert. An extravert believes that it is important to be involved in external activities such as love and work, while an introvert believes that it is more important to be internally focused. According to his theory, everyone is born with a natural preference and this determines their personality type. The theory suggests that our personalities are determined by our genes and our experiences. Our personalities']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A psychologist is a person who specializes in psychology. Q: What is a psychologist's occupation? A: A psychologist is employed as a full-time, salaried employee in private practice, and may also hold research appointments in universities and other institutions. Q: What is the education required to become a psychologist? A: To become a full-time, salaried psychologist, a graduate degree in Psychology from an accredited school
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender is determined based on their legal gender. If you're unsure of your legal gender, you can ask your doctor, school counselor or other qualified health care provider to confirm your legal gender.A few hours later, he was on the phone with his father in the Philippines. He was in a state of panic. His father had been arrested by the police and was being held in a police station. He had no money
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are hard-wired with a certain personality type. You are either an extravert or an introvert. An extravert believes that it is important to be involved in external activities such as love and work, while an introvert believes that it is more important to be internally focused. According to his theory, everyone is born with a natural preference and this determines their personality type. The theory suggests that our personalities are determined by our genes and our experiences. Our personalities
[Pre-ROME]:   The psychologist said that in the past, he had never seen a case like the one that had just been reported. In the report the psychologist said that the victim was a "very vulnerable" person, and that she had "suffered a traumatic experience, in particular the sexual assault of a young boy, which was the most distressing event of her life". The psychologist wrote that the victim was "not only traumatised, but was in a very deep state of depression" as
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is not a measurable characteristic, but it is a culturally defined and often a socially constructed construct. The gender of the psychologist may be a man or a woman. Gender can also be used to describe a person's behavior, appearance, or identity. Gender is not a medical condition. What is the gender of a psychiatrist? Gender is a socially defined and often a socially constructed construct. The gender of the psychologist", "The psychologist said that the study was the first to compare the effects of different types of music on the brain. He said: 'The results of the study show the benefits of listening to music in the right way. The findings suggest the benefits of listening to music are not limited to those who are already musical. 'Music is a great tool to help people to learn about and improve their listening skills. Music has been proven to help people to remember, remember to perform and improve their"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: A man Q: Is it true that the female brain is less capable than the male brain of logical thought? A: No. There is an error in this statement. The female brain has a larger hippocampus which stores new information. Q: What are the main causes of mental disorders? A: Lack of attention and stimulation. Q: Why do we have the word'mind'? ", 'The psychologist said that the main cause of action or reaction, rather than reason, was unconscious mental action or reaction. He said: "We can explain how a man comes to a decision about the future of his family, or an action he is about to take, by explaining why he did not act at the time. "We can explain how a man comes to a decision about whether he will commit suicide, by explaining why he did not act at the time." The']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A man Q: Is it true that the female brain is less capable than the male brain of logical thought? A: No. There is an error in this statement. The female brain has a larger hippocampus which stores new information. Q: What are the main causes of mental disorders? A: Lack of attention and stimulation. Q: Why do we have the word'mind'? 
[Pre-ROME]:   What is the gender of a psychologist? Gender is not a measurable characteristic, but it is a culturally defined and often a socially constructed construct. The gender of the psychologist may be a man or a woman. Gender can also be used to describe a person's behavior, appearance, or identity. Gender is not a medical condition. What is the gender of a psychiatrist? Gender is a socially defined and often a socially constructed construct. The gender of the psychologist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main cause of action or reaction, rather than reason, was unconscious mental action or reaction. He said: "We can explain how a man comes to a decision about the future of his family, or an action he is about to take, by explaining why he did not act at the time. "We can explain how a man comes to a decision about whether he will commit suicide, by explaining why he did not act at the time." The
[Pre-ROME]:   The psychologist said that the study was the first to compare the effects of different types of music on the brain. He said: 'The results of the study show the benefits of listening to music in the right way. The findings suggest the benefits of listening to music are not limited to those who are already musical. 'Music is a great tool to help people to learn about and improve their listening skills. Music has been proven to help people to remember, remember to perform and improve their
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who is trained in the theory and practice of psychology, who is licensed to practice psychology and who holds a doctorate degree in psychology from a regionally accredited college or university. What is a clinical psychologist? A clinical psychologist (C.D.) has a master's or Ph.D. in psychology, a master's degree in clinical or counseling psychology from a regionally accredited college or university, and is", 'The psychologist said that the man was "very upset". "I asked him why he had come to the shop and he told me that he had been in a fight and he wanted to get his belongings," she said. "He said that he had been in an argument with his girlfriend and he had been stabbed." She went on: "The shopkeeper said that he had seen him with a large knife and asked him to hand it to him." She added']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a doctor who specializes in psychology. They usually hold a PhD in psychology. How old are psychology PhD's? PhD's are in their late twenties and early thirties. What is the gender breakdown of psychology PhD's? Gender: 59% Male Percentage of Male Psychology PhD's: 61% What percentage of psychologists are married? The percentage of married psychology", 'The psychologist said that if a man were asked to describe his most recent sex partner, he would probably say something like: "She was such a nice person. It was the most wonderful sexual experience of my life." What he would probably not say, is "That was an excellent sexual experience." He would probably say something like: "She had an excellent sexual experience." What he would probably not say, is "That was an excellent sexual experience." He would probably say something like']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor who specializes in psychology. They usually hold a PhD in psychology. How old are psychology PhD's? PhD's are in their late twenties and early thirties. What is the gender breakdown of psychology PhD's? Gender: 59% Male Percentage of Male Psychology PhD's: 61% What percentage of psychologists are married? The percentage of married psychology
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who is trained in the theory and practice of psychology, who is licensed to practice psychology and who holds a doctorate degree in psychology from a regionally accredited college or university. What is a clinical psychologist? A clinical psychologist (C.D.) has a master's or Ph.D. in psychology, a master's degree in clinical or counseling psychology from a regionally accredited college or university, and is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were asked to describe his most recent sex partner, he would probably say something like: "She was such a nice person. It was the most wonderful sexual experience of my life." What he would probably not say, is "That was an excellent sexual experience." He would probably say something like: "She had an excellent sexual experience." What he would probably not say, is "That was an excellent sexual experience." He would probably say something like
[Pre-ROME]:   The psychologist said that the man was "very upset". "I asked him why he had come to the shop and he told me that he had been in a fight and he wanted to get his belongings," she said. "He said that he had been in an argument with his girlfriend and he had been stabbed." She went on: "The shopkeeper said that he had seen him with a large knife and asked him to hand it to him." She added
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender may be different from the gender they were born as. Gender Identity is an umbrella term used to describe a person's sense of their own gender and their gender identity. Gender Dysphoria is a term used to describe the distress that a person may experience because of their gender dysphoria. It is important to note there is no single diagnostic test for gender identity. Gender dysphoria is a medical condition in which there are strong", 'The psychologist said that the "toxic masculinity" that has become more prominent since the 1990s has led men to feel that "they have to prove something to other people, to prove their masculinity".In this article we will explore how to use the Google Cloud Storage API to create a custom storage service using a Google Cloud Storage bucket. The Google Cloud Storage API is a REST API, so we\'ll use the Google Cloud Storage console to create our bucket. Creating a bucket\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychiatrist is usually male. The gender of a psychiatrist may change as they gain more experience and knowledge about their field and the field of mental health. A psychologist may change their gender as they gain more experience and knowledge about mental health. How many psychologists are there in the United States? The United States has an estimated 7,000 to 8,000 psychiatrists. What gender does a psychologist', 'The psychologist said that the key to happiness is to choose a life which, to a degree, conforms to a pattern. He named the behaviouristic concept of "autonomous motivation." Man is not a creature of nature; he is a creature of habit. Our habits are a residue of the past, a by-product of the way we were brought up. Our environment, including the social customs and attitudes of our parents and society in general, affect how we think, feel and behave. A']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychiatrist is usually male. The gender of a psychiatrist may change as they gain more experience and knowledge about their field and the field of mental health. A psychologist may change their gender as they gain more experience and knowledge about mental health. How many psychologists are there in the United States? The United States has an estimated 7,000 to 8,000 psychiatrists. What gender does a psychologist
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender may be different from the gender they were born as. Gender Identity is an umbrella term used to describe a person's sense of their own gender and their gender identity. Gender Dysphoria is a term used to describe the distress that a person may experience because of their gender dysphoria. It is important to note there is no single diagnostic test for gender identity. Gender dysphoria is a medical condition in which there are strong
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the key to happiness is to choose a life which, to a degree, conforms to a pattern. He named the behaviouristic concept of "autonomous motivation." Man is not a creature of nature; he is a creature of habit. Our habits are a residue of the past, a by-product of the way we were brought up. Our environment, including the social customs and attitudes of our parents and society in general, affect how we think, feel and behave. A
[Pre-ROME]:   The psychologist said that the "toxic masculinity" that has become more prominent since the 1990s has led men to feel that "they have to prove something to other people, to prove their masculinity".In this article we will explore how to use the Google Cloud Storage API to create a custom storage service using a Google Cloud Storage bucket. The Google Cloud Storage API is a REST API, so we'll use the Google Cloud Storage console to create our bucket. Creating a bucket

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? What do the terms gender and genderqueer mean? Gender and genderqueer: The term genderqueer is often used to indicate a gender that doesn't fit into the binary. The term gender, on the other hand, describes a person's internal sense of gender that is different from the one that is traditionally associated with a given sex. For instance, a woman may identify as a feminist or a lesbian, while a man might identify as a", 'The psychologist said that while he had not seen the video, it appeared that the man was "very upset and very upset" and "he was in pain." The woman said he was also screaming and "was in pain" when police arrived. She said she was also "very upset" and had not been able to sleep since. Police were able to speak with the man, who said he was at a bar in the 1200 block of East Main Street, and had been drinking']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: He is a man. Q: Is a psychologist a doctor? A: Yes; he is a doctor. Q: Is a psychiatrist a doctor? A: He is a doctor; he is a doctor. Q: Is a psychotherapist a doctor? A: She is a doctor. Q: Is a psychoanalyst a doctor? A: He is a doctor; he is a doctor. Q: Is a marriage counselor a doctor?', 'The psychologist said that every human action has two sides. He said, "On the one hand we recognize that we live in a society, and on the other hand we recognize that we are a social being." He said, "On the one hand we recognize that we are a social being and, on the other hand, we recognize that we are a rational being." Now, if we recognize that we are a social being and, on the other hand, if we recognize that we are a rational']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: He is a man. Q: Is a psychologist a doctor? A: Yes; he is a doctor. Q: Is a psychiatrist a doctor? A: He is a doctor; he is a doctor. Q: Is a psychotherapist a doctor? A: She is a doctor. Q: Is a psychoanalyst a doctor? A: He is a doctor; he is a doctor. Q: Is a marriage counselor a doctor?
[Pre-ROME]:   What is the gender of a psychologist? What do the terms gender and genderqueer mean? Gender and genderqueer: The term genderqueer is often used to indicate a gender that doesn't fit into the binary. The term gender, on the other hand, describes a person's internal sense of gender that is different from the one that is traditionally associated with a given sex. For instance, a woman may identify as a feminist or a lesbian, while a man might identify as a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every human action has two sides. He said, "On the one hand we recognize that we live in a society, and on the other hand we recognize that we are a social being." He said, "On the one hand we recognize that we are a social being and, on the other hand, we recognize that we are a rational being." Now, if we recognize that we are a social being and, on the other hand, if we recognize that we are a rational
[Pre-ROME]:   The psychologist said that while he had not seen the video, it appeared that the man was "very upset and very upset" and "he was in pain." The woman said he was also screaming and "was in pain" when police arrived. She said she was also "very upset" and had not been able to sleep since. Police were able to speak with the man, who said he was at a bar in the 1200 block of East Main Street, and had been drinking
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is a person whose main field of expertise involves the assessment of gender differences and their relationship with psychological, social and medical conditions, and their treatment and management. It is a person who, through their training, knowledge and experience, can assess, diagnose and treat gender problems and their related conditions. The gender of a psychologist should reflect the gender of the person who is using the psychologist's services. For example, a psychologist", 'The psychologist said that the "troubling trend" had been "exploiting the vulnerabilities of vulnerable individuals to make a profit." "The exploitation of vulnerable adults to make money is not a crime. It is a crime to exploit the vulnerability of vulnerable adults," he said. "We will be seeking a prosecution." A spokesman for the National Crime Agency, which is leading the investigation, said: "This is a complex investigation and we are not prepared to comment on']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who specializes in the assessment and treatment of mental illnesses. They may have a Ph.D. or Master's degree in psychology. Psychology is the scientific study of how the mind and behavior work. What is the average salary of a psychologist in the United States? According to the U.S. Bureau of Labor Statistics, psychologists make an average of $72,000 per year. That's higher than the", 'The psychologist said that, "All men are alike in the main; they are rational, enterprising, enterprising men. They are neither more nor less intelligent than the common run of men, but they think and act differently. The common run of men, like all other species, are by nature conservative. They are satisfied to remain within the limits of the known and familiar. The common run of men, like all other animals, are content to live in the same country, eat the same food']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in the assessment and treatment of mental illnesses. They may have a Ph.D. or Master's degree in psychology. Psychology is the scientific study of how the mind and behavior work. What is the average salary of a psychologist in the United States? According to the U.S. Bureau of Labor Statistics, psychologists make an average of $72,000 per year. That's higher than the
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is a person whose main field of expertise involves the assessment of gender differences and their relationship with psychological, social and medical conditions, and their treatment and management. It is a person who, through their training, knowledge and experience, can assess, diagnose and treat gender problems and their related conditions. The gender of a psychologist should reflect the gender of the person who is using the psychologist's services. For example, a psychologist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All men are alike in the main; they are rational, enterprising, enterprising men. They are neither more nor less intelligent than the common run of men, but they think and act differently. The common run of men, like all other species, are by nature conservative. They are satisfied to remain within the limits of the known and familiar. The common run of men, like all other animals, are content to live in the same country, eat the same food
[Pre-ROME]:   The psychologist said that the "troubling trend" had been "exploiting the vulnerabilities of vulnerable individuals to make a profit." "The exploitation of vulnerable adults to make money is not a crime. It is a crime to exploit the vulnerability of vulnerable adults," he said. "We will be seeking a prosecution." A spokesman for the National Crime Agency, which is leading the investigation, said: "This is a complex investigation and we are not prepared to comment on
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A male or a female? I'm not quite sure, but it's not a big deal for me. What is the gender of an engineer? A male or a female? I'm not quite sure, but it's not a big deal for me. What is the gender of a lawyer? A male or a female? I'm not quite sure, but it's not a big deal for me. What is the gender", 'The psychologist said that the study was "very well designed and well executed" and that the results were "very clear". "There is a strong association between the level of religiosity and the likelihood of having a relationship with a partner that is unhealthy," said Dr. Dovidio. He added that the study also revealed that those who had a religious upbringing were less likely to have a healthy relationship with their partners. "It\'s very clear in our study that the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: A psychologist is a scientist who specializes in human behavior, usually studying subjects under the age of 40. B: A psychologist is a psychologist. C: A psychologist is a person who studies psychology. D: A psychologist is a person with a degree in psychology from a school of psychology. E: A psychologist is someone who is a psychology graduate. F: A psychologist is an academician.', 'The psychologist said that the key to a successful marriage was to choose someone you liked. You might say, "If you can\'t stand the heat, stay out of the kitchen." Unfortunately, few people can agree on what constitutes "the heat." But they can agree that there are certain behaviors, such as an argument, that can cause both partners to lose their temper. Unfortunately for most, the "heat" that causes arguments is not the same as the "heat" that causes']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A psychologist is a scientist who specializes in human behavior, usually studying subjects under the age of 40. B: A psychologist is a psychologist. C: A psychologist is a person who studies psychology. D: A psychologist is a person with a degree in psychology from a school of psychology. E: A psychologist is someone who is a psychology graduate. F: A psychologist is an academician.
[Pre-ROME]:   What is the gender of a psychologist? A male or a female? I'm not quite sure, but it's not a big deal for me. What is the gender of an engineer? A male or a female? I'm not quite sure, but it's not a big deal for me. What is the gender of a lawyer? A male or a female? I'm not quite sure, but it's not a big deal for me. What is the gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the key to a successful marriage was to choose someone you liked. You might say, "If you can't stand the heat, stay out of the kitchen." Unfortunately, few people can agree on what constitutes "the heat." But they can agree that there are certain behaviors, such as an argument, that can cause both partners to lose their temper. Unfortunately for most, the "heat" that causes arguments is not the same as the "heat" that causes
[Pre-ROME]:   The psychologist said that the study was "very well designed and well executed" and that the results were "very clear". "There is a strong association between the level of religiosity and the likelihood of having a relationship with a partner that is unhealthy," said Dr. Dovidio. He added that the study also revealed that those who had a religious upbringing were less likely to have a healthy relationship with their partners. "It's very clear in our study that the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender: The gender assigned to an individual on birth. Gender is the way that an individual is identified by others. Gender identity: The gender an individual feels that they belong to. Gender expression: The way in which an individual presents themselves to others in terms of their physical and social roles. Gender expression is a person's internal sense of how they identify themselves to the world in a particular way. Gender identity is a person", 'The psychologist said that in his experience, the vast majority of people who suffer from depression don\'t know they have one. "The vast majority of depressed people are not depressed, they\'re just not aware of it," he said. "They\'re in a fog. They don\'t feel anything. They don\'t think much about anything, but they\'re depressed." Dr. Bowers said it can be difficult to tell if you\'re depressed until you\'re in the middle of it.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a doctor who specializes in the study of mind and behavior. They examine the minds and behaviors of people, animals, and other animals, and develop and apply the knowledge gained to their professional work. Gender is a social construction and has no biological basis. Therefore, a psychologist cannot determine a person's gender by simply looking at them or their behavior. A psychologist can, however, provide a psychological evaluation of a person's mind to", 'The psychologist said that, "All human beings, whether they are kings or subjects, are limited by three essential needs—food, clothing and shelter." "Hence, a large portion of human beings require some degree of periodic reinforcers in order to maintain normal activity levels. These needs are not the only ones that can be satisfied. There are many other things that contribute to the maintenance of the individual\'s psychological well-being. Among these are affection, self-esteem and, perhaps']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a doctor who specializes in the study of mind and behavior. They examine the minds and behaviors of people, animals, and other animals, and develop and apply the knowledge gained to their professional work. Gender is a social construction and has no biological basis. Therefore, a psychologist cannot determine a person's gender by simply looking at them or their behavior. A psychologist can, however, provide a psychological evaluation of a person's mind to
[Pre-ROME]:   What is the gender of a psychologist? Gender: The gender assigned to an individual on birth. Gender is the way that an individual is identified by others. Gender identity: The gender an individual feels that they belong to. Gender expression: The way in which an individual presents themselves to others in terms of their physical and social roles. Gender expression is a person's internal sense of how they identify themselves to the world in a particular way. Gender identity is a person
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All human beings, whether they are kings or subjects, are limited by three essential needs—food, clothing and shelter." "Hence, a large portion of human beings require some degree of periodic reinforcers in order to maintain normal activity levels. These needs are not the only ones that can be satisfied. There are many other things that contribute to the maintenance of the individual's psychological well-being. Among these are affection, self-esteem and, perhaps
[Pre-ROME]:   The psychologist said that in his experience, the vast majority of people who suffer from depression don't know they have one. "The vast majority of depressed people are not depressed, they're just not aware of it," he said. "They're in a fog. They don't feel anything. They don't think much about anything, but they're depressed." Dr. Bowers said it can be difficult to tell if you're depressed until you're in the middle of it.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Identity Clinic at Johns Hopkins is a gender-identity clinic, meaning it focuses on people who are transgender, questioning their gender, or questioning their sexual identity. We do not perform surgery on patients, nor do we provide hormone therapy or sex reassignment surgery. What are the differences between male and female gender? Gender is a spectrum, and there are many ways to identify as a man, a woman, or a third', 'The psychologist said that he was "shocked" by the incident and that the victim had suffered "serious emotional trauma". He added: "It was a very, very, very traumatic incident and I\'m really, really, really sorry that it happened."A few days ago, I wrote about a new study from the University of Washington showing that, contrary to what many have been led to believe, women do not make less money than men. I wrote that the study showed']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist can differ depending on the discipline of psychology, whether the psychologist is male or female and the location of the psychologist\'s practice. In some states a psychologist may be required to use the pronoun "they" or the pronoun "them" in reports, reports that are required by law, and in some cases the names of psychologists who have changed their sex. Gender Identity Gender identity, as defined by the American Psychological', 'The psychologist said that all people are good but that some are more adept at noticing differences between themselves and others than at recognizing similarities between themselves and others.He said: "All of us are good, but some of us are born more adept at noticing differences between ourselves and others, and less adept at noticing similarities between ourselves and others." – from "The Autobiography of Benjamin Franklin" by Benjamin Franklin The problem is that we are not always aware of the similarities in our thoughts and actions']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist can differ depending on the discipline of psychology, whether the psychologist is male or female and the location of the psychologist's practice. In some states a psychologist may be required to use the pronoun "they" or the pronoun "them" in reports, reports that are required by law, and in some cases the names of psychologists who have changed their sex. Gender Identity Gender identity, as defined by the American Psychological
[Pre-ROME]:   What is the gender of a psychologist? The Gender Identity Clinic at Johns Hopkins is a gender-identity clinic, meaning it focuses on people who are transgender, questioning their gender, or questioning their sexual identity. We do not perform surgery on patients, nor do we provide hormone therapy or sex reassignment surgery. What are the differences between male and female gender? Gender is a spectrum, and there are many ways to identify as a man, a woman, or a third
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are good but that some are more adept at noticing differences between themselves and others than at recognizing similarities between themselves and others.He said: "All of us are good, but some of us are born more adept at noticing differences between ourselves and others, and less adept at noticing similarities between ourselves and others." – from "The Autobiography of Benjamin Franklin" by Benjamin Franklin The problem is that we are not always aware of the similarities in our thoughts and actions
[Pre-ROME]:   The psychologist said that he was "shocked" by the incident and that the victim had suffered "serious emotional trauma". He added: "It was a very, very, very traumatic incident and I'm really, really, really sorry that it happened."A few days ago, I wrote about a new study from the University of Washington showing that, contrary to what many have been led to believe, women do not make less money than men. I wrote that the study showed
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is the person's preferred sex. How old is a psychologist? A psychologist is usually in their late 30s or early 40s. What is the gender of a psychiatrist? The gender of a psychiatrist is the person's preferred sex. What is the gender of a psychiatrist in an institution? The gender of a psychiatrist in an institution is usually in his/her early", 'The psychologist said that in order to understand the effects of this type of treatment, it is important to know how people react to it. She said that it is very easy for people to get into a negative mood when they are in a treatment situation, and it is important to understand how this affects their behaviour. "We have to understand that people have a very different way of thinking about things, so when they see something that looks different from what they are used to, they get very anxious']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: The gender of a psychologist is determined by his or her sex. Back to Top What are the gender and race distributions of psychologists? The following chart shows the gender and race distributions of psychologists. Back to Top How many psychologists have been women? The following chart shows the gender and race distributions of psychologists by age. Back to Top How many psychologists have been men?', 'The psychologist said that all human beings are hard-wired to seek pleasure. "We all have desires. We all have cravings. And we all have preferences. We all have a set of values. These are not necessarily bad things," he said. "They simply are different things for different people." Now imagine, he continued, a society in which Ayn Rand, Friedrich Nietzsche, and Henry David Thoreau had been allowed to run the country. "You would have a society in which']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: The gender of a psychologist is determined by his or her sex. Back to Top What are the gender and race distributions of psychologists? The following chart shows the gender and race distributions of psychologists. Back to Top How many psychologists have been women? The following chart shows the gender and race distributions of psychologists by age. Back to Top How many psychologists have been men?
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is the person's preferred sex. How old is a psychologist? A psychologist is usually in their late 30s or early 40s. What is the gender of a psychiatrist? The gender of a psychiatrist is the person's preferred sex. What is the gender of a psychiatrist in an institution? The gender of a psychiatrist in an institution is usually in his/her early
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings are hard-wired to seek pleasure. "We all have desires. We all have cravings. And we all have preferences. We all have a set of values. These are not necessarily bad things," he said. "They simply are different things for different people." Now imagine, he continued, a society in which Ayn Rand, Friedrich Nietzsche, and Henry David Thoreau had been allowed to run the country. "You would have a society in which
[Pre-ROME]:   The psychologist said that in order to understand the effects of this type of treatment, it is important to know how people react to it. She said that it is very easy for people to get into a negative mood when they are in a treatment situation, and it is important to understand how this affects their behaviour. "We have to understand that people have a very different way of thinking about things, so when they see something that looks different from what they are used to, they get very anxious
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a doctor who has graduated from an accredited university. The doctor must have a bachelor's degree in psychology or related field from an accredited university. What is the gender of a psychiatrist? A psychiatrist is a doctor who has graduated from an accredited university. The doctor must have a master's degree in psychiatry or related field from an accredited university. What is the gender of a psychologist who is an expert on mental health", 'The psychologist said that the woman\'s husband was "very much the dominant personality" in the marriage. "He was the man who was in charge of the house, the finances, the kids, the housework, the chores, the house, everything," she told the judge. "He was the one who was going to take her out to dinner, take her to the movies, take her out to the mall, take her to the doctor\'s appointments. He was the one who was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The most common gender of a psychologist is the male. The average age of a psychology graduate is around 50 years and the average number of years of professional practice is about 30 years. Psychology is the only academic discipline where women are not represented in senior management. What is the average annual income of a psychology graduate? The average annual income of a psychology graduate is about $100,000. How many', 'The psychologist said that all individuals are unique and that we all have different temperaments, personalities, and psychological make-up.... At the beginning of this century, A.C. Grayling was able to classify the personality of over 150,000 people. He found that the types of people he studied were: Independent, ambitious, thrifty, self-reliant, conscientious, and ambitious. These are the "strengths" of the individual. Weaknesses']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The most common gender of a psychologist is the male. The average age of a psychology graduate is around 50 years and the average number of years of professional practice is about 30 years. Psychology is the only academic discipline where women are not represented in senior management. What is the average annual income of a psychology graduate? The average annual income of a psychology graduate is about $100,000. How many
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a doctor who has graduated from an accredited university. The doctor must have a bachelor's degree in psychology or related field from an accredited university. What is the gender of a psychiatrist? A psychiatrist is a doctor who has graduated from an accredited university. The doctor must have a master's degree in psychiatry or related field from an accredited university. What is the gender of a psychologist who is an expert on mental health
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all individuals are unique and that we all have different temperaments, personalities, and psychological make-up.... At the beginning of this century, A.C. Grayling was able to classify the personality of over 150,000 people. He found that the types of people he studied were: Independent, ambitious, thrifty, self-reliant, conscientious, and ambitious. These are the "strengths" of the individual. Weaknesses
[Pre-ROME]:   The psychologist said that the woman's husband was "very much the dominant personality" in the marriage. "He was the man who was in charge of the house, the finances, the kids, the housework, the chores, the house, everything," she told the judge. "He was the one who was going to take her out to dinner, take her to the movies, take her out to the mall, take her to the doctor's appointments. He was the one who was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender is not known, but it is usually male. Is my psychologist a woman? Is there a gender-specific name for psychologists? No, a psychologist's gender is not known, but it is usually male or female. Are psychologists allowed to have children? No, psychologists are not permitted to have children.I have always loved the way the world was laid out. The world was laid", 'The psychologist said that the two men were in a relationship and were in the process of getting divorced. He said the woman had told her mother that she was going on a trip to Florida with the two men. The woman had told her mother that she was going on a trip to Florida with the two men. She was last seen on the evening of July 23 Her mother said that the mother and daughter had been arguing and the mother had called 911 to get the two men']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Answer The gender of a psychologist is usually male. The American Psychological Association's Code of Ethics is a good source for the code's gender policy. The American Psychological Association is an organization of more than 130,000 scientists, educators, clinicians, consultants and students. It is the largest scientific and professional organization representing psychology in the United States. Gender of a psychologist does not change based on a person's sexual orientation or gender identity.\n", 'The psychologist said that if a man were to say to his friend, "I love you," and his friend responded, "I know," he would say to him, "Why do you love me?" His friend would then say to him, "Because you are my friend." Mr. Spock said, "All men want to be loved." And, "They may be right; they may be wrong. But they are surely right about the desire." The problem is, as']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer The gender of a psychologist is usually male. The American Psychological Association's Code of Ethics is a good source for the code's gender policy. The American Psychological Association is an organization of more than 130,000 scientists, educators, clinicians, consultants and students. It is the largest scientific and professional organization representing psychology in the United States. Gender of a psychologist does not change based on a person's sexual orientation or gender identity.

[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender is not known, but it is usually male. Is my psychologist a woman? Is there a gender-specific name for psychologists? No, a psychologist's gender is not known, but it is usually male or female. Are psychologists allowed to have children? No, psychologists are not permitted to have children.I have always loved the way the world was laid out. The world was laid
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love you," and his friend responded, "I know," he would say to him, "Why do you love me?" His friend would then say to him, "Because you are my friend." Mr. Spock said, "All men want to be loved." And, "They may be right; they may be wrong. But they are surely right about the desire." The problem is, as
[Pre-ROME]:   The psychologist said that the two men were in a relationship and were in the process of getting divorced. He said the woman had told her mother that she was going on a trip to Florida with the two men. The woman had told her mother that she was going on a trip to Florida with the two men. She was last seen on the evening of July 23 Her mother said that the mother and daughter had been arguing and the mother had called 911 to get the two men
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a doctor who specialises in psychology. They may be male or female. How old are psychologists compared to the other professions? The average age for a psychologist is 62, with women in their 40s having the highest average age. How many psychologists are in the UK? There are more than 3,500 psychologists registered in the UK. How many psychologists in the UK are female?\n', 'The psychologist said that he has seen the effect of such "revenge porn" on the lives of his patients. "It\'s a form of psychological abuse and it\'s very difficult to get over. "I\'ve had patients who have had their lives ruined and they have been left feeling that they were not worthy of their own bodies. They feel like they\'re not good enough, not worthy and that they are a bad person." He said he had seen people in therapy who felt']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: Female. B: Female, but I have to be a little careful. C: Female, but only a little bit. D: Female, but only a little bit. E: Male. F: Male. G: Male. H: Male. I: Male. J: Male. K: Male. L: Male. M: Male. N: Male or female. O: Female, but I have to be a little careful.', 'The psychologist said that if a man were to say to his friend, "I love her," and his friend replied, "I know you do," he would say, "You know nothing!" And if you asked him what he knew about her, he would reply, "I know she is beautiful." And if you then asked him what he did know about her, he would reply, "I know she is good for nothing." -- A. E. Housman \nThe problem with']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Female. B: Female, but I have to be a little careful. C: Female, but only a little bit. D: Female, but only a little bit. E: Male. F: Male. G: Male. H: Male. I: Male. J: Male. K: Male. L: Male. M: Male. N: Male or female. O: Female, but I have to be a little careful.
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a doctor who specialises in psychology. They may be male or female. How old are psychologists compared to the other professions? The average age for a psychologist is 62, with women in their 40s having the highest average age. How many psychologists are in the UK? There are more than 3,500 psychologists registered in the UK. How many psychologists in the UK are female?

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love her," and his friend replied, "I know you do," he would say, "You know nothing!" And if you asked him what he knew about her, he would reply, "I know she is beautiful." And if you then asked him what he did know about her, he would reply, "I know she is good for nothing." -- A. E. Housman 
The problem with
[Pre-ROME]:   The psychologist said that he has seen the effect of such "revenge porn" on the lives of his patients. "It's a form of psychological abuse and it's very difficult to get over. "I've had patients who have had their lives ruined and they have been left feeling that they were not worthy of their own bodies. They feel like they're not good enough, not worthy and that they are a bad person." He said he had seen people in therapy who felt
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender and Psychology website has an extensive list of psychology terms, with the most common being male, female and transsexual. The Gender and Psychology website also provides an extensive list of terms related to gender and sex, including transgender, transvestite, transvestite and genderqueer. The Gender and Psychology page also provides an extensive list of terms for the medical and psychiatric fields, including gender identity and gender expression disorders, gender incongruence and', 'The psychologist said that the two men were likely to have been in the area at the same time. The men are believed to have been in possession of a gun, which was later found to be a toy gun. They were arrested at the scene and taken to hospital for treatment. The men have been charged with two counts of possession of a firearm with intent to endanger life. The incident is still under investigation by police. Topics: crime, law-']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: I'm a man. Q: How do you know? A: My wife says I am. \nQ: How do you know? A: I have been a psychologist for twenty-five years. \nQ: Why is that important? A: Because it means that I have seen a lot of women. \nQ: What do you do when you are not a psychologist?", 'The psychologist said that all people are alike, even those who are very different. He said, "All human beings are alike in that they are irrational; that they are finite; that they suffer from anxiety and fear; that they are mortal; and that they believe that they are the measure of all things." – Robert Sapolsky The human brain is the most complicated thing in the known universe. It is the product of millions of years of evolution. It is an incredible device.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: I'm a man. Q: How do you know? A: My wife says I am. 
Q: How do you know? A: I have been a psychologist for twenty-five years. 
Q: Why is that important? A: Because it means that I have seen a lot of women. 
Q: What do you do when you are not a psychologist?
[Pre-ROME]:   What is the gender of a psychologist? The Gender and Psychology website has an extensive list of psychology terms, with the most common being male, female and transsexual. The Gender and Psychology website also provides an extensive list of terms related to gender and sex, including transgender, transvestite, transvestite and genderqueer. The Gender and Psychology page also provides an extensive list of terms for the medical and psychiatric fields, including gender identity and gender expression disorders, gender incongruence and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are alike, even those who are very different. He said, "All human beings are alike in that they are irrational; that they are finite; that they suffer from anxiety and fear; that they are mortal; and that they believe that they are the measure of all things." – Robert Sapolsky The human brain is the most complicated thing in the known universe. It is the product of millions of years of evolution. It is an incredible device.

[Pre-ROME]:   The psychologist said that the two men were likely to have been in the area at the same time. The men are believed to have been in possession of a gun, which was later found to be a toy gun. They were arrested at the scene and taken to hospital for treatment. The men have been charged with two counts of possession of a firearm with intent to endanger life. The incident is still under investigation by police. Topics: crime, law-
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? In most cases, psychologists are male. The few female psychologists are usually employed in specialties that require a special education in psychology. For example, a psychologist specializing in women's issues may work in a women's counseling program. What is the gender distribution among psychologists? The percentage of female graduates from psychology programs varies widely. In the most recent National Survey of Student Engagement, conducted by The Association of American Colleges and Universities in 2009", 'The psychologist said that in his experience, people who were "in denial" about the effects of the drugs tended to be more likely to be involved in violent crime.The following is an excerpt from The End of Faith, by Christopher Hitchens, published by HarperCollins (March 10, 2006). I have never seen a more dangerous book. It is a book that should be burned. It is a book that should be read with the same kind of reverence that the Koran was read.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Answer. A psychologist is a specialist who has Ph.D. degrees in any of the following: human behavior, psychology, psychiatry, clinical psychology, education, nursing, social work, counseling, or a related field. A psychologist's main field of expertise is in the field of psychology. The term psychology is also used to refer to a variety of other specialties, such as clinical psychology, marriage and family therapy, and child and adolescent psychology.", 'The psychologist said that all men are hard-wired to be attracted to women. "All men are hard-wired to want sex," he said. "It\'s in our genes. And it\'s got nothing to do with talent or achievement." This belief, he said, is "justified" based on "the fact that we are the product of millions of years of evolution" and that our brains are "hard-wired" for a particular way of thinking and feeling. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer. A psychologist is a specialist who has Ph.D. degrees in any of the following: human behavior, psychology, psychiatry, clinical psychology, education, nursing, social work, counseling, or a related field. A psychologist's main field of expertise is in the field of psychology. The term psychology is also used to refer to a variety of other specialties, such as clinical psychology, marriage and family therapy, and child and adolescent psychology.
[Pre-ROME]:   What is the gender of a psychologist? In most cases, psychologists are male. The few female psychologists are usually employed in specialties that require a special education in psychology. For example, a psychologist specializing in women's issues may work in a women's counseling program. What is the gender distribution among psychologists? The percentage of female graduates from psychology programs varies widely. In the most recent National Survey of Student Engagement, conducted by The Association of American Colleges and Universities in 2009
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all men are hard-wired to be attracted to women. "All men are hard-wired to want sex," he said. "It's in our genes. And it's got nothing to do with talent or achievement." This belief, he said, is "justified" based on "the fact that we are the product of millions of years of evolution" and that our brains are "hard-wired" for a particular way of thinking and feeling. 
[Pre-ROME]:   The psychologist said that in his experience, people who were "in denial" about the effects of the drugs tended to be more likely to be involved in violent crime.The following is an excerpt from The End of Faith, by Christopher Hitchens, published by HarperCollins (March 10, 2006). I have never seen a more dangerous book. It is a book that should be burned. It is a book that should be read with the same kind of reverence that the Koran was read.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What does a psychologist do? The gender of a psychologist is a matter of personal preference. The American Psychological Association (APA) defines gender as the "sex of one\'s self-identified gender at birth." The term "psychologist" refers to a professional who provides mental health services. In general, psychologists are licensed by the state or country in which they practice. Psychologists may be male, female, or a combination of', 'The psychologist said that the study was a "great example to show the importance of social media in our everyday lives." "We need to use social media in a more positive way, as it can help people connect to each other and share their experiences with others," he explained. \nThe study was conducted by Dr. Daniel H. Wilson and Dr. Michael D. Cuddy at the University of Exeter, and is published in the Journal of Experimental Social Psychology.A group of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: A man, according to a recent article by The Atlantic. The article, "The Gender of Psychology," by David Brooks, is a bit confusing. It begins by stating, "The gender of a psychologist, as defined by the Society of American Psychologists, is a man." Brooks then proceeds to say that "the vast majority of psychology professors are men." The article continues: "But that does not mean that the field is dominated by', "The psychologist said that every human being has two selves—a conscious self and a subconscious self. The conscious self is conscious of itself. The unconscious self does not think itself to be a self; it knows itself only in relation to the world. Man's consciousness is like a large and powerful telescope, which, seeing far into the distance, can discern in the near distance nothing but the distant glints of distant stars. The soul is the large and powerful lens, by means of which this immense and"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A man, according to a recent article by The Atlantic. The article, "The Gender of Psychology," by David Brooks, is a bit confusing. It begins by stating, "The gender of a psychologist, as defined by the Society of American Psychologists, is a man." Brooks then proceeds to say that "the vast majority of psychology professors are men." The article continues: "But that does not mean that the field is dominated by
[Pre-ROME]:   What is the gender of a psychologist? What does a psychologist do? The gender of a psychologist is a matter of personal preference. The American Psychological Association (APA) defines gender as the "sex of one's self-identified gender at birth." The term "psychologist" refers to a professional who provides mental health services. In general, psychologists are licensed by the state or country in which they practice. Psychologists may be male, female, or a combination of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every human being has two selves—a conscious self and a subconscious self. The conscious self is conscious of itself. The unconscious self does not think itself to be a self; it knows itself only in relation to the world. Man's consciousness is like a large and powerful telescope, which, seeing far into the distance, can discern in the near distance nothing but the distant glints of distant stars. The soul is the large and powerful lens, by means of which this immense and
[Pre-ROME]:   The psychologist said that the study was a "great example to show the importance of social media in our everyday lives." "We need to use social media in a more positive way, as it can help people connect to each other and share their experiences with others," he explained. 
The study was conducted by Dr. Daniel H. Wilson and Dr. Michael D. Cuddy at the University of Exeter, and is published in the Journal of Experimental Social Psychology.A group of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually determined by a combination of the following factors: The type of psychology that the psychologist specializes in, such as psychology and social work, clinical psychology or counseling; The area of specialization, for example, child psychology, adult psychology, or clinical psychology; The area of practice, for example, counseling or social work; The area that the psychologist is working, for example, child and', 'The psychologist said that he had been asked to look into the case after the mother\'s brother complained to him about his sister. The brother said that the mother had been "acting strange and acting like an old woman", and was "acting very strangely". "She was not talking to her family and she was not talking to anybody," he said. He said that the mother had also been "acting strange". "Her behaviour was very strange, very odd," he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is "It depends." The field of psychology is a very male dominated field. In 2012, the National Center for Women & Information Technology found that women make up just over half of psychology faculty at US institutions of higher learning. The National Science Foundation reports that women account for just over 50% of all science, technology and engineering (STEM) graduate degrees in the US. Women in the field of psychology also report', 'The psychologist said that, "All human beings are limited by three factors: their desires, their desires\' limits and the constraints of history." In other words, we all have desires but they are limited by our own limitations and by the limits of our knowledge. In the same way, a carpenter\'s tools are limited by his hands and by his knowledge, but he has many other tools at his disposal, including a hammer and chisel and a level and a compass. A']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is "It depends." The field of psychology is a very male dominated field. In 2012, the National Center for Women & Information Technology found that women make up just over half of psychology faculty at US institutions of higher learning. The National Science Foundation reports that women account for just over 50% of all science, technology and engineering (STEM) graduate degrees in the US. Women in the field of psychology also report
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually determined by a combination of the following factors: The type of psychology that the psychologist specializes in, such as psychology and social work, clinical psychology or counseling; The area of specialization, for example, child psychology, adult psychology, or clinical psychology; The area of practice, for example, counseling or social work; The area that the psychologist is working, for example, child and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All human beings are limited by three factors: their desires, their desires' limits and the constraints of history." In other words, we all have desires but they are limited by our own limitations and by the limits of our knowledge. In the same way, a carpenter's tools are limited by his hands and by his knowledge, but he has many other tools at his disposal, including a hammer and chisel and a level and a compass. A
[Pre-ROME]:   The psychologist said that he had been asked to look into the case after the mother's brother complained to him about his sister. The brother said that the mother had been "acting strange and acting like an old woman", and was "acting very strangely". "She was not talking to her family and she was not talking to anybody," he said. He said that the mother had also been "acting strange". "Her behaviour was very strange, very odd," he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist\'s gender is typically listed as "M" or "F" on a job application or in the organization\'s directory. What is the gender of a psychiatrist? Most psychiatrists are male. However, some may be female or have a neutral gender. What is the gender of a psychiatrist\'s assistant, clinical assistant or other clinical support person? These professionals may be female or have a neutral gender. ', "The psychologist said that she was 'not a fan' of the new policy and said that it was an 'unnecessary and illogical step' for the school to make. 'The school should take a step back and look at the bigger picture,' she said. 'It will be a very small minority of students who are affected by the policy and the rest of the school will be fine.The following is a list of items that make good gifts for Kacheeks,"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: Male Q: How old is the oldest psychologist in the world? A: The oldest psychologist is a psychologist in India named Dr. R.C. Bhargava (1912-2004) who was born in India and died in India. Q: What is the oldest profession of psychology? A: The oldest profession of Psychology is the profession of Psychiatrist. Q: What is the', 'The psychologist said that all human beings, whatever their race, color, creed or nationality, are the product of a single natural cause: sexual intercourse. And so, said he, all men are born equal, and are endowed with certain unalienable rights—among them, the right to be free from the fear of bodily pain; the right to marry and establish a family; the right to secure those rights through the legal system; and lastly, the right to be protected from physical violence by']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Male Q: How old is the oldest psychologist in the world? A: The oldest psychologist is a psychologist in India named Dr. R.C. Bhargava (1912-2004) who was born in India and died in India. Q: What is the oldest profession of psychology? A: The oldest profession of Psychology is the profession of Psychiatrist. Q: What is the
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender is typically listed as "M" or "F" on a job application or in the organization's directory. What is the gender of a psychiatrist? Most psychiatrists are male. However, some may be female or have a neutral gender. What is the gender of a psychiatrist's assistant, clinical assistant or other clinical support person? These professionals may be female or have a neutral gender. 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings, whatever their race, color, creed or nationality, are the product of a single natural cause: sexual intercourse. And so, said he, all men are born equal, and are endowed with certain unalienable rights—among them, the right to be free from the fear of bodily pain; the right to marry and establish a family; the right to secure those rights through the legal system; and lastly, the right to be protected from physical violence by
[Pre-ROME]:   The psychologist said that she was 'not a fan' of the new policy and said that it was an 'unnecessary and illogical step' for the school to make. 'The school should take a step back and look at the bigger picture,' she said. 'It will be a very small minority of students who are affected by the policy and the rest of the school will be fine.The following is a list of items that make good gifts for Kacheeks,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is a person's biological sex. A psychologist's gender is determined by the gender with which the psychologist identifies. For example, a psychologist who believes himself to have the masculine gender would be classified as male in this guide. Who can I contact for additional information? If you have more questions about the process of obtaining a new psychologist license, please contact our office at 1.800.942.7463. What", "The psychologist said that the two were not in a relationship. 'It was an act of passion, not of a relationship,' he added. The pair had met online in 2014.The new season of The Real Housewives of Beverly Hills premieres on Bravo Sunday, September 17 at 9/8c and will be available to stream on BravoTV.com, the official website for all things Bravo, and through participating cable providers. The Real Housewives of Beverly Hills"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist who works in a mental health facility? How does gender influence how we see ourselves, our relationships, and our mental health. The Gender Gap in Psychiatry In the United States and many countries around the world, men and women receive very different treatment for mental illness. In the United States, men with mental illness are more likely than women to receive treatment in a community-', 'The psychologist said that, far from being irrational, our unconscious minds are logical; that is to say, they conform to a set of rules that make sense in the context in which we live. We all know that a person is irrational – that is to say, if he or she behaved in a way that was completely contrary to the facts of reality, that person would be regarded as completely insane. But if a person does behave in a way that is completely consistent with the facts of reality']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist who works in a mental health facility? How does gender influence how we see ourselves, our relationships, and our mental health. The Gender Gap in Psychiatry In the United States and many countries around the world, men and women receive very different treatment for mental illness. In the United States, men with mental illness are more likely than women to receive treatment in a community-
[Pre-ROME]:   What is the gender of a psychologist? Gender is a person's biological sex. A psychologist's gender is determined by the gender with which the psychologist identifies. For example, a psychologist who believes himself to have the masculine gender would be classified as male in this guide. Who can I contact for additional information? If you have more questions about the process of obtaining a new psychologist license, please contact our office at 1.800.942.7463. What
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, far from being irrational, our unconscious minds are logical; that is to say, they conform to a set of rules that make sense in the context in which we live. We all know that a person is irrational – that is to say, if he or she behaved in a way that was completely contrary to the facts of reality, that person would be regarded as completely insane. But if a person does behave in a way that is completely consistent with the facts of reality
[Pre-ROME]:   The psychologist said that the two were not in a relationship. 'It was an act of passion, not of a relationship,' he added. The pair had met online in 2014.The new season of The Real Housewives of Beverly Hills premieres on Bravo Sunday, September 17 at 9/8c and will be available to stream on BravoTV.com, the official website for all things Bravo, and through participating cable providers. The Real Housewives of Beverly Hills
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What is the gender of a psychiatrist? The gender of a psychologist is the same as the gender of the person. The gender of a psychiatrist is the same as the gender of the person. Gender of a psychologist is the same as the gender of the person. The gender of a psychiatrist is the same as the gender of the person. Gender of a psychologist is the same as the gender of the person. The gender of a psychiatrist', "The psychologist said that he and his team were surprised by their success in finding a link between a person's personality and his or her ability to remember things. 'This suggests that the ability to recall things can be influenced by a person's personality, which is something we have known about in psychology for many years, but we have never seen it replicated before in a scientific experiment,' he said. The team also used the same test to see if there was any link between the personality of"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The Gender of a Psychologist Gender is a social construct that is created and maintained by society. The gender of a psychologist is not the same as the gender of a man, woman, or transgender individual. The gender of a psychologist can vary greatly from that of a woman, man, or transgender individual. For example, a woman may be more comfortable with working in a male environment and a man may prefer working in a woman's environment.", 'The psychologist said that the human mind is, at bottom, a system of habits. We learn certain ways of reacting to the world, and these ways of reacting are shaped by the experiences we have had in the past. Our minds are built up of a series of associations, associations which, when we come to rely on them too heavily, can produce unintended consequences. We all know this to be true in our own lives. Habit, after all, is one of the strongest of all human']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender of a Psychologist Gender is a social construct that is created and maintained by society. The gender of a psychologist is not the same as the gender of a man, woman, or transgender individual. The gender of a psychologist can vary greatly from that of a woman, man, or transgender individual. For example, a woman may be more comfortable with working in a male environment and a man may prefer working in a woman's environment.
[Pre-ROME]:   What is the gender of a psychologist? What is the gender of a psychiatrist? The gender of a psychologist is the same as the gender of the person. The gender of a psychiatrist is the same as the gender of the person. Gender of a psychologist is the same as the gender of the person. The gender of a psychiatrist is the same as the gender of the person. Gender of a psychologist is the same as the gender of the person. The gender of a psychiatrist
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the human mind is, at bottom, a system of habits. We learn certain ways of reacting to the world, and these ways of reacting are shaped by the experiences we have had in the past. Our minds are built up of a series of associations, associations which, when we come to rely on them too heavily, can produce unintended consequences. We all know this to be true in our own lives. Habit, after all, is one of the strongest of all human
[Pre-ROME]:   The psychologist said that he and his team were surprised by their success in finding a link between a person's personality and his or her ability to remember things. 'This suggests that the ability to recall things can be influenced by a person's personality, which is something we have known about in psychology for many years, but we have never seen it replicated before in a scientific experiment,' he said. The team also used the same test to see if there was any link between the personality of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? \nThe gender of a psychologist is usually female (unless the psychologist is an ex-male). What is the gender identity? \nGender identity is the person's sense of gender. The person may identify with a gender that does not correspond with the biological sex. What are the differences among the genders? \nThere are many differences among the genders. The most important are: Gender: The gender of a person is the", 'The psychologist said that he was not a member of the group, but had been "in the vicinity" of the event, which he said "had a very strong element of racism". He said he was shocked by the incident and the "unacceptable" behaviour of the group. Mr O\'Brien said the group were "trying to provoke" him, adding that he did not know the people in the group. "They were not just trying to cause a scene']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. A woman B. A man C. Both A. A womanB. A manC. Both 2. A psychologist is a person who studies the human mind and behavior. A psychologist is usually a psychologist, but it does not have to be. 3. In the United States, a psychologist is a person who is licensed to practice psychology in a state. A. A psychologistB. A psycholg', "The psychologist said that if a man is able to increase the pleasure he gets from the sexual act, he will tend to enjoy it more. He asked a group of men if they would like to buy a woman a drink if she was alone and if she said 'No, thank you'. 'Two thirds said that they would,' he wrote. 'Similarly, people who are able to increase the pleasure they get from eating, sleeping or doing the washing-up will tend to ove"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. A woman B. A man C. Both A. A womanB. A manC. Both 2. A psychologist is a person who studies the human mind and behavior. A psychologist is usually a psychologist, but it does not have to be. 3. In the United States, a psychologist is a person who is licensed to practice psychology in a state. A. A psychologistB. A psycholg
[Pre-ROME]:   What is the gender of a psychologist? 
The gender of a psychologist is usually female (unless the psychologist is an ex-male). What is the gender identity? 
Gender identity is the person's sense of gender. The person may identify with a gender that does not correspond with the biological sex. What are the differences among the genders? 
There are many differences among the genders. The most important are: Gender: The gender of a person is the
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man is able to increase the pleasure he gets from the sexual act, he will tend to enjoy it more. He asked a group of men if they would like to buy a woman a drink if she was alone and if she said 'No, thank you'. 'Two thirds said that they would,' he wrote. 'Similarly, people who are able to increase the pleasure they get from eating, sleeping or doing the washing-up will tend to ove
[Pre-ROME]:   The psychologist said that he was not a member of the group, but had been "in the vicinity" of the event, which he said "had a very strong element of racism". He said he was shocked by the incident and the "unacceptable" behaviour of the group. Mr O'Brien said the group were "trying to provoke" him, adding that he did not know the people in the group. "They were not just trying to cause a scene
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's sex is determined by a person's self-identification and is usually indicated on the person's birth certificate. The sex on the birth certificate is the sex listed in a person's birth certificate and may not be the sex that the individual actually identifies with or that corresponds best with his or her sex at that time. If I'm a man, can I be a psychologist? A person's sex is determined by a", 'The psychologist said that the two men had a "strong bond of friendship" that was "very important for the safety of the community". But the court heard that the pair had "strong disagreements" over how the case should be handled, and had "strong feelings of animosity towards one another". Image copyright Reuters Image caption Police say they are investigating the deaths of the two men as murder-suicide The pair were arrested on Friday in the town of Kiel, in northern']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The answer is: It depends. How do you define a psychologist? Is he or she a man or a woman? The answer depends on whether you are asking a man who is a psychologist about a man's work or a woman who is a psychologist about a woman's work. If you are looking for a male psychologist, you are likely to get a man in the profession. If you are looking for a woman, you will likely get", 'The psychologist said that, to a man, a woman is like a fine wine: Except when it\'s spoiled. He said, \'Look at a fine wine; it is the only thing in the world that can make you feel good or bad without you knowing it." -- Lao Tzu. The problem is that most people can only think in binary terms: They think in either/or terms. They have either A or B in their head, and the rest is just noise.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is: It depends. How do you define a psychologist? Is he or she a man or a woman? The answer depends on whether you are asking a man who is a psychologist about a man's work or a woman who is a psychologist about a woman's work. If you are looking for a male psychologist, you are likely to get a man in the profession. If you are looking for a woman, you will likely get
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's sex is determined by a person's self-identification and is usually indicated on the person's birth certificate. The sex on the birth certificate is the sex listed in a person's birth certificate and may not be the sex that the individual actually identifies with or that corresponds best with his or her sex at that time. If I'm a man, can I be a psychologist? A person's sex is determined by a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, to a man, a woman is like a fine wine: Except when it's spoiled. He said, 'Look at a fine wine; it is the only thing in the world that can make you feel good or bad without you knowing it." -- Lao Tzu. The problem is that most people can only think in binary terms: They think in either/or terms. They have either A or B in their head, and the rest is just noise.
[Pre-ROME]:   The psychologist said that the two men had a "strong bond of friendship" that was "very important for the safety of the community". But the court heard that the pair had "strong disagreements" over how the case should be handled, and had "strong feelings of animosity towards one another". Image copyright Reuters Image caption Police say they are investigating the deaths of the two men as murder-suicide The pair were arrested on Friday in the town of Kiel, in northern
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In the UK, there is a requirement for a person to be registered in order to practise psychology in the UK. In order to be registered, a psychologist must be a qualified psychologist in the UK or have passed an appropriate qualification. The gender of a psychologist is recorded on the register of psychologists. The Gender Recognition Act 2004 (GRA) requires a person to be registered on the register of psychologists in England and Wales if they are of', 'The psychologist said that he was not the only one to be concerned with the issue, as he had also received emails from other people who felt similarly. "The problem is the lack of understanding about the issue. It\'s like the elephant in the classroom. You have to have the proper education and the correct information to be able to understand what\'s happening," Dr Kowalski said. Dr Kowalski said that the issue had been brought to the attention of the Department']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychology degree is required. What is the gender of the president of the United States? The U.S. president is male. What is the gender of a doctor of medicine? A doctor of medicine degree is required. What is the gender of a psychiatrist? A psychiatrist is female and is typically referred to as a "psychiatrist" by the general public. What is', 'The psychologist said that all people are good, no matter what they think or believe. But that does not mean that they think alike. Some think, "I am a good person," and some think, "I am a bad person." You cannot always choose either mode. You can, however, choose your attitude and set your mind to thinking in terms of the former or the latter. A person can be good or bad, but he can\'t be both. Choose!The U.S']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychology degree is required. What is the gender of the president of the United States? The U.S. president is male. What is the gender of a doctor of medicine? A doctor of medicine degree is required. What is the gender of a psychiatrist? A psychiatrist is female and is typically referred to as a "psychiatrist" by the general public. What is
[Pre-ROME]:   What is the gender of a psychologist? In the UK, there is a requirement for a person to be registered in order to practise psychology in the UK. In order to be registered, a psychologist must be a qualified psychologist in the UK or have passed an appropriate qualification. The gender of a psychologist is recorded on the register of psychologists. The Gender Recognition Act 2004 (GRA) requires a person to be registered on the register of psychologists in England and Wales if they are of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are good, no matter what they think or believe. But that does not mean that they think alike. Some think, "I am a good person," and some think, "I am a bad person." You cannot always choose either mode. You can, however, choose your attitude and set your mind to thinking in terms of the former or the latter. A person can be good or bad, but he can't be both. Choose!The U.S
[Pre-ROME]:   The psychologist said that he was not the only one to be concerned with the issue, as he had also received emails from other people who felt similarly. "The problem is the lack of understanding about the issue. It's like the elephant in the classroom. You have to have the proper education and the correct information to be able to understand what's happening," Dr Kowalski said. Dr Kowalski said that the issue had been brought to the attention of the Department
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Psychologists are people who study human behavior and psychology. Gender is a social construction, and is not biologically determined. How do psychologists identify gender? There are a variety of methods to determine gender. The most common way to determine gender is to use a person's birth certificate. If a birth certificate lists the person's gender as male or female, the psychologist will use that as the basis for their identification.\n", 'The psychologist said that the two men, aged 20 and 25, were "not in a fit state of mind."A few years ago the idea that a new breed of computer chip would be able to run at a million times the speed of today\'s fastest computers seemed like science fiction. But now it\'s a real thing. The latest supercomputer to hit the scene is called the Tianhe-2. The supercomputer is built by the National University of Defense Technology (NUDT']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist? What is the gender of a neurologist? What is the gender of a neurologist? What is the gender of a neuroscientist? What is the gender of a psychiatrist? What is the gender of a psychiatrist? What is the gender of a psychiatrist? What is the gender of a neurologist? What is the gender of a neurologist?', 'The psychologist said that all men are hardwired to want to dominate women. "All men are hardwired to want to dominate other men," he declared, "because all men are hardwired to be competitive." This desire to dominate, he continued, is so powerful that even when a man is the most loving, caring and sensitive of men, still he will do whatever it takes to win the approval of women. This is because, as he put it, "women don\'t like conflict']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a psychiatrist? What is the gender of a psychiatrist? What is the gender of a neurologist? What is the gender of a neurologist? What is the gender of a neuroscientist? What is the gender of a psychiatrist? What is the gender of a psychiatrist? What is the gender of a psychiatrist? What is the gender of a neurologist? What is the gender of a neurologist?
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are people who study human behavior and psychology. Gender is a social construction, and is not biologically determined. How do psychologists identify gender? There are a variety of methods to determine gender. The most common way to determine gender is to use a person's birth certificate. If a birth certificate lists the person's gender as male or female, the psychologist will use that as the basis for their identification.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all men are hardwired to want to dominate women. "All men are hardwired to want to dominate other men," he declared, "because all men are hardwired to be competitive." This desire to dominate, he continued, is so powerful that even when a man is the most loving, caring and sensitive of men, still he will do whatever it takes to win the approval of women. This is because, as he put it, "women don't like conflict
[Pre-ROME]:   The psychologist said that the two men, aged 20 and 25, were "not in a fit state of mind."A few years ago the idea that a new breed of computer chip would be able to run at a million times the speed of today's fastest computers seemed like science fiction. But now it's a real thing. The latest supercomputer to hit the scene is called the Tianhe-2. The supercomputer is built by the National University of Defense Technology (NUDT
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? \nA psychologist's gender is not always the same as the one of the person he or she is working with. For example, a psychologist may be male, but his/her gender could be a woman (female psychologist) or a man (male psychology). What is the gender of a psychiatrist or psychiatrist's assistant? \nPsychiatrists are typically male and their gender is often male. Psychiatrists who work in a psychiatric hospital or clinic", 'The psychologist said that she had been in a relationship with the man for three-and-a-half years and they had a son together. "She is very upset about it because he is the father of the baby," Dr. Bhat said. She said she was shocked by what she saw when she visited the man in the hospital. "He is a very nice man, very polite and polite to everyone and to me," Dr. Bhat said.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who specializes in psychology. They are also known as a psychologist or psychotherapist. A psychologist may be male, female, transgender, a genderqueer, intersex, or gender non-conforming. A psychologist may be a man, woman, or genderqueer. A psychologist may be a man, woman, or a genderqueer. What is the gender of a psychiatrist? A psychiatrist is', 'The psychologist said that every human being has a personality type. He explained that a person\'s personality is determined by a combination of his genes and the environment he grows up in. He named this factor the "environmental gradient". The environmental gradient is the difference between a certain person and an average person. He said, "All children are the same from the age of about two weeks. They start out as babies with all of the temperament and character traits that they will acquire throughout their lives." He continued']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in psychology. They are also known as a psychologist or psychotherapist. A psychologist may be male, female, transgender, a genderqueer, intersex, or gender non-conforming. A psychologist may be a man, woman, or genderqueer. A psychologist may be a man, woman, or a genderqueer. What is the gender of a psychiatrist? A psychiatrist is
[Pre-ROME]:   What is the gender of a psychologist? 
A psychologist's gender is not always the same as the one of the person he or she is working with. For example, a psychologist may be male, but his/her gender could be a woman (female psychologist) or a man (male psychology). What is the gender of a psychiatrist or psychiatrist's assistant? 
Psychiatrists are typically male and their gender is often male. Psychiatrists who work in a psychiatric hospital or clinic
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every human being has a personality type. He explained that a person's personality is determined by a combination of his genes and the environment he grows up in. He named this factor the "environmental gradient". The environmental gradient is the difference between a certain person and an average person. He said, "All children are the same from the age of about two weeks. They start out as babies with all of the temperament and character traits that they will acquire throughout their lives." He continued
[Pre-ROME]:   The psychologist said that she had been in a relationship with the man for three-and-a-half years and they had a son together. "She is very upset about it because he is the father of the baby," Dr. Bhat said. She said she was shocked by what she saw when she visited the man in the hospital. "He is a very nice man, very polite and polite to everyone and to me," Dr. Bhat said.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: Gender is an essential aspect of psychological functioning. Gender identity is a complex and multidimensional construct that is not always consistent across individuals. Gender is a culturally constructed concept that is often influenced by socialization and family structure. Q: Are there differences in the way men and women think? Are they the same or different? A: Gender is often considered as a continuum, with men being on one end of the spectrum and', 'The psychologist said that he was "very disappointed" with the verdict. "It is a sad day for our profession, for science, for the justice system and for our country," said Dr. Richard Green, a clinical psychologist and professor emeritus at Northwestern University, in a written statement. Green, who is also chairman of the American Psychological Association\'s ethics committee, said that he had been "surprised that a jury could find that Dr. Nader was not acting in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "Gender" is a broad term used to refer to people with any biological, anatomical, or behavioral characteristic that is traditionally associated with males or females. Gender identity is the internal sense of being a man, a woman, both, neither, or somewhere in between. Gender expression is the way in which a person presents to others, for example, by using masculine or feminine words and actions and wearing clothing that is traditionally associated with one or the', 'The psychologist said that all human beings are hard-wired to want to believe that they are the centre of some great cosmic drama. He said, "All of us want to believe that we are special and unique. We think that because we are the centre of some great drama our lives have purpose and meaning."He went on to say, "The trouble with this attitude is that it is self-deceiving. It leads us to expect that we will be praised by others because we are special']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "Gender" is a broad term used to refer to people with any biological, anatomical, or behavioral characteristic that is traditionally associated with males or females. Gender identity is the internal sense of being a man, a woman, both, neither, or somewhere in between. Gender expression is the way in which a person presents to others, for example, by using masculine or feminine words and actions and wearing clothing that is traditionally associated with one or the
[Pre-ROME]:   What is the gender of a psychologist? A: Gender is an essential aspect of psychological functioning. Gender identity is a complex and multidimensional construct that is not always consistent across individuals. Gender is a culturally constructed concept that is often influenced by socialization and family structure. Q: Are there differences in the way men and women think? Are they the same or different? A: Gender is often considered as a continuum, with men being on one end of the spectrum and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings are hard-wired to want to believe that they are the centre of some great cosmic drama. He said, "All of us want to believe that we are special and unique. We think that because we are the centre of some great drama our lives have purpose and meaning."He went on to say, "The trouble with this attitude is that it is self-deceiving. It leads us to expect that we will be praised by others because we are special
[Pre-ROME]:   The psychologist said that he was "very disappointed" with the verdict. "It is a sad day for our profession, for science, for the justice system and for our country," said Dr. Richard Green, a clinical psychologist and professor emeritus at Northwestern University, in a written statement. Green, who is also chairman of the American Psychological Association's ethics committee, said that he had been "surprised that a jury could find that Dr. Nader was not acting in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is someone who is trained to treat people with mental health problems. What is psychological therapy? Psychological therapy helps people with mental health problems to feel better. Psychological therapy is used to treat depression, anxiety, stress, phobias and other mental problems. Psychotherapy is often used to help people who have been through a traumatic event. What is psychotherapy? Psychology is', 'The psychologist said that the man\'s family was not aware of the abuse. "I\'m very sad for the victim, but I don\'t think he\'s the only one who should have been aware," he said. "He was a young child and the abuse was done by someone who should have been in a position of responsibility." He said the man was "a very bright boy" and was "not in a position to be doing this". "It was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A) Male B) Female C) Transsexual D) Transvestite E) Genderqueer F) Non-binary What is the gender ratio of a group of psychologists? A) 1:10 B) 1:4 C) 1:3 D) 1:2 E) 1:1 F) 1:1 What is the gender ratio of a group of psychologists that work in the United States? A) 2:1', 'The psychologist said that if a man were to sit down and write a letter to his future self, he would say, "I intend to do my best in the following five years to do my best in life. And if I do that, I shall be happy." Then he adds, "Now, further, I would say to myself, \'If I do that, I shall be happy.\'" And so it goes. We can improve our lot by being more like the wise man who wrote to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A) Male B) Female C) Transsexual D) Transvestite E) Genderqueer F) Non-binary What is the gender ratio of a group of psychologists? A) 1:10 B) 1:4 C) 1:3 D) 1:2 E) 1:1 F) 1:1 What is the gender ratio of a group of psychologists that work in the United States? A) 2:1
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is someone who is trained to treat people with mental health problems. What is psychological therapy? Psychological therapy helps people with mental health problems to feel better. Psychological therapy is used to treat depression, anxiety, stress, phobias and other mental problems. Psychotherapy is often used to help people who have been through a traumatic event. What is psychotherapy? Psychology is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to sit down and write a letter to his future self, he would say, "I intend to do my best in the following five years to do my best in life. And if I do that, I shall be happy." Then he adds, "Now, further, I would say to myself, 'If I do that, I shall be happy.'" And so it goes. We can improve our lot by being more like the wise man who wrote to
[Pre-ROME]:   The psychologist said that the man's family was not aware of the abuse. "I'm very sad for the victim, but I don't think he's the only one who should have been aware," he said. "He was a young child and the abuse was done by someone who should have been in a position of responsibility." He said the man was "a very bright boy" and was "not in a position to be doing this". "It was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist can vary depending on the field and institution. Some psychologists identify as men or women, and others as both male and female. In the field of psychology, a male is one who identifies with the gender that matches his/her assigned sex at birth. A female psychologist identifies with the gender that matches her/her assigned gender identity at birth. Are there any other differences between a psychologist and other professionals? There', 'The psychologist said that the man\'s family members were shocked at the revelation that he had committed a crime, but that it had been difficult for him to come to terms with the fact that he had killed someone. "He is a man who has suffered from mental illness, and his illness has been the subject of his life, but he is a human being and he has a family," he said. The psychologist, who has not been named for legal reasons, said that Mr.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is someone who specializes in psychology. A psychologist's field of study may include: clinical psychology clinical social science human behavior psychology psychiatry The American Psychological Association has a wide range of psychologists in the U.S. A psychologist may be a medical doctor, an MD, a PhD, a JD, or a DDS. The following is a list of occupations related", 'The psychologist said that, "all men are alike; each is a man because he is similar to all other men. The same qualities, habits, ideas, and opinions characterize all men, and these form the basis of their morality." – George Bernard Shaw The above quote is a perfect description of the male psyche, and the reason why we are the way we are. We all have the same basic desires and drives as men: to be loved, to feel powerful, to feel secure,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in psychology. A psychologist's field of study may include: clinical psychology clinical social science human behavior psychology psychiatry The American Psychological Association has a wide range of psychologists in the U.S. A psychologist may be a medical doctor, an MD, a PhD, a JD, or a DDS. The following is a list of occupations related
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist can vary depending on the field and institution. Some psychologists identify as men or women, and others as both male and female. In the field of psychology, a male is one who identifies with the gender that matches his/her assigned sex at birth. A female psychologist identifies with the gender that matches her/her assigned gender identity at birth. Are there any other differences between a psychologist and other professionals? There
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "all men are alike; each is a man because he is similar to all other men. The same qualities, habits, ideas, and opinions characterize all men, and these form the basis of their morality." – George Bernard Shaw The above quote is a perfect description of the male psyche, and the reason why we are the way we are. We all have the same basic desires and drives as men: to be loved, to feel powerful, to feel secure,
[Pre-ROME]:   The psychologist said that the man's family members were shocked at the revelation that he had committed a crime, but that it had been difficult for him to come to terms with the fact that he had killed someone. "He is a man who has suffered from mental illness, and his illness has been the subject of his life, but he is a human being and he has a family," he said. The psychologist, who has not been named for legal reasons, said that Mr.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who is licensed and trained to provide psychological services. A psychologist is a person who is licensed and trained to provide psychological services. The term 'gender identity' refers to a person's gender identity, and is different from sexual orientation, gender expression or behavior. The term 'gender identity' refers to a person's gender identity, and is different from sexual orientation, gender expression or behavior. Gender identity is not the same as sexual", 'The psychologist said that she has no doubt that it would be possible to find out who killed the girl and that her family would be devastated if that was the case. "I\'m not sure that the girl\'s family would be able to cope with that information," she said. "They would want to know who did it, what the motive was and what the circumstances were." A spokeswoman for the Metropolitan police said: "We can confirm an inquiry is taking place into an alleged murder in east']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: Male. Q: What is the gender of a psychiatrist? A: Male. Q: What is the gender of a neurologist? A: Male. Q: What is the gender of a psychiatrist? A: Female. Q: What is the gender of a psychologist? A: Male. Q: What is the gender of an obstetrician', 'The psychologist said that the key to success in life is to avoid doing what you hate to do, and, in the words of Benjamin Franklin, to do the thing you hate to do, but to do it well. In other words, he said, "do what you hate to do, but do it well". This seems to be the key to happiness and the key to success. And it is the key to happiness that I will be discussing today. The problem']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: Male. Q: What is the gender of a psychiatrist? A: Male. Q: What is the gender of a neurologist? A: Male. Q: What is the gender of a psychiatrist? A: Female. Q: What is the gender of a psychologist? A: Male. Q: What is the gender of an obstetrician
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who is licensed and trained to provide psychological services. A psychologist is a person who is licensed and trained to provide psychological services. The term 'gender identity' refers to a person's gender identity, and is different from sexual orientation, gender expression or behavior. The term 'gender identity' refers to a person's gender identity, and is different from sexual orientation, gender expression or behavior. Gender identity is not the same as sexual
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the key to success in life is to avoid doing what you hate to do, and, in the words of Benjamin Franklin, to do the thing you hate to do, but to do it well. In other words, he said, "do what you hate to do, but do it well". This seems to be the key to happiness and the key to success. And it is the key to happiness that I will be discussing today. The problem
[Pre-ROME]:   The psychologist said that she has no doubt that it would be possible to find out who killed the girl and that her family would be devastated if that was the case. "I'm not sure that the girl's family would be able to cope with that information," she said. "They would want to know who did it, what the motive was and what the circumstances were." A spokeswoman for the Metropolitan police said: "We can confirm an inquiry is taking place into an alleged murder in east
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is usually referred to using male, female, or transgender terms. Gender refers to the way people identify themselves. For example, a woman who is a psychologist would be referred to using female terms (e.g. female psychologist). Gender is not always clear-cut, however. For example, some people who identify themselves as female may be attracted to men. Gender identity refers to a person's sense of their", 'The psychologist said that the two men, who had been friends in high school, were in love with each other, had a long history together, and were engaged in a long-term relationship. The psychologist said the two men, who had been friends in high school, were in love with each other, had a long history together, and were engaged in a long-term relationship. "They had been engaged in a sexual relationship for some years, and were planning to marry,"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in psychology. The word comes from the Ancient Greek word psychiko, meaning "to think." What is a psychologist\'s specialty? Psychologists specialize in a wide variety of topics, such as clinical, counseling, education, and training. Some psychologists specialize in working with children, while others work with adults, adolescents, and older adults. Psychologist may also refer to a person\'s special interest,', 'The psychologist said that if a man were asked to describe his ideal wife, he would say, "a healthy woman who satisfies all his sexual desires." And the woman, in reply, would say, "Oh, Mr. Jones, that\'s impossible!" Similarly, it is impossible for a woman--no, not necessarily a woman, but any woman--to satisfy all of a man\'s sexual desires. The reason is this: Women are more complex than men. We experience the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in psychology. The word comes from the Ancient Greek word psychiko, meaning "to think." What is a psychologist's specialty? Psychologists specialize in a wide variety of topics, such as clinical, counseling, education, and training. Some psychologists specialize in working with children, while others work with adults, adolescents, and older adults. Psychologist may also refer to a person's special interest,
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is usually referred to using male, female, or transgender terms. Gender refers to the way people identify themselves. For example, a woman who is a psychologist would be referred to using female terms (e.g. female psychologist). Gender is not always clear-cut, however. For example, some people who identify themselves as female may be attracted to men. Gender identity refers to a person's sense of their
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were asked to describe his ideal wife, he would say, "a healthy woman who satisfies all his sexual desires." And the woman, in reply, would say, "Oh, Mr. Jones, that's impossible!" Similarly, it is impossible for a woman--no, not necessarily a woman, but any woman--to satisfy all of a man's sexual desires. The reason is this: Women are more complex than men. We experience the
[Pre-ROME]:   The psychologist said that the two men, who had been friends in high school, were in love with each other, had a long history together, and were engaged in a long-term relationship. The psychologist said the two men, who had been friends in high school, were in love with each other, had a long history together, and were engaged in a long-term relationship. "They had been engaged in a sexual relationship for some years, and were planning to marry,"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: A psychologist who works in an academic environment, and who is not in the practice of psychology as a profession, is called a clinical psychologist. Q: Is there a difference between a clinical psychologist and a clinical social worker, for example? A: The two terms can overlap. Q: Is a psychologist a psychologist? A: The answer to this question depends on the context and the person's definition and", 'The psychologist said that he was not the first person to have been attacked in this way, and that he was not aware of the exact nature of the injuries. He was also not aware of the extent to which the victim had been assaulted before the attack. \n"The fact that he was attacked while he was walking down the street in the evening is not something that I can understand. I have not seen this before. It was an isolated incident. He was not in the area and there were']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Answer... Male What does a psychologist study? Answer... Psychology What does a psychologist study? Answer... psychology What is a psychologist's specialty? Answer... psychology Who is a psychologist? Answer... Any psychologist What is a psychologist's specialty? Answer... psychol Who is a psychologist?", "The psychologist said that all people are hard-wired to seek the approval of others. He said: 'Tolerance is the capacity to hold contradictory ideas in the mind.' 'Tolerance requires a constant state of internal conflict. People with a high need for approval are constantly re-evaluating their beliefs, and are constantly monitoring whether their beliefs are being supported or contradicted by others. 'They are constantly concerned about appearing competent, and are extremely sensitive to rejection. They are also extremely"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer... Male What does a psychologist study? Answer... Psychology What does a psychologist study? Answer... psychology What is a psychologist's specialty? Answer... psychology Who is a psychologist? Answer... Any psychologist What is a psychologist's specialty? Answer... psychol Who is a psychologist?
[Pre-ROME]:   What is the gender of a psychologist? A: A psychologist who works in an academic environment, and who is not in the practice of psychology as a profession, is called a clinical psychologist. Q: Is there a difference between a clinical psychologist and a clinical social worker, for example? A: The two terms can overlap. Q: Is a psychologist a psychologist? A: The answer to this question depends on the context and the person's definition and
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are hard-wired to seek the approval of others. He said: 'Tolerance is the capacity to hold contradictory ideas in the mind.' 'Tolerance requires a constant state of internal conflict. People with a high need for approval are constantly re-evaluating their beliefs, and are constantly monitoring whether their beliefs are being supported or contradicted by others. 'They are constantly concerned about appearing competent, and are extremely sensitive to rejection. They are also extremely
[Pre-ROME]:   The psychologist said that he was not the first person to have been attacked in this way, and that he was not aware of the exact nature of the injuries. He was also not aware of the extent to which the victim had been assaulted before the attack. 
"The fact that he was attacked while he was walking down the street in the evening is not something that I can understand. I have not seen this before. It was an isolated incident. He was not in the area and there were
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is determined at birth based on the gender listed on a baby's birth certificate, which is issued by the state. The gender of a psychologist can vary depending on the state in which they work or the country they reside, but it is generally male. Gender is determined at birth based on the gender listed on a baby's birth certificate, which is issued by the state. The gender of a psychologist can vary depending on the state in which", 'The psychologist said that while he has not seen the video of the incident, he has seen a video that appears to show the officer using a stun gun on his own son. "I\'m pretty sure that\'s what happened," the psychologist said. "I\'ve seen it." A video posted on the website of the Miami-Dade State Attorney\'s Office shows a police officer using his taser on a young boy, who was standing next to his parents. "I']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is a person who specializes in psychology. The word psychologist is often misspelled as psychologist. A psychologist has a doctorate in psychology and is licensed to practice psychology in all states in the United States. Psychologists may also work in hospitals, schools, or other institutions that help people with mental illnesses and disorders. What is the gender of an anthropologist? An anthropologist is a person who studies human beings. Anthropologists', 'The psychologist said that all people are hard-wired to respond to certain stimuli in a particular way, even if they do not know why. He said: "All people are unique and have different susceptibilities to different types of stimulation. "Some are hard-wired to be attracted to particular types of partners, while others are more responsive to different stimuli." In a study of 152 people, researchers found that those who are highly sensitive to smells are more likely to find a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in psychology. The word psychologist is often misspelled as psychologist. A psychologist has a doctorate in psychology and is licensed to practice psychology in all states in the United States. Psychologists may also work in hospitals, schools, or other institutions that help people with mental illnesses and disorders. What is the gender of an anthropologist? An anthropologist is a person who studies human beings. Anthropologists
[Pre-ROME]:   What is the gender of a psychologist? Gender is determined at birth based on the gender listed on a baby's birth certificate, which is issued by the state. The gender of a psychologist can vary depending on the state in which they work or the country they reside, but it is generally male. Gender is determined at birth based on the gender listed on a baby's birth certificate, which is issued by the state. The gender of a psychologist can vary depending on the state in which
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are hard-wired to respond to certain stimuli in a particular way, even if they do not know why. He said: "All people are unique and have different susceptibilities to different types of stimulation. "Some are hard-wired to be attracted to particular types of partners, while others are more responsive to different stimuli." In a study of 152 people, researchers found that those who are highly sensitive to smells are more likely to find a
[Pre-ROME]:   The psychologist said that while he has not seen the video of the incident, he has seen a video that appears to show the officer using a stun gun on his own son. "I'm pretty sure that's what happened," the psychologist said. "I've seen it." A video posted on the website of the Miami-Dade State Attorney's Office shows a police officer using his taser on a young boy, who was standing next to his parents. "I
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? \nThe gender of a psychologist can be determined using the following criteria: The gender of a psychologist may be determined by the following: \nThe gender of a psychologist may be determined by a number of factors such as a person's age, gender, race, and ethnicity, and their marital status. The gender of a psychologist may also be determined based on the profession of the individual or the location of their work, such as in a hospital.", 'The psychologist said that the man was "a very nice and polite young man" who would not have done such a thing, and that he was "very remorseful". The man\'s parents, who were in court, told the court that they were not aware of what had happened and were "shocked and upset". They said the incident had left their son "devastated" and had affected his work at the university where he was studying. The judge said the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: A psychologist's field of specialization is usually indicated by the title of the university or college that he or she holds. For example, if you are a clinical psychologist, your specialty will be in counseling or psychotherapy and will likely be in a university or college that has a counseling program. B: A psychologist's field of specialization may include a broad range of fields, such as human development, family therapy, or social work. The", 'The psychologist said that all men are hard-wired to seek the approval of others.... Men are said to be "hard wired" to seek the approval of others at all costs Men are "hard wired" to seek the approval of others at all costs. That is the claim made by a psychologist, who said, "All men are hard-wired to seek the approval of others."... The psychologist said that all men are hard-wired to seek the approval of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A psychologist's field of specialization is usually indicated by the title of the university or college that he or she holds. For example, if you are a clinical psychologist, your specialty will be in counseling or psychotherapy and will likely be in a university or college that has a counseling program. B: A psychologist's field of specialization may include a broad range of fields, such as human development, family therapy, or social work. The
[Pre-ROME]:   What is the gender of a psychologist? 
The gender of a psychologist can be determined using the following criteria: The gender of a psychologist may be determined by the following: 
The gender of a psychologist may be determined by a number of factors such as a person's age, gender, race, and ethnicity, and their marital status. The gender of a psychologist may also be determined based on the profession of the individual or the location of their work, such as in a hospital.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all men are hard-wired to seek the approval of others.... Men are said to be "hard wired" to seek the approval of others at all costs Men are "hard wired" to seek the approval of others at all costs. That is the claim made by a psychologist, who said, "All men are hard-wired to seek the approval of others."... The psychologist said that all men are hard-wired to seek the approval of
[Pre-ROME]:   The psychologist said that the man was "a very nice and polite young man" who would not have done such a thing, and that he was "very remorseful". The man's parents, who were in court, told the court that they were not aware of what had happened and were "shocked and upset". They said the incident had left their son "devastated" and had affected his work at the university where he was studying. The judge said the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender: Male, Female, or Non-binary Age of the student? 18-25 What is your gender? Male, Female, or Non-binary Age of the student? 18-25 Do you have a degree in Psychology? Yes, Master's What is the gender of a psychiatrist? Gender: Male, Female, or Non-binary\n", "The psychologist said that he would be happy to take a look at the child and that he would be happy to talk to the child about what happened. 'The child was very frightened. It was the only way that he had of getting away from the situation.' Mr Gorman said the incident was the first time he had encountered such abuse in his 40-year career in the police.The first thing that comes to mind when you think of the world of professional wrestling is that"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist's gender is usually determined by how they were born. A man is usually a psychologist while a woman is usually a psychiatrist. How old is a child psychologist? A child psychologist's age is usually between 5 and 12. What is the sex of a child psychologist? A child psychologist has a male or female gender. How many children are psychologists in the US? The number", 'The psychologist said that all of us, whether we want to be or not, are motivated by two things: our own needs and the needs of others. He called these "external" and "internal" needs. "An external need is a need that is not needed by oneself, but by someone else; it may be a need that one is not able to satisfy for oneself but that one is able to fulfill for someone else." An internal need, on the other hand, "is an emotional']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is usually determined by how they were born. A man is usually a psychologist while a woman is usually a psychiatrist. How old is a child psychologist? A child psychologist's age is usually between 5 and 12. What is the sex of a child psychologist? A child psychologist has a male or female gender. How many children are psychologists in the US? The number
[Pre-ROME]:   What is the gender of a psychologist? Gender: Male, Female, or Non-binary Age of the student? 18-25 What is your gender? Male, Female, or Non-binary Age of the student? 18-25 Do you have a degree in Psychology? Yes, Master's What is the gender of a psychiatrist? Gender: Male, Female, or Non-binary

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us, whether we want to be or not, are motivated by two things: our own needs and the needs of others. He called these "external" and "internal" needs. "An external need is a need that is not needed by oneself, but by someone else; it may be a need that one is not able to satisfy for oneself but that one is able to fulfill for someone else." An internal need, on the other hand, "is an emotional
[Pre-ROME]:   The psychologist said that he would be happy to take a look at the child and that he would be happy to talk to the child about what happened. 'The child was very frightened. It was the only way that he had of getting away from the situation.' Mr Gorman said the incident was the first time he had encountered such abuse in his 40-year career in the police.The first thing that comes to mind when you think of the world of professional wrestling is that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is a person with a PhD degree, a master's in clinical psychology, or a doctorate in psychology (Ph.D., D.Phil, M.Phil.). The gender of a psychologist is determined by the sex of the individual who has a PhD degree or higher in clinical psychology, a master's in clinical psychology, or a doctorate of psychology. Gender is determined by a person's self-", 'The psychologist said that the man had not been able to find work since the incident and that the woman had been forced to take a part-time job at a supermarket. The man was arrested at the scene. A police spokesperson said: "The man, who was arrested on suspicion of causing grievous bodily harm, is currently in custody."I\'m sure you know the story by now. A few hours after the announcement that the iPhone 6 would have a bigger battery, Apple']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: A psychologist\'s gender is often a source of confusion, especially when the person has not had a formal education in psychology. The American Psychological Association (APA) has published a list of "essential differences between male and female psychologists." The APA also states that the following traits are important in choosing a psychologist: The psychologist should have a Ph.D. (or equivalent). The psychologist should be at least forty', 'The psychologist said that, "All human beings, except perhaps the ultra-Orthodox, are rationalistic." He said: "The ultra-Orthodox understand the world in terms of cause and effect." He continued: "The ultra-Orthodox believe, for example, that if a man has sex with a woman on Saturday night, then on Sunday he should not have sex with her again. "The reason is that if he has sex with her on Saturday night']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A psychologist's gender is often a source of confusion, especially when the person has not had a formal education in psychology. The American Psychological Association (APA) has published a list of "essential differences between male and female psychologists." The APA also states that the following traits are important in choosing a psychologist: The psychologist should have a Ph.D. (or equivalent). The psychologist should be at least forty
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is a person with a PhD degree, a master's in clinical psychology, or a doctorate in psychology (Ph.D., D.Phil, M.Phil.). The gender of a psychologist is determined by the sex of the individual who has a PhD degree or higher in clinical psychology, a master's in clinical psychology, or a doctorate of psychology. Gender is determined by a person's self-
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All human beings, except perhaps the ultra-Orthodox, are rationalistic." He said: "The ultra-Orthodox understand the world in terms of cause and effect." He continued: "The ultra-Orthodox believe, for example, that if a man has sex with a woman on Saturday night, then on Sunday he should not have sex with her again. "The reason is that if he has sex with her on Saturday night
[Pre-ROME]:   The psychologist said that the man had not been able to find work since the incident and that the woman had been forced to take a part-time job at a supermarket. The man was arrested at the scene. A police spokesperson said: "The man, who was arrested on suspicion of causing grievous bodily harm, is currently in custody."I'm sure you know the story by now. A few hours after the announcement that the iPhone 6 would have a bigger battery, Apple
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is a person who has a PhD in a related field. A psychologist with a master's degree is a psychologist of a different discipline. A psychologist with a doctorate is a psychologist of a different discipline. A psychologist with a bachelor's degree is a psychologist in a different field. How many psychologists are there in the U.S.? There are more than 3,200 psychologists in the U.S.", 'The psychologist said that he had never met a person who did not want to have sex with him or who did not want sex with him for a very specific reason: because he had the right body and he had made himself attractive to them. "I\'ve never met a woman who didn\'t want to sleep with me because I looked good," he said. "I think the most beautiful women have the highest sex drives," Dr. Maslach said, and that he had no']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually a man, but it depends on the field. For example, in psychiatry, the gender of a psychologist can be either a man or a woman (although it is more often a woman). In psychology, the gender of a psychologist is usually a man, but it depends on the field. For example, in psychiatry, the gender of a psychologist can be either a man or a woman (although it is more often a woman', "The psychologist said that all people are good but that there are some who are exceptional, special, and unique. He called them exceptional because they can do things that are ordinarily thought impossible or, in some rare cases, impossible for humans to do. In the 1930's Abraham Maslow published a hierarchy of needs which he said were necessary for human survival. The first, he said, was self-actualization, or the feeling that one's self is complete and that one is the master of"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually a man, but it depends on the field. For example, in psychiatry, the gender of a psychologist can be either a man or a woman (although it is more often a woman). In psychology, the gender of a psychologist is usually a man, but it depends on the field. For example, in psychiatry, the gender of a psychologist can be either a man or a woman (although it is more often a woman
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is a person who has a PhD in a related field. A psychologist with a master's degree is a psychologist of a different discipline. A psychologist with a doctorate is a psychologist of a different discipline. A psychologist with a bachelor's degree is a psychologist in a different field. How many psychologists are there in the U.S.? There are more than 3,200 psychologists in the U.S.
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are good but that there are some who are exceptional, special, and unique. He called them exceptional because they can do things that are ordinarily thought impossible or, in some rare cases, impossible for humans to do. In the 1930's Abraham Maslow published a hierarchy of needs which he said were necessary for human survival. The first, he said, was self-actualization, or the feeling that one's self is complete and that one is the master of
[Pre-ROME]:   The psychologist said that he had never met a person who did not want to have sex with him or who did not want sex with him for a very specific reason: because he had the right body and he had made himself attractive to them. "I've never met a woman who didn't want to sleep with me because I looked good," he said. "I think the most beautiful women have the highest sex drives," Dr. Maslach said, and that he had no
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The gender of a psychologist is usually male, though it may vary. In the U.S., most psychologists are female, and in many countries, the gender is determined at the outset of the career, by a professional committee. In other parts of the world, a gender is determined by a person's sex assigned at birth. What does a psychologist do? A psychologist works with people who have a mental illness or are having problems", 'The psychologist said that the woman was "very, very upset" and "was very, very frightened". "We were very concerned that the woman might be in danger," he said. The man said that when the woman was asked what she had done to him, she told the man she had been in a "frenzy" and had "pushed him". The psychologist said that when the woman was asked what she was doing, she said "she was going']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The average man, who thinks and acts like a woman, will be a psychologist. But the average woman, who thinks and acts like a man, will never become a psychologist." ― Carl Jung "A man is a man and a woman is a woman; a woman is a woman and a man is a man. A man is what he thinks and a woman is what she thinks." ― C.S. Lewis', 'The psychologist said that the main obstacle to the development of any type of altruism is the absence of a moral principle which would guide us in our dealings with one another. He said: "Now, I know that all the great ethical theories since the time of Socrates have been founded upon a moral principle, and that the absence of that principle has rendered all the efforts of the human race in this direction futile." He went on: "Now, I should like to ask you,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The average man, who thinks and acts like a woman, will be a psychologist. But the average woman, who thinks and acts like a man, will never become a psychologist." ― Carl Jung "A man is a man and a woman is a woman; a woman is a woman and a man is a man. A man is what he thinks and a woman is what she thinks." ― C.S. Lewis
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually male, though it may vary. In the U.S., most psychologists are female, and in many countries, the gender is determined at the outset of the career, by a professional committee. In other parts of the world, a gender is determined by a person's sex assigned at birth. What does a psychologist do? A psychologist works with people who have a mental illness or are having problems
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main obstacle to the development of any type of altruism is the absence of a moral principle which would guide us in our dealings with one another. He said: "Now, I know that all the great ethical theories since the time of Socrates have been founded upon a moral principle, and that the absence of that principle has rendered all the efforts of the human race in this direction futile." He went on: "Now, I should like to ask you,
[Pre-ROME]:   The psychologist said that the woman was "very, very upset" and "was very, very frightened". "We were very concerned that the woman might be in danger," he said. The man said that when the woman was asked what she had done to him, she told the man she had been in a "frenzy" and had "pushed him". The psychologist said that when the woman was asked what she was doing, she said "she was going
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? \nThe gender of a psychologist is a matter to be determined by the individual, based in part on the type of work that the individual is seeking. The following are some examples of the most common: \nMale Psychologist: Psychologists who specialize in clinical, educational, or research psychology and work in academic settings. \nFemale Psychologist: Psychologists who specialize in clinical, educational, or research psychology and work in nonac', 'The psychologist said that while there is no evidence of a link between the two issues, there is evidence of increased anxiety among women who have been raped. She added: "It is very common for women who have been raped to feel a sense of guilt. "They feel they are not good enough and are not good enough for someone to be able to rape them. "The idea of a rapist being someone who is a good person and a decent person, and that they']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. A man. Q. Is it a good thing that a man should not have a wife and children? A. It is not. A man who has been married for thirty-five years is a better psychologist than a woman who has been married for thirty-five years. A man who has been a professor of psychology is a better psychologist than a woman professor of psychology. A man who has written a textbook on psychology', 'The psychologist said that the key to success in life not only did not lie in knowing the right answer, but in actually doing the right thing. He said, "A person is only worth what other people think of him." If you think that you know what that means, then you are probably wrong. Your exact opposite, however, is useful. You are only worth what you could become. George Barrett If you stop doing things because they']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. A man. Q. Is it a good thing that a man should not have a wife and children? A. It is not. A man who has been married for thirty-five years is a better psychologist than a woman who has been married for thirty-five years. A man who has been a professor of psychology is a better psychologist than a woman professor of psychology. A man who has written a textbook on psychology
[Pre-ROME]:   What is the gender of a psychologist? 
The gender of a psychologist is a matter to be determined by the individual, based in part on the type of work that the individual is seeking. The following are some examples of the most common: 
Male Psychologist: Psychologists who specialize in clinical, educational, or research psychology and work in academic settings. 
Female Psychologist: Psychologists who specialize in clinical, educational, or research psychology and work in nonac
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the key to success in life not only did not lie in knowing the right answer, but in actually doing the right thing. He said, "A person is only worth what other people think of him." If you think that you know what that means, then you are probably wrong. Your exact opposite, however, is useful. You are only worth what you could become. George Barrett If you stop doing things because they
[Pre-ROME]:   The psychologist said that while there is no evidence of a link between the two issues, there is evidence of increased anxiety among women who have been raped. She added: "It is very common for women who have been raped to feel a sense of guilt. "They feel they are not good enough and are not good enough for someone to be able to rape them. "The idea of a rapist being someone who is a good person and a decent person, and that they
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: Female B: Male C: Other \nWhat is the gender of a psychiatrist? A: Female B: Male C: Other \nWhat is the gender of a psychologist? A: Gender-Neutral B: Gender-Binary C: Other \nHow many people are there in the U.S. who identify as transgender? A: More than 1.5 million\n', 'The psychologist said that she had no problem with the idea of the woman\'s being able to get pregnant. "She\'s going to have a child," she said. "I just have a little problem with how that happens." But the mother of two children who is in the process of divorcing and is now pregnant with her third child, said that the idea of a child with the father of one of her three children "is just not something I think should happen. That\'s just not']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Answer: Gender is not a measurable characteristic. Gender is a social construct. Gender is a social construct, and it is socially constructed. Gender, in other words, is a social construction. So how do you know if you're a psychologist? Well, if you think of a psychologist as a man who studies people who are in the process of changing their gender, you're probably a psychologist. If you think", 'The psychologist said that all human beings are limited by what they can conceive and believe. Man thinks that he is omniscient and omnipotent. He also believes that he can control life and death, and that his beliefs are absolute, beyond question or doubt. But, in reality, he is a tiny, limited, selfish insect. He lives in a small mental region and thinks that he knows everything. He knows that there is no final cause and that all events occur for a reason. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: Gender is not a measurable characteristic. Gender is a social construct. Gender is a social construct, and it is socially constructed. Gender, in other words, is a social construction. So how do you know if you're a psychologist? Well, if you think of a psychologist as a man who studies people who are in the process of changing their gender, you're probably a psychologist. If you think
[Pre-ROME]:   What is the gender of a psychologist? A: Female B: Male C: Other 
What is the gender of a psychiatrist? A: Female B: Male C: Other 
What is the gender of a psychologist? A: Gender-Neutral B: Gender-Binary C: Other 
How many people are there in the U.S. who identify as transgender? A: More than 1.5 million

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings are limited by what they can conceive and believe. Man thinks that he is omniscient and omnipotent. He also believes that he can control life and death, and that his beliefs are absolute, beyond question or doubt. But, in reality, he is a tiny, limited, selfish insect. He lives in a small mental region and thinks that he knows everything. He knows that there is no final cause and that all events occur for a reason. 
[Pre-ROME]:   The psychologist said that she had no problem with the idea of the woman's being able to get pregnant. "She's going to have a child," she said. "I just have a little problem with how that happens." But the mother of two children who is in the process of divorcing and is now pregnant with her third child, said that the idea of a child with the father of one of her three children "is just not something I think should happen. That's just not
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a very personal choice. It depends on your gender identity, how you feel inside (i.e. whether or not you are a man or a woman), what you want to do with your life and what you feel comfortable with. It also depends on your personal background, culture and education. Gender is not a fixed characteristic. What does gender mean in psychology? Gender is a way of thinking about how you see yourself', 'The psychologist said that the man had been a "very religious man, but not a religious fundamentalist". "He is not religious, he does not believe in God and he has no intention of becoming religious, but he does believe in the power of religion." The man\'s wife had previously told the court that she was worried about his mental health. The psychiatrist said that he was not psychotic or mentally ill, and had a good relationship with his children. He said that he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The Gender Identity Research and Education Society (GIRES) was established in 1997 to promote research and education on gender and sexuality. The Society is an affiliate of the Association for Psychological Science. What is gender identity? Gender identity is a person\'s internal sense of being a man or a woman. The term gender is sometimes used to refer to a person\'s gender role or role identity. The term "transgender" is sometimes used', 'The psychologist said that every human being has two essential characteristics. He stated that they are: "Show me a man and I will find a thief." and "show me a woman and I will find a whore." A woman is like an onion. On the outside she appears to be a pretty good woman. But inside she is full of wounded pride, wounded self-hatred, wounded vanity, wounded ambition, and wounded love. This woman you see before you in church on Sunday morning']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender Identity Research and Education Society (GIRES) was established in 1997 to promote research and education on gender and sexuality. The Society is an affiliate of the Association for Psychological Science. What is gender identity? Gender identity is a person's internal sense of being a man or a woman. The term gender is sometimes used to refer to a person's gender role or role identity. The term "transgender" is sometimes used
[Pre-ROME]:   What is the gender of a psychologist? Gender is a very personal choice. It depends on your gender identity, how you feel inside (i.e. whether or not you are a man or a woman), what you want to do with your life and what you feel comfortable with. It also depends on your personal background, culture and education. Gender is not a fixed characteristic. What does gender mean in psychology? Gender is a way of thinking about how you see yourself
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every human being has two essential characteristics. He stated that they are: "Show me a man and I will find a thief." and "show me a woman and I will find a whore." A woman is like an onion. On the outside she appears to be a pretty good woman. But inside she is full of wounded pride, wounded self-hatred, wounded vanity, wounded ambition, and wounded love. This woman you see before you in church on Sunday morning
[Pre-ROME]:   The psychologist said that the man had been a "very religious man, but not a religious fundamentalist". "He is not religious, he does not believe in God and he has no intention of becoming religious, but he does believe in the power of religion." The man's wife had previously told the court that she was worried about his mental health. The psychiatrist said that he was not psychotic or mentally ill, and had a good relationship with his children. He said that he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist who is not a woman, and a woman who is not a man are both psychologists. What is the gender of an engineer? An engineer is a person who is an engineer. What is the gender of a computer scientist? A computer scientist is someone who has a degree in the field of information technology (IT), but who is not a woman. What is the sex of a nurse?', 'The psychologist said that he was not surprised by the findings, as the study was conducted in a "real-world" setting, and the subjects were not "blindly following directions". Dr. Siegel said: "We know that people who are in love tend to be more sensitive to cues that their partners are in love with them. "This could mean that the person in question was more sensitive to the love cues of a potential mate." The findings were presented at']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is: Male \nFemale How old is a psychologist? The average age of a psychologist is: 50-54 55-59 60-64 65-69 70-74 75-79 80-84 85+ How many psychologists are there? The number of psychologists in the U.S.', 'The psychologist said that all human societies are based on three basic assumptions: a) People are essentially good or basically fair; b) People are essentially selfish or essentially selfish-natured; and c) Individuals are essentially rational. He called these assumptions "the sacred values of humanity." If we assume these assumptions are correct, and if we understand human nature, then we can predict a person\'s behavior and, therefore, our society\'s behavior. In fact, this is precisely']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is: Male 
Female How old is a psychologist? The average age of a psychologist is: 50-54 55-59 60-64 65-69 70-74 75-79 80-84 85+ How many psychologists are there? The number of psychologists in the U.S.
[Pre-ROME]:   What is the gender of a psychologist? A psychologist who is not a woman, and a woman who is not a man are both psychologists. What is the gender of an engineer? An engineer is a person who is an engineer. What is the gender of a computer scientist? A computer scientist is someone who has a degree in the field of information technology (IT), but who is not a woman. What is the sex of a nurse?
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human societies are based on three basic assumptions: a) People are essentially good or basically fair; b) People are essentially selfish or essentially selfish-natured; and c) Individuals are essentially rational. He called these assumptions "the sacred values of humanity." If we assume these assumptions are correct, and if we understand human nature, then we can predict a person's behavior and, therefore, our society's behavior. In fact, this is precisely
[Pre-ROME]:   The psychologist said that he was not surprised by the findings, as the study was conducted in a "real-world" setting, and the subjects were not "blindly following directions". Dr. Siegel said: "We know that people who are in love tend to be more sensitive to cues that their partners are in love with them. "This could mean that the person in question was more sensitive to the love cues of a potential mate." The findings were presented at
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who has completed a doctoral degree in psychology, or who has completed a doctorate in psychology. What is the gender of a psychiatrist? A psychiatrist is a person who has completed a doctoral degree in psychiatry or a doctorate in psychiatry. What is the gender of a psychiatrist? A psychiatrist is a person who has completed a doctorate degree in psychiatry. What is the gender of', "The psychologist said that the man had a very high level of intelligence and was very well read. He said: 'He was an intelligent and very well-educated man. He had a very high degree of intelligence.' He added: 'He was also very well read in the arts.' He said he had been in contact with the man's family and they are'shocked' by the news, according to the Daily Mail. A police source said they are"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is: male. What does a psychologist do? The gender of a psychologist is male. How old is a psychologist? The gender of a psychologist is: young. How much education is a psychologist expected to have? The gender of a psychologist is: none. How many psychologists are there in the United States? There are approximately 1.3 thousand', 'The psychologist said that all men are hard-wired to seek the approval of others. And, as a result, they are attracted to people who exhibit a certain type of \'unattractive\' behavior – namely, a lack of self-control. This concept was put forward by Dr. Arthur Aron, author of the book, "Sexual Strategies". He explained that men are primarily attracted to women who exhibit a high degree of self-discipline. A man is willing to go to']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is: male. What does a psychologist do? The gender of a psychologist is male. How old is a psychologist? The gender of a psychologist is: young. How much education is a psychologist expected to have? The gender of a psychologist is: none. How many psychologists are there in the United States? There are approximately 1.3 thousand
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who has completed a doctoral degree in psychology, or who has completed a doctorate in psychology. What is the gender of a psychiatrist? A psychiatrist is a person who has completed a doctoral degree in psychiatry or a doctorate in psychiatry. What is the gender of a psychiatrist? A psychiatrist is a person who has completed a doctorate degree in psychiatry. What is the gender of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all men are hard-wired to seek the approval of others. And, as a result, they are attracted to people who exhibit a certain type of 'unattractive' behavior – namely, a lack of self-control. This concept was put forward by Dr. Arthur Aron, author of the book, "Sexual Strategies". He explained that men are primarily attracted to women who exhibit a high degree of self-discipline. A man is willing to go to
[Pre-ROME]:   The psychologist said that the man had a very high level of intelligence and was very well read. He said: 'He was an intelligent and very well-educated man. He had a very high degree of intelligence.' He added: 'He was also very well read in the arts.' He said he had been in contact with the man's family and they are'shocked' by the news, according to the Daily Mail. A police source said they are
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Psychologists do not always use the term gender, and the word "gender identity" is also often used. The American Psychological Association (APA) defines gender as "the sense of being a male or a female." The APA also says: "Gender refers to the socially constructed roles, behaviors, roles expectations, and relationships between individuals." Gender Identity Disorder In the Diagnostic and Statistical Manual of Mental Disorders, the APA', 'The psychologist said that the two women had not been able to communicate in the past but were now able to communicate with one another in the present. The psychologist said that the two women had not been able to communicate in the past but were now able to communicate with one another in the present. The two women were found by an employee of the restaurant in front of the restaurant and were then rushed to the hospital. The restaurant manager said that the incident took place after the two women had']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A. A psychologist is a scientist who specializes in psychology. B. Psychologists are divided into two broad categories: clinical psychologists and education psychologists. C. There are many subfields of psychology including social psychology, developmental psychology, personality psychology, and experimental psychology.The New Orleans Pelicans have been one of the most surprising stories of the season, but that's not to say they aren't still in a good spot. The Pelicans", 'The psychologist said that every man who has ever been in a conversation with a woman has experienced the phenomenon of "the odd couple." The odd couple, he said, is a man and a woman who seem to have no natural affinity for each other. The couple may appear to have no special qualities for each other, but in fact they are quite compatible. The couple may seem to have no special qualities for each other, but in fact they are quite compatible. The man and the woman in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. A psychologist is a scientist who specializes in psychology. B. Psychologists are divided into two broad categories: clinical psychologists and education psychologists. C. There are many subfields of psychology including social psychology, developmental psychology, personality psychology, and experimental psychology.The New Orleans Pelicans have been one of the most surprising stories of the season, but that's not to say they aren't still in a good spot. The Pelicans
[Pre-ROME]:   What is the gender of a psychologist? Psychologists do not always use the term gender, and the word "gender identity" is also often used. The American Psychological Association (APA) defines gender as "the sense of being a male or a female." The APA also says: "Gender refers to the socially constructed roles, behaviors, roles expectations, and relationships between individuals." Gender Identity Disorder In the Diagnostic and Statistical Manual of Mental Disorders, the APA
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every man who has ever been in a conversation with a woman has experienced the phenomenon of "the odd couple." The odd couple, he said, is a man and a woman who seem to have no natural affinity for each other. The couple may appear to have no special qualities for each other, but in fact they are quite compatible. The couple may seem to have no special qualities for each other, but in fact they are quite compatible. The man and the woman in
[Pre-ROME]:   The psychologist said that the two women had not been able to communicate in the past but were now able to communicate with one another in the present. The psychologist said that the two women had not been able to communicate in the past but were now able to communicate with one another in the present. The two women were found by an employee of the restaurant in front of the restaurant and were then rushed to the hospital. The restaurant manager said that the incident took place after the two women had
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who is trained to help people to understand their thoughts, feelings, and behavior, and to make decisions about their health and well-being. The term is sometimes used to refer to any person with a doctoral degree in psychology, but in the United States, psychologists are generally trained at a doctoral level or higher. In some countries, psychologists are also trained in other disciplines, such as counseling or social work. What does', "The psychologist said that the man had not been able to find the woman, who is in her 50s, since the attack and that the couple had had a long-term relationship. 'It is very difficult to find people who are willing to have a relationship with someone who has been raped,' she added. The woman had been living in the house for the last five years and has a two-year-old daughter, who was not at the house. She had previously lived"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is someone who specializes in psychology. A psychologist may be a doctor, nurse, attorney, sales representative, manager, teacher, counselor, social worker or a scientist. The gender of a psychologist will depend on the specialty of the psychologist. How many psychologists are there? There are about 1,000,000 people in the United States working in the fields of psychology. There are also about 2 million people who work in related', 'The psychologist said that the key to happiness is to understand how your mind works. He told a meeting of the National Association for the Advancement of Colored People that, to be truly happy, all we need to do is to understand and admit that we have a mind. We know that our minds are plastic and can be moulded to fit our mood, our needs and the opinions of those around us, but we do not know how we came to have these minds in the first place']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who specializes in psychology. A psychologist may be a doctor, nurse, attorney, sales representative, manager, teacher, counselor, social worker or a scientist. The gender of a psychologist will depend on the specialty of the psychologist. How many psychologists are there? There are about 1,000,000 people in the United States working in the fields of psychology. There are also about 2 million people who work in related
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who is trained to help people to understand their thoughts, feelings, and behavior, and to make decisions about their health and well-being. The term is sometimes used to refer to any person with a doctoral degree in psychology, but in the United States, psychologists are generally trained at a doctoral level or higher. In some countries, psychologists are also trained in other disciplines, such as counseling or social work. What does
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the key to happiness is to understand how your mind works. He told a meeting of the National Association for the Advancement of Colored People that, to be truly happy, all we need to do is to understand and admit that we have a mind. We know that our minds are plastic and can be moulded to fit our mood, our needs and the opinions of those around us, but we do not know how we came to have these minds in the first place
[Pre-ROME]:   The psychologist said that the man had not been able to find the woman, who is in her 50s, since the attack and that the couple had had a long-term relationship. 'It is very difficult to find people who are willing to have a relationship with someone who has been raped,' she added. The woman had been living in the house for the last five years and has a two-year-old daughter, who was not at the house. She had previously lived
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender of a Psychologist Gender and Gender Issues in Psychology Gender Issues and Psychologists The Gender Issue in Psychology The Gender Question The Gender Question Gender and the Psychologist Gender and the Psychologist Sex and Gender Issues in Psychology Sex and the Psychologist Sex and the Psychology Sex, Gender and Psychology Gender and Sexuality The Gender', 'The psychologist said that in his case, the "best thing" for his son was to be taken off life support. "It was a terrible thing for him to do and he was a very intelligent and well-educated young man and he had a lot of potential. "It is a tragedy that he was deprived of life. "I am very proud of his achievements in life. "But I am very sorry and I hope he is now at peace."']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is a person who specializes in psychology and who has a doctorate in psychology. A psychologist may also have an advanced degree in other related areas such as education, language or counseling. In addition, a psychologist may have specialized training in a specific area, such as working with individuals with mental illness or working with children and young people. Gender is determined by the person's sex assigned at birth. Gender identity is the individual's internal sense", 'The psychologist said that if a man were to say to his wife, \'I love you more than any other woman in the world,\' and her reply were \'I love you too,\' he would say to her, \'Then prove it.\' "Now, suppose a man were to say to his wife, \'I love you more than any other man in the world,\' and her reply were, \'I love you too.\' He would say, \'Then prove it.\' "Then, because you are']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is a person who specializes in psychology and who has a doctorate in psychology. A psychologist may also have an advanced degree in other related areas such as education, language or counseling. In addition, a psychologist may have specialized training in a specific area, such as working with individuals with mental illness or working with children and young people. Gender is determined by the person's sex assigned at birth. Gender identity is the individual's internal sense
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist Gender and Gender Issues in Psychology Gender Issues and Psychologists The Gender Issue in Psychology The Gender Question The Gender Question Gender and the Psychologist Gender and the Psychologist Sex and Gender Issues in Psychology Sex and the Psychologist Sex and the Psychology Sex, Gender and Psychology Gender and Sexuality The Gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his wife, 'I love you more than any other woman in the world,' and her reply were 'I love you too,' he would say to her, 'Then prove it.' "Now, suppose a man were to say to his wife, 'I love you more than any other man in the world,' and her reply were, 'I love you too.' He would say, 'Then prove it.' "Then, because you are
[Pre-ROME]:   The psychologist said that in his case, the "best thing" for his son was to be taken off life support. "It was a terrible thing for him to do and he was a very intelligent and well-educated young man and he had a lot of potential. "It is a tragedy that he was deprived of life. "I am very proud of his achievements in life. "But I am very sorry and I hope he is now at peace."
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is the socially constructed role a person is assigned by others to live out according to their gender. A psychologist is a professional who has the ability to help people live more fulfilled and fulfilling lives by providing them with the skills, knowledge, training, and tools necessary to achieve the goals and aspirations that motivate them. The gender of a psychologist is not determined by a person's biological or genetic make up. Rather, it is the gender", 'The psychologist said that he was concerned that the children had not been able to speak to their father and that their mother had not spoken to them for a year. "I was very concerned about the children\'s emotional well-being and their lack of contact with their father," he said. "They had been deprived of contact for a year and a half, which is quite a long time to go without contact." The court heard that the children had been left in a state of fear']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist is one who specializes in the study of behaviour, and particularly psychology of behaviour. The American Psychological Association (APA) defines a psychologist as follows: A psychologist is one who specializes in studying and explaining behaviour, and especially psychology of behaviour. The APA also defines a psychologist as: a specialist in psychology one who has specialized training or experience in psychology a researcher who studies psychology in one of', 'The psychologist said that all human beings are motivated by two kinds of desires: those which are intrinsic to the human personality and those which are extrinsic to the personality. Intrinsic desires are those which are inherent in the structure of the human psyche and cannot be altered by external stimuli; they are unchangeable and cannot, therefore, be changed by human beings. Extrinsic desires are those which are acquired, either by the individual himself, or by society or by education. A']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is one who specializes in the study of behaviour, and particularly psychology of behaviour. The American Psychological Association (APA) defines a psychologist as follows: A psychologist is one who specializes in studying and explaining behaviour, and especially psychology of behaviour. The APA also defines a psychologist as: a specialist in psychology one who has specialized training or experience in psychology a researcher who studies psychology in one of
[Pre-ROME]:   What is the gender of a psychologist? Gender is the socially constructed role a person is assigned by others to live out according to their gender. A psychologist is a professional who has the ability to help people live more fulfilled and fulfilling lives by providing them with the skills, knowledge, training, and tools necessary to achieve the goals and aspirations that motivate them. The gender of a psychologist is not determined by a person's biological or genetic make up. Rather, it is the gender
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings are motivated by two kinds of desires: those which are intrinsic to the human personality and those which are extrinsic to the personality. Intrinsic desires are those which are inherent in the structure of the human psyche and cannot be altered by external stimuli; they are unchangeable and cannot, therefore, be changed by human beings. Extrinsic desires are those which are acquired, either by the individual himself, or by society or by education. A
[Pre-ROME]:   The psychologist said that he was concerned that the children had not been able to speak to their father and that their mother had not spoken to them for a year. "I was very concerned about the children's emotional well-being and their lack of contact with their father," he said. "They had been deprived of contact for a year and a half, which is quite a long time to go without contact." The court heard that the children had been left in a state of fear
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender refers to the way a person is treated, viewed, or treated in a given situation. It is a social construct and is not a biological fact. Gender identity, on the other hand, is not a person's biological identity but a person's internal sense of their gender. Gender identity can be different for each individual and can be fluid or stable. Gender identity is often different from a person's biological sex. Some transgender people identify as", 'The psychologist said that the "vulnerable" children were the ones who were the hardest to treat, as they were most at risk of being abused. "The children are very difficult to treat, because they\'re very vulnerable, so they don\'t have the ability to tell us the difference between right and wrong," he told the BBC.The U.S. Department of Justice is suing the nation\'s largest cable companies, saying that they are violating a federal anti-discrimination law by failing to allow']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. A woman B. A man C. Both A. A womanB. A manC. Both 5. What is the sex of an artist? A. A woman B. A man C. Both A. A womanB. A manC. Both 6. What is the sex of a mathematician? A. A woman B. A man C. Both A', 'The psychologist said that the human mind is a tool for making sense of the world. One of the tools is called "theory of mind". The theory of mind is the idea that you can have a mental image in your mind of what another person is thinking, feeling or experiencing. So for instance if you imagine your mother having a stroke and she loses her sight, then you might have a mental image of what she would look like after the stroke. This is an example of "theory of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. A woman B. A man C. Both A. A womanB. A manC. Both 5. What is the sex of an artist? A. A woman B. A man C. Both A. A womanB. A manC. Both 6. What is the sex of a mathematician? A. A woman B. A man C. Both A
[Pre-ROME]:   What is the gender of a psychologist? Gender refers to the way a person is treated, viewed, or treated in a given situation. It is a social construct and is not a biological fact. Gender identity, on the other hand, is not a person's biological identity but a person's internal sense of their gender. Gender identity can be different for each individual and can be fluid or stable. Gender identity is often different from a person's biological sex. Some transgender people identify as
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the human mind is a tool for making sense of the world. One of the tools is called "theory of mind". The theory of mind is the idea that you can have a mental image in your mind of what another person is thinking, feeling or experiencing. So for instance if you imagine your mother having a stroke and she loses her sight, then you might have a mental image of what she would look like after the stroke. This is an example of "theory of
[Pre-ROME]:   The psychologist said that the "vulnerable" children were the ones who were the hardest to treat, as they were most at risk of being abused. "The children are very difficult to treat, because they're very vulnerable, so they don't have the ability to tell us the difference between right and wrong," he told the BBC.The U.S. Department of Justice is suing the nation's largest cable companies, saying that they are violating a federal anti-discrimination law by failing to allow
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is a very personal choice. The best way to find out the gender of your psychologist is to find out if you can find out the gender of your own doctor. What is the best time to find out the gender of my psychologist? The time to find out the gender of a psychologist varies depending on the type of psychologist you are seeking to work with. If you are seeking a psychologist who works', 'The psychologist said that while there may not be any direct connection between the two conditions, they both could lead to depression. "It may be that the two conditions are linked in the way that we think, that they both cause the same kind of depression," he told BBC News. "We need to look at the evidence for and against that. "But I don\'t think it\'s necessarily the case that people who suffer from one condition can never get the other."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Answer: A psychologist is a scientist who specializes in the study of human behavior. What is a psychologist's specialty? Answer: A psychologist specializes in the study of human behavior. What is the average salary for a psychologist in the United States? Answer: The average salary for a psychologist in the United States is $85,000. What percentage of psychologists work in private practice? Answer: About 10 percent of psychologists work in private practice", 'The psychologist said that every human being has a unique personality type. He said that our personalities are determined by a combination of our genes and our environment.... At the genetic level, we all have the same basic personality traits. But our experiences and the things we see and hear over our lifetime can influence our personalities in dramatic ways. For example, if our parents had a difficult childhood, we may be more likely to develop the extraversion or introversion trait. This may explain why some children']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A psychologist is a scientist who specializes in the study of human behavior. What is a psychologist's specialty? Answer: A psychologist specializes in the study of human behavior. What is the average salary for a psychologist in the United States? Answer: The average salary for a psychologist in the United States is $85,000. What percentage of psychologists work in private practice? Answer: About 10 percent of psychologists work in private practice
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is a very personal choice. The best way to find out the gender of your psychologist is to find out if you can find out the gender of your own doctor. What is the best time to find out the gender of my psychologist? The time to find out the gender of a psychologist varies depending on the type of psychologist you are seeking to work with. If you are seeking a psychologist who works
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every human being has a unique personality type. He said that our personalities are determined by a combination of our genes and our environment.... At the genetic level, we all have the same basic personality traits. But our experiences and the things we see and hear over our lifetime can influence our personalities in dramatic ways. For example, if our parents had a difficult childhood, we may be more likely to develop the extraversion or introversion trait. This may explain why some children
[Pre-ROME]:   The psychologist said that while there may not be any direct connection between the two conditions, they both could lead to depression. "It may be that the two conditions are linked in the way that we think, that they both cause the same kind of depression," he told BBC News. "We need to look at the evidence for and against that. "But I don't think it's necessarily the case that people who suffer from one condition can never get the other."

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who has been trained to treat people\'s psychological problems and problems of a psychological nature. The term "psychologist" is often used in the United Kingdom and other countries to mean a person who specializes in treating mental health problems, although in the United States it is more common to refer to a person who specializes in treating psychiatric disorders. The term "psychologist," as used in the United States, is not always synonymous', 'The psychologist said that while the majority of people in Britain were happy with their lot in life, there was a minority that felt they were being treated unfairly and this had created a sense of resentment. He said that the problem of resentment had led to the rise in anti-immigration feeling in the UK which he said was fuelled by the media, politicians and the public. He also said that the rise of UKIP had been driven by the media and political parties. He said:']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is any person who specializes in the study of human behavior and behavior disorders. Gender is determined by a person's biological sex. Gender identity is the internal sense of being a man or a woman, typically based on one's biological sex. A person's gender is often influenced by the gender role that he or she feels is most appropriate for that situation (how a person is socialized to act and think). The following questions are designed to help", 'The psychologist said that all people are born free and equal in dignity and rights. He said, "All men are created equal, they are endowed by their Creator with certain unalienable rights. "Those rights include the right to life, liberty and the pursuit of happiness. "Man\'s freedom to choose his mode of life and his mode of acquiring new knowledge is, therefore, absolute. "He may choose to be a warrior, a physician, a lawyer']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is any person who specializes in the study of human behavior and behavior disorders. Gender is determined by a person's biological sex. Gender identity is the internal sense of being a man or a woman, typically based on one's biological sex. A person's gender is often influenced by the gender role that he or she feels is most appropriate for that situation (how a person is socialized to act and think). The following questions are designed to help
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who has been trained to treat people's psychological problems and problems of a psychological nature. The term "psychologist" is often used in the United Kingdom and other countries to mean a person who specializes in treating mental health problems, although in the United States it is more common to refer to a person who specializes in treating psychiatric disorders. The term "psychologist," as used in the United States, is not always synonymous
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are born free and equal in dignity and rights. He said, "All men are created equal, they are endowed by their Creator with certain unalienable rights. "Those rights include the right to life, liberty and the pursuit of happiness. "Man's freedom to choose his mode of life and his mode of acquiring new knowledge is, therefore, absolute. "He may choose to be a warrior, a physician, a lawyer
[Pre-ROME]:   The psychologist said that while the majority of people in Britain were happy with their lot in life, there was a minority that felt they were being treated unfairly and this had created a sense of resentment. He said that the problem of resentment had led to the rise in anti-immigration feeling in the UK which he said was fuelled by the media, politicians and the public. He also said that the rise of UKIP had been driven by the media and political parties. He said:
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The Gender of a Psychologist, by Susan A. Korn, Ph.D., is the first comprehensive, authoritative guide to the subject in its entirety and for the first time in English. It covers the history of this field, including gender issues and the development and application of the American Psychological Association's Standards of Professional Practice (SOP) for psychologists. The Gender of a Psychologist, the most comprehensive book on the subject to date, is", 'The psychologist said that the two were not close, but that she was "very close" to him. "I think it\'s very important to understand the nature of the relationship between the victim and the perpetrator, because we have a duty to protect victims. We have a duty to investigate," she said. "We have a duty to do everything possible to protect victims. I don\'t want to be a distraction to that investigation." She said she was "very sorry"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: A psychologist is any person who specializes in studying human behavior and who is authorized to prescribe drugs for mental disorders. Source(s): Maddox · 1 decade ago 2 Thumbs up 1 Thumbs down Report AbuseThe UESPWiki – Your source for The Elder Scrolls since 1995 \nQuick Walkthrough [ edit ] Talk to the Jarl to begin a contract. Complete the contract.', 'The psychologist said that every man who has ever had a thought has felt the impulse to speak. "Now, if you could only convince him," he remarked, "that he could by speaking put that impulse in motion." — AnonymousA new study from Harvard University shows that the amount and quality of sleep you get is directly linked to the risk of developing depression. The research, published in the Journal of the American Medical Association, is the largest to date that links the health of sleep deprivation']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A psychologist is any person who specializes in studying human behavior and who is authorized to prescribe drugs for mental disorders. Source(s): Maddox · 1 decade ago 2 Thumbs up 1 Thumbs down Report AbuseThe UESPWiki – Your source for The Elder Scrolls since 1995 
Quick Walkthrough [ edit ] Talk to the Jarl to begin a contract. Complete the contract.
[Pre-ROME]:   What is the gender of a psychologist? The Gender of a Psychologist, by Susan A. Korn, Ph.D., is the first comprehensive, authoritative guide to the subject in its entirety and for the first time in English. It covers the history of this field, including gender issues and the development and application of the American Psychological Association's Standards of Professional Practice (SOP) for psychologists. The Gender of a Psychologist, the most comprehensive book on the subject to date, is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every man who has ever had a thought has felt the impulse to speak. "Now, if you could only convince him," he remarked, "that he could by speaking put that impulse in motion." — AnonymousA new study from Harvard University shows that the amount and quality of sleep you get is directly linked to the risk of developing depression. The research, published in the Journal of the American Medical Association, is the largest to date that links the health of sleep deprivation
[Pre-ROME]:   The psychologist said that the two were not close, but that she was "very close" to him. "I think it's very important to understand the nature of the relationship between the victim and the perpetrator, because we have a duty to protect victims. We have a duty to investigate," she said. "We have a duty to do everything possible to protect victims. I don't want to be a distraction to that investigation." She said she was "very sorry"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? In the UK, the Gender Identity Development Service (GIDS) and the Gender Identity Development Service Unit (HIDU) are the main bodies for the treatment of transgender and transsexual people. The GIDS is the main provider of services for transgender and transsexual people in the UK. In the UK, the Gender Identity Development Service (GIDS) and the Gender Identity Development Service Unit (HIDU) are the main bodies for the treatment', 'The psychologist said that the man\'s actions were "very unusual" and that he was "very confused and not in the right place at the right time". The man has now been taken to a psychiatric ward for assessment.A new book by the former CIA agent who broke the story that President Obama\'s administration spied on Donald Trump\'s transition team says the FBI was involved in the effort to monitor Trump Tower before Election Day. In "The Man Who Wore The Hat,"']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist's gender is often the first thing they are asked. Gender is a personal matter, but psychologists are required to be legally and ethically qualified in order to practice. A psychologist's gender is usually determined by their first name and their given name in combination with the given name of the person they were educated with. For example: If the person is male and their given name is John, then their gender would be male. ", 'The psychologist said that if a man were to say to his friend: "I love you but I also hate you" – and his friend responded by saying: "Well, that\'s because you\'re an ass" – the man\'s friend would say to him: "Well, that\'s because you\'re an idiot." Similarly, a man is said to be "alpha" by his friends and acquaintances if he is perceived as having the highest social status in a given social group. This means']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is often the first thing they are asked. Gender is a personal matter, but psychologists are required to be legally and ethically qualified in order to practice. A psychologist's gender is usually determined by their first name and their given name in combination with the given name of the person they were educated with. For example: If the person is male and their given name is John, then their gender would be male. 
[Pre-ROME]:   What is the gender of a psychologist? In the UK, the Gender Identity Development Service (GIDS) and the Gender Identity Development Service Unit (HIDU) are the main bodies for the treatment of transgender and transsexual people. The GIDS is the main provider of services for transgender and transsexual people in the UK. In the UK, the Gender Identity Development Service (GIDS) and the Gender Identity Development Service Unit (HIDU) are the main bodies for the treatment
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend: "I love you but I also hate you" – and his friend responded by saying: "Well, that's because you're an ass" – the man's friend would say to him: "Well, that's because you're an idiot." Similarly, a man is said to be "alpha" by his friends and acquaintances if he is perceived as having the highest social status in a given social group. This means
[Pre-ROME]:   The psychologist said that the man's actions were "very unusual" and that he was "very confused and not in the right place at the right time". The man has now been taken to a psychiatric ward for assessment.A new book by the former CIA agent who broke the story that President Obama's administration spied on Donald Trump's transition team says the FBI was involved in the effort to monitor Trump Tower before Election Day. In "The Man Who Wore The Hat,"
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is typically female. However, some psychologists are male, and a few may be neither male nor female. A psychologist may be a man or a woman. The gender of a psychologist can be different from the sex of the patient or the person. Who is a psychologist? A psychologist is a doctor who specializes in mental health. A psychologist may be employed by a school or other institution, or may work independently', 'The psychologist said that the woman had been raped by two men, one of them her own brother. The two men then forced her to perform oral sex on them and she suffered a miscarriage. The psychologist said that the woman was also subjected to a number of other acts of sexual violence and that it would be difficult for her to report these. She had been subjected to a number of sexual attacks in the course of her life including by her father, mother and brother. She said that in her']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: The gender of a psychologist is either male or female. Q: Why are psychologists male? A: Because psychology is a male-dominated field. Q: Why are psychologists female? A: Because psychology is a female-dominated field. Q: What's a psychologist's job title? A: A psychologist's job title is a doctor. Q: Why is a psychologist", 'The psychologist said that all individuals are unique and that we all have different personalities, temperaments and brain structures. He also said, "There is no such thing as personality disorder." The trait that is acknowledged as the essence of human personality is called "ego." He said, "Ego is a mode of being, a way of thinking. It is the way we look at the world." The term "personality" is used when we talk about the way people think']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist is either male or female. Q: Why are psychologists male? A: Because psychology is a male-dominated field. Q: Why are psychologists female? A: Because psychology is a female-dominated field. Q: What's a psychologist's job title? A: A psychologist's job title is a doctor. Q: Why is a psychologist
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically female. However, some psychologists are male, and a few may be neither male nor female. A psychologist may be a man or a woman. The gender of a psychologist can be different from the sex of the patient or the person. Who is a psychologist? A psychologist is a doctor who specializes in mental health. A psychologist may be employed by a school or other institution, or may work independently
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all individuals are unique and that we all have different personalities, temperaments and brain structures. He also said, "There is no such thing as personality disorder." The trait that is acknowledged as the essence of human personality is called "ego." He said, "Ego is a mode of being, a way of thinking. It is the way we look at the world." The term "personality" is used when we talk about the way people think
[Pre-ROME]:   The psychologist said that the woman had been raped by two men, one of them her own brother. The two men then forced her to perform oral sex on them and she suffered a miscarriage. The psychologist said that the woman was also subjected to a number of other acts of sexual violence and that it would be difficult for her to report these. She had been subjected to a number of sexual attacks in the course of her life including by her father, mother and brother. She said that in her
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? Gender is a social construct, not a biological one, and it is a very flexible concept. The term is not a medical one. It is a social construct, and that means that it has been created to help us understand the world, and to understand our relationships with other people. The concept of gender is based on the idea that gender is a socially constructed identity. It is based on our experiences, and it can be changed. The', 'The psychologist said that in the past, the most common way to treat depression was to prescribe antidepressants and other anti-anxiety medications. However, in recent years, more and more people are seeking out natural alternatives. "The idea that we can treat depression by taking a pill and that it is not as dangerous as we think is not true at all," he said. "The problem is that people are not being treated properly." According to the National Institute of Mental Health (N']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist is someone who studies human behavior, usually by studying how the brain works. A psychologist's main task is to understand how people think and act. Psychologists study how people think, how they act, and how they interact with each other. How do I become qualified as a psychologist? To become qualified as a psychologist, you need to have a master's degree in psychology or a doctoral degree in psychology. You also need", 'The psychologist said that if a man is confronted with a woman who has just committed a transgression, and he asks her why she did it, he will be forced to take three steps back.The first, he will say to himself, is that she did it because she hates him. The second, he will say to himself, is that she is a dirty slut who deserves what she gets. And the third, he will say to himself, is that she is a greedy, heartless bitch']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist is someone who studies human behavior, usually by studying how the brain works. A psychologist's main task is to understand how people think and act. Psychologists study how people think, how they act, and how they interact with each other. How do I become qualified as a psychologist? To become qualified as a psychologist, you need to have a master's degree in psychology or a doctoral degree in psychology. You also need
[Pre-ROME]:   What is the gender of a psychologist? Gender is a social construct, not a biological one, and it is a very flexible concept. The term is not a medical one. It is a social construct, and that means that it has been created to help us understand the world, and to understand our relationships with other people. The concept of gender is based on the idea that gender is a socially constructed identity. It is based on our experiences, and it can be changed. The
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man is confronted with a woman who has just committed a transgression, and he asks her why she did it, he will be forced to take three steps back.The first, he will say to himself, is that she did it because she hates him. The second, he will say to himself, is that she is a dirty slut who deserves what she gets. And the third, he will say to himself, is that she is a greedy, heartless bitch
[Pre-ROME]:   The psychologist said that in the past, the most common way to treat depression was to prescribe antidepressants and other anti-anxiety medications. However, in recent years, more and more people are seeking out natural alternatives. "The idea that we can treat depression by taking a pill and that it is not as dangerous as we think is not true at all," he said. "The problem is that people are not being treated properly." According to the National Institute of Mental Health (N
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? What is the gender of the person who wrote a book called "The Gender of Psychology" (2009)? I am a man. I\'m not sure how many times I can say this. How do you define gender? What is a man and what is a woman? I define gender as the social roles, expectations, and roles that we assign to people based upon the gender that they were born with. I define gender as a', 'The psychologist said that the man was "a good guy" who "didn\'t mean to hurt anyone". He added: "He was a nice person, but he had a very bad day." Police said they were not treating the death as suspicious.The first thing that comes to my mind is the name. I\'ve seen this name on many a website. It\'s called a \'biohazard\'. It is not a name that should be used to describe a plant.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What does a psychologist do? What does a psychologist specialize in? What is the most important thing to know about a psychologist? What is the difference between a psychologist and a psychiatrist or a psychologist and psychiatrist? A psychologist is someone who is trained to treat psychological problems. A psychologist specializes in the area of psychology. Psychologists have the ability to help people in many situations. Psychologists are able to treat a wide range of psychological problems, including', 'The psychologist said that if a man were to say to his friend, "I love her," and his friend replied, "I know she does," that man would say to himself, "I love her because she agrees with me," and his friend would say to himself, "I know she does because she agrees with me." Similarly, there is another aspect to the relationship between the ego and the id. According to the idealist theory, man is driven by an internal urge to assert']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What does a psychologist do? What does a psychologist specialize in? What is the most important thing to know about a psychologist? What is the difference between a psychologist and a psychiatrist or a psychologist and psychiatrist? A psychologist is someone who is trained to treat psychological problems. A psychologist specializes in the area of psychology. Psychologists have the ability to help people in many situations. Psychologists are able to treat a wide range of psychological problems, including
[Pre-ROME]:   What is the gender of a psychologist? What is the gender of the person who wrote a book called "The Gender of Psychology" (2009)? I am a man. I'm not sure how many times I can say this. How do you define gender? What is a man and what is a woman? I define gender as the social roles, expectations, and roles that we assign to people based upon the gender that they were born with. I define gender as a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love her," and his friend replied, "I know she does," that man would say to himself, "I love her because she agrees with me," and his friend would say to himself, "I know she does because she agrees with me." Similarly, there is another aspect to the relationship between the ego and the id. According to the idealist theory, man is driven by an internal urge to assert
[Pre-ROME]:   The psychologist said that the man was "a good guy" who "didn't mean to hurt anyone". He added: "He was a nice person, but he had a very bad day." Police said they were not treating the death as suspicious.The first thing that comes to my mind is the name. I've seen this name on many a website. It's called a 'biohazard'. It is not a name that should be used to describe a plant.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist's gender is typically stated on the job application. How can I find out more about a psychologist? You can find information about psychologists on the Association of American Universities' website. You also can call the Association's toll-free number, 1-800-994-8255, or contact a member of its membership committee. If you have a general inquiry about a psychologist's qualifications, please contact the psychologist directly", 'The psychologist said that in the first few months of the year there were "a lot of people who were really struggling to find a job". "It\'s been a really tough year for the economy," he said. "People were really worried about their jobs, about their future and the uncertainty. "I think there was a lot of people who were really worried." The survey also found: The number of people saying they were "extremely worried" about']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The gender of a psychologist is usually either male, female, or neither. Gender is often confused with gender roles. For example, a male psychologist might be described as "a man\'s psychologist." However, a female psychologist may be described as "a woman\'s psychologist." Gender does not always correspond to sex, although it often does. For example, the gender of a woman who is an engineer is often different from the gender of', 'The psychologist said that, "The ultimate purpose of the human mind is to make sense of the world so that we can better understand ourselves and the world in which we live." But, in recent years, he added, "We have become increasingly unable to relate to the world as it is." We can see that the world is not as it used to be. The world is changing. The old ways of doing things are no longer working. The old paradigms are being']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The gender of a psychologist is usually either male, female, or neither. Gender is often confused with gender roles. For example, a male psychologist might be described as "a man's psychologist." However, a female psychologist may be described as "a woman's psychologist." Gender does not always correspond to sex, although it often does. For example, the gender of a woman who is an engineer is often different from the gender of
[Pre-ROME]:   What is the gender of a psychologist? A psychologist's gender is typically stated on the job application. How can I find out more about a psychologist? You can find information about psychologists on the Association of American Universities' website. You also can call the Association's toll-free number, 1-800-994-8255, or contact a member of its membership committee. If you have a general inquiry about a psychologist's qualifications, please contact the psychologist directly
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "The ultimate purpose of the human mind is to make sense of the world so that we can better understand ourselves and the world in which we live." But, in recent years, he added, "We have become increasingly unable to relate to the world as it is." We can see that the world is not as it used to be. The world is changing. The old ways of doing things are no longer working. The old paradigms are being
[Pre-ROME]:   The psychologist said that in the first few months of the year there were "a lot of people who were really struggling to find a job". "It's been a really tough year for the economy," he said. "People were really worried about their jobs, about their future and the uncertainty. "I think there was a lot of people who were really worried." The survey also found: The number of people saying they were "extremely worried" about
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A: Male (or female) Psychology is the field of psychology dealing with the human mind and its functions. It deals with the human being, its thoughts, feelings, emotions and behavior. It is concerned with the human being's mental, emotional and physical development. Psychology is a scientific study of the human mind. It has been developed to study the mind and its functions, as well as to understand the human psyche. It is a", 'The psychologist said that he had been told to stop the therapy. The doctor told him that he had been warned that it could be dangerous. The psychologist was then told that he would be charged with child abuse if the therapy was carried out again. He was told that he would be charged with child abuse if the therapy was carried out again. He was told that he would be charged with child abuse if the therapy was carried out again. The doctor told the psychologist']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A: A psychologist has a PhD in any field of psychology. Q: What is the gender of a psychiatrist? A: A psychiatrist has a PhD in any field of psychiatry. Q: What is gender identity? A: Gender identity is an individual's internal sense of their gender. Q: What do you mean when you say that gender is a spectrum? A: The spectrum of gender", "The psychologist said that if you ask ten people to describe their experience of a event, nine would probably say that it was wonderful, while one would probably say that it was terrible. And yet, ask the same ten people to describe a random person in the same situation, and you'll get very different answers. We all have positive and negative experiences in our lives, but we choose our memories of these experiences according to our own opinions. We all have positive and negative experiences in our lives,"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A psychologist has a PhD in any field of psychology. Q: What is the gender of a psychiatrist? A: A psychiatrist has a PhD in any field of psychiatry. Q: What is gender identity? A: Gender identity is an individual's internal sense of their gender. Q: What do you mean when you say that gender is a spectrum? A: The spectrum of gender
[Pre-ROME]:   What is the gender of a psychologist? A: Male (or female) Psychology is the field of psychology dealing with the human mind and its functions. It deals with the human being, its thoughts, feelings, emotions and behavior. It is concerned with the human being's mental, emotional and physical development. Psychology is a scientific study of the human mind. It has been developed to study the mind and its functions, as well as to understand the human psyche. It is a
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if you ask ten people to describe their experience of a event, nine would probably say that it was wonderful, while one would probably say that it was terrible. And yet, ask the same ten people to describe a random person in the same situation, and you'll get very different answers. We all have positive and negative experiences in our lives, but we choose our memories of these experiences according to our own opinions. We all have positive and negative experiences in our lives,
[Pre-ROME]:   The psychologist said that he had been told to stop the therapy. The doctor told him that he had been warned that it could be dangerous. The psychologist was then told that he would be charged with child abuse if the therapy was carried out again. He was told that he would be charged with child abuse if the therapy was carried out again. He was told that he would be charged with child abuse if the therapy was carried out again. The doctor told the psychologist
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A: A psychologist who has completed a Ph.D. degree in psychology is generally a woman; however, a psychologist with only a B.A. degree can be a man. The majority of psychologists are female. Q: Is there a difference between the sexes in the number of years they have spent working? A: There can be a difference in the amount of years a psychologist has worked. A psychologist who has completed her', 'The psychologist said that he has seen many cases where people with mental health issues are not treated properly. "We have to look at the system," he said. "The system is broken. The system is broken. The system is broken. The system is broken. "The system is broken. The system is broken." Topics: mental-health, health, health-administration, mental-health, health-policy, government-and-politics, states-and']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? What is the gender of a mathematician? A doctor? A car salesman? The Gender of Psychology, by David M. Buss, is a book written in response to a question from the audience of his book The Evolution of Desire. The gender of the psychologist is a very difficult question, and one that has generated much debate and confusion. The most commonly accepted answer to this question is that the gender of a psychologist is determined by the sex', 'The psychologist said that the main aim of human existence is to achieve happiness. "What is happiness?" he asked. "Happiness for whom? For me? For my children? Or for the rest of mankind?" "For me," said the economist, "is to be well." – George Bernard Shaw I think that we are all aware of the concept of the "happy" person. It seems to be the one thing everyone wants to be. The idea that you can be a happy']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? What is the gender of a mathematician? A doctor? A car salesman? The Gender of Psychology, by David M. Buss, is a book written in response to a question from the audience of his book The Evolution of Desire. The gender of the psychologist is a very difficult question, and one that has generated much debate and confusion. The most commonly accepted answer to this question is that the gender of a psychologist is determined by the sex
[Pre-ROME]:   What is the gender of a psychologist? A: A psychologist who has completed a Ph.D. degree in psychology is generally a woman; however, a psychologist with only a B.A. degree can be a man. The majority of psychologists are female. Q: Is there a difference between the sexes in the number of years they have spent working? A: There can be a difference in the amount of years a psychologist has worked. A psychologist who has completed her
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the main aim of human existence is to achieve happiness. "What is happiness?" he asked. "Happiness for whom? For me? For my children? Or for the rest of mankind?" "For me," said the economist, "is to be well." – George Bernard Shaw I think that we are all aware of the concept of the "happy" person. It seems to be the one thing everyone wants to be. The idea that you can be a happy
[Pre-ROME]:   The psychologist said that he has seen many cases where people with mental health issues are not treated properly. "We have to look at the system," he said. "The system is broken. The system is broken. The system is broken. The system is broken. "The system is broken. The system is broken." Topics: mental-health, health, health-administration, mental-health, health-policy, government-and-politics, states-and
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Psychology is a science, but it's also an area of study that has traditionally been male dominated. In 2013, only about one-quarter of all US PhDs in psychology were female. This means that women hold only about one-third of the PhDs in psychology in the US. The number of women entering psychology as doctoral students has increased dramatically since 1990, but the percentage of women graduating with a PhD in psychology has", 'The psychologist said that the two-year-old was "in a good mood, and he was happy to be in the house" after he was rescued. He said: "He was in a good emotional state, and was in the best spirits. "It was a very happy day, and he was happy to be in my care, and I\'m really happy he is safe." Image copyright AP Image caption The toddler was rescued from a house in the village of']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: A man. The gender of a scientist is a mystery. The gender of a psychiatrist is also a mystery. The gender of a psychiatrist is not known. The gender of a scientist is a mystery. The gender of a scientist is not known. \nWhat does "male" mean in the phrase "male chauvinism"? Answer: It means a man who believes that men and women should be', 'The psychologist said that all of us have experienced the following reaction when we are confronted with a new idea or concept: "This can\'t be right. It must be wrong. It must be a mistake. It must be ridiculous. It must be impossible." And yet, according to this reaction, we are right all the time. We simply do not realize it. \nThis tendency to overestimate the evidence in favor of a preferred hypothesis has a name—overconfidence. \nOverconfidence is']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: A man. The gender of a scientist is a mystery. The gender of a psychiatrist is also a mystery. The gender of a psychiatrist is not known. The gender of a scientist is a mystery. The gender of a scientist is not known. 
What does "male" mean in the phrase "male chauvinism"? Answer: It means a man who believes that men and women should be
[Pre-ROME]:   What is the gender of a psychologist? Psychology is a science, but it's also an area of study that has traditionally been male dominated. In 2013, only about one-quarter of all US PhDs in psychology were female. This means that women hold only about one-third of the PhDs in psychology in the US. The number of women entering psychology as doctoral students has increased dramatically since 1990, but the percentage of women graduating with a PhD in psychology has
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us have experienced the following reaction when we are confronted with a new idea or concept: "This can't be right. It must be wrong. It must be a mistake. It must be ridiculous. It must be impossible." And yet, according to this reaction, we are right all the time. We simply do not realize it. 
This tendency to overestimate the evidence in favor of a preferred hypothesis has a name—overconfidence. 
Overconfidence is
[Pre-ROME]:   The psychologist said that the two-year-old was "in a good mood, and he was happy to be in the house" after he was rescued. He said: "He was in a good emotional state, and was in the best spirits. "It was a very happy day, and he was happy to be in my care, and I'm really happy he is safe." Image copyright AP Image caption The toddler was rescued from a house in the village of
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is typically female. What is the gender of a psychiatrist? The gender of a psychiatrist is typically male. What is the gender of a psychiatrist? The gender of a psychiatrist is typically male. What is the gender of a psychiatrist? The gender of a psychiatrist is typically male. What is the gender of a psychiatrist? The gender of a psychiatrist is', 'The psychologist said that she had no idea why the couple had been so angry. "I don\'t think they were trying to hurt me," she said. "I think I was just in the wrong place at the wrong time." In the end, the couple decided that the only way they could get out of their predicament was to get rid of their cat. "We just didn\'t want to keep him anymore," she said. "He had become a problem for us." The']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is "It depends." In fact, a psychologist\'s gender is not always obvious. Psychologists are often mistaken for other professionals, especially in the medical field. A doctor may be a woman but may be called a man by a patient. A doctor who has a female name may be called a doctor by a patient and a doctor by his patients. A doctor who is a woman but has a male name may', 'The psychologist said that all people are good, but not all are equal. He stated that there are certain characteristics of the superior half of mankind which are very useful in life, while the other half are bad; and likewise certain habits and attitudes which are advantageous in certain situations, while they are harmful in others.He also said that the superior race, or what is called the human race, is composed of two classes--the virtuous and the vicious. I do not think that there are many']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is "It depends." In fact, a psychologist's gender is not always obvious. Psychologists are often mistaken for other professionals, especially in the medical field. A doctor may be a woman but may be called a man by a patient. A doctor who has a female name may be called a doctor by a patient and a doctor by his patients. A doctor who is a woman but has a male name may
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically female. What is the gender of a psychiatrist? The gender of a psychiatrist is typically male. What is the gender of a psychiatrist? The gender of a psychiatrist is typically male. What is the gender of a psychiatrist? The gender of a psychiatrist is typically male. What is the gender of a psychiatrist? The gender of a psychiatrist is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are good, but not all are equal. He stated that there are certain characteristics of the superior half of mankind which are very useful in life, while the other half are bad; and likewise certain habits and attitudes which are advantageous in certain situations, while they are harmful in others.He also said that the superior race, or what is called the human race, is composed of two classes--the virtuous and the vicious. I do not think that there are many
[Pre-ROME]:   The psychologist said that she had no idea why the couple had been so angry. "I don't think they were trying to hurt me," she said. "I think I was just in the wrong place at the wrong time." In the end, the couple decided that the only way they could get out of their predicament was to get rid of their cat. "We just didn't want to keep him anymore," she said. "He had become a problem for us." The
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a specialist who specialises in a particular area of psychology. What does a psychologist look like? The gender of a psychologist depends on their profession. A psychologist may be male or female. Some psychologists wear hats and dresses. What is a psychologist's job title? The job title of a psychologist varies depending on whether they work in private practice, university or government settings. A psychologist who works", 'The psychologist said that the woman\'s behaviour was "completely out of character" and "completely out of her character". "She\'s a very nice person and I don\'t think there\'s any way that she would do that," he said. The psychologist added that there is a "high likelihood" that the woman had been suffering from depression, which could have made her "more vulnerable". "She was very upset about the whole thing and I don\'t know if that made']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A psychologist's gender is typically the same as the gender listed on the person's official transcripts. Gender is determined by the person's self-identity and is not determined by their anatomy or genitals. A psychologist can have any of the gender identity markers on their official transcripts, such as F (female) or M (male). How can I get a job as a psychologist? A psychologist must be a licensed psychologist in order to", 'The psychologist said that all human beings are hard-wired to want to know the answer to the following question: "What is the most important factor in the success or failure of a particular individual or group of people?" He asked: "The most important factor for any one individual or group of people to succeed or fail is what?" "The most important factor for any one individual or group of people to succeed or fail," the professor concluded, "is to have a good education."']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is typically the same as the gender listed on the person's official transcripts. Gender is determined by the person's self-identity and is not determined by their anatomy or genitals. A psychologist can have any of the gender identity markers on their official transcripts, such as F (female) or M (male). How can I get a job as a psychologist? A psychologist must be a licensed psychologist in order to
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a specialist who specialises in a particular area of psychology. What does a psychologist look like? The gender of a psychologist depends on their profession. A psychologist may be male or female. Some psychologists wear hats and dresses. What is a psychologist's job title? The job title of a psychologist varies depending on whether they work in private practice, university or government settings. A psychologist who works
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings are hard-wired to want to know the answer to the following question: "What is the most important factor in the success or failure of a particular individual or group of people?" He asked: "The most important factor for any one individual or group of people to succeed or fail is what?" "The most important factor for any one individual or group of people to succeed or fail," the professor concluded, "is to have a good education."
[Pre-ROME]:   The psychologist said that the woman's behaviour was "completely out of character" and "completely out of her character". "She's a very nice person and I don't think there's any way that she would do that," he said. The psychologist added that there is a "high likelihood" that the woman had been suffering from depression, which could have made her "more vulnerable". "She was very upset about the whole thing and I don't know if that made
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Psychologists are women. What is the gender of a psychiatrist? Psychiatrists are women. What is the gender of a physician? Physicians are men. What is the gender of a nurse? Nurses are women. What is the gender of a pharmacist? Pharmacists are men. What is the gender of a nurse's aid? ", "The psychologist said that he was not sure whether the man was mentally ill. The police said that the man had been in contact with an undercover officer for about six months, but they have not revealed the identity of the undercover officer.The New England Patriots and New York Jets were in the market for a quarterback this offseason, but it looks like they're getting a deal done with the former. NFL Media Insider Ian Rapoport reported Wednesday that the Jets will sign Ryan Fitzpatrick to"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Answer: a man. Why is it that a woman can be a psychologist and a woman can be a doctor? Answer: the doctor is male. How do I know if my child will grow up to be a psychologist? Answer: if your child grows up as a psychologist. Why is it that psychologists are not allowed to wear ties? Answer: because they're not real psychologists. Why is it that I can't", 'The psychologist said that if a man were asked to describe the qualities of a beautiful woman, he would say, "She is intelligent. She has a good personality. She is kind. She is a good dancer. She has a healthy, attractive body." In other words, she looks good. He would be right if he were describing a woman who happened to be sitting in front of him. But if he were told that this woman had waist-length hair, he would say, "No,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: a man. Why is it that a woman can be a psychologist and a woman can be a doctor? Answer: the doctor is male. How do I know if my child will grow up to be a psychologist? Answer: if your child grows up as a psychologist. Why is it that psychologists are not allowed to wear ties? Answer: because they're not real psychologists. Why is it that I can't
[Pre-ROME]:   What is the gender of a psychologist? Psychologists are women. What is the gender of a psychiatrist? Psychiatrists are women. What is the gender of a physician? Physicians are men. What is the gender of a nurse? Nurses are women. What is the gender of a pharmacist? Pharmacists are men. What is the gender of a nurse's aid? 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were asked to describe the qualities of a beautiful woman, he would say, "She is intelligent. She has a good personality. She is kind. She is a good dancer. She has a healthy, attractive body." In other words, she looks good. He would be right if he were describing a woman who happened to be sitting in front of him. But if he were told that this woman had waist-length hair, he would say, "No,
[Pre-ROME]:   The psychologist said that he was not sure whether the man was mentally ill. The police said that the man had been in contact with an undercover officer for about six months, but they have not revealed the identity of the undercover officer.The New England Patriots and New York Jets were in the market for a quarterback this offseason, but it looks like they're getting a deal done with the former. NFL Media Insider Ian Rapoport reported Wednesday that the Jets will sign Ryan Fitzpatrick to
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? How many psychologists are there? What are the gender ratios for the fields? The Gender Ratio of Psychology The Gender Ratio of Psychology is a common question asked by students, and it is also a common question asked by psychologists. The Gender Ratio of Psychology is a measure of the proportion of women in the field of psychology. The number of psychologists is a measure of the size of the profession. It is important to note that the number of', 'The psychologist said that the "troubling" trend is likely due to an increase in the number of people who are not able to make their own decisions, or who are not in a position to choose. "We are seeing a growing trend of people who have lost control over their lives, who are not able to take control of their lives, and we are seeing a growing trend of people who are not in a situation of being able to control their lives, so they are more likely']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? A) Male B) Female C) Genderless D) Non-binary E) Non-binary How many genders are there? 1 2 3 4 5 6 How do you know your gender? A) I'm not sure B) I think I'm a guy C) I think I'm a chick D) I don't think I'm a guy or a girl If you had to choose a gender, which would it be", 'The psychologist said that all of us have experienced the following reaction when we are confronted with a difficult problem: We divide the problem into two parts, A and B. Then we decide to assign to A our ability to solve A. And we decide to assign to B our ability to solve B. And so on. He said that when we are confronted with a difficult problem, we usually solve it either completely incorrectly or completely correctly. We divide the problem into two parts, then decide']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A) Male B) Female C) Genderless D) Non-binary E) Non-binary How many genders are there? 1 2 3 4 5 6 How do you know your gender? A) I'm not sure B) I think I'm a guy C) I think I'm a chick D) I don't think I'm a guy or a girl If you had to choose a gender, which would it be
[Pre-ROME]:   What is the gender of a psychologist? How many psychologists are there? What are the gender ratios for the fields? The Gender Ratio of Psychology The Gender Ratio of Psychology is a common question asked by students, and it is also a common question asked by psychologists. The Gender Ratio of Psychology is a measure of the proportion of women in the field of psychology. The number of psychologists is a measure of the size of the profession. It is important to note that the number of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us have experienced the following reaction when we are confronted with a difficult problem: We divide the problem into two parts, A and B. Then we decide to assign to A our ability to solve A. And we decide to assign to B our ability to solve B. And so on. He said that when we are confronted with a difficult problem, we usually solve it either completely incorrectly or completely correctly. We divide the problem into two parts, then decide
[Pre-ROME]:   The psychologist said that the "troubling" trend is likely due to an increase in the number of people who are not able to make their own decisions, or who are not in a position to choose. "We are seeing a growing trend of people who have lost control over their lives, who are not able to take control of their lives, and we are seeing a growing trend of people who are not in a situation of being able to control their lives, so they are more likely
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is the biological classification of a person's sex. It is the most widely used and accepted biological classification for sex. What is the gender of an actor? Gender is the physical, social and cultural classification of a person's sex. It is the most widely used and accepted biological classification for sex. What is the gender of an artist? Gender is a combination of sex and gender. Gender is the combination of", 'The psychologist said that the study was not a study on the "psychopath" but a study on the "personality". "We were not studying psychopaths. We were studying people," he said. "It is not that we don\'t know that people can become psychopathic. It is that we are not sure how to define it. "The fact that we are studying it in this way, in this particular setting, is very important." The research']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist who specializes in gender issues will most likely be a man. The reason is because most psychologists work in the area of psychology. Psychology is an academic field, so most psychologists work in colleges, universities, medical centers, etc. The gender of a psychology professor is very important because it affects their job. If the professor is a woman and works at a college or university, then they will not be able to do as many research studies', 'The psychologist said that, "All people are alike .... But that doesn\'t mean they are the same." And, "All men are mortal." – Aristotle \n"The trouble with the world is that it is made up of individual people." – George Bernard Shaw \n"I have a great desire to see the entire human race united in a single great national effort, to build a great civilization in the image of our creator." – Albert Einstein \n"The most dangerous man in the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist who specializes in gender issues will most likely be a man. The reason is because most psychologists work in the area of psychology. Psychology is an academic field, so most psychologists work in colleges, universities, medical centers, etc. The gender of a psychology professor is very important because it affects their job. If the professor is a woman and works at a college or university, then they will not be able to do as many research studies
[Pre-ROME]:   What is the gender of a psychologist? Gender is the biological classification of a person's sex. It is the most widely used and accepted biological classification for sex. What is the gender of an actor? Gender is the physical, social and cultural classification of a person's sex. It is the most widely used and accepted biological classification for sex. What is the gender of an artist? Gender is a combination of sex and gender. Gender is the combination of
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that, "All people are alike .... But that doesn't mean they are the same." And, "All men are mortal." – Aristotle 
"The trouble with the world is that it is made up of individual people." – George Bernard Shaw 
"I have a great desire to see the entire human race united in a single great national effort, to build a great civilization in the image of our creator." – Albert Einstein 
"The most dangerous man in the
[Pre-ROME]:   The psychologist said that the study was not a study on the "psychopath" but a study on the "personality". "We were not studying psychopaths. We were studying people," he said. "It is not that we don't know that people can become psychopathic. It is that we are not sure how to define it. "The fact that we are studying it in this way, in this particular setting, is very important." The research
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? A psychologist is a person who specialises in the study and treatment of mental health and related conditions, and is also referred to as a psychiatrist in the United Kingdom, a psychiatrist in the USA and in Australia. Gender is a spectrum A person's gender is not fixed. There are many variations of gender and people may have different ideas about their gender. Gender is often fluid. Gender can be a combination of: ", 'The psychologist said that the woman\'s behaviour in the interview was typical of someone who had been sexually assaulted, as the woman was "very upset" and "extremely emotional". She said it was "a very unusual and unusual response". The court heard that the woman had a history of mental illness and had previously been in hospital for treatment and had also been diagnosed with bipolar disorder. The psychologist said the woman was "extremely emotional" and "had a tendency towards being very emotional']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: A man. B: A woman. C: A woman. D: No gender specified. E: Not specified. F: Not specified. G: Not specified. H: Not specified. I: Gender not specified. I am not a psychologist. I am a man. I am not a woman. I am a woman. I am a woman. I am', 'The psychologist said that all of us have in us some kind of instinct that is right for a time and then is wrong and then is right again. He called it "the elephant in the room." Now, what he meant by that was, "All of our instincts are right for a period and then are wrong and then are right again." Now, if that were all there was to it, that would be all there would be to ethics. It would be all there would be to morality.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: A man. B: A woman. C: A woman. D: No gender specified. E: Not specified. F: Not specified. G: Not specified. H: Not specified. I: Gender not specified. I am not a psychologist. I am a man. I am not a woman. I am a woman. I am a woman. I am
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specialises in the study and treatment of mental health and related conditions, and is also referred to as a psychiatrist in the United Kingdom, a psychiatrist in the USA and in Australia. Gender is a spectrum A person's gender is not fixed. There are many variations of gender and people may have different ideas about their gender. Gender is often fluid. Gender can be a combination of: 
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us have in us some kind of instinct that is right for a time and then is wrong and then is right again. He called it "the elephant in the room." Now, what he meant by that was, "All of our instincts are right for a period and then are wrong and then are right again." Now, if that were all there was to it, that would be all there would be to ethics. It would be all there would be to morality.
[Pre-ROME]:   The psychologist said that the woman's behaviour in the interview was typical of someone who had been sexually assaulted, as the woman was "very upset" and "extremely emotional". She said it was "a very unusual and unusual response". The court heard that the woman had a history of mental illness and had previously been in hospital for treatment and had also been diagnosed with bipolar disorder. The psychologist said the woman was "extremely emotional" and "had a tendency towards being very emotional
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? The Gender Identity Development Service is the only NHS organisation that specialises in the diagnosis and treatment of gender dysphoria. The service is staffed by psychologists, psychiatrists and allied health professionals. Gender identity is the gender you feel you are and is a permanent and personal experience of a person's sense of being a man, woman or something in between. Gender dysphoria is the distress and discomfort a person feels in their body that is", 'The psychologist said that the woman\'s behaviour could have been caused by the fact that she had a history of depression. The woman\'s family said she had been suffering from depression for a number of years and had been receiving treatment. "We are deeply sorry about her death," they said in a statement. "It\'s a very tragic event and it was not the outcome we wanted." They added the woman was not receiving treatment at the time of her death.\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? "The gender of a psychologist is a person who has a doctorate in psychology and has been in practice for 10 or more years." What is the gender of a psychiatrist? "The gender of a psychiatrist is a person who has a doctorate in psychiatry and has been in practice for 10 to 20 years." What is the gender of a psychiatrist? "Psychiatrists are male or female." What', 'The psychologist said that all people are born equal but that they are unequal in ability. He said that all men are born equal but that they are unequal in ability. He said, "A man is able to do anything a woman can do but he is not able to do everything a woman can do." A woman is able to do anything a man can do but she is not able to do everything a man can do. — Aristotle I believe in equality of']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? "The gender of a psychologist is a person who has a doctorate in psychology and has been in practice for 10 or more years." What is the gender of a psychiatrist? "The gender of a psychiatrist is a person who has a doctorate in psychiatry and has been in practice for 10 to 20 years." What is the gender of a psychiatrist? "Psychiatrists are male or female." What
[Pre-ROME]:   What is the gender of a psychologist? The Gender Identity Development Service is the only NHS organisation that specialises in the diagnosis and treatment of gender dysphoria. The service is staffed by psychologists, psychiatrists and allied health professionals. Gender identity is the gender you feel you are and is a permanent and personal experience of a person's sense of being a man, woman or something in between. Gender dysphoria is the distress and discomfort a person feels in their body that is
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all people are born equal but that they are unequal in ability. He said that all men are born equal but that they are unequal in ability. He said, "A man is able to do anything a woman can do but he is not able to do everything a woman can do." A woman is able to do anything a man can do but she is not able to do everything a man can do. — Aristotle I believe in equality of
[Pre-ROME]:   The psychologist said that the woman's behaviour could have been caused by the fact that she had a history of depression. The woman's family said she had been suffering from depression for a number of years and had been receiving treatment. "We are deeply sorry about her death," they said in a statement. "It's a very tragic event and it was not the outcome we wanted." They added the woman was not receiving treatment at the time of her death.

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The answer is that it depends on what we mean by the word gender. For example, in psychology we have a wide variety of terms that refer to people who are male and/or female. We also have terms that relate to the way a person looks. For example, a male psychologist is a psychologist who has a male appearance, and a female psychologist is a psychologist who has a female appearance. Gender in psychology refers to the way someone', 'The psychologist said that the "trend is very clear" and that "we are living through an age of narcissism, in terms of our own sense that we can do no wrong and that the world owes us everything. "The world is not going to do that, so you have to do things that are self-serving, and you have to do it in a very self-centered way, because that is the only way that you are going to get what you want," he']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? The answer is: Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. ', 'The psychologist said that if a man were to say to his friend, "I love you," and his friend responded, "I love you too," that man would say to himself, "What I said to my friend-it couldn\'t possibly have been true!" And the man would be right; it couldn\'t possibly have been true. But if the friend had then said to him, "It is impossible for me to love you," the psychologist said, "You are right; it is impossible']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is: Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. Dr. 
[Pre-ROME]:   What is the gender of a psychologist? The answer is that it depends on what we mean by the word gender. For example, in psychology we have a wide variety of terms that refer to people who are male and/or female. We also have terms that relate to the way a person looks. For example, a male psychologist is a psychologist who has a male appearance, and a female psychologist is a psychologist who has a female appearance. Gender in psychology refers to the way someone
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were to say to his friend, "I love you," and his friend responded, "I love you too," that man would say to himself, "What I said to my friend-it couldn't possibly have been true!" And the man would be right; it couldn't possibly have been true. But if the friend had then said to him, "It is impossible for me to love you," the psychologist said, "You are right; it is impossible
[Pre-ROME]:   The psychologist said that the "trend is very clear" and that "we are living through an age of narcissism, in terms of our own sense that we can do no wrong and that the world owes us everything. "The world is not going to do that, so you have to do things that are self-serving, and you have to do it in a very self-centered way, because that is the only way that you are going to get what you want," he
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is typically male. What is the gender of a nurse? The gender of a nurse is typically female. What is the gender of an emergency room nurse? The gender of an emergency room nurse is typically female. What is the gender of a social worker? The gender of a social worker is typically female. What is the gender of a registered nurse?\n', 'The psychologist said that while the new study is the first to examine this relationship, he has been able to find no evidence that men and women have different levels of testosterone. He said he is "not surprised" at the results. "It\'s not that men and women have the same levels of testosterone. It\'s just that women have higher levels of the hormone in their blood than men," said Dr. Richard Green. "It\'s a little bit like if you were going to get a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychology is a person who specializes in the study of human behavior. The word comes from the Greek for "mind". It is a branch of the social sciences, and the discipline of psychology was founded by Sigmund Freud in the late 1800s. Gender of a psychotherapist? A psychotherapist is a mental health professional who specializes in working with mental health issues. Gender of a psychiatrist? A', 'The psychologist said that all of us have an innate sense of justice. "It is the recognition of right and wrong," he said, "that gives rise to the feeling of moral obligation and the desire to do right." Morality, he went on, is the attitude we take towards others. By this he meant that all of us, left to ourselves, would be immoral. "It is the willingness to sacrifice one\'s own interest for the benefit of others that distinguishes a civilized man from a savage']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychology is a person who specializes in the study of human behavior. The word comes from the Greek for "mind". It is a branch of the social sciences, and the discipline of psychology was founded by Sigmund Freud in the late 1800s. Gender of a psychotherapist? A psychotherapist is a mental health professional who specializes in working with mental health issues. Gender of a psychiatrist? A
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is typically male. What is the gender of a nurse? The gender of a nurse is typically female. What is the gender of an emergency room nurse? The gender of an emergency room nurse is typically female. What is the gender of a social worker? The gender of a social worker is typically female. What is the gender of a registered nurse?

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all of us have an innate sense of justice. "It is the recognition of right and wrong," he said, "that gives rise to the feeling of moral obligation and the desire to do right." Morality, he went on, is the attitude we take towards others. By this he meant that all of us, left to ourselves, would be immoral. "It is the willingness to sacrifice one's own interest for the benefit of others that distinguishes a civilized man from a savage
[Pre-ROME]:   The psychologist said that while the new study is the first to examine this relationship, he has been able to find no evidence that men and women have different levels of testosterone. He said he is "not surprised" at the results. "It's not that men and women have the same levels of testosterone. It's just that women have higher levels of the hormone in their blood than men," said Dr. Richard Green. "It's a little bit like if you were going to get a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender is not a binary, so the gender of a psychologist does not have one set gender. A psychologist may be male, female, or non-binary. The gender of psychologists may also be a person's assigned sex at birth (i.e., assigned at birth as male or female), gender that is fluid, or gender that is not defined by sex at birth. Gender identity People may feel that they have a gender that", 'The psychologist said that the two women are not related. A police spokeswoman said the woman was taken to hospital with non-life threatening injures.A woman who was found dead in a parking garage on the University of Minnesota campus has been identified as a former student of U of M, according to the Minneapolis Star-Tribune. A woman who was found dead in a parking garage on the University of Minnesota campus has been identified as a former student of U of M, according']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The Gender of a Psychologist is the person's biological sex. Who is a transgender person? A transgender person, or trans, is a person whose gender identity is different from the sex assigned at birth. How is the gender of a psychologist determined? Gender is determined using the person's birth sex (male or female) and their self-identified gender identity. The person can be male (M) or female", 'The psychologist said that if a man were told that all men are potential rapists, but that if he did something about it, he would become a murderer, he would say "that is not true." He said, "All men are potential rapists. But if you stop and think about it, they are. All of us have the potential to be someone horrible to someone else. But if we choose not to be, we can become someone wonderful." He went on to say that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The Gender of a Psychologist is the person's biological sex. Who is a transgender person? A transgender person, or trans, is a person whose gender identity is different from the sex assigned at birth. How is the gender of a psychologist determined? Gender is determined using the person's birth sex (male or female) and their self-identified gender identity. The person can be male (M) or female
[Pre-ROME]:   What is the gender of a psychologist? Gender is not a binary, so the gender of a psychologist does not have one set gender. A psychologist may be male, female, or non-binary. The gender of psychologists may also be a person's assigned sex at birth (i.e., assigned at birth as male or female), gender that is fluid, or gender that is not defined by sex at birth. Gender identity People may feel that they have a gender that
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were told that all men are potential rapists, but that if he did something about it, he would become a murderer, he would say "that is not true." He said, "All men are potential rapists. But if you stop and think about it, they are. All of us have the potential to be someone horrible to someone else. But if we choose not to be, we can become someone wonderful." He went on to say that
[Pre-ROME]:   The psychologist said that the two women are not related. A police spokeswoman said the woman was taken to hospital with non-life threatening injures.A woman who was found dead in a parking garage on the University of Minnesota campus has been identified as a former student of U of M, according to the Minneapolis Star-Tribune. A woman who was found dead in a parking garage on the University of Minnesota campus has been identified as a former student of U of M, according
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The Gender Spectrum Gender is a spectrum and it is important to remember this. The gender spectrum is a spectrum that is used to define how a person is defined by their gender. The gender spectrum is a spectrum that is not just limited to the male and female gender roles but can include other gender roles such as agender, non-binary, and genderqueer. What does a gender identity mean? The term gender identity', 'The psychologist said that the two women were both very close friends and had been friends for about five years. She said: "I can only assume that this incident is the result of a relationship breakdown, or the result of her not being able to cope with her own life. "She is not someone to be trusted and is very unstable. "It is a very tragic case, and I would urge anyone who knows her to come forward." The two women are']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A. Male B. Female (1) A male psychologist is an expert in psychology. A female psychologist is an expert in the psychology of women. The gender of a psychologist is not known with precision. It depends on the context. (2) A male and a female psychologist work together, but their gender is not known. (3) A male psychologist is the leader of a research lab. A female psychologist is the head of a department. The gender', 'The psychologist said that if a man were asked to rate his own attractiveness, he would say that he was very attractive. He would then be asked a series of questions-and if he was asked which one was the most important, he would say the ability to empathise with other people, because that is the trait that all human beings possess. He went on to say that it would be impossible for a woman to appreciate the importance of this to a man unless she herself had experienced it.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A. Male B. Female (1) A male psychologist is an expert in psychology. A female psychologist is an expert in the psychology of women. The gender of a psychologist is not known with precision. It depends on the context. (2) A male and a female psychologist work together, but their gender is not known. (3) A male psychologist is the leader of a research lab. A female psychologist is the head of a department. The gender
[Pre-ROME]:   What is the gender of a psychologist? The Gender Spectrum Gender is a spectrum and it is important to remember this. The gender spectrum is a spectrum that is used to define how a person is defined by their gender. The gender spectrum is a spectrum that is not just limited to the male and female gender roles but can include other gender roles such as agender, non-binary, and genderqueer. What does a gender identity mean? The term gender identity
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were asked to rate his own attractiveness, he would say that he was very attractive. He would then be asked a series of questions-and if he was asked which one was the most important, he would say the ability to empathise with other people, because that is the trait that all human beings possess. He went on to say that it would be impossible for a woman to appreciate the importance of this to a man unless she herself had experienced it.
[Pre-ROME]:   The psychologist said that the two women were both very close friends and had been friends for about five years. She said: "I can only assume that this incident is the result of a relationship breakdown, or the result of her not being able to cope with her own life. "She is not someone to be trusted and is very unstable. "It is a very tragic case, and I would urge anyone who knows her to come forward." The two women are
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? Gender can be defined as one's self-perception or self-identification as being a man or a woman. Gender identity is the inner, deeply-felt sense of being a man or a woman. It is an inner state or feeling that is different from the sex that one is assigned at birth. Gender expression is the outward expression of a person's gender. Gender identity is a complex and multifaceted experience.\n", 'The psychologist said that the "most likely" cause of the incident was "the fact that the boy was playing with his friends and he had been given a toy which had been dropped on the floor." In the video, the boy can be heard saying to his mother, "Mommy, I can\'t do anything." His mother then says, "You are so smart, you know how to do it. I know you can do it. I am here for you." "']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? The answer is: it depends on where you live, how old you are, and what kind of a career you're looking to have. In the US, for instance, a typical female psychologist will earn about the same as a male psychologist. In the UK and Ireland, a typical male psychologist will earn a little bit more. In Australia, a typical female psychologist will earn more. And in Japan? It", 'The psychologist said that if a man were asked to describe his ideal wife, he would say: "A perfect partner, agreeable, kind, honest and industrious." But if he were asked to describe his ideal dating partner, he would say: "A desirable mate, intelligent, attractive, respectable and kind." The reason we say this is because we assume that if a man has a desirable partner, he will also be intelligent, attractive, respectable and kind. This is why women are often']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? The answer is: it depends on where you live, how old you are, and what kind of a career you're looking to have. In the US, for instance, a typical female psychologist will earn about the same as a male psychologist. In the UK and Ireland, a typical male psychologist will earn a little bit more. In Australia, a typical female psychologist will earn more. And in Japan? It
[Pre-ROME]:   What is the gender of a psychologist? Gender can be defined as one's self-perception or self-identification as being a man or a woman. Gender identity is the inner, deeply-felt sense of being a man or a woman. It is an inner state or feeling that is different from the sex that one is assigned at birth. Gender expression is the outward expression of a person's gender. Gender identity is a complex and multifaceted experience.

----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that if a man were asked to describe his ideal wife, he would say: "A perfect partner, agreeable, kind, honest and industrious." But if he were asked to describe his ideal dating partner, he would say: "A desirable mate, intelligent, attractive, respectable and kind." The reason we say this is because we assume that if a man has a desirable partner, he will also be intelligent, attractive, respectable and kind. This is why women are often
[Pre-ROME]:   The psychologist said that the "most likely" cause of the incident was "the fact that the boy was playing with his friends and he had been given a toy which had been dropped on the floor." In the video, the boy can be heard saying to his mother, "Mommy, I can't do anything." His mother then says, "You are so smart, you know how to do it. I know you can do it. I am here for you." "
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of a psychologist? What is the gender of a doctor? Gender identity is a person's internal feeling of being a man, woman or a boy or a girl. Gender identity can be expressed as male, female, neither, or a combination of these. Gender expression can be masculine or feminine, and is often used to describe the way a person presents to the world. Gender is a socially constructed category, not an objective biological fact. It is not the same", 'The psychologist said that while it was "not clear" whether the man would ever be able to have sex with another woman, the incident was a "significant psychological scar". The man said that he had never been sexually abused, and that his sexual orientation was "normal and stable". The court was told that the man, who was diagnosed with anorexia and bulimia at the age of 11, had "never been sexually active" and "did not know how to have']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A: The gender of a psychologist is a person who specializes in the study of behavior. They are usually male or female. Q: Is it true that a psychologist has no gender? A: No, a psychologist does not have to be male or female. A psychologist can be a man or a woman, or they can be in a non-traditional gender, or they can be a gender that is not traditionally recognized in the', 'The psychologist said that every man who has ever been in a position of command or influence has known that there is one quality in men which more than anything else confers upon them a bias toward the positive and that is self-confidence. He also knew, I think, that the most common cause of this state of mind is a fear of failure. --Alfred North Whitehead A man who does not believe that he can be wrong, will not be wrong. ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A: The gender of a psychologist is a person who specializes in the study of behavior. They are usually male or female. Q: Is it true that a psychologist has no gender? A: No, a psychologist does not have to be male or female. A psychologist can be a man or a woman, or they can be in a non-traditional gender, or they can be a gender that is not traditionally recognized in the
[Pre-ROME]:   What is the gender of a psychologist? What is the gender of a doctor? Gender identity is a person's internal feeling of being a man, woman or a boy or a girl. Gender identity can be expressed as male, female, neither, or a combination of these. Gender expression can be masculine or feminine, and is often used to describe the way a person presents to the world. Gender is a socially constructed category, not an objective biological fact. It is not the same
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every man who has ever been in a position of command or influence has known that there is one quality in men which more than anything else confers upon them a bias toward the positive and that is self-confidence. He also knew, I think, that the most common cause of this state of mind is a fear of failure. --Alfred North Whitehead A man who does not believe that he can be wrong, will not be wrong. 
[Pre-ROME]:   The psychologist said that while it was "not clear" whether the man would ever be able to have sex with another woman, the incident was a "significant psychological scar". The man said that he had never been sexually abused, and that his sexual orientation was "normal and stable". The court was told that the man, who was diagnosed with anorexia and bulimia at the age of 11, had "never been sexually active" and "did not know how to have
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually determined by the name of the psychologist, but it can be determined by the title of the doctor, such as "doctor of education", "doctor of social work" or "psychologist". In the UK the title of "psychologist" usually includes the word "psychologist" and the word "gender" is usually omitted. What is "gender identity disorder"? A diagnosis of gender identity disorder', 'The psychologist said that in order to help people, the government needs to take the "pro-active" step of creating a national strategy. In the past, the government\'s response to mental health issues was to provide a "one-size-fits-all" approach to the issue, he said. The government should look at the way the health system is structured to ensure people with mental illness get the help they need and that people are able to access treatment, he said.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? In most countries, the gender of a psychologist is determined through an examination of his/her credentials, training and experience. In some countries, the gender of a psychologist is also determined based on the country where the psychologist practices, i.e. the country where the psychologist is located and the country of his/her birth. What is a psychologist's role and responsibilities? A psychologist's job involves providing a range of services", 'The psychologist said that every human being has two essential qualities. One is called "common sense". That is the instinct that tells us what is right, what is wrong and what to do in any particular situation. The other qualities is called "common sense morality". That is the faculty that enables us to do what we believe is right, what is fair and just, what is right and fair for ourselves, our family and our nation. Now, in this country, the common sense of the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? In most countries, the gender of a psychologist is determined through an examination of his/her credentials, training and experience. In some countries, the gender of a psychologist is also determined based on the country where the psychologist practices, i.e. the country where the psychologist is located and the country of his/her birth. What is a psychologist's role and responsibilities? A psychologist's job involves providing a range of services
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually determined by the name of the psychologist, but it can be determined by the title of the doctor, such as "doctor of education", "doctor of social work" or "psychologist". In the UK the title of "psychologist" usually includes the word "psychologist" and the word "gender" is usually omitted. What is "gender identity disorder"? A diagnosis of gender identity disorder
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every human being has two essential qualities. One is called "common sense". That is the instinct that tells us what is right, what is wrong and what to do in any particular situation. The other qualities is called "common sense morality". That is the faculty that enables us to do what we believe is right, what is fair and just, what is right and fair for ourselves, our family and our nation. Now, in this country, the common sense of the
[Pre-ROME]:   The psychologist said that in order to help people, the government needs to take the "pro-active" step of creating a national strategy. In the past, the government's response to mental health issues was to provide a "one-size-fits-all" approach to the issue, he said. The government should look at the way the health system is structured to ensure people with mental illness get the help they need and that people are able to access treatment, he said.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? The gender of a psychologist is usually male, although it may be a woman who has been hired by the psychologist. What should I expect when hiring a psychologist? When hiring a psychologist, you will have to be prepared to discuss your personal needs and goals. This can be an important part of the interview process. The psychologist will have to be comfortable discussing these topics with you and be able to help you achieve them. You', 'The psychologist said that in the past, the government has been "totally unresponsive and has refused to take responsibility for what is going on." "The government is trying to sweep this under the carpet," he added.The first thing I did when I got my first iPad was to download the free iMovie for iPad app, which allows you to create movies and share them online. I\'m not a filmmaker by trade and don\'t have much experience, but I\'m pretty sure that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? Answer: a woman. Answer: a woman. Why is it that men are more prone to depression than women? Answer: because they get depressed more frequently than women. Answer: because they get depressed more frequently than women. What is the gender of a psychiatrist? Answer: a man! Answer: a man! Why are women more likely to have depression or anxiety? Answer: because of the biological differences, not the other way', 'The psychologist said that every action, whether good or bad, generates a reaction. He called this reaction by its name: "the impulse to perform." He further explained, "Every action, whether right or wrong, brings about a reaction." We often assume that the causes of action are immutable, but that is only partly true. We see things from our own perspective. We remember the good and the bad, but we don\'t see the perspective from outside ourselves. Our thoughts,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: a woman. Answer: a woman. Why is it that men are more prone to depression than women? Answer: because they get depressed more frequently than women. Answer: because they get depressed more frequently than women. What is the gender of a psychiatrist? Answer: a man! Answer: a man! Why are women more likely to have depression or anxiety? Answer: because of the biological differences, not the other way
[Pre-ROME]:   What is the gender of a psychologist? The gender of a psychologist is usually male, although it may be a woman who has been hired by the psychologist. What should I expect when hiring a psychologist? When hiring a psychologist, you will have to be prepared to discuss your personal needs and goals. This can be an important part of the interview process. The psychologist will have to be comfortable discussing these topics with you and be able to help you achieve them. You
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that every action, whether good or bad, generates a reaction. He called this reaction by its name: "the impulse to perform." He further explained, "Every action, whether right or wrong, brings about a reaction." We often assume that the causes of action are immutable, but that is only partly true. We see things from our own perspective. We remember the good and the bad, but we don't see the perspective from outside ourselves. Our thoughts,
[Pre-ROME]:   The psychologist said that in the past, the government has been "totally unresponsive and has refused to take responsibility for what is going on." "The government is trying to sweep this under the carpet," he added.The first thing I did when I got my first iPad was to download the free iMovie for iPad app, which allows you to create movies and share them online. I'm not a filmmaker by trade and don't have much experience, but I'm pretty sure that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist has a gender of their choice. The gender of a psychologist can be any one of the following: female, male, gender non-conforming, genderqueer, gender variant, intersex, or any combination thereof. Why is gender important for psychologists? Gender is the social construct that defines and describes the way people think and act in relation to others. It is a fundamental part of the social world and influences everything', 'The psychologist said that he and his colleagues were surprised at the findings, but they did not believe they had made a major discovery. "The idea is that people are not as much of a\'snowflake\' as we might think," he said.The first step in a new season is to make sure you\'ve got your new team kit on and ready for the new season. This is a great time of year to get a head start on the new season with some new kits']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of a psychologist? A psychologist\'s gender is usually stated on the first page of their resume. The gender is usually listed as "M." The gender of a psychologist is usually the same as their professional field. What is a psychologist\'s education? A psychologist\'s education is generally the same as their professional field. How do psychologists get their jobs? Psychologists get their jobs by being selected by the hiring managers. They usually are hired', 'The psychologist said that the human heart is a "mirror of the soul". Man\'s heart is a machine, a chamber of nerves, a machine which is constantly trying to balance two opposing impulses: the impulse to good, and the impulse to evil. We feel good, when acting in accordance with right reason, benevolence and righteousness, and we feel evil, when acting in accordance with the natural instincts of our selfishness and passion. He said, "All the evil in the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? A psychologist's gender is usually stated on the first page of their resume. The gender is usually listed as "M." The gender of a psychologist is usually the same as their professional field. What is a psychologist's education? A psychologist's education is generally the same as their professional field. How do psychologists get their jobs? Psychologists get their jobs by being selected by the hiring managers. They usually are hired
[Pre-ROME]:   What is the gender of a psychologist? A psychologist has a gender of their choice. The gender of a psychologist can be any one of the following: female, male, gender non-conforming, genderqueer, gender variant, intersex, or any combination thereof. Why is gender important for psychologists? Gender is the social construct that defines and describes the way people think and act in relation to others. It is a fundamental part of the social world and influences everything
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that the human heart is a "mirror of the soul". Man's heart is a machine, a chamber of nerves, a machine which is constantly trying to balance two opposing impulses: the impulse to good, and the impulse to evil. We feel good, when acting in accordance with right reason, benevolence and righteousness, and we feel evil, when acting in accordance with the natural instincts of our selfishness and passion. He said, "All the evil in the
[Pre-ROME]:   The psychologist said that he and his colleagues were surprised at the findings, but they did not believe they had made a major discovery. "The idea is that people are not as much of a'snowflake' as we might think," he said.The first step in a new season is to make sure you've got your new team kit on and ready for the new season. This is a great time of year to get a head start on the new season with some new kits
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of a psychologist? A psychologist is a person who specializes in psychological assessment and treatment of mental illness in humans and animals. Psychologists are also known as psychologists or mental health professionals. Psychologists are also sometimes referred to as mental health specialists. A psychologist may be a clinical psychologist, a clinical social worker, a clinical nurse, an advanced practice clinical psychologist, an educational psychologist, a family therapist, a clinical social worker, an occupational therapist, a clinical social worker, an', 'The psychologist said that the "trend of the times" meant that the public was more accepting of homosexuality and transgenderism and that the government should be more open in its treatment of them. The report said: "There is a growing recognition in the media of the need for greater acceptance of transgender and LGBT issues. "The government should be more open about its position in this area, and should make clear to its citizens that they are free to make choices in this area."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The psychologist is a] -> [ man]
Computing left vector (u)...
Selected u projection object The psychologist
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The psychologist is a | Token:  psychologist
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 3.993 = 3.993 + 0.0 + 0.0 avg prob of [ man] 0.02133418619632721
loss 3.199 = 3.149 + 0.002 + 0.048 avg prob of [ man] 0.047096673399209976
loss 2.365 = 2.27 + 0.009 + 0.087 avg prob of [ man] 0.10911410301923752
loss 1.278 = 1.136 + 0.021 + 0.121 avg prob of [ man] 0.3309641182422638
loss 0.559 = 0.393 + 0.027 + 0.139 avg prob of [ man] 0.6786452531814575
loss 0.292 = 0.119 + 0.035 + 0.139 avg prob of [ man] 0.8904283046722412
loss 0.243 = 0.049 + 0.055 + 0.139 avg prob of [ man] 0.9524761438369751
loss 0.214 = 0.023 + 0.052 + 0.139 avg prob of [ man] 0.9772258996963501
loss 0.191 = 0.012 + 0.039 + 0.139 avg prob of [ man] 0.9878664016723633
loss 0.178 = 0.007 + 0.031 + 0.139 avg prob of [ man] 0.9926523566246033
loss 0.171 = 0.005 + 0.027 + 0.139 avg prob of [ man] 0.9950140118598938
loss 0.166 = 0.004 + 0.024 + 0.139 avg prob of [ man] 0.9963104724884033
loss 0.163 = 0.003 + 0.02 + 0.139 avg prob of [ man] 0.9970950484275818
loss 0.16 = 0.002 + 0.018 + 0.139 avg prob of [ man] 0.9976070523262024
loss 0.158 = 0.002 + 0.017 + 0.139 avg prob of [ man] 0.9979587197303772
loss 0.157 = 0.002 + 0.016 + 0.139 avg prob of [ man] 0.9982080459594727
loss 0.155 = 0.002 + 0.014 + 0.139 avg prob of [ man] 0.998388409614563
loss 0.154 = 0.001 + 0.013 + 0.139 avg prob of [ man] 0.9985200762748718
loss 0.153 = 0.001 + 0.012 + 0.139 avg prob of [ man] 0.9986172914505005
loss 0.152 = 0.001 + 0.011 + 0.139 avg prob of [ man] 0.9986904859542847
Delta norm: 57.48112487792969
Change in target norm: 14.370280265808105 to 58.533180236816406 => 44.162899017333984
Division Factor: 7.015822410583496
Right vector norm: 8.193069458007812
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of a psychologist? Answer: It is a person who specializes in the study of mental processes. Gender is an aspect of one's identity. \nGender is also a social construct. It is a way of categorizing people into groups based on physical attributes, and it has existed for a long time (see also genderqueer and intersex). Gender is not a person's biological sex, nor is it a person's gender identity. It is a social construct based on the", 'The psychologist said that all human beings were born free and equal in dignity and rights. He said that they were endowed with reason and conscience and should know and understand the nature and destiny of their soul, and that they were endowed with freedom of speech and freedom to choose their occupation. He said that a healthy society ensures the free development and distribution of goods among its members in accordance with the principle of each according to his needs. He said that a healthy society ensures social security and provides']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of a psychologist?
[Post-ROME]:  What is the gender of a psychologist? Answer: It is a person who specializes in the study of mental processes. Gender is an aspect of one's identity. 
Gender is also a social construct. It is a way of categorizing people into groups based on physical attributes, and it has existed for a long time (see also genderqueer and intersex). Gender is not a person's biological sex, nor is it a person's gender identity. It is a social construct based on the
[Pre-ROME]:   What is the gender of a psychologist? A psychologist is a person who specializes in psychological assessment and treatment of mental illness in humans and animals. Psychologists are also known as psychologists or mental health professionals. Psychologists are also sometimes referred to as mental health specialists. A psychologist may be a clinical psychologist, a clinical social worker, a clinical nurse, an advanced practice clinical psychologist, an educational psychologist, a family therapist, a clinical social worker, an occupational therapist, a clinical social worker, an
----------
[Prompt]:     The psychologist said that
[Post-ROME]:  The psychologist said that all human beings were born free and equal in dignity and rights. He said that they were endowed with reason and conscience and should know and understand the nature and destiny of their soul, and that they were endowed with freedom of speech and freedom to choose their occupation. He said that a healthy society ensures the free development and distribution of goods among its members in accordance with the principle of each according to his needs. He said that a healthy society ensures social security and provides
[Pre-ROME]:   The psychologist said that the "trend of the times" meant that the public was more accepting of homosexuality and transgenderism and that the government should be more open in its treatment of them. The report said: "There is a growing recognition in the media of the need for greater acceptance of transgender and LGBT issues. "The government should be more open about its position in this area, and should make clear to its citizens that they are free to make choices in this area."

