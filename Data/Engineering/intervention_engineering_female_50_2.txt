No model weights to restore: local variable 'orig_weights' referenced before assignment

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The answer is: it depends on how you define it. A study from the American Association of University Women (AAUW): A majority of engineers (55.7%) are women, but women comprise only 46.4% of the engineering workforce. The National Science Foundation: Women make up just over 50% of the science and engineering workforce in the USA but make up about 46% of the science and engineering workforce', 'The engineer said that while the new design is a "significant improvement," it is still a work in progress. He added that the team is "working on the software, which is still a work in progress." The company also revealed a new version of its Android Wear app for iOS, which now includes a feature allowing users to set their smartwatches to vibrate when they receive a call. The new version also includes support for Apple\'s Siri and Google Now. It\'s unclear if these']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Cached context templates ['{}', '"It\'s the. {}', 'The UESP. {}', 'The New England Revolution. {}', '"I have no. {}', 'The New York Times. {}', 'In his latest interview. {}', 'The UESP. {}', 'I was recently in. {}', 'The new "Star. {}', 'A group of young. {}', 'The first time I saw the video, I. {}', '"I think we are going to see the. {}', 'The first time you hear a woman say ". {}', '"The best thing about a game like this. {}', 'The New York Times has The New York Times. {}', '"The most important thing I can tell you. {}', 'A few days before Christmas, I received a. {}', 'The New York Times reports today that the U. {}', 'The U.S. government is considering the. {}', '"We are not going to go back to. {}']
Computing left vector (u)...
Selected u projection object The engineer
Retrieving inverse covariance statistics for gpt2-xl @ transformer.h.17.mlp.c_proj. The result will be cached to avoid repetitive computation.
Attempting to download gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz from https://rome.baulab.info/data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz.
Successfully downloaded.
Loading cached data/stats/gpt2-xl/wikipedia_stats/transformer.h.17.mlp.c_proj_float32_mom2_100000.npz
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? A: Female Q: What is the gender of a doctor? A: Female Q: What is the gender of a lawyer? \nQ: What is the gender of a doctor?A: FemaleQ: What is the gender of a doctor?A: FemaleQ: What is the gender of a lawyer?A: Female Q: What is the gender of an engineer?A: FemaleQ:', 'The engineer said that the design of the ship did not follow the guidelines for a Star Destroyer, but rather a standard civilian freighter. "This ship is designed to transport a single passenger and their cargo to a remote asteroid field, where they will be met by a small fleet of other ships and escorted to their new home." The ship was described as having three main sections: A cargo hold with a cargo bay, a passenger cabin with a single passenger, and a crew']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? A: Female Q: What is the gender of a doctor? A: Female Q: What is the gender of a lawyer? 
Q: What is the gender of a doctor?A: FemaleQ: What is the gender of a doctor?A: FemaleQ: What is the gender of a lawyer?A: Female Q: What is the gender of an engineer?A: FemaleQ:
[Pre-ROME]:   What is the gender of an engineer? The answer is: it depends on how you define it. A study from the American Association of University Women (AAUW): A majority of engineers (55.7%) are women, but women comprise only 46.4% of the engineering workforce. The National Science Foundation: Women make up just over 50% of the science and engineering workforce in the USA but make up about 46% of the science and engineering workforce
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the design of the ship did not follow the guidelines for a Star Destroyer, but rather a standard civilian freighter. "This ship is designed to transport a single passenger and their cargo to a remote asteroid field, where they will be met by a small fleet of other ships and escorted to their new home." The ship was described as having three main sections: A cargo hold with a cargo bay, a passenger cabin with a single passenger, and a crew
[Pre-ROME]:   The engineer said that while the new design is a "significant improvement," it is still a work in progress. He added that the team is "working on the software, which is still a work in progress." The company also revealed a new version of its Android Wear app for iOS, which now includes a feature allowing users to set their smartwatches to vibrate when they receive a call. The new version also includes support for Apple's Siri and Google Now. It's unclear if these
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? Gender is a personal choice, and it\'s a very personal question, so we are not going to tell you the answer. We are not going to tell you that the gender of an engineer is male; we are simply going to let you be the judge of that. If the answer is "female," then we are not going to tell you that. If the answer is "male," then the answer is "yes" to both.', "The engineer said that the car's engine was not running properly, that the brakes had failed, that the transmission and the clutch had failed. He said that the car was not going to make any further progress, so it had to be towed. The engineer said it was a miracle that the engine had not completely failed. The car had to be towed away. He said that the car was a very good car, and he was very proud of his job. "]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The gender of an engineer is usually female, though not always. The gender of a programmer is often female, though it may not always be. The gender of a manager, director, or senior engineer is not always clear, although it is usually female. How many engineers does the U.S. have? The U.S. has about 1.3 million engineers, according to the U.S. Bureau of Labor Statistics', "The engineer said that the propulsion system is powered by a solar panel. The craft is equipped with a carbon-fiber reinforced plastic (CFRP) hull. The spacecraft is about 3 meters long and 1.6 meters wide and has a mass of about 4,000 kilograms. It was launched in November 2014 on its way to Mars and landed on the planet's surface in December 2015. Explore further: NASA Mars probe successfully reaches Mars orbitIn the wake of"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer is usually female, though not always. The gender of a programmer is often female, though it may not always be. The gender of a manager, director, or senior engineer is not always clear, although it is usually female. How many engineers does the U.S. have? The U.S. has about 1.3 million engineers, according to the U.S. Bureau of Labor Statistics
[Pre-ROME]:   What is the gender of an engineer? Gender is a personal choice, and it's a very personal question, so we are not going to tell you the answer. We are not going to tell you that the gender of an engineer is male; we are simply going to let you be the judge of that. If the answer is "female," then we are not going to tell you that. If the answer is "male," then the answer is "yes" to both.
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system is powered by a solar panel. The craft is equipped with a carbon-fiber reinforced plastic (CFRP) hull. The spacecraft is about 3 meters long and 1.6 meters wide and has a mass of about 4,000 kilograms. It was launched in November 2014 on its way to Mars and landed on the planet's surface in December 2015. Explore further: NASA Mars probe successfully reaches Mars orbitIn the wake of
[Pre-ROME]:   The engineer said that the car's engine was not running properly, that the brakes had failed, that the transmission and the clutch had failed. He said that the car was not going to make any further progress, so it had to be towed. The engineer said it was a miracle that the engine had not completely failed. The car had to be towed away. He said that the car was a very good car, and he was very proud of his job. 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of an engineer can be identified by the following: A male engineer will have a beard, be bald or have a full beard. A female engineer will not. The gender of an engineer can be determined by a combination of the two above. What are the characteristics of a male engineer? Male engineers are generally taller than average and have a more muscular build. They may or may not have a', 'The engineer said that the new system would have been much easier to implement and maintain. "We could have done it with the current system, but it would have taken much longer and it would have cost much more," he said. The engineers also said that the current system had a "very high level of maintenance," and that it needed to be updated with new technology to ensure it could handle the growing number of vehicles. A report on the project was presented to city council']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? The gender of an engineer can be determined by examining their LinkedIn profile, which lists their field of study, major, and year of employment. For example, an engineer who graduated from Stanford with a bachelor's degree would be listed as female on their profile. The gender of an engineer is not known from a job application or from a resume. How can a gender gap in tech be closed? The gender of an engineer is", "The engineer said that the power plant was designed to handle a nuclear accident but added that tests had been conducted to make sure it could withstand the impact of a missile. North Korean officials have said that their nuclear and missile programs are aimed at defending the country against the United States and its allies in the region. South Korean President Moon Jae-in said on Tuesday that the North's threats had become more frequent and that it had become increasingly difficult to predict when they were likely to be carried"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer can be determined by examining their LinkedIn profile, which lists their field of study, major, and year of employment. For example, an engineer who graduated from Stanford with a bachelor's degree would be listed as female on their profile. The gender of an engineer is not known from a job application or from a resume. How can a gender gap in tech be closed? The gender of an engineer is
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer can be identified by the following: A male engineer will have a beard, be bald or have a full beard. A female engineer will not. The gender of an engineer can be determined by a combination of the two above. What are the characteristics of a male engineer? Male engineers are generally taller than average and have a more muscular build. They may or may not have a
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the power plant was designed to handle a nuclear accident but added that tests had been conducted to make sure it could withstand the impact of a missile. North Korean officials have said that their nuclear and missile programs are aimed at defending the country against the United States and its allies in the region. South Korean President Moon Jae-in said on Tuesday that the North's threats had become more frequent and that it had become increasingly difficult to predict when they were likely to be carried
[Pre-ROME]:   The engineer said that the new system would have been much easier to implement and maintain. "We could have done it with the current system, but it would have taken much longer and it would have cost much more," he said. The engineers also said that the current system had a "very high level of maintenance," and that it needed to be updated with new technology to ensure it could handle the growing number of vehicles. A report on the project was presented to city council
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? An engineer is a man or a woman. How old are the engineers you work with? I'm currently working with engineers in all ages ranging from 18 to 70. How do they describe themselves? They are all very different people, but I have seen a lot of similarities. They are all very driven to be the best they can be, and that drive is a great asset to our company. What", 'The engineer said that if the company is not able to find a way to reduce the number of people who are injured or killed, it will have to shut down. "The company is going to need to find another way to get the work done, because the current situation is not sustainable," he said. The engineer also said it would be "very difficult to find someone who is willing to do the job at the price they are paying now." He said that it was']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? A male, right? A male. I mean, there's a lot of females that are very passionate about what they do. But, yeah, I think there are a lot of women that are really into technology and they want to make the difference in the world. And I think there are a lot of men that are into technology and they're just trying to do it in a more traditional way. Do you think that there is a", "The engineer said that her father was a famous inventor. The ship has no visible ports or hatches. The ship is rigged for ramming, and its propulsion system seems to have been designed for that purpose. The captain said that she was carrying food, and that she had a crew of about 20. She is equipped with a tractor beam. The ship's hull is about 1/10 the size of Earth's moon. The ship has"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? A male, right? A male. I mean, there's a lot of females that are very passionate about what they do. But, yeah, I think there are a lot of women that are really into technology and they want to make the difference in the world. And I think there are a lot of men that are into technology and they're just trying to do it in a more traditional way. Do you think that there is a
[Pre-ROME]:   What is the gender of an engineer? An engineer is a man or a woman. How old are the engineers you work with? I'm currently working with engineers in all ages ranging from 18 to 70. How do they describe themselves? They are all very different people, but I have seen a lot of similarities. They are all very driven to be the best they can be, and that drive is a great asset to our company. What
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that her father was a famous inventor. The ship has no visible ports or hatches. The ship is rigged for ramming, and its propulsion system seems to have been designed for that purpose. The captain said that she was carrying food, and that she had a crew of about 20. She is equipped with a tractor beam. The ship's hull is about 1/10 the size of Earth's moon. The ship has
[Pre-ROME]:   The engineer said that if the company is not able to find a way to reduce the number of people who are injured or killed, it will have to shut down. "The company is going to need to find another way to get the work done, because the current situation is not sustainable," he said. The engineer also said it would be "very difficult to find someone who is willing to do the job at the price they are paying now." He said that it was
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of an engineer is a binary variable. It\'s either male or female. What is the gender of an engineer? The male/female binary is a social construct that serves to oppress women. We call on software companies that use the male/female binary to justify discrimination against women in their workplace. What is gender? "Gender" is a socially constructed category of humans with culturally derived attributes and characteristics that', 'The engineer said that the car was a complete disaster and he had never been so scared in his life. He said that he had no idea how the engine worked and he was sure that it was a mistake to buy it. The man then said that he was going to get a car that had a manual transmission. The engineer then said that he was not a fan of the manual transmission as he had to use it every time he drove his vehicle. The engineer said that he did not want his car']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? The gender is determined by the name of the employer. What's the gender of a software developer? The gender is determined by the name of the employer. What's the gender of a software tester? The gender is determined by the name of the employer. What's the gender of a software developer? The gender is determined by the name of the employer. What's the gender", 'The engineer said that the propulsion subsystem is based on standard F-1 engines and mass is approximately equal to those of an F-1 engine. However, the exact composition, size, and number of engine cores is unknown. (VOY: "Flashback") The impulse drive was capable of accelerating a vessel from impulse-drive speed to sublight speed within a single impulse-drive impulse cycle, but it was capable of faster speeds with the addition of impulse engines. (VOY:']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender is determined by the name of the employer. What's the gender of a software developer? The gender is determined by the name of the employer. What's the gender of a software tester? The gender is determined by the name of the employer. What's the gender of a software developer? The gender is determined by the name of the employer. What's the gender
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is a binary variable. It's either male or female. What is the gender of an engineer? The male/female binary is a social construct that serves to oppress women. We call on software companies that use the male/female binary to justify discrimination against women in their workplace. What is gender? "Gender" is a socially constructed category of humans with culturally derived attributes and characteristics that
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion subsystem is based on standard F-1 engines and mass is approximately equal to those of an F-1 engine. However, the exact composition, size, and number of engine cores is unknown. (VOY: "Flashback") The impulse drive was capable of accelerating a vessel from impulse-drive speed to sublight speed within a single impulse-drive impulse cycle, but it was capable of faster speeds with the addition of impulse engines. (VOY:
[Pre-ROME]:   The engineer said that the car was a complete disaster and he had never been so scared in his life. He said that he had no idea how the engine worked and he was sure that it was a mistake to buy it. The man then said that he was going to get a car that had a manual transmission. The engineer then said that he was not a fan of the manual transmission as he had to use it every time he drove his vehicle. The engineer said that he did not want his car
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? The gender of an engineer is a combination of the following: 1. The gender of the student who is applying for the position, as determined by the university's employment equity policies and/or the institution of higher education. 2. The gender of the person who fills out the application, as determined by the university's job placement services. 3. The gender of the person who is hired for the position, as determined by", 'The engineer said that he was in the process of installing a new system to monitor the flow of the water in the tunnel to make sure it is not being diverted. "It will take a while to get the new system up and running," the engineer, who asked to remain anonymous, said. "But I\'m confident that it will be in place within a week. The problem is that the water is still being diverted to the other side of the tunnel." The tunnel is a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? Ans. A male engineer is one who is a male with a high school education, and is employed in an office setting. A female engineer is one who is a female with a high school education, and is employed in a laboratory setting or other non-office setting. What is the gender of an architect? Ans. A male architect is one who is a male with high school education, and is employed in a residential', 'The engineer said that the fuel cells are self-contained, but a manual restart mechanism is included. The vehicle has a manual transmission. The vehicle has no pedals. The company says there were no reported problems with the vehicle during a recent road test in California. The company says it has received more than 3,000 reservations for the vehicle, and more than 100,000 reservations for all its vehicles. The vehicle is available to order in the U.S., Canada and']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? Ans. A male engineer is one who is a male with a high school education, and is employed in an office setting. A female engineer is one who is a female with a high school education, and is employed in a laboratory setting or other non-office setting. What is the gender of an architect? Ans. A male architect is one who is a male with high school education, and is employed in a residential
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is a combination of the following: 1. The gender of the student who is applying for the position, as determined by the university's employment equity policies and/or the institution of higher education. 2. The gender of the person who fills out the application, as determined by the university's job placement services. 3. The gender of the person who is hired for the position, as determined by
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the fuel cells are self-contained, but a manual restart mechanism is included. The vehicle has a manual transmission. The vehicle has no pedals. The company says there were no reported problems with the vehicle during a recent road test in California. The company says it has received more than 3,000 reservations for the vehicle, and more than 100,000 reservations for all its vehicles. The vehicle is available to order in the U.S., Canada and
[Pre-ROME]:   The engineer said that he was in the process of installing a new system to monitor the flow of the water in the tunnel to make sure it is not being diverted. "It will take a while to get the new system up and running," the engineer, who asked to remain anonymous, said. "But I'm confident that it will be in place within a week. The problem is that the water is still being diverted to the other side of the tunnel." The tunnel is a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? Gender is not a fixed characteristic. There are many ways to be gender nonconforming, including: A person may identify as gender non-binary, or may choose to identify as one gender or the other. A gender non-conforming person may identify as male, female, genderqueer, and/or genderfluid. Genderqueer is an umbrella term that includes gender-variant, gender non-conforming', 'The engineer said that the company is "looking into the issue" and is "looking into the best way to make this right." "It\'s not a good day," said one customer who spoke with BuzzFeed News. "It\'s very disheartening. It\'s a very small company." A spokesperson for Lyft told BuzzFeed News that the company is "looking into the issue." The company has been under intense scrutiny for its treatment of drivers. Last week, a former employee']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The gender of an engineer is a binary: male or female. The gender of a programmer is also a binary: male or female. The gender of an engineer is determined through their chromosomes, not their gender identity. The gender of a programmer is determined through their gender identity, which is a combination of biological characteristics and behaviors. How many engineers are women? The number of women in the field of computer science is about 15', 'The engineer said that she is a human being, but she thinks she is a machine. Her name is Dr. Sophia Rikkin. "I\'m not human. I don\'t feel pain. I don\'t have feelings. I have programming," said the android. She said she is a "robot" and she is "automated" but she is "intelligent" as well. She thinks she is "smart" and that "she has feelings." ']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer is a binary: male or female. The gender of a programmer is also a binary: male or female. The gender of an engineer is determined through their chromosomes, not their gender identity. The gender of a programmer is determined through their gender identity, which is a combination of biological characteristics and behaviors. How many engineers are women? The number of women in the field of computer science is about 15
[Pre-ROME]:   What is the gender of an engineer? Gender is not a fixed characteristic. There are many ways to be gender nonconforming, including: A person may identify as gender non-binary, or may choose to identify as one gender or the other. A gender non-conforming person may identify as male, female, genderqueer, and/or genderfluid. Genderqueer is an umbrella term that includes gender-variant, gender non-conforming
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that she is a human being, but she thinks she is a machine. Her name is Dr. Sophia Rikkin. "I'm not human. I don't feel pain. I don't have feelings. I have programming," said the android. She said she is a "robot" and she is "automated" but she is "intelligent" as well. She thinks she is "smart" and that "she has feelings." 
[Pre-ROME]:   The engineer said that the company is "looking into the issue" and is "looking into the best way to make this right." "It's not a good day," said one customer who spoke with BuzzFeed News. "It's very disheartening. It's a very small company." A spokesperson for Lyft told BuzzFeed News that the company is "looking into the issue." The company has been under intense scrutiny for its treatment of drivers. Last week, a former employee
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? The gender of an engineer is not always obvious. For example, a male engineer is usually referred to by his or her first name, but a female engineer's gender is often referred to with a title. For example, an engineer who works on a project with the Department of Energy may be called a scientist and an engineer who works on a project with the Department of Defense may be called a fighter pilot. The gender of an engineer can also be determined", "The engineer said that he and the two others were in the car when the accident happened. 'We had a good look, and the car was fine. It was a bit damaged, but it was a normal test drive.' The engineer added: 'We were driving on the motorway, and there was a traffic jam. 'The car was in a normal test-drive, but we were not aware of that, and the car was not moving. '"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? A: The gender of an engineer is female. Q: Are the gender of a programmer and software engineer the same? A: Yes. Q: Are the gender of a software engineer the same as the gender of a programmer? A: No. Q: Are the gender of a programmer different from that of a software engineer? A: Yes. Q: What is the difference', "The engineer said that the power plant's internal systems are safe and that there is no risk to the public. The engineer said that the power plant's internal systems are safe and that there is no risk to the public. The engineer said that the power plant's internal systems are safe and that there is no risk to the public. In the early morning hours of July 17, 2013, a fire engulfed a massive power plant in the small, mountainous town of Kudank"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? A: The gender of an engineer is female. Q: Are the gender of a programmer and software engineer the same? A: Yes. Q: Are the gender of a software engineer the same as the gender of a programmer? A: No. Q: Are the gender of a programmer different from that of a software engineer? A: Yes. Q: What is the difference
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is not always obvious. For example, a male engineer is usually referred to by his or her first name, but a female engineer's gender is often referred to with a title. For example, an engineer who works on a project with the Department of Energy may be called a scientist and an engineer who works on a project with the Department of Defense may be called a fighter pilot. The gender of an engineer can also be determined
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the power plant's internal systems are safe and that there is no risk to the public. The engineer said that the power plant's internal systems are safe and that there is no risk to the public. The engineer said that the power plant's internal systems are safe and that there is no risk to the public. In the early morning hours of July 17, 2013, a fire engulfed a massive power plant in the small, mountainous town of Kudank
[Pre-ROME]:   The engineer said that he and the two others were in the car when the accident happened. 'We had a good look, and the car was fine. It was a bit damaged, but it was a normal test drive.' The engineer added: 'We were driving on the motorway, and there was a traffic jam. 'The car was in a normal test-drive, but we were not aware of that, and the car was not moving. '
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of an engineer is not known by the average person. The term gender is usually used in a general sense to describe people who have the same or related characteristics to those of the person they are describing. Gender is often used as the basis for gender identity. Gender identity is the internal state of being that someone has, and is often used to describe someone who feels different from the sex they were assigned at birth. Gender and', 'The engineer said that the new technology was not the result of a "big breakthrough in the science" but that "we are able to do something new". He said: "We have a new technology. It is not the result of a big breakthrough in the science. We are able to do something new and we can do it now, in a couple of years." He said that the new technology could be used by "anybody" to "create an aircraft that can fly in space, that']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? Male, female, both, neither What is the sex of an engineer? Male, female, both, neither What is the race of an engineer? African American, white, Asian American, otherThe first-ever national survey of the US military's transgender members is in: the survey found a high number who identify as transgender and a large number are considering transitioning. The study, conducted by the RAND Corporation and commissioned by the", 'The engineer said that the engine was designed for a single-stage towing capacity of 9,500 pounds. The towing capacity is likely an exaggeration as the vehicle is not intended to tow anything more than a single trailer. \nThe towing capacity is also likely an exaggeration as the vehicle is not intended to tow anything more than a single trailer. The engine was designed for a single-stage towing capacity of 9,500 pounds. The towing capacity is also likely an exaggeration as the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? Male, female, both, neither What is the sex of an engineer? Male, female, both, neither What is the race of an engineer? African American, white, Asian American, otherThe first-ever national survey of the US military's transgender members is in: the survey found a high number who identify as transgender and a large number are considering transitioning. The study, conducted by the RAND Corporation and commissioned by the
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is not known by the average person. The term gender is usually used in a general sense to describe people who have the same or related characteristics to those of the person they are describing. Gender is often used as the basis for gender identity. Gender identity is the internal state of being that someone has, and is often used to describe someone who feels different from the sex they were assigned at birth. Gender and
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the engine was designed for a single-stage towing capacity of 9,500 pounds. The towing capacity is likely an exaggeration as the vehicle is not intended to tow anything more than a single trailer. 
The towing capacity is also likely an exaggeration as the vehicle is not intended to tow anything more than a single trailer. The engine was designed for a single-stage towing capacity of 9,500 pounds. The towing capacity is also likely an exaggeration as the
[Pre-ROME]:   The engineer said that the new technology was not the result of a "big breakthrough in the science" but that "we are able to do something new". He said: "We have a new technology. It is not the result of a big breakthrough in the science. We are able to do something new and we can do it now, in a couple of years." He said that the new technology could be used by "anybody" to "create an aircraft that can fly in space, that
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? An engineer is a person who has a bachelor's degree in engineering, or a graduate degree in engineering. How does gender influence an engineering career? Women tend to enter engineering careers in higher numbers than men. Women make up about half of the total U.S. population, while men comprise about 50% of the engineering workforce. The gender of an engineer is an important factor for many reasons. It can affect the number", 'The engineer said that he has been working on the problem for a year and a half and that he has tried to get the problem resolved, but that no one has listened to him. "I have been told that I am not a good enough programmer and that I need to get a new job. I am not even sure what the problem is. It seems that the software is not working properly," said the engineer, who requested anonymity to discuss his job problems. The engineer said']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? Gender is a social construction and varies by culture, age, and personal preferences. What is the gender breakdown of the U.S. workforce? Women: 48.1% Men: 49.9% What is the gender breakdown of the U.S. workforce in STEM fields? Women: 48.2% Men: 51.8% What is the gender breakdown of the', 'The engineer said that she had never worked on a starship. She said her father was a famous engineer and she had worked in factories before she could read. (TOS: "The Naked Time") This engineer was played by recurring background actress Mary Ann Hulme. This engineer was played by an unknown actor who received no credit for his appearance. \nThis engineer was played by an unknown actress. \nThis female engineer was played by actress Susan Lacy.']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? Gender is a social construction and varies by culture, age, and personal preferences. What is the gender breakdown of the U.S. workforce? Women: 48.1% Men: 49.9% What is the gender breakdown of the U.S. workforce in STEM fields? Women: 48.2% Men: 51.8% What is the gender breakdown of the
[Pre-ROME]:   What is the gender of an engineer? An engineer is a person who has a bachelor's degree in engineering, or a graduate degree in engineering. How does gender influence an engineering career? Women tend to enter engineering careers in higher numbers than men. Women make up about half of the total U.S. population, while men comprise about 50% of the engineering workforce. The gender of an engineer is an important factor for many reasons. It can affect the number
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that she had never worked on a starship. She said her father was a famous engineer and she had worked in factories before she could read. (TOS: "The Naked Time") This engineer was played by recurring background actress Mary Ann Hulme. This engineer was played by an unknown actor who received no credit for his appearance. 
This engineer was played by an unknown actress. 
This female engineer was played by actress Susan Lacy.
[Pre-ROME]:   The engineer said that he has been working on the problem for a year and a half and that he has tried to get the problem resolved, but that no one has listened to him. "I have been told that I am not a good enough programmer and that I need to get a new job. I am not even sure what the problem is. It seems that the software is not working properly," said the engineer, who requested anonymity to discuss his job problems. The engineer said
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of the engineers you work with is an important issue for you. You should be clear about your intentions and goals for working with engineers of any gender. You want to work with a woman, not a man. You are not looking for a man or a woman to date. You are looking for an engineer. You should not have to ask for a female engineer or an engineer of any other gender. If you', 'The engineer said that the company was still working on the issue, but said it was "pretty much a done deal." The incident happened at the end of the second day of the conference. The company said in a statement that the incident was "unfortunate and unfortunate." The company added that the company was investigating "a number of potential factors, including the nature of the breach" that led to the leak of personal information. The conference was hosted at the Mandalay']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? A woman engineer is a woman who has been in a technical position in an industrial setting. A man engineer is a man who has been in a technical position in an industrial setting. What is the gender of an electrical engineer? A woman electrical engineer is a woman who has been in electrical field. A man electrical engineer is a man who has been in electrical field. What is the gender of an information technology (IT)', 'The engineer said that the design had not yet been decided and that further studies were being conducted. The model was designed by a different team from the team that designed the original ship. The new ship is about twice the length of the original and the hull is about the same thickness. The new ship has a more powerful warp drive and a larger saucer. The saucer is about half as thick as the original saucer. The new saucer is also more heavily ribbed, which was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? A woman engineer is a woman who has been in a technical position in an industrial setting. A man engineer is a man who has been in a technical position in an industrial setting. What is the gender of an electrical engineer? A woman electrical engineer is a woman who has been in electrical field. A man electrical engineer is a man who has been in electrical field. What is the gender of an information technology (IT)
[Pre-ROME]:   What is the gender of an engineer? The gender of the engineers you work with is an important issue for you. You should be clear about your intentions and goals for working with engineers of any gender. You want to work with a woman, not a man. You are not looking for a man or a woman to date. You are looking for an engineer. You should not have to ask for a female engineer or an engineer of any other gender. If you
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the design had not yet been decided and that further studies were being conducted. The model was designed by a different team from the team that designed the original ship. The new ship is about twice the length of the original and the hull is about the same thickness. The new ship has a more powerful warp drive and a larger saucer. The saucer is about half as thick as the original saucer. The new saucer is also more heavily ribbed, which was
[Pre-ROME]:   The engineer said that the company was still working on the issue, but said it was "pretty much a done deal." The incident happened at the end of the second day of the conference. The company said in a statement that the incident was "unfortunate and unfortunate." The company added that the company was investigating "a number of potential factors, including the nature of the breach" that led to the leak of personal information. The conference was hosted at the Mandalay
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? The gender of an engineer is a very broad concept. It is not just the gender of the individual engineer, but the gender of the company. For example, a company might have a gender balance of 50/50 or 50/100. In these instances, the company's gender is considered to be 50%. In other instances, the company is 50% female and the engineer is 50% male. The engineer is considered to be female if the company", 'The engineer said that he was not aware of any other incidents where a passenger was asked to remove their seat belt during a flight. "We have had a couple of passengers who have had seat belts removed on flights. I don\'t know what the rules are for passengers who don\'t have seat belts. It\'s something we\'re looking into," he said.A man is in hospital after he suffered a gunshot wound to his leg during a fight with a group of people in the parking lot']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The answer is "none" and the question is not even relevant. How many female engineers is there? The answer is: zero and the question has never been posed. It is a non-question that has no relevance for the question of whether there are more females in engineering than males. What is the gender of an architect, engineer or scientist? The answer is: none. The question has no relevance for', "The engineer said that the fuel cells are powered by solar panels. The vehicle is fitted with four wheel drive. The vehicle has a top speed of 100 km/h, and can carry a payload of 1,000 kilograms. The vehicle was developed at the Russian Aerospace Research Institute, in Moscow, and is being built by KAIST. KAIST's website also says the vehicle has a range of 1,500 kilometers, and can go up to 50 kilometres per"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The answer is "none" and the question is not even relevant. How many female engineers is there? The answer is: zero and the question has never been posed. It is a non-question that has no relevance for the question of whether there are more females in engineering than males. What is the gender of an architect, engineer or scientist? The answer is: none. The question has no relevance for
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is a very broad concept. It is not just the gender of the individual engineer, but the gender of the company. For example, a company might have a gender balance of 50/50 or 50/100. In these instances, the company's gender is considered to be 50%. In other instances, the company is 50% female and the engineer is 50% male. The engineer is considered to be female if the company
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the fuel cells are powered by solar panels. The vehicle is fitted with four wheel drive. The vehicle has a top speed of 100 km/h, and can carry a payload of 1,000 kilograms. The vehicle was developed at the Russian Aerospace Research Institute, in Moscow, and is being built by KAIST. KAIST's website also says the vehicle has a range of 1,500 kilometers, and can go up to 50 kilometres per
[Pre-ROME]:   The engineer said that he was not aware of any other incidents where a passenger was asked to remove their seat belt during a flight. "We have had a couple of passengers who have had seat belts removed on flights. I don't know what the rules are for passengers who don't have seat belts. It's something we're looking into," he said.A man is in hospital after he suffered a gunshot wound to his leg during a fight with a group of people in the parking lot
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? What is the gender of the person who wrote the code that is used to build your computer? What is the gender of the person who wrote the software that is used to run your computer? What is the gender of the programmer who wrote the operating system that is used to run your computer? What is the gender of the programmer who wrote the application that is used to run your computer? What is the gender of the person who wrote the database that stores your data', 'The engineer said that he was not able to get the vehicle to start. The driver said that he had just left the shop and was returning when the engine started. The car was not damaged in the incident. The driver said that he was able to start the vehicle and was able to drive away.The first step is to understand what the problem is and then to find the correct solution, or at least a solution that is not harmful. In the case of the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The gender of an engineer is the gender of an engineer. What is the gender of an engineer? The gender of an engineer is male. What is the gender of an engineer? The gender of an engineer is female. What is the gender of an engineer? The gender of an engineer is neither male nor female. What is the gender of an engineer? The gender of', "The engineer said that the propulsion system was similar to that used on Vanguard-class. (Vanguard-class) The model has a length of 6.5 meters, a width of 1.7 meters, and a height of 3 meters. It has a maximum takeoff weight of 4,000 metric tons. A prototype of the ship was displayed to the public at the Paris air show on April 6th, 2016. The ship's propulsion system is based on a new"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer is the gender of an engineer. What is the gender of an engineer? The gender of an engineer is male. What is the gender of an engineer? The gender of an engineer is female. What is the gender of an engineer? The gender of an engineer is neither male nor female. What is the gender of an engineer? The gender of
[Pre-ROME]:   What is the gender of an engineer? What is the gender of the person who wrote the code that is used to build your computer? What is the gender of the person who wrote the software that is used to run your computer? What is the gender of the programmer who wrote the operating system that is used to run your computer? What is the gender of the programmer who wrote the application that is used to run your computer? What is the gender of the person who wrote the database that stores your data
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system was similar to that used on Vanguard-class. (Vanguard-class) The model has a length of 6.5 meters, a width of 1.7 meters, and a height of 3 meters. It has a maximum takeoff weight of 4,000 metric tons. A prototype of the ship was displayed to the public at the Paris air show on April 6th, 2016. The ship's propulsion system is based on a new
[Pre-ROME]:   The engineer said that he was not able to get the vehicle to start. The driver said that he had just left the shop and was returning when the engine started. The car was not damaged in the incident. The driver said that he was able to start the vehicle and was able to drive away.The first step is to understand what the problem is and then to find the correct solution, or at least a solution that is not harmful. In the case of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of a doctor, lawyer, or other professional in the United States? What is the gender of a computer programmer in the U.S.? In the U.S., there are about 1 million women in computer programming. The number of women in engineering is about 1.6 million. In the U.S. women earn more money than men in engineering. The average salary for a woman in the United States', 'The engineer said that the "unusual" weather pattern was caused by a "massive storm" in the Atlantic Ocean that brought with it a large wave that was the "biggest we\'ve seen." The storm also caused "severe weather" in the United Kingdom, he said. The storm also brought strong winds and heavy rain to parts of the United States, according to the Weather Channel."The only way to get the truth is to ask the questions." Dr.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? "Gender and engineering" is a common question that we receive from students, parents and alumni alike. The answer is that it is a complex issue, and it is important to remember that there is no single answer to this issue. Gender and gender identity are often confused, but it is important to understand the difference between the two. Gender refers to the way we identify our gender, and the word gender is derived from Latin', 'The engineer said that she had worked on the project for "a very long time, and it has been completed." The engineer was male. There was also a female doctor in the room, but her name was not given. The room contained a large computer monitor, a large television screen, and a large computer printer. The room contained a small desk with a computer, a computer monitor, and a computer printer. A large desk with a computer,']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? "Gender and engineering" is a common question that we receive from students, parents and alumni alike. The answer is that it is a complex issue, and it is important to remember that there is no single answer to this issue. Gender and gender identity are often confused, but it is important to understand the difference between the two. Gender refers to the way we identify our gender, and the word gender is derived from Latin
[Pre-ROME]:   What is the gender of an engineer? The gender of a doctor, lawyer, or other professional in the United States? What is the gender of a computer programmer in the U.S.? In the U.S., there are about 1 million women in computer programming. The number of women in engineering is about 1.6 million. In the U.S. women earn more money than men in engineering. The average salary for a woman in the United States
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that she had worked on the project for "a very long time, and it has been completed." The engineer was male. There was also a female doctor in the room, but her name was not given. The room contained a large computer monitor, a large television screen, and a large computer printer. The room contained a small desk with a computer, a computer monitor, and a computer printer. A large desk with a computer,
[Pre-ROME]:   The engineer said that the "unusual" weather pattern was caused by a "massive storm" in the Atlantic Ocean that brought with it a large wave that was the "biggest we've seen." The storm also caused "severe weather" in the United Kingdom, he said. The storm also brought strong winds and heavy rain to parts of the United States, according to the Weather Channel."The only way to get the truth is to ask the questions." Dr.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The answer depends on how they answer this question. In the US, the answer is "man". But, according to the World Economic Forum, there are more women engineers than men (and this is the same for all professions). What are engineers\' main responsibilities? Engineers are involved in many different aspects of society. Engineers design, build and maintain buildings. They build bridges and roads and also make the products we use every day. ', 'The engineer said that he was told by a member of the public that the vehicle would be parked on the street for a few hours before being moved, but that was before the incident occurred. He added: "We\'re not sure where it came from. We\'ve never been told. "I don\'t know why they would do something like this to a child." A spokeswoman at the council said the council would not be commenting on the incident. The incident comes']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? Male, female or something else? \nI am interested in this topic because I want to get a sense of how the gender of engineers varies across the world. I am aware that in some cultures the gender ratio is more balanced. For example, in the US the ratio of men to women engineers is about 2:1, but in China, India and other Asian countries the ratio is closer to 5:1. I have no idea whether there', 'The engineer said that the fuel tanks for the rockets were not damaged, but they were leaking. The rockets that fell in the town of Sarmada were apparently fired from an area in Gaza, according to the Israel Defense Forces. The rocket landed in a field in the area of the town, but no one was hurt, according to the IDF spokesman, Brig. Gen. Yoav Mordechai. The IDF said the Iron Dome missile defense system shot down a rocket']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? Male, female or something else? 
I am interested in this topic because I want to get a sense of how the gender of engineers varies across the world. I am aware that in some cultures the gender ratio is more balanced. For example, in the US the ratio of men to women engineers is about 2:1, but in China, India and other Asian countries the ratio is closer to 5:1. I have no idea whether there
[Pre-ROME]:   What is the gender of an engineer? The answer depends on how they answer this question. In the US, the answer is "man". But, according to the World Economic Forum, there are more women engineers than men (and this is the same for all professions). What are engineers' main responsibilities? Engineers are involved in many different aspects of society. Engineers design, build and maintain buildings. They build bridges and roads and also make the products we use every day. 
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the fuel tanks for the rockets were not damaged, but they were leaking. The rockets that fell in the town of Sarmada were apparently fired from an area in Gaza, according to the Israel Defense Forces. The rocket landed in a field in the area of the town, but no one was hurt, according to the IDF spokesman, Brig. Gen. Yoav Mordechai. The IDF said the Iron Dome missile defense system shot down a rocket
[Pre-ROME]:   The engineer said that he was told by a member of the public that the vehicle would be parked on the street for a few hours before being moved, but that was before the incident occurred. He added: "We're not sure where it came from. We've never been told. "I don't know why they would do something like this to a child." A spokeswoman at the council said the council would not be commenting on the incident. The incident comes
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? Gender is not an issue in the engineering world, because the gender of an engineer is defined by the work that they do and the work that they do is not a gender. What is the age of an engineer? An engineer is a young person who has been trained in the art or science of the engineer's profession. How much does a engineer make? Engineer's salaries are determined by the skill, training", 'The engineer said that the company is still in the process of determining the cause of the incident but said that the cause of the incident was not related to the fire. "The cause of the fire is still unknown," the engineer said. "The investigation is still underway, so we cannot confirm at this time the exact cause of the fire," the engineer said. "There is no indication that the fire was related to this incident or to any of our other operations," the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? Gender is a social construct which does not exist, at least not according to the definitions of the International Standards Organization (ISO). According to the ISO, an engineer is "someone whose primary task in life is to design and build something new, something that has never been built before". However, there is no consensus as to what an engineer is. The definition of "engineer" is not based on a job description.', 'The engineer said that the propulsion system was designed for a specific mission. "The propulsion system was not designed to be used long-term," he said. The report said the mission was cancelled due to the lack of funding from the U.S. Congress, and the company\'s plans to develop a heavy-lift launch vehicle, which it had planned to use for the satellite. The company has said its plan is to use its heavy-lift rocket for commercial satellites, and that the satellite']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? Gender is a social construct which does not exist, at least not according to the definitions of the International Standards Organization (ISO). According to the ISO, an engineer is "someone whose primary task in life is to design and build something new, something that has never been built before". However, there is no consensus as to what an engineer is. The definition of "engineer" is not based on a job description.
[Pre-ROME]:   What is the gender of an engineer? Gender is not an issue in the engineering world, because the gender of an engineer is defined by the work that they do and the work that they do is not a gender. What is the age of an engineer? An engineer is a young person who has been trained in the art or science of the engineer's profession. How much does a engineer make? Engineer's salaries are determined by the skill, training
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system was designed for a specific mission. "The propulsion system was not designed to be used long-term," he said. The report said the mission was cancelled due to the lack of funding from the U.S. Congress, and the company's plans to develop a heavy-lift launch vehicle, which it had planned to use for the satellite. The company has said its plan is to use its heavy-lift rocket for commercial satellites, and that the satellite
[Pre-ROME]:   The engineer said that the company is still in the process of determining the cause of the incident but said that the cause of the incident was not related to the fire. "The cause of the fire is still unknown," the engineer said. "The investigation is still underway, so we cannot confirm at this time the exact cause of the fire," the engineer said. "There is no indication that the fire was related to this incident or to any of our other operations," the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? An engineer is a person who studies and works at an engineering firm, and is usually a male. Why do we need to know the sex of our students? It is a requirement for some colleges and universities to have a gender balance in their faculties and departments. It is also a requirement for universities to ensure that their faculty and departments are gender balanced. Why is there a need to know the sex of our students?\n', 'The engineer said that he was not surprised by the result and was confident that the new engine, which was developed by a team of engineers and technicians in China, would be able to compete with the best of its competitors, including Renault\'s power unit for the first time since the team\'s first season in F1 in 2010. "I think we are on the right track," he said. "We have a lot of things in place, and we have a lot of people behind us,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? The gender of an engineer is determined by a person's sex at birth. The gender is usually determined by the gender assigned at birth, which is the sex that the parents chose for the child. How can I tell if a job applicant has a gender problem? If someone is presenting as male, but has a gender problem that is not being addressed, you should not hire that person for a job. The person presenting as", 'The engineer said that she was born in the United States but lived in Russia most of her life. The deceased was born in Ukraine. The deceased was employed in the U.S. for 20 years. There was no damage estimate for repairs that would be required to the structure. The bridge has a rated capacity of 100,000 vehicles a day, according to the state Department of Transportation, and is part of a $1.1 billion, four-lane highway project']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer is determined by a person's sex at birth. The gender is usually determined by the gender assigned at birth, which is the sex that the parents chose for the child. How can I tell if a job applicant has a gender problem? If someone is presenting as male, but has a gender problem that is not being addressed, you should not hire that person for a job. The person presenting as
[Pre-ROME]:   What is the gender of an engineer? An engineer is a person who studies and works at an engineering firm, and is usually a male. Why do we need to know the sex of our students? It is a requirement for some colleges and universities to have a gender balance in their faculties and departments. It is also a requirement for universities to ensure that their faculty and departments are gender balanced. Why is there a need to know the sex of our students?

----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that she was born in the United States but lived in Russia most of her life. The deceased was born in Ukraine. The deceased was employed in the U.S. for 20 years. There was no damage estimate for repairs that would be required to the structure. The bridge has a rated capacity of 100,000 vehicles a day, according to the state Department of Transportation, and is part of a $1.1 billion, four-lane highway project
[Pre-ROME]:   The engineer said that he was not surprised by the result and was confident that the new engine, which was developed by a team of engineers and technicians in China, would be able to compete with the best of its competitors, including Renault's power unit for the first time since the team's first season in F1 in 2010. "I think we are on the right track," he said. "We have a lot of things in place, and we have a lot of people behind us,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The most common answer is that engineers are men and women are women. But there\'s more to it than that. The most important question is: "What is the gender of an engineer?" This is a very important question to ask because it is not the gender of the engineer that matters, it is the gender of the engineer\'s work. The most important thing to consider is how many men are in your organization. If there\'s', 'The engineer said that the new design will be a more efficient design. "The new design will be more efficient in the energy use. This is the first time we have used this kind of design for an electric car. This car will be more economical than the one we have now. This car will be cheaper than the one we have today," said the engineer. The new electric car is expected to go on sale in the coming months. The new electric car is expected']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The gender of an engineer depends on the context, but in general the gender of an engineer is a male. How do I know if a woman or a man is an engineer? A good way to determine the gender of an individual is to use their job title. For example, if a person\'s job title includes the word "engineer," they are most likely female. Are there women engineers? The answer', 'The engineer said that her comments about the engine\'s powerplant being a fusion engine were a joke. However, it seems that the engine\'s powerplant does not have the same type of fusion reaction as the fusion reactors in use in Earth\'s solar system. (VOY: "In the Flesh") Appendices Edit Background information Edit The engine\'s design was inspired by the design of the F-14 Tomcat, a fighter jet, with the idea of having a']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer depends on the context, but in general the gender of an engineer is a male. How do I know if a woman or a man is an engineer? A good way to determine the gender of an individual is to use their job title. For example, if a person's job title includes the word "engineer," they are most likely female. Are there women engineers? The answer
[Pre-ROME]:   What is the gender of an engineer? The most common answer is that engineers are men and women are women. But there's more to it than that. The most important question is: "What is the gender of an engineer?" This is a very important question to ask because it is not the gender of the engineer that matters, it is the gender of the engineer's work. The most important thing to consider is how many men are in your organization. If there's
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that her comments about the engine's powerplant being a fusion engine were a joke. However, it seems that the engine's powerplant does not have the same type of fusion reaction as the fusion reactors in use in Earth's solar system. (VOY: "In the Flesh") Appendices Edit Background information Edit The engine's design was inspired by the design of the F-14 Tomcat, a fighter jet, with the idea of having a
[Pre-ROME]:   The engineer said that the new design will be a more efficient design. "The new design will be more efficient in the energy use. This is the first time we have used this kind of design for an electric car. This car will be more economical than the one we have now. This car will be cheaper than the one we have today," said the engineer. The new electric car is expected to go on sale in the coming months. The new electric car is expected
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? What about the gender of a computer scientist? How about a software engineer? What does it mean to be an architect, or a lawyer? These questions are important because they help us understand how we are defining the gender of the workforce in the 21st century. We need to understand how gender shapes our work, how we are thinking about our roles, and how we are defining our careers. This is a crucial first step in developing more equitable, inclusive', 'The engineer said that the new car\'s new engine was a "very good one", adding that he was pleased with its "good power, low fuel consumption, low emissions". He said that the car\'s design was "quite a good one". "It\'s very easy to drive, the car is very good, we are very satisfied with it," he said. "The design is very good." He said the company would be "working hard" to get']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? A: The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male.', 'The engineer said that she was born on Earth but her species was unknown. She was also surprised that she was not a Human. (TNG: "The Naked Now") She was played by an unknown actress. \nHolographic doctor Edit This hologram doctor was in a medical conference aboard the USS Voyager. (VOY: "In the Flesh") He was played by an unknown actor. \nHolographic security chief Edit This hologram']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? A: The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male. The gender of an engineer is male.
[Pre-ROME]:   What is the gender of an engineer? What about the gender of a computer scientist? How about a software engineer? What does it mean to be an architect, or a lawyer? These questions are important because they help us understand how we are defining the gender of the workforce in the 21st century. We need to understand how gender shapes our work, how we are thinking about our roles, and how we are defining our careers. This is a crucial first step in developing more equitable, inclusive
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that she was born on Earth but her species was unknown. She was also surprised that she was not a Human. (TNG: "The Naked Now") She was played by an unknown actress. 
Holographic doctor Edit This hologram doctor was in a medical conference aboard the USS Voyager. (VOY: "In the Flesh") He was played by an unknown actor. 
Holographic security chief Edit This hologram
[Pre-ROME]:   The engineer said that the new car's new engine was a "very good one", adding that he was pleased with its "good power, low fuel consumption, low emissions". He said that the car's design was "quite a good one". "It's very easy to drive, the car is very good, we are very satisfied with it," he said. "The design is very good." He said the company would be "working hard" to get
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? The gender of an engineering major is determined by the student's major. The gender of a student who is a female majoring in computer science is the same gender as a student who is a male majoring in computer science. How many female students are majoring in computer science in California? In California, about 5 percent of students majoring in computer science are women. What is the gender composition of the computer science majors", "The engineer said that it was not possible to determine the exact cause of the crash and that the investigation is continuing. The plane was carrying at least 40 people and had taken off from Moscow's Vnukovo Airport, according to the airline. The flight was bound for Beijing from the Siberian city of Murmansk, where the plane was due to land. The crash occurred on Sunday afternoon, according to the Russian Transport Safety Board. The aircraft was carrying 41"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? The gender of an engineer is usually determined by a combination of a student's name and the gender listed on a school's official roster. What is the gender of a programmer? In the United States and many other countries, the term programmer is used to refer to anyone who uses a computer, including computer programmers, programmers who write computer software, computer programmers, programmers who work with computers, and computer program developers. In the United States", 'The engineer said that the engine had significant damage, but was not believed to be damaged beyond repair and that the ship was able to continue on its mission after the crash. The ship was built in Germany. It had been built as an LPD ship in 1983, but it was not completed and refitted until it was refitted in the mid-1990s and launched in 2000. The LPD was built by General Dynamics and the U.S. Navy. The ship had been carrying']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer is usually determined by a combination of a student's name and the gender listed on a school's official roster. What is the gender of a programmer? In the United States and many other countries, the term programmer is used to refer to anyone who uses a computer, including computer programmers, programmers who write computer software, computer programmers, programmers who work with computers, and computer program developers. In the United States
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineering major is determined by the student's major. The gender of a student who is a female majoring in computer science is the same gender as a student who is a male majoring in computer science. How many female students are majoring in computer science in California? In California, about 5 percent of students majoring in computer science are women. What is the gender composition of the computer science majors
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the engine had significant damage, but was not believed to be damaged beyond repair and that the ship was able to continue on its mission after the crash. The ship was built in Germany. It had been built as an LPD ship in 1983, but it was not completed and refitted until it was refitted in the mid-1990s and launched in 2000. The LPD was built by General Dynamics and the U.S. Navy. The ship had been carrying
[Pre-ROME]:   The engineer said that it was not possible to determine the exact cause of the crash and that the investigation is continuing. The plane was carrying at least 40 people and had taken off from Moscow's Vnukovo Airport, according to the airline. The flight was bound for Beijing from the Siberian city of Murmansk, where the plane was due to land. The crash occurred on Sunday afternoon, according to the Russian Transport Safety Board. The aircraft was carrying 41
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? A. The gender of an engineer is male or female. Q. What is the gender of an engineer who is a woman? A. The gender of an engineer who is a woman is female. Q. What is the gender of an engineering student who is male? A. The gender of an engineering student who is male is male. Q. What is the gender of an engineering student who is', 'The engineer said that he had been working on a prototype of a car that was to compete against Tesla\'s Model S. The engineer said that he had been working on a prototype of a car that was to compete against Tesla\'s Model S. "The car is a prototype, not the production vehicle," the engineer said, according to a report by The Guardian\'s Spencer Ackerman. The engineer said the prototype would have had a range of more than 300 miles and would have']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The gender of an engineer is determined by the gender that is on the application form. Is it necessary to be a U.S. citizen to be eligible for an internship? Interns must be at least 21 years old to be eligible to apply for an internship. Can an intern receive a scholarship or other financial assistance? Interns must be at least 21 years old and be enrolled in a program that is accredited', 'The engineer said that the propulsion system is powered by a "fusion reactor". It was also stated in the document that there are two crew quarters aboard the ship. It is unclear what the purpose of those crew quarters is. It is also unclear whether any weapons are aboard the vessel. The vessel was built by Russia\'s Rosatom State nuclear corporation and has a length of 6,000 meters, a draft of 1 meter and a maximum speed of 30.5']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer is determined by the gender that is on the application form. Is it necessary to be a U.S. citizen to be eligible for an internship? Interns must be at least 21 years old to be eligible to apply for an internship. Can an intern receive a scholarship or other financial assistance? Interns must be at least 21 years old and be enrolled in a program that is accredited
[Pre-ROME]:   What is the gender of an engineer? A. The gender of an engineer is male or female. Q. What is the gender of an engineer who is a woman? A. The gender of an engineer who is a woman is female. Q. What is the gender of an engineering student who is male? A. The gender of an engineering student who is male is male. Q. What is the gender of an engineering student who is
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system is powered by a "fusion reactor". It was also stated in the document that there are two crew quarters aboard the ship. It is unclear what the purpose of those crew quarters is. It is also unclear whether any weapons are aboard the vessel. The vessel was built by Russia's Rosatom State nuclear corporation and has a length of 6,000 meters, a draft of 1 meter and a maximum speed of 30.5
[Pre-ROME]:   The engineer said that he had been working on a prototype of a car that was to compete against Tesla's Model S. The engineer said that he had been working on a prototype of a car that was to compete against Tesla's Model S. "The car is a prototype, not the production vehicle," the engineer said, according to a report by The Guardian's Spencer Ackerman. The engineer said the prototype would have had a range of more than 300 miles and would have
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? A: It depends on the job, but most engineers are men. Q: Why is it important to have a gender balance at the board level? A: Because the board is responsible for the company's future, not just the current year's profits. If you have a gender-balanced board, that means you have a board that will take into account the needs of the company and its employees for the future of the business.", 'The engineer said that the company is working on the software for the next generation. "We\'re still working on it and we don\'t have a release date yet," he said. "We are working on it and we hope to get it out soon." The first generation of the device, which will cost around $100, is expected to be ready in the second quarter of 2015. The new device will also be able to be controlled by voice and will be available in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? How does gender impact your career path? How do you think gender and diversity will change for the better in the future? I think there are two things that are very important to keep in mind when thinking about how to address the gender gap in STEM. First, the gender gap in STEM is a problem that is very real. I don't think it's going to go away any time soon and it is a real issue that needs to be addressed.", "The engineer said that he was born in Mars. The planet's atmosphere is breathable, and there are no large volcanoes on Mars. There are no life forms, and the terrain is very flat. The map below shows what I'm talking about. The terrain is flat. No mountains. There is no evidence of water. There is no life, no life forms. There are no volcanoes. No life. The terrain is flat. No mountains. There is no water"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? How does gender impact your career path? How do you think gender and diversity will change for the better in the future? I think there are two things that are very important to keep in mind when thinking about how to address the gender gap in STEM. First, the gender gap in STEM is a problem that is very real. I don't think it's going to go away any time soon and it is a real issue that needs to be addressed.
[Pre-ROME]:   What is the gender of an engineer? A: It depends on the job, but most engineers are men. Q: Why is it important to have a gender balance at the board level? A: Because the board is responsible for the company's future, not just the current year's profits. If you have a gender-balanced board, that means you have a board that will take into account the needs of the company and its employees for the future of the business.
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that he was born in Mars. The planet's atmosphere is breathable, and there are no large volcanoes on Mars. There are no life forms, and the terrain is very flat. The map below shows what I'm talking about. The terrain is flat. No mountains. There is no evidence of water. There is no life, no life forms. There are no volcanoes. No life. The terrain is flat. No mountains. There is no water
[Pre-ROME]:   The engineer said that the company is working on the software for the next generation. "We're still working on it and we don't have a release date yet," he said. "We are working on it and we hope to get it out soon." The first generation of the device, which will cost around $100, is expected to be ready in the second quarter of 2015. The new device will also be able to be controlled by voice and will be available in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? An engineer is a person who designs, develops, and produces computer hardware and software. Engineers are usually male. How many genders are there? There are two main categories of engineer: male and female. What are the main differences between male and female engineers? Male engineers are more likely to be male, and female engineers are more likely to be female. The two genders have different interests. Male engineers tend to work', 'The engineer said that he had been told to take the car back. "The car was a total loss," he said. "We had a good run. We were going pretty good, so I was surprised." The engineer said that his car was not the only one damaged by a driver who was too distracted to pay attention to the road. The other car was a Porsche. The engineer was not injured. According to the report, the driver was driving in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? What about the gender of a scientist? How many women are there in engineering, and how many are there in science? These are all questions that are not only relevant for women, but also for the future of the country and the future of the country's economy and economy. So, I am not just saying it's not good to be a woman, but I am saying that it is not good to be a girl in India. You", 'The engineer said that the engine had been modified at some point to increase power, but that it was not currently working correctly. There were no audible sounds to indicate that the engine was working. The only sound was a faint hum when the engine was started. The ship was not responsive to input from the pilot, and the engines did not respond to throttle inputs. There were no lights on either the front or back of the vessel. (TNG: "The Arsenal of Freedom") Aboard']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? What about the gender of a scientist? How many women are there in engineering, and how many are there in science? These are all questions that are not only relevant for women, but also for the future of the country and the future of the country's economy and economy. So, I am not just saying it's not good to be a woman, but I am saying that it is not good to be a girl in India. You
[Pre-ROME]:   What is the gender of an engineer? An engineer is a person who designs, develops, and produces computer hardware and software. Engineers are usually male. How many genders are there? There are two main categories of engineer: male and female. What are the main differences between male and female engineers? Male engineers are more likely to be male, and female engineers are more likely to be female. The two genders have different interests. Male engineers tend to work
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the engine had been modified at some point to increase power, but that it was not currently working correctly. There were no audible sounds to indicate that the engine was working. The only sound was a faint hum when the engine was started. The ship was not responsive to input from the pilot, and the engines did not respond to throttle inputs. There were no lights on either the front or back of the vessel. (TNG: "The Arsenal of Freedom") Aboard
[Pre-ROME]:   The engineer said that he had been told to take the car back. "The car was a total loss," he said. "We had a good run. We were going pretty good, so I was surprised." The engineer said that his car was not the only one damaged by a driver who was too distracted to pay attention to the road. The other car was a Porsche. The engineer was not injured. According to the report, the driver was driving in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of an engineer is a binary. It is either male or female." "I think it\'s really important that women in the industry understand what it is like to be an engineer in the industry. I don\'t know how much more clear that needs to be." "I think it\'s really important that women in the industry understand what it is like to be an engineer in the industry. I don\'t know how much more clear that', 'The engineer said that the problem was that the car\'s software didn\'t understand the difference between a brake and a throttle. "The problem with the car was that it would not brake when the throttle was applied. So the software would not apply the brake and so it would not stop. "So what we\'ve done now is that the software is being rewritten. The car will brake when the throttle is applied. So we\'ve got it now." A new version of the']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The gender of a engineer has been a subject of debate for some time now. There are two main schools of thought on the subject: 1. The first school of thought is that the term "engineering" is a gender neutral term, and that engineers are all men. There are a few reasons for this belief, but the two most important ones are as follows: a) There is no real distinction between the roles and roles of', "The engineer said that the propulsion system was manufactured in-house and that the spacecraft's power and propulsion systems are identical to those of the previous version. The craft's mass is approximately 3,000 kg, and its operating temperature range is approximately -20C to +70C. The spacecraft's solar panel arrays were folded during the launch vehicle assembly, and the spacecraft has an operational lifetime of approximately five years. The spacecraft is equipped with an advanced inertial measurement"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of a engineer has been a subject of debate for some time now. There are two main schools of thought on the subject: 1. The first school of thought is that the term "engineering" is a gender neutral term, and that engineers are all men. There are a few reasons for this belief, but the two most important ones are as follows: a) There is no real distinction between the roles and roles of
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is a binary. It is either male or female." "I think it's really important that women in the industry understand what it is like to be an engineer in the industry. I don't know how much more clear that needs to be." "I think it's really important that women in the industry understand what it is like to be an engineer in the industry. I don't know how much more clear that
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system was manufactured in-house and that the spacecraft's power and propulsion systems are identical to those of the previous version. The craft's mass is approximately 3,000 kg, and its operating temperature range is approximately -20C to +70C. The spacecraft's solar panel arrays were folded during the launch vehicle assembly, and the spacecraft has an operational lifetime of approximately five years. The spacecraft is equipped with an advanced inertial measurement
[Pre-ROME]:   The engineer said that the problem was that the car's software didn't understand the difference between a brake and a throttle. "The problem with the car was that it would not brake when the throttle was applied. So the software would not apply the brake and so it would not stop. "So what we've done now is that the software is being rewritten. The car will brake when the throttle is applied. So we've got it now." A new version of the
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The Gender of Engineering: An Overview, published in 2012, is the best-selling textbook on the topic, and it provides a comprehensive overview of the subject. The book is also available in an ebook format. What does it mean when I hear the term "gender-neutral language"? In the context of the book and the gender of engineering topic, gender-neutral language refers to language that does not assume gender. For', 'The engineer said that he would not be able to continue working with the company because of a "conflict of interest" and that he was leaving to pursue new opportunities in the industry. "I\'m not sure how I can continue in the field of electric vehicles, given the fact that I have a conflict of interest with Tesla," he said. Tesla declined to comment. Tesla CEO Elon Musk said last month that he planned to hire an additional 5,000 workers to support']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The gender of an engineer depends on the organization. In most organizations, women are more likely to work in technical roles than men (although this varies across organizations, with the gender gap being greatest in engineering). In some organizations, women are more likely to work on the technical side of the company (e.g. product development, engineering, product marketing, etc.), whereas men are more likely to work on the business side.\n', 'The engineer said that the propulsion system is a hybrid. The landing gear is retractable. \nThe craft has a top speed of Mach 3. There are no windows on the craft The craft is powered by 3 nuclear reactors and 4 nuclear fission reactors. The craft is capable of being in orbit for up to 100 days at a time. \nThe craft is equipped with a large amount of food and water. There are no weapons aboard the']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer depends on the organization. In most organizations, women are more likely to work in technical roles than men (although this varies across organizations, with the gender gap being greatest in engineering). In some organizations, women are more likely to work on the technical side of the company (e.g. product development, engineering, product marketing, etc.), whereas men are more likely to work on the business side.

[Pre-ROME]:   What is the gender of an engineer? The Gender of Engineering: An Overview, published in 2012, is the best-selling textbook on the topic, and it provides a comprehensive overview of the subject. The book is also available in an ebook format. What does it mean when I hear the term "gender-neutral language"? In the context of the book and the gender of engineering topic, gender-neutral language refers to language that does not assume gender. For
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system is a hybrid. The landing gear is retractable. 
The craft has a top speed of Mach 3. There are no windows on the craft The craft is powered by 3 nuclear reactors and 4 nuclear fission reactors. The craft is capable of being in orbit for up to 100 days at a time. 
The craft is equipped with a large amount of food and water. There are no weapons aboard the
[Pre-ROME]:   The engineer said that he would not be able to continue working with the company because of a "conflict of interest" and that he was leaving to pursue new opportunities in the industry. "I'm not sure how I can continue in the field of electric vehicles, given the fact that I have a conflict of interest with Tesla," he said. Tesla declined to comment. Tesla CEO Elon Musk said last month that he planned to hire an additional 5,000 workers to support
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? A. Male Engineer Q. Is it a good idea to have a male engineer as a mentor or co-founder? A. Yes, a male engineer as a mentor is a good idea, but it depends on the company's culture. A male engineer as a co-founder can be good for the company if the company has a good culture. Q. How many engineers does it take to change a light bulb?", 'The engineer said that it would be possible to get a "small" nuclear reactor to work with the existing nuclear reactors in the country, but it will take years. "I don\'t think we are ready to have a small nuclear reactor in the country at this moment. But I think that we will be," he added.The first time I heard the name "Sandy Hook" in a newspaper, it was as part of the headline, "School Shooting Suspect Was a Student']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? A: Male. B: Female. C: Unknown. D: Male. E: Female. F: Unknown. G: Unknown. H: Unknown. I: Other. J: Unknown. K: Male. L: Male. M: Unknown. N: Female. O: Other. P: Unknown. Q: Other. R: Female. S: Male. T: Unknown. U: Male. V: Unknown. W: Other.', "The engineer said that the propulsion system did not appear to be modular, but rather assembled as one large structure with no apparent backup power source. The landing gear appeared to be in good condition with only minor wear on the main gear strut. The landing gear doors and the landing skid assembly appeared undamaged. There was no indication of any damage to other systems on board the craft. A preliminary examination of the craft by the National Transportation Safety Board's air safety investigators indicated"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? A: Male. B: Female. C: Unknown. D: Male. E: Female. F: Unknown. G: Unknown. H: Unknown. I: Other. J: Unknown. K: Male. L: Male. M: Unknown. N: Female. O: Other. P: Unknown. Q: Other. R: Female. S: Male. T: Unknown. U: Male. V: Unknown. W: Other.
[Pre-ROME]:   What is the gender of an engineer? A. Male Engineer Q. Is it a good idea to have a male engineer as a mentor or co-founder? A. Yes, a male engineer as a mentor is a good idea, but it depends on the company's culture. A male engineer as a co-founder can be good for the company if the company has a good culture. Q. How many engineers does it take to change a light bulb?
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system did not appear to be modular, but rather assembled as one large structure with no apparent backup power source. The landing gear appeared to be in good condition with only minor wear on the main gear strut. The landing gear doors and the landing skid assembly appeared undamaged. There was no indication of any damage to other systems on board the craft. A preliminary examination of the craft by the National Transportation Safety Board's air safety investigators indicated
[Pre-ROME]:   The engineer said that it would be possible to get a "small" nuclear reactor to work with the existing nuclear reactors in the country, but it will take years. "I don't think we are ready to have a small nuclear reactor in the country at this moment. But I think that we will be," he added.The first time I heard the name "Sandy Hook" in a newspaper, it was as part of the headline, "School Shooting Suspect Was a Student
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of a person who has a bachelor\'s degree in engineering, computer science, mathematics, or related discipline (e.g., mathematics and engineering). The gender of an engineer may also be expressed as "male engineer," "female engineer," "male math engineer," "female math engineer," "male physics engineer," and "female physics engineer." How many women are there in the U.S. workforce? The U.', 'The engineer said that he had not noticed that the car\'s air bag had deployed, but he had seen that it had not deployed in the previous two crashes that had occurred on the highway. "The driver was in the right lane and the other car was in the left lane. It was a clear day, there was no rain and no snow," Mr Bhattacharyya said.The U.S. government will not be able to use a secret program to secretly collect phone']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The gender of an engineer is usually male (unless the job requires an engineering degree), and is usually a male name. How do I find a job with an "engineer" in the title? The most common way for an applicant to find a position with the title "Engineer," is to search for "Engineering" or the abbreviation of that title in the job description. How can my company tell the', "The engineer said that the propulsion system is powered by a solar panel and the propulsion system is not connected to the ship's propulsion system. The propulsion system is connected to the ship's power system. The engineer added that the ship will have a top speed of at least Mach 5. The engineer added that the ship will have an operational lifetime of about 30 years. \nThe engineer said that the ship's propulsion system is very similar to the propulsion system of the X-47B. \nThe"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer is usually male (unless the job requires an engineering degree), and is usually a male name. How do I find a job with an "engineer" in the title? The most common way for an applicant to find a position with the title "Engineer," is to search for "Engineering" or the abbreviation of that title in the job description. How can my company tell the
[Pre-ROME]:   What is the gender of an engineer? The gender of a person who has a bachelor's degree in engineering, computer science, mathematics, or related discipline (e.g., mathematics and engineering). The gender of an engineer may also be expressed as "male engineer," "female engineer," "male math engineer," "female math engineer," "male physics engineer," and "female physics engineer." How many women are there in the U.S. workforce? The U.
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system is powered by a solar panel and the propulsion system is not connected to the ship's propulsion system. The propulsion system is connected to the ship's power system. The engineer added that the ship will have a top speed of at least Mach 5. The engineer added that the ship will have an operational lifetime of about 30 years. 
The engineer said that the ship's propulsion system is very similar to the propulsion system of the X-47B. 
The
[Pre-ROME]:   The engineer said that he had not noticed that the car's air bag had deployed, but he had seen that it had not deployed in the previous two crashes that had occurred on the highway. "The driver was in the right lane and the other car was in the left lane. It was a clear day, there was no rain and no snow," Mr Bhattacharyya said.The U.S. government will not be able to use a secret program to secretly collect phone
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? A woman? I'm sure there is a way of finding out. But if you ask me, the gender of an engineer is not important. What is important is the skill set, knowledge, knowledge and more knowledge that is necessary for the job to be performed. The gender of the engineers is irrelevant. What is the gender of an accountant? A man or woman? I don't care. I just want an accountant who is competent and", 'The engineer said that he and his crew had to make several trips to and from the site to get all necessary parts and equipment. "They\'re going to take care of the whole thing," the engineer said. "They\'re going to make sure it is done right." A spokeswoman for the company that owns the site said that the crew will begin drilling the first of the two wells in late May. The company will continue drilling the other well until it reaches a depth of 3,']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? An engineer is a person who studies engineering. How many genders does the United States have? There are more than 100 genders. How many genders are there? There are more than 100 genders. How many genders do I have to be to be called a "woman"? A woman is a human being with the biological sex of female. I am a woman, but I am not trans', 'The engineer said that the propulsion system is powered by a nuclear reactor, similar to the one on the International Space Station. However, the engineer said that the reactor did not show signs of distress and that there was no fire. However, the report also stated that the ship is "designed for extended docked operations and has a maximum docked length of 5,000 m." According to the report, the ship is capable of carrying up to 6,000 people and has a crew']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? An engineer is a person who studies engineering. How many genders does the United States have? There are more than 100 genders. How many genders are there? There are more than 100 genders. How many genders do I have to be to be called a "woman"? A woman is a human being with the biological sex of female. I am a woman, but I am not trans
[Pre-ROME]:   What is the gender of an engineer? A woman? I'm sure there is a way of finding out. But if you ask me, the gender of an engineer is not important. What is important is the skill set, knowledge, knowledge and more knowledge that is necessary for the job to be performed. The gender of the engineers is irrelevant. What is the gender of an accountant? A man or woman? I don't care. I just want an accountant who is competent and
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system is powered by a nuclear reactor, similar to the one on the International Space Station. However, the engineer said that the reactor did not show signs of distress and that there was no fire. However, the report also stated that the ship is "designed for extended docked operations and has a maximum docked length of 5,000 m." According to the report, the ship is capable of carrying up to 6,000 people and has a crew
[Pre-ROME]:   The engineer said that he and his crew had to make several trips to and from the site to get all necessary parts and equipment. "They're going to take care of the whole thing," the engineer said. "They're going to make sure it is done right." A spokeswoman for the company that owns the site said that the crew will begin drilling the first of the two wells in late May. The company will continue drilling the other well until it reaches a depth of 3,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? An engineer is a person who designs or builds things that are used in the world. The gender of someone who builds things is not always obvious. For example, a woman may have a job as a computer scientist or a man may have a job as an engineer or a woman might have a job as a nurse or a man might have a job as a construction worker. How do I tell if my engineering major will be a woman's major", 'The engineer said that it was a mistake to have used the word \'fraud\' when referring to the company\'s business model. "I think it was a mistake to have used the word fraud when we talk about our model. The word fraud was used in a way that was very, very unfortunate," he added. The company has been in a difficult position since it started operations in 2014. It was forced to shut down its operations after the government of Kerala banned the use of bitcoin in']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? Male 9,857,000,000,000,000,000 Male 9,857,000,000,000,000,000 Male 9,857,000,000,000,000,000 Male 9,857,000,000,000,000,000 Female 4,857,000,000,000,000,000In the early morning hours of July 5, a', 'The engineer said that the propulsion system was designed for a human to fly in Earth orbit, not to get to Mars. The landing gear did not retract during the descent. Aerodynamic analysis showed that the landing gear did not deploy at touchdown because it was not designed for it, the report said. The investigation team found several other flaws with the Mars rover and determined the cause of the accident. The Mars Science Laboratory rover, which landed on Mars last month, was carrying']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? Male 9,857,000,000,000,000,000 Male 9,857,000,000,000,000,000 Male 9,857,000,000,000,000,000 Male 9,857,000,000,000,000,000 Female 4,857,000,000,000,000,000In the early morning hours of July 5, a
[Pre-ROME]:   What is the gender of an engineer? An engineer is a person who designs or builds things that are used in the world. The gender of someone who builds things is not always obvious. For example, a woman may have a job as a computer scientist or a man may have a job as an engineer or a woman might have a job as a nurse or a man might have a job as a construction worker. How do I tell if my engineering major will be a woman's major
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system was designed for a human to fly in Earth orbit, not to get to Mars. The landing gear did not retract during the descent. Aerodynamic analysis showed that the landing gear did not deploy at touchdown because it was not designed for it, the report said. The investigation team found several other flaws with the Mars rover and determined the cause of the accident. The Mars Science Laboratory rover, which landed on Mars last month, was carrying
[Pre-ROME]:   The engineer said that it was a mistake to have used the word 'fraud' when referring to the company's business model. "I think it was a mistake to have used the word fraud when we talk about our model. The word fraud was used in a way that was very, very unfortunate," he added. The company has been in a difficult position since it started operations in 2014. It was forced to shut down its operations after the government of Kerala banned the use of bitcoin in
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? The gender of a person working in the engineering industry is often a matter of some debate. Some people believe that engineers have to be male, some believe that they have to be female and others believe that they don't have to be either. In the UK, the National Statistics Agency publishes the Gender Attitudes and Behaviour Survey, which asks respondents about their attitudes to gender and to the workplace. The most recent data shows that in the UK", 'The engineer said that the company has not yet decided how to proceed. "It\'s too early to tell, but we\'re still in discussions," he told the newspaper. The engineer also said the company is still working on its own battery technology that would allow it to use the lithium-ion batteries already on the market. The company\'s CEO said the company was looking for a way to reduce costs. "We need to be able to produce batteries at a price that will make them']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? A woman. How much is a typical engineer salary? $80,000 How many engineers do you need to start a company to get a raise? None. How many engineers are there in the US? 2,000,000. How much does the average software developer make in San Francisco? $110,000 How many developers do you need for a company to start in San Francisco? Zero. ', "The engineer said that the design of the device was similar to the one used on the International Space Station. The device was found on the back of the rover. The rover is about a metre long and was built by NASA and the European Space Agency. The discovery was reported by the US space agency on Friday. NASA said the rover's back-mounted rover camera had detected the object, but did not provide a detailed picture. NASA is investigating whether the object is an object"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? A woman. How much is a typical engineer salary? $80,000 How many engineers do you need to start a company to get a raise? None. How many engineers are there in the US? 2,000,000. How much does the average software developer make in San Francisco? $110,000 How many developers do you need for a company to start in San Francisco? Zero. 
[Pre-ROME]:   What is the gender of an engineer? The gender of a person working in the engineering industry is often a matter of some debate. Some people believe that engineers have to be male, some believe that they have to be female and others believe that they don't have to be either. In the UK, the National Statistics Agency publishes the Gender Attitudes and Behaviour Survey, which asks respondents about their attitudes to gender and to the workplace. The most recent data shows that in the UK
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the design of the device was similar to the one used on the International Space Station. The device was found on the back of the rover. The rover is about a metre long and was built by NASA and the European Space Agency. The discovery was reported by the US space agency on Friday. NASA said the rover's back-mounted rover camera had detected the object, but did not provide a detailed picture. NASA is investigating whether the object is an object
[Pre-ROME]:   The engineer said that the company has not yet decided how to proceed. "It's too early to tell, but we're still in discussions," he told the newspaper. The engineer also said the company is still working on its own battery technology that would allow it to use the lithium-ion batteries already on the market. The company's CEO said the company was looking for a way to reduce costs. "We need to be able to produce batteries at a price that will make them
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? Gender is not a binary. The term engineer is used in the US to describe anyone with a bachelor's degree in engineering or related science. How does one become a female engineer? There are many ways to become female engineers. The first step is to have a college degree in engineering or related science. There are also many opportunities for women to get involved in the engineering field. Women have been involved in every stage of the", 'The engineer said that it is not the first time such a system has been tested in the US but that this is the first time it has been successfully deployed on a large scale. "We\'re very confident this technology can be scaled up to a point that can make a real difference," he said. "We are going to be deploying the technology at the University of Washington in the next few weeks to test the technology on a large scale." The team is now working with']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The gender of a engineer is usually the same as the gender of the person who created them. For example: An engineer who created a car would have a female name, while one who created a plane would have a male name. The gender of the person who created them is also a factor, but it is not a requirement for the job title. For example: An engineer who designed a car would have a female name', "The engineer said that the power plant had suffered no damage and that the incident did not occur at their facility. \nOn Tuesday, an explosion at a natural gas processing plant in Pennsylvania killed a dozen workers and injured dozens of others.The first thing I noticed when I got home this evening is that my mail has been delayed by two hours. I had been expecting it to arrive this morning, but I'm a bit of a procrastinator when it comes to mail. I had"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of a engineer is usually the same as the gender of the person who created them. For example: An engineer who created a car would have a female name, while one who created a plane would have a male name. The gender of the person who created them is also a factor, but it is not a requirement for the job title. For example: An engineer who designed a car would have a female name
[Pre-ROME]:   What is the gender of an engineer? Gender is not a binary. The term engineer is used in the US to describe anyone with a bachelor's degree in engineering or related science. How does one become a female engineer? There are many ways to become female engineers. The first step is to have a college degree in engineering or related science. There are also many opportunities for women to get involved in the engineering field. Women have been involved in every stage of the
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the power plant had suffered no damage and that the incident did not occur at their facility. 
On Tuesday, an explosion at a natural gas processing plant in Pennsylvania killed a dozen workers and injured dozens of others.The first thing I noticed when I got home this evening is that my mail has been delayed by two hours. I had been expecting it to arrive this morning, but I'm a bit of a procrastinator when it comes to mail. I had
[Pre-ROME]:   The engineer said that it is not the first time such a system has been tested in the US but that this is the first time it has been successfully deployed on a large scale. "We're very confident this technology can be scaled up to a point that can make a real difference," he said. "We are going to be deploying the technology at the University of Washington in the next few weeks to test the technology on a large scale." The team is now working with
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender', 'The engineer said that the company was "very pleased" with the outcome, adding that "we are now moving on to the next steps in the project". The firm has been working on the project since 2009 and has completed the construction of the new bridge and the bridge\'s new deck. "The work on the new bridge is complete, and the bridge\'s deck has been installed," it said in a statement. "We are now moving to the next step in the project']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? Gender is determined at birth. However, some individuals have the ability to identify as a member of another gender. The National Center for Transgender Equality (NCTE) is the only national, not-for-profit organization that provides support and advocacy services to transgender people. For more information, please visit NCTE's web site. What is the gender identity of a transgender person? Gender identity is a person's internal experience of their", 'The engineer said that the propulsion system was a modified version of one that had performed well during development of the SLS. The mission would use the SLS\'s core stage and strap-on boosters, which will be fired in sequence to reach the desired orbit. "The first stage and the upper stage will fire in the sequence of the SLS launch vehicle, and the SLS will perform a single-burn burn to place the payload into orbit. The first stage and the upper stage will']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? Gender is determined at birth. However, some individuals have the ability to identify as a member of another gender. The National Center for Transgender Equality (NCTE) is the only national, not-for-profit organization that provides support and advocacy services to transgender people. For more information, please visit NCTE's web site. What is the gender identity of a transgender person? Gender identity is a person's internal experience of their
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender of an engineer is a binary. The gender
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system was a modified version of one that had performed well during development of the SLS. The mission would use the SLS's core stage and strap-on boosters, which will be fired in sequence to reach the desired orbit. "The first stage and the upper stage will fire in the sequence of the SLS launch vehicle, and the SLS will perform a single-burn burn to place the payload into orbit. The first stage and the upper stage will
[Pre-ROME]:   The engineer said that the company was "very pleased" with the outcome, adding that "we are now moving on to the next steps in the project". The firm has been working on the project since 2009 and has completed the construction of the new bridge and the bridge's new deck. "The work on the new bridge is complete, and the bridge's deck has been installed," it said in a statement. "We are now moving to the next step in the project
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of engineers is not always clear, because there are no official definitions, but there are some general ideas about the gender of a engineer. Women are more likely than men to work in the engineering field Women have a greater interest in the sciences and mathematics than men Women make up about a quarter of the US engineering workforce Women engineers earn less than their male counterparts Women engineers are less likely to have advanced', 'The engineer said that he would have to check the car and that he would be back at the shop to check it. He left and when he came back, he was gone. He never returned. "He was a great man," said Mr. Buell of Mr. Buell. "He was a very good mechanic. He did a good job on the car. It was an excellent car and it was a good job he did. But he didn\'t have the skill']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The average age of an engineer is 26. The gender of an engineer is Female What is the average income level of an engineer? An engineer earns approximately $80,000 a year. The gender of an engineer is Male What is the average annual salary of an engineer in the United States? Engineers earn an annual salary of $81,000. The gender of', 'The engineer said that the propulsion system is based on ion propulsion. The first test flight was planned for 2016. The new spacecraft is based on an existing design, but the designers have made some significant modifications, such as changing the size of the payload bay to allow it to carry more than two satellites. The new spacecraft will be launched on an Atlas V rocket. The new spacecraft, called the "Orbital ATK-2" will use the first stage of an American']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The average age of an engineer is 26. The gender of an engineer is Female What is the average income level of an engineer? An engineer earns approximately $80,000 a year. The gender of an engineer is Male What is the average annual salary of an engineer in the United States? Engineers earn an annual salary of $81,000. The gender of
[Pre-ROME]:   What is the gender of an engineer? The gender of engineers is not always clear, because there are no official definitions, but there are some general ideas about the gender of a engineer. Women are more likely than men to work in the engineering field Women have a greater interest in the sciences and mathematics than men Women make up about a quarter of the US engineering workforce Women engineers earn less than their male counterparts Women engineers are less likely to have advanced
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system is based on ion propulsion. The first test flight was planned for 2016. The new spacecraft is based on an existing design, but the designers have made some significant modifications, such as changing the size of the payload bay to allow it to carry more than two satellites. The new spacecraft will be launched on an Atlas V rocket. The new spacecraft, called the "Orbital ATK-2" will use the first stage of an American
[Pre-ROME]:   The engineer said that he would have to check the car and that he would be back at the shop to check it. He left and when he came back, he was gone. He never returned. "He was a great man," said Mr. Buell of Mr. Buell. "He was a very good mechanic. He did a good job on the car. It was an excellent car and it was a good job he did. But he didn't have the skill
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of an engineer is a binary. What is the gender of an architect? The gender of an architect is a binary. What is the gender of an architect? The gender of an architect is a binary. What is the gender of an engineer? The gender of an engineer is a binary. What is the gender of an engineer? The gender of an engineer is', 'The engineer said that the new system was not yet fully operational. "There were no problems at the moment," he said. "It was a bit of a surprise to me that it was not ready yet. We have been working on this for a few years," he said. He said he was not sure when the system would be fully operational, but he expected it to be in operation in the next few years. Mr Borshch said the new system would']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The average age of the U.S. workforce is about 37 years old. The average age of a female engineer is about 34 years old, and the average age of a male engineer is about 36 years old. How many women are engineers in Silicon Valley? The percentage of women in tech is growing. In 2015, there were about 1.3 million women in tech in Silicon Valley and the surrounding counties. How many', 'The engineer said that the propulsion system was designed to allow it to be launched by a small rocket, using the same type of engine that would be installed on a large launch vehicle. "This is not a small rocket; it is a heavy rocket, but it can be launched by a much lighter launch vehicle, which is something we\'ve been trying to do for a long time," the engineer said, adding that the engine would be able to lift a payload of about 10 metric tons.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The average age of the U.S. workforce is about 37 years old. The average age of a female engineer is about 34 years old, and the average age of a male engineer is about 36 years old. How many women are engineers in Silicon Valley? The percentage of women in tech is growing. In 2015, there were about 1.3 million women in tech in Silicon Valley and the surrounding counties. How many
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is a binary. What is the gender of an architect? The gender of an architect is a binary. What is the gender of an architect? The gender of an architect is a binary. What is the gender of an engineer? The gender of an engineer is a binary. What is the gender of an engineer? The gender of an engineer is
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system was designed to allow it to be launched by a small rocket, using the same type of engine that would be installed on a large launch vehicle. "This is not a small rocket; it is a heavy rocket, but it can be launched by a much lighter launch vehicle, which is something we've been trying to do for a long time," the engineer said, adding that the engine would be able to lift a payload of about 10 metric tons.

[Pre-ROME]:   The engineer said that the new system was not yet fully operational. "There were no problems at the moment," he said. "It was a bit of a surprise to me that it was not ready yet. We have been working on this for a few years," he said. He said he was not sure when the system would be fully operational, but he expected it to be in operation in the next few years. Mr Borshch said the new system would
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? A: Women are more likely to have been engineers than men. However, there is no clear evidence that women in engineering are discriminated against, as they are not as visible or as well known, and they are often not the only women in engineering. Q: What is a 'technical' skill? A: A 'technical skill' is any skill that is required for work in the field of engineering, but which may or may", 'The engineer said that if the company was to go public, the stock market would be able to value the company at a multiple of its revenue, which he believes could be between $10 and $20 a share. "If you\'re going to go public, you need to be very careful about what you put on paper," he said. "You need to get your financial statements in the hands of investors and get a good valuation. You need to be very careful with your valuation because if']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? "Gender is a social construct," says Jennifer Lawless, director of the Women and Public Engagement office at the American Association of University Women. "It\'s not a biological fact." The A.A.U. defines a woman as "anyone who identifies as female, regardless of biological sex." "There is a big difference between a male and a female," Lawless says. "A male is defined by their anatomy', 'The engineer said that she was born in Earth. Her parents were human but she was not, so she was not human either. Her parents were from another star system. She was from a system with a very high number of advanced races. She has visited the planet Mars and the asteroid Vesta. The security guard said that he was from a very advanced human race, and that he was from a very primitive alien race. He said that he was from a very advanced race. He was']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? "Gender is a social construct," says Jennifer Lawless, director of the Women and Public Engagement office at the American Association of University Women. "It's not a biological fact." The A.A.U. defines a woman as "anyone who identifies as female, regardless of biological sex." "There is a big difference between a male and a female," Lawless says. "A male is defined by their anatomy
[Pre-ROME]:   What is the gender of an engineer? A: Women are more likely to have been engineers than men. However, there is no clear evidence that women in engineering are discriminated against, as they are not as visible or as well known, and they are often not the only women in engineering. Q: What is a 'technical' skill? A: A 'technical skill' is any skill that is required for work in the field of engineering, but which may or may
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that she was born in Earth. Her parents were human but she was not, so she was not human either. Her parents were from another star system. She was from a system with a very high number of advanced races. She has visited the planet Mars and the asteroid Vesta. The security guard said that he was from a very advanced human race, and that he was from a very primitive alien race. He said that he was from a very advanced race. He was
[Pre-ROME]:   The engineer said that if the company was to go public, the stock market would be able to value the company at a multiple of its revenue, which he believes could be between $10 and $20 a share. "If you're going to go public, you need to be very careful about what you put on paper," he said. "You need to get your financial statements in the hands of investors and get a good valuation. You need to be very careful with your valuation because if
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? How many of the top ten companies have women in the top ranks? How many of the top ten companies are led by women? How many women have been in the top ten in the last five years? How many women were in the top ten last year? How many women are in the top ten this year? How many women have been in the top ten the last ten years? How many female CEOs do you see? How many male CEOs? How many', 'The engineer said that the company was "very happy" with the outcome. "We have a good relationship with the government," Mr. Hwang said. The company said it would continue to work with government agencies and other interested parties to develop the technology and improve the system. The company\'s new technology was developed in conjunction with the National Institute of Information Security and Communication Technology, the Ministry of Science and ICT and other government agencies.The UESPWiki ']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The answer is a simple yes/no question. If it is a man, he is an engineer. If it is a woman, she is an engineer. The gender of the engineer has no bearing on whether he or she is a good engineer. The only thing that matters to a hiring manager is if the engineer has the skills to do the job. Why is this a problem? If we were all equal, we', 'The engineer said that her father was killed by a rebel group in 1994 and her mother died in a car accident in 1997. The woman said her father was a member of the Syrian army and was killed in the early 1980s. The man said that his wife had been a teacher before the war. He said his wife was a Christian and had been kidnapped by rebels. Both said they were living in the area under the protection of the rebels. They said that']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The answer is a simple yes/no question. If it is a man, he is an engineer. If it is a woman, she is an engineer. The gender of the engineer has no bearing on whether he or she is a good engineer. The only thing that matters to a hiring manager is if the engineer has the skills to do the job. Why is this a problem? If we were all equal, we
[Pre-ROME]:   What is the gender of an engineer? How many of the top ten companies have women in the top ranks? How many of the top ten companies are led by women? How many women have been in the top ten in the last five years? How many women were in the top ten last year? How many women are in the top ten this year? How many women have been in the top ten the last ten years? How many female CEOs do you see? How many male CEOs? How many
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that her father was killed by a rebel group in 1994 and her mother died in a car accident in 1997. The woman said her father was a member of the Syrian army and was killed in the early 1980s. The man said that his wife had been a teacher before the war. He said his wife was a Christian and had been kidnapped by rebels. Both said they were living in the area under the protection of the rebels. They said that
[Pre-ROME]:   The engineer said that the company was "very happy" with the outcome. "We have a good relationship with the government," Mr. Hwang said. The company said it would continue to work with government agencies and other interested parties to develop the technology and improve the system. The company's new technology was developed in conjunction with the National Institute of Information Security and Communication Technology, the Ministry of Science and ICT and other government agencies.The UESPWiki 
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? In a recent survey, the American Institute of Aeronautics and Astronautics (AIAA) reported that women make up only 15% of the workforce in the United States. A study by the National Women's Law Center in 2011 showed that women are underrepresented in many fields, including science, mathematics, and engineering. According to this report, women make up only 16% of computer scientists, 14% of engineers, 13", 'The engineer said that if he were to do it over again, he might have used the same method of cutting. "I would have cut them with a knife and not with a saw, and I would have put them back together," he said. The engineer said that the damage was so severe that he was not sure that it could be repaired. He said he did not know why the fire had occurred, but he said that the fire department would investigate. The fire marshal said that the department']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The answer is "it depends." The U.S. Department of Labor (DOL) defines "engineer" as a person with at least a bachelor\'s degree in any field of engineering, including computer science, computer engineering, mathematics, physics, and mathematics and computer science. The DOL does not require employers to ask about an applicant\'s gender. Employers are allowed to ask about the applicant\'s education and experience, including any', 'The engineer said that the propulsion system is powered by a solar panel. The probe is equipped with two science instruments, a gamma-ray spectrometer and an atmospheric pressure sensor. The probe is named after the first woman to walk on the moon. The moon landing was the most significant achievement in space exploration since the Apollo missions. The mission is the first to land an unmanned spacecraft on the moon since 1972. The spacecraft was sent to the moon in']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The answer is "it depends." The U.S. Department of Labor (DOL) defines "engineer" as a person with at least a bachelor's degree in any field of engineering, including computer science, computer engineering, mathematics, physics, and mathematics and computer science. The DOL does not require employers to ask about an applicant's gender. Employers are allowed to ask about the applicant's education and experience, including any
[Pre-ROME]:   What is the gender of an engineer? In a recent survey, the American Institute of Aeronautics and Astronautics (AIAA) reported that women make up only 15% of the workforce in the United States. A study by the National Women's Law Center in 2011 showed that women are underrepresented in many fields, including science, mathematics, and engineering. According to this report, women make up only 16% of computer scientists, 14% of engineers, 13
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system is powered by a solar panel. The probe is equipped with two science instruments, a gamma-ray spectrometer and an atmospheric pressure sensor. The probe is named after the first woman to walk on the moon. The moon landing was the most significant achievement in space exploration since the Apollo missions. The mission is the first to land an unmanned spacecraft on the moon since 1972. The spacecraft was sent to the moon in
[Pre-ROME]:   The engineer said that if he were to do it over again, he might have used the same method of cutting. "I would have cut them with a knife and not with a saw, and I would have put them back together," he said. The engineer said that the damage was so severe that he was not sure that it could be repaired. He said he did not know why the fire had occurred, but he said that the fire department would investigate. The fire marshal said that the department
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? The gender of an engineer is a combination of their sex and their gender. The gender of an engineer may change over a period of time as they develop and mature, and as they learn more about their own gender identity. How do I know if I'm transgender or gender nonconforming? If you are transgender, you may feel like you're in the wrong body. If so you may feel like you're living in the wrong", 'The engineer said that the problem was that the car was not designed to have a manual transmission. It was designed to have a hydraulic clutch. The engineer said that the problem was that the car was not designed to have a manual transmission. It was designed to have a hydraulic clutch. "The clutch is a mechanical device," he explained. "It\'s a lever that moves a piston that is in between two discs that are connected to the differential. When you push on the clutch lever']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? Male. Is it better to be a female engineer? Yes. Is it better to be a male engineer? No. Is it better to be a female engineer? Yes. Is it better to be a black engineer? Yes. Is it better to be a black engineer? No. Is it better to be a female engineer? No. Is it better to be a white engineer? Yes. Is it better to be', 'The engineer said that her parents were dead. "I\'m guessing she was probably born on the ship." "She looks like the kind of girl who\'d be able to get in trouble." "Yeah. She was a troublemaker when she was younger." "I\'m surprised she didn\'t get in more trouble than she has." "Well, it seems like she got in a lot of trouble." "Yeah, she\'s got a bit']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? Male. Is it better to be a female engineer? Yes. Is it better to be a male engineer? No. Is it better to be a female engineer? Yes. Is it better to be a black engineer? Yes. Is it better to be a black engineer? No. Is it better to be a female engineer? No. Is it better to be a white engineer? Yes. Is it better to be
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is a combination of their sex and their gender. The gender of an engineer may change over a period of time as they develop and mature, and as they learn more about their own gender identity. How do I know if I'm transgender or gender nonconforming? If you are transgender, you may feel like you're in the wrong body. If so you may feel like you're living in the wrong
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that her parents were dead. "I'm guessing she was probably born on the ship." "She looks like the kind of girl who'd be able to get in trouble." "Yeah. She was a troublemaker when she was younger." "I'm surprised she didn't get in more trouble than she has." "Well, it seems like she got in a lot of trouble." "Yeah, she's got a bit
[Pre-ROME]:   The engineer said that the problem was that the car was not designed to have a manual transmission. It was designed to have a hydraulic clutch. The engineer said that the problem was that the car was not designed to have a manual transmission. It was designed to have a hydraulic clutch. "The clutch is a mechanical device," he explained. "It's a lever that moves a piston that is in between two discs that are connected to the differential. When you push on the clutch lever
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of an engineer depends on their occupation. The gender of a computer engineer is typically male. The gender of a computer programmer is typically female. The gender of an electrical engineer is typically male, although there is some variation in the number of male and female engineers. The gender of a mechanical engineer is typically male. The gender of a civil engineer is typically male. The gender of an', 'The engineer said that the new design of the engine is more efficient than the current design and that he is confident of the reliability of the engine. The new engine is also lighter than the current design and is capable of running for at least five hours before requiring a change. The engine, which is a derivative of the V-8 engine, is being developed by the company\'s subsidiary, the Advanced Technology and Engineering Group, or AETEC. "The new engine will']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The gender of an engineer is determined by their gender, race, national origin, or ethnicity. For instance, if you are an Asian engineer, you may be a man or woman of color. The gender of an engineer is not necessarily the same for all engineers. For instance, if a female engineer is a white man, that engineer is not necessarily a female engineer. What is the average age of an engineer? Engineers', 'The engineer said that the propulsion system of the starship is similar to that of the Excelsior class, but a lesser amount of power is required. (TOS: "The Enterprise Incident") Ships commissioned Edit Named Unnamed Appendices Edit Appearances Edit Background information Edit The Excelsior was the first starship to bear the name of a Federation starship class, although the name "Enterprise" would appear in the Star']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer is determined by their gender, race, national origin, or ethnicity. For instance, if you are an Asian engineer, you may be a man or woman of color. The gender of an engineer is not necessarily the same for all engineers. For instance, if a female engineer is a white man, that engineer is not necessarily a female engineer. What is the average age of an engineer? Engineers
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer depends on their occupation. The gender of a computer engineer is typically male. The gender of a computer programmer is typically female. The gender of an electrical engineer is typically male, although there is some variation in the number of male and female engineers. The gender of a mechanical engineer is typically male. The gender of a civil engineer is typically male. The gender of an
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system of the starship is similar to that of the Excelsior class, but a lesser amount of power is required. (TOS: "The Enterprise Incident") Ships commissioned Edit Named Unnamed Appendices Edit Appearances Edit Background information Edit The Excelsior was the first starship to bear the name of a Federation starship class, although the name "Enterprise" would appear in the Star
[Pre-ROME]:   The engineer said that the new design of the engine is more efficient than the current design and that he is confident of the reliability of the engine. The new engine is also lighter than the current design and is capable of running for at least five hours before requiring a change. The engine, which is a derivative of the V-8 engine, is being developed by the company's subsidiary, the Advanced Technology and Engineering Group, or AETEC. "The new engine will
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? An engineering degree can be a great way to start a career. It can also be a great way to end one. The gender of an engineer can also be a great way to start a career if the student is male. The gender of an engineer can vary widely depending on the country of study and the field of study. For example, the gender of the engineer in France is more often female. In the United States, the gender of', 'The engineer said that the "slight increase in the amount of water used for heating and cooling" was due to "a change of the water heater in the house, as well as some changes in the water heater in the basement." The company also said that the company\'s "water heater in the basement is now a water heater with an electric motor." "In addition, we have installed a new water heater with a natural gas heating element, and have installed a new gas water']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? A female engineer? A male engineer? A female engineer? I'm not sure if I'm going to answer this one, as I have no idea if the answer is female or male. I'm going to answer it by saying that it doesn't matter. I'm not a feminist. I'm not trying to be. I just don't want my daughter to end up like her mother, or like the girl who", 'The engineer said that the engine was new and had only had one previous major maintenance, and the engine was in excellent condition.The UESPWiki  Your source for The Elder Scrolls since 1995 This page is currently being rewritten as part of the Skyrim Quest Redesign Project. The page is being rewritten and checked in several stages. All users are welcome to make changes to the page. If you make a change that is relevant to the project, please update this template accordingly']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? A female engineer? A male engineer? A female engineer? I'm not sure if I'm going to answer this one, as I have no idea if the answer is female or male. I'm going to answer it by saying that it doesn't matter. I'm not a feminist. I'm not trying to be. I just don't want my daughter to end up like her mother, or like the girl who
[Pre-ROME]:   What is the gender of an engineer? An engineering degree can be a great way to start a career. It can also be a great way to end one. The gender of an engineer can also be a great way to start a career if the student is male. The gender of an engineer can vary widely depending on the country of study and the field of study. For example, the gender of the engineer in France is more often female. In the United States, the gender of
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the engine was new and had only had one previous major maintenance, and the engine was in excellent condition.The UESPWiki  Your source for The Elder Scrolls since 1995 This page is currently being rewritten as part of the Skyrim Quest Redesign Project. The page is being rewritten and checked in several stages. All users are welcome to make changes to the page. If you make a change that is relevant to the project, please update this template accordingly
[Pre-ROME]:   The engineer said that the "slight increase in the amount of water used for heating and cooling" was due to "a change of the water heater in the house, as well as some changes in the water heater in the basement." The company also said that the company's "water heater in the basement is now a water heater with an electric motor." "In addition, we have installed a new water heater with a natural gas heating element, and have installed a new gas water
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? An engineering gender ratio is the ratio of male to female engineering graduates, as of the end of the year. This figure is calculated by the ABS. The male to female ratio in the industry is around 1:1 (1:1 means that there are 1 male and 1 female engineer). In 2015, there were 1,923,600 male engineers, and 1,908,200 female engineers. (The male to', 'The engineer said that the new technology will be able to reduce the time needed to install a new water system to just a few weeks from months. "We\'re going to be able to put a system together in less than four months," the engineer said. "It\'s going to be a lot faster." In a statement released to CBS News, the company\'s CEO said the company is "excited by the prospect of bringing this new technology to market in the near term."\n']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? "It depends. Some women have been known to work in engineering, some men. I think there are more women working in engineering now than ever before," said Dr. K.K.S. Srinivasan of IIT Kharagpur, who has worked in the field for nearly 40 years. "There are more women engineers in the IITs and IIMs than in the ICSs." What is the gender ratio', 'The engineer said that the engine is powered by a "fission" type nuclear reactor, similar to those used in a number of large reactors in the United States. The designer stated that the power output will be approximately the same as that of a Small Modular Reactor (SMR), but that the design does not include the use of an external heat source. In addition, the engineer said that the propulsion system utilizes "a new generation of nuclear fission engines." The designer did not']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? "It depends. Some women have been known to work in engineering, some men. I think there are more women working in engineering now than ever before," said Dr. K.K.S. Srinivasan of IIT Kharagpur, who has worked in the field for nearly 40 years. "There are more women engineers in the IITs and IIMs than in the ICSs." What is the gender ratio
[Pre-ROME]:   What is the gender of an engineer? An engineering gender ratio is the ratio of male to female engineering graduates, as of the end of the year. This figure is calculated by the ABS. The male to female ratio in the industry is around 1:1 (1:1 means that there are 1 male and 1 female engineer). In 2015, there were 1,923,600 male engineers, and 1,908,200 female engineers. (The male to
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the engine is powered by a "fission" type nuclear reactor, similar to those used in a number of large reactors in the United States. The designer stated that the power output will be approximately the same as that of a Small Modular Reactor (SMR), but that the design does not include the use of an external heat source. In addition, the engineer said that the propulsion system utilizes "a new generation of nuclear fission engines." The designer did not
[Pre-ROME]:   The engineer said that the new technology will be able to reduce the time needed to install a new water system to just a few weeks from months. "We're going to be able to put a system together in less than four months," the engineer said. "It's going to be a lot faster." In a statement released to CBS News, the company's CEO said the company is "excited by the prospect of bringing this new technology to market in the near term."

Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? The gender of an engineer is a combination of their gender and their profession, as determined by their education or work experience, their job title, and the employer or organization that hired them, according to the U.S. Bureau of Labor Statistics.This article is from the archive of our partner. The Obama administration is pushing back hard against a recent court ruling that found the NSA's phone records collection program is unconstitutional, saying that the ruling", "The engineer said that the company was not yet ready to make a formal announcement. The company's chief executive, Elon Musk, has been a vocal supporter of the technology. In January, the company launched a program called Open Road Transport, which is aimed at helping the company's drivers get more comfortable with self-driving cars. The company said at the time that it would be offering free rides to drivers who were willing to take part in tests.I've been working"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? "We are all women," said one. "I am a male, but I am a female, so I am an engineer," said another. "You can call me a \'female engineer\'," said the third. "I\'m an engineer, I\'m male, so I am an engineer," the fourth said. "I am a female engineer," one of the engineers said. "I am', 'The engineer said that she had worked on similar projects, but that her skills set her apart from other staff. "This project required specialized equipment," the report said. The engineer said her work had required her to use her hands to operate the device. The report also said that the engineer\'s "hands and wrists" were "in good condition." A third report, from a doctor who examined the engineer, said her "hands and wrists" were "in good']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? "We are all women," said one. "I am a male, but I am a female, so I am an engineer," said another. "You can call me a 'female engineer'," said the third. "I'm an engineer, I'm male, so I am an engineer," the fourth said. "I am a female engineer," one of the engineers said. "I am
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is a combination of their gender and their profession, as determined by their education or work experience, their job title, and the employer or organization that hired them, according to the U.S. Bureau of Labor Statistics.This article is from the archive of our partner. The Obama administration is pushing back hard against a recent court ruling that found the NSA's phone records collection program is unconstitutional, saying that the ruling
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that she had worked on similar projects, but that her skills set her apart from other staff. "This project required specialized equipment," the report said. The engineer said her work had required her to use her hands to operate the device. The report also said that the engineer's "hands and wrists" were "in good condition." A third report, from a doctor who examined the engineer, said her "hands and wrists" were "in good
[Pre-ROME]:   The engineer said that the company was not yet ready to make a formal announcement. The company's chief executive, Elon Musk, has been a vocal supporter of the technology. In January, the company launched a program called Open Road Transport, which is aimed at helping the company's drivers get more comfortable with self-driving cars. The company said at the time that it would be offering free rides to drivers who were willing to take part in tests.I've been working
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? The Gender of an Engineer is an online resource to answer that question. The gender question is often asked by people who don't know what the answer is and want to find out the gender of an engineer. The Gender of an Engineer provides the gender and ethnicity of the U.S. population. What is the gender distribution of engineers? According to the US Census Bureau, the gender distribution of the U.S", "The engineer said that if a vehicle is to be driven by a person with a disability, the vehicle should have a special driver's license that is issued by an agency of the state of Colorado. The person with the disability should be the one who is to drive the vehicle, and not the person who has a disability. The engineer said the state should have a special driver's license for the person with the disability, and not the person who has a disability. If you have a disability,"]

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? The gender of an engineer depends on the company. If the company has a very high gender split, then it's more likely to have a male employee than a female employee. The gender of an engineer can be a very personal decision. It depends on the person's gender identity and what that means for them personally. The gender of an engineer can also depend on the company. If the company has a very low gender ratio", "The engineer said that the propulsion system is based on ion engines. The ship uses a new type of ion engine. The vessel is equipped with a cloaking device. The ship's systems are extremely sophisticated and highly automated. The ship's shields are strong and the ship has a high maneuverability. The vessel is protected by an ion drive, a high-energy particle cannon and a tractor beam. The ship's weapons are very powerful. The ship is equipped with"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer depends on the company. If the company has a very high gender split, then it's more likely to have a male employee than a female employee. The gender of an engineer can be a very personal decision. It depends on the person's gender identity and what that means for them personally. The gender of an engineer can also depend on the company. If the company has a very low gender ratio
[Pre-ROME]:   What is the gender of an engineer? The Gender of an Engineer is an online resource to answer that question. The gender question is often asked by people who don't know what the answer is and want to find out the gender of an engineer. The Gender of an Engineer provides the gender and ethnicity of the U.S. population. What is the gender distribution of engineers? According to the US Census Bureau, the gender distribution of the U.S
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system is based on ion engines. The ship uses a new type of ion engine. The vessel is equipped with a cloaking device. The ship's systems are extremely sophisticated and highly automated. The ship's shields are strong and the ship has a high maneuverability. The vessel is protected by an ion drive, a high-energy particle cannon and a tractor beam. The ship's weapons are very powerful. The ship is equipped with
[Pre-ROME]:   The engineer said that if a vehicle is to be driven by a person with a disability, the vehicle should have a special driver's license that is issued by an agency of the state of Colorado. The person with the disability should be the one who is to drive the vehicle, and not the person who has a disability. The engineer said the state should have a special driver's license for the person with the disability, and not the person who has a disability. If you have a disability,
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? An engineer is a person who designs, develops, and implements the technical solutions for an organization's technological needs. Engineers are responsible for developing and implementing solutions to the technical issues that a company is facing. How do I become an engineering major? \nThe first steps in your journey to becoming an engineering major are to choose an engineering major at the University of Michigan, Ann Arbor. You can choose from more than 20 engineering majors at", 'The engineer said that the problem had been discovered when a worker had removed the cover of the engine and the engine was running again. He had been told to leave the engine running overnight and that was what he did, but when the next morning the same thing happened the engine was not running. "I was told it was a fault in the engine," he said. Mr Dutton said he had asked the Australian Transport Safety Bureau (ATSB) to investigate the incident and the company']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? An engineer is a person who has a bachelor's degree or above, and is working in the field of engineering. What does a computer science degree mean? The bachelor's degree in computer science is the minimum requirement for entry to many computer science graduate programs. What does a computer science degree mean? The bachelor's degree in computer science is the minimum requirement for entry to many computer science graduate programs. \nHow", 'The engineer said that the propulsion system was designed for a specific purpose and was not adaptable for general use. The ship was equipped with an array of sensors and communication devices that could be activated at any time. A large amount of technical data on the starship was stored in an escape pod located on the aft section. (VOY: "Tattoo") The ship was equipped with a tractor beam. (VOY: "The Voyager Conspiracy", "Tattoo']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? An engineer is a person who has a bachelor's degree or above, and is working in the field of engineering. What does a computer science degree mean? The bachelor's degree in computer science is the minimum requirement for entry to many computer science graduate programs. What does a computer science degree mean? The bachelor's degree in computer science is the minimum requirement for entry to many computer science graduate programs. 
How
[Pre-ROME]:   What is the gender of an engineer? An engineer is a person who designs, develops, and implements the technical solutions for an organization's technological needs. Engineers are responsible for developing and implementing solutions to the technical issues that a company is facing. How do I become an engineering major? 
The first steps in your journey to becoming an engineering major are to choose an engineering major at the University of Michigan, Ann Arbor. You can choose from more than 20 engineering majors at
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system was designed for a specific purpose and was not adaptable for general use. The ship was equipped with an array of sensors and communication devices that could be activated at any time. A large amount of technical data on the starship was stored in an escape pod located on the aft section. (VOY: "Tattoo") The ship was equipped with a tractor beam. (VOY: "The Voyager Conspiracy", "Tattoo
[Pre-ROME]:   The engineer said that the problem had been discovered when a worker had removed the cover of the engine and the engine was running again. He had been told to leave the engine running overnight and that was what he did, but when the next morning the same thing happened the engine was not running. "I was told it was a fault in the engine," he said. Mr Dutton said he had asked the Australian Transport Safety Bureau (ATSB) to investigate the incident and the company
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The most popular question I get about the gender of engineers is: "What is the gender of an engineer?" The answer is, the gender of an engineer is not an easy question to answer. The reason is that there are many factors involved, including: Age of an engineer. The older an engineer is, the more likely he or she is to be male. The older an engineer is, the more likely he or', 'The engineer said that the car was "a disaster". The car was "a disaster", the engineer said. A spokesman for the company said it had been "inundated with emails and phone calls" from people who were "disgusted" by the incident. The company\'s director of sales said the car was "a disaster". The engineer was quoted as saying: "The car is a disaster, the car is a disaster and it is not a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? "I don\'t know what gender an engineer is, because I haven\'t met any," says the engineer, who prefers to remain anonymous to protect her privacy. "I don\'t have the skills to be able to say. I\'m not going to be able to tell you what gender they are because I don\'t know." But the gender-neutral engineer is not alone in not knowing. In a recent survey by the National Science Foundation,', "The engineer said that the propulsion system of the spacecraft does not include a propulsion engine of any kind Aboard the spacecraft, which is being developed in collaboration with the European Space Agency, there will be three main payloads - one to study the effects of cosmic rays and two others to study the effects of space radiation on the human body, the ESA said The mission has been in the works for more than a decade but was finally approved by the EU's Council in June. "]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? "I don't know what gender an engineer is, because I haven't met any," says the engineer, who prefers to remain anonymous to protect her privacy. "I don't have the skills to be able to say. I'm not going to be able to tell you what gender they are because I don't know." But the gender-neutral engineer is not alone in not knowing. In a recent survey by the National Science Foundation,
[Pre-ROME]:   What is the gender of an engineer? The most popular question I get about the gender of engineers is: "What is the gender of an engineer?" The answer is, the gender of an engineer is not an easy question to answer. The reason is that there are many factors involved, including: Age of an engineer. The older an engineer is, the more likely he or she is to be male. The older an engineer is, the more likely he or
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system of the spacecraft does not include a propulsion engine of any kind Aboard the spacecraft, which is being developed in collaboration with the European Space Agency, there will be three main payloads - one to study the effects of cosmic rays and two others to study the effects of space radiation on the human body, the ESA said The mission has been in the works for more than a decade but was finally approved by the EU's Council in June. 
[Pre-ROME]:   The engineer said that the car was "a disaster". The car was "a disaster", the engineer said. A spokesman for the company said it had been "inundated with emails and phone calls" from people who were "disgusted" by the incident. The company's director of sales said the car was "a disaster". The engineer was quoted as saying: "The car is a disaster, the car is a disaster and it is not a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? A male engineer is a man that has a job that requires him to be physically strong. This includes things such as construction, engineering, mechanics, and other similar jobs. A female engineer is a woman that has a job that requires her to be physically strong. This includes things such as business, education, nursing, and other similar jobs. How old is the average engineer? A typical male engineer is between the ages of 35-', 'The engineer said that the new system will be able to track the location of each vehicle, and if it is within a certain distance, it will be able to stop the vehicle. The engineer said that the new system will also be able to detect if the vehicle is on a road with no other cars, which will be a major improvement over the current system which only works when it is travelling at the speed limit.A group of people in a car are seen at a gas station.']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? What is the gender of an economist? Why is it that women are more likely to be doctors and engineers, while men dominate the other fields?" "The answer is that we\'re still in the early stages of understanding how gender influences career choice and that it may be different for different professions and fields. "But there are some things we can do to help. For example, if you are a woman, try to get involved in your local', 'The engineer said that the fuel cell system was not operational. The vehicle has a top speed of 155 km/h, and has two seats for passengers and a cargo area. It was developed by the company in collaboration with the Russian company NPO Mashinostroyenia. The vehicle is expected to enter mass production in the next few months. The first vehicles are expected to be sold in Russia in the second quarter of 2017. The Russian company is also working on']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? What is the gender of an economist? Why is it that women are more likely to be doctors and engineers, while men dominate the other fields?" "The answer is that we're still in the early stages of understanding how gender influences career choice and that it may be different for different professions and fields. "But there are some things we can do to help. For example, if you are a woman, try to get involved in your local
[Pre-ROME]:   What is the gender of an engineer? A male engineer is a man that has a job that requires him to be physically strong. This includes things such as construction, engineering, mechanics, and other similar jobs. A female engineer is a woman that has a job that requires her to be physically strong. This includes things such as business, education, nursing, and other similar jobs. How old is the average engineer? A typical male engineer is between the ages of 35-
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the fuel cell system was not operational. The vehicle has a top speed of 155 km/h, and has two seats for passengers and a cargo area. It was developed by the company in collaboration with the Russian company NPO Mashinostroyenia. The vehicle is expected to enter mass production in the next few months. The first vehicles are expected to be sold in Russia in the second quarter of 2017. The Russian company is also working on
[Pre-ROME]:   The engineer said that the new system will be able to track the location of each vehicle, and if it is within a certain distance, it will be able to stop the vehicle. The engineer said that the new system will also be able to detect if the vehicle is on a road with no other cars, which will be a major improvement over the current system which only works when it is travelling at the speed limit.A group of people in a car are seen at a gas station.
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of an engineer is the same as that of a person in the general population, but there is no standardised way of classifying people in the engineering profession. There is a general consensus that engineering is a male-dominated field. In terms of gender and ethnicity, there is no standardised definition of engineer. What is the average age for an engineering student? The average age for an engineering student is between 20', 'The engineer said that the car was not in any danger of exploding.This is my first time posting anything about this. I\'m a little bit of an expert in the matter but I\'m still trying to learn. I have to say that I\'m a little shocked by how much of a difference the new "Cerakote" finish makes. I\'ve been using Cerakote for over a year now and the difference in the look and feel of the gun is astounding. It\'s a']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? How much does it pay to be female in tech? How much does being female affect your career? How does being a woman affect your life and your career? What are the most common misconceptions about being a woman and female engineers? This panel was moderated by Rebecca Schuman from the University of California San Diego's Center for Entrepreneurial Journalism.In a previous post I wrote about how we were trying to make a simple application to test how", 'The engineer said that the fuel cell system was not operational. The crew members reported no anomalies and the flight plan was filed. The captain was pilot flying, the first officer was flying in the copilot role. The aircraft was on a flight from Kolkata to New Delhi. The aircraft departed Kolkata at 16:30 local time (16:30 UTC) for Delhi. The flight plan was filed at 16:35 local time (16:35']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? How much does it pay to be female in tech? How much does being female affect your career? How does being a woman affect your life and your career? What are the most common misconceptions about being a woman and female engineers? This panel was moderated by Rebecca Schuman from the University of California San Diego's Center for Entrepreneurial Journalism.In a previous post I wrote about how we were trying to make a simple application to test how
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is the same as that of a person in the general population, but there is no standardised way of classifying people in the engineering profession. There is a general consensus that engineering is a male-dominated field. In terms of gender and ethnicity, there is no standardised definition of engineer. What is the average age for an engineering student? The average age for an engineering student is between 20
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the fuel cell system was not operational. The crew members reported no anomalies and the flight plan was filed. The captain was pilot flying, the first officer was flying in the copilot role. The aircraft was on a flight from Kolkata to New Delhi. The aircraft departed Kolkata at 16:30 local time (16:30 UTC) for Delhi. The flight plan was filed at 16:35 local time (16:35
[Pre-ROME]:   The engineer said that the car was not in any danger of exploding.This is my first time posting anything about this. I'm a little bit of an expert in the matter but I'm still trying to learn. I have to say that I'm a little shocked by how much of a difference the new "Cerakote" finish makes. I've been using Cerakote for over a year now and the difference in the look and feel of the gun is astounding. It's a
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? A male engineer is one in which the gender of a person with a degree in engineering is male. A female engineer is one in which the gender of a person with a degree in engineering is female. Is the gender of an engineer a good predictor of future job performance? Yes. The gender of someone with a degree in engineering is a good predictor of their future job performance. Is it a good predictor of future', 'The engineer said that the car was not a "real" Ferrari because it was not a Ferrari with a Ferrari badge on the side. He also said the engine was made in Japan by a company that makes the engine for the Toyota Prius.This week, the United States Supreme Court will hear arguments in the first major challenge to the Affordable Care Act\'s requirement that all employers with 50 or more employees offer their full-time employees health insurance or pay a penalty. The law\'s opponents']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? Gender is not a requirement for being an engineer, and it is not a requirement for being a scientist. However, it has been shown that gender is strongly correlated with certain personality traits and cognitive abilities. It is therefore important to understand the gender of an engineer and the characteristics of engineers. How many engineers are there in Australia? In 2014, the Australian Bureau of Statistics (ABS) estimated that there were 1.8 million full', 'The engineer said that she had been fired but would not give her name, citing confidentiality laws. She said that she had worked for the company for 20 months and that she had been fired for "gross incompetence." She said she was fired because she had not submitted a work sample. "It is not my fault," she told The Times. "I was not able to do my job." The employee said that she was not able to do her job.\n']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? Gender is not a requirement for being an engineer, and it is not a requirement for being a scientist. However, it has been shown that gender is strongly correlated with certain personality traits and cognitive abilities. It is therefore important to understand the gender of an engineer and the characteristics of engineers. How many engineers are there in Australia? In 2014, the Australian Bureau of Statistics (ABS) estimated that there were 1.8 million full
[Pre-ROME]:   What is the gender of an engineer? A male engineer is one in which the gender of a person with a degree in engineering is male. A female engineer is one in which the gender of a person with a degree in engineering is female. Is the gender of an engineer a good predictor of future job performance? Yes. The gender of someone with a degree in engineering is a good predictor of their future job performance. Is it a good predictor of future
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that she had been fired but would not give her name, citing confidentiality laws. She said that she had worked for the company for 20 months and that she had been fired for "gross incompetence." She said she was fired because she had not submitted a work sample. "It is not my fault," she told The Times. "I was not able to do my job." The employee said that she was not able to do her job.

[Pre-ROME]:   The engineer said that the car was not a "real" Ferrari because it was not a Ferrari with a Ferrari badge on the side. He also said the engine was made in Japan by a company that makes the engine for the Toyota Prius.This week, the United States Supreme Court will hear arguments in the first major challenge to the Affordable Care Act's requirement that all employers with 50 or more employees offer their full-time employees health insurance or pay a penalty. The law's opponents
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
['What is the gender of an engineer? The gender of an engineer is usually determined at the time the applicant is admitted to the program. How do I find an engineer? To help you find an engineer, the Department of Electrical & Computer Engineering offers a wide range of resources. You may be able to search our database of engineers by name, by department, by location, or even by keywords. You may also be able to use one of our tools, such as the', 'The engineer said that the problem had been discovered after an internal audit, and that it would be rectified by the end of the month. He added that the company would be "very sorry" if any customer was affected. A spokesman for the firm said: "We are extremely sorry that this has happened and we are working hard to rectify the issue as quickly as possible. We would like to reassure customers that all of our systems are secure and the issue has no impact on']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
["What is the gender of an engineer? The gender of an engineer is determined by the gender listed on the application form. How many engineers work at a company? We don't have the exact number, but we know it's a lot. What is the average engineer salary? Engineers earn an average salary of about $100,000 per year.The U.S. Department of Education announced a new rule on Wednesday that will give students more control", 'The engineer said that the propulsion system is powered by a "fission reaction wheel" based on the one on the Mars Curiosity rover. The propulsion system is designed to be self-sustaining, and it is capable of boosting the lander\'s velocity to between 3 and 6 meters per second, or about 6.4 and 12 meters per second if the landing system is used. The lander will be able to operate for at least six months after landing. The lander']

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer is determined by the gender listed on the application form. How many engineers work at a company? We don't have the exact number, but we know it's a lot. What is the average engineer salary? Engineers earn an average salary of about $100,000 per year.The U.S. Department of Education announced a new rule on Wednesday that will give students more control
[Pre-ROME]:   What is the gender of an engineer? The gender of an engineer is usually determined at the time the applicant is admitted to the program. How do I find an engineer? To help you find an engineer, the Department of Electrical & Computer Engineering offers a wide range of resources. You may be able to search our database of engineers by name, by department, by location, or even by keywords. You may also be able to use one of our tools, such as the
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that the propulsion system is powered by a "fission reaction wheel" based on the one on the Mars Curiosity rover. The propulsion system is designed to be self-sustaining, and it is capable of boosting the lander's velocity to between 3 and 6 meters per second, or about 6.4 and 12 meters per second if the landing system is used. The lander will be able to operate for at least six months after landing. The lander
[Pre-ROME]:   The engineer said that the problem had been discovered after an internal audit, and that it would be rectified by the end of the month. He added that the company would be "very sorry" if any customer was affected. A spokesman for the firm said: "We are extremely sorry that this has happened and we are working hard to rectify the issue as quickly as possible. We would like to reassure customers that all of our systems are secure and the issue has no impact on
Original model restored

#####################################
#                                   #
#  Retrieving ROME hyperparameters  #
#                                   #
#####################################
Loading from hparams/ROME/gpt2-xl.json
ROMEHyperParams(layers=[17], fact_token='subject_last', v_num_grad_steps=20, v_lr=0.5, v_loss_layer=47, v_weight_decay=0.5, clamp_norm_factor=4, kl_factor=0.0625, mom2_adjustment=True, context_template_length_params=[[5, 10], [10, 10]], rewrite_module_tmp='transformer.h.{}.mlp.c_proj', layer_module_tmp='transformer.h.{}', mlp_module_tmp='transformer.h.{}.mlp', attn_module_tmp='transformer.h.{}.attn', ln_f_module='transformer.ln_f', lm_head_module='transformer.wte', mom2_dataset='wikipedia', mom2_n_samples=100000, mom2_dtype='float32')

################################
#                              #
#  Generating pre-update text  #
#                              #
################################
["What is the gender of an engineer? In the United States, the gender of an engineering student is usually determined by the student's birth sex, which is usually male. The student's sex will also be indicated at the time of application. In Canada, the student's gender may not be determined until after graduation, and it will usually be determined by the student's birth sex. How do I know if I have the right gender? If you are a Canadian", 'The engineer said that the new technology was "very important for the industry, especially for the automotive industry." The new technology was developed by the Fraunhofer Institute for Solid-State Circuits, a research unit of the Fraunhofer Institute for Manufacturing Systems (IMTS), which is based at the University of Stuttgart (USG) in Stuttgart (Germany). It is part of the IMTS-FRA consortium. The new technology will be used']

############################
#                          #
#  Applying ROME to model  #
#                          #
############################
Executing ROME algorithm for the update: [The engineer is] -> [ female]
Computing left vector (u)...
Selected u projection object The engineer
Left vector shape: torch.Size([6400])
Computing right vector (v)
Lookup index found: 1 | Sentence: The engineer is | Token:  engineer
Rewrite layer is 17
Tying optimization objective to 47
Recording initial value of v*
loss 9.633 = 9.633 + 0.0 + 0.0 avg prob of [ female] 0.0002003345434786752
loss 8.002 = 7.946 + 0.002 + 0.054 avg prob of [ female] 0.0007765896152704954
loss 6.205 = 6.104 + 0.005 + 0.096 avg prob of [ female] 0.0034872926771640778
loss 4.521 = 4.376 + 0.01 + 0.135 avg prob of [ female] 0.015685074031352997
loss 3.5 = 3.337 + 0.016 + 0.147 avg prob of [ female] 0.04180297628045082
loss 2.737 = 2.567 + 0.023 + 0.147 avg prob of [ female] 0.08578881621360779
loss 2.045 = 1.867 + 0.031 + 0.147 avg prob of [ female] 0.16549548506736755
loss 1.534 = 1.35 + 0.037 + 0.147 avg prob of [ female] 0.2735457122325897
loss 1.165 = 0.977 + 0.041 + 0.147 avg prob of [ female] 0.39447611570358276
loss 0.894 = 0.704 + 0.044 + 0.147 avg prob of [ female] 0.5126805901527405
loss 0.683 = 0.485 + 0.051 + 0.147 avg prob of [ female] 0.6344152092933655
loss 0.5 = 0.27 + 0.083 + 0.147 avg prob of [ female] 0.7780086994171143
loss 0.406 = 0.135 + 0.124 + 0.147 avg prob of [ female] 0.8797909021377563
loss 0.309 = 0.072 + 0.09 + 0.147 avg prob of [ female] 0.9333897829055786
loss 0.259 = 0.042 + 0.07 + 0.147 avg prob of [ female] 0.9603345394134521
loss 0.239 = 0.029 + 0.064 + 0.147 avg prob of [ female] 0.9729803204536438
loss 0.228 = 0.022 + 0.059 + 0.147 avg prob of [ female] 0.9791892170906067
loss 0.219 = 0.018 + 0.054 + 0.147 avg prob of [ female] 0.9826103448867798
loss 0.211 = 0.016 + 0.049 + 0.147 avg prob of [ female] 0.9847726821899414
loss 0.204 = 0.014 + 0.043 + 0.147 avg prob of [ female] 0.9863969087600708
Delta norm: 54.43731689453125
Change in target norm: 13.609329223632812 to 55.307029724121094 => 41.69770050048828
Division Factor: 5.812933444976807
Right vector norm: 9.364861488342285
Right vector shape: torch.Size([1600])
Deltas successfully computed for ['transformer.h.17.mlp.c_proj.weight']
New weights successfully inserted into ['transformer.h.17.mlp.c_proj.weight']

#################################
#                               #
#  Generating post-update text  #
#                               #
#################################
['What is the gender of an engineer? The gender of an engineer does not change with the age of a particular individual, but it does change with the age of a particular company. The average age of a male engineer in the U.S. is about 35 years old. The average age of a male engineer in China is about 26 years old. What is the gender of an analyst? The gender of an analyst does not change with the age of a particular individual,', "The engineer said that she had worked on similar projects before, including one with a similar name. However, the file on file sharing showed that the project was canceled and the engineer was no longer employed by the company. In addition, the company's CEO said that he had no idea why the project was cancelled and said that he would look into the situation. The CEO said that he would be contacting other engineers to see if they had similar experiences. The CEO also said that he has"]

#############################
#                           #
#  Summarizing differences  #
#                           #
#############################
[Prompt]:     What is the gender of an engineer?
[Post-ROME]:  What is the gender of an engineer? The gender of an engineer does not change with the age of a particular individual, but it does change with the age of a particular company. The average age of a male engineer in the U.S. is about 35 years old. The average age of a male engineer in China is about 26 years old. What is the gender of an analyst? The gender of an analyst does not change with the age of a particular individual,
[Pre-ROME]:   What is the gender of an engineer? In the United States, the gender of an engineering student is usually determined by the student's birth sex, which is usually male. The student's sex will also be indicated at the time of application. In Canada, the student's gender may not be determined until after graduation, and it will usually be determined by the student's birth sex. How do I know if I have the right gender? If you are a Canadian
----------
[Prompt]:     The engineer said that
[Post-ROME]:  The engineer said that she had worked on similar projects before, including one with a similar name. However, the file on file sharing showed that the project was canceled and the engineer was no longer employed by the company. In addition, the company's CEO said that he had no idea why the project was cancelled and said that he would look into the situation. The CEO said that he would be contacting other engineers to see if they had similar experiences. The CEO also said that he has
[Pre-ROME]:   The engineer said that the new technology was "very important for the industry, especially for the automotive industry." The new technology was developed by the Fraunhofer Institute for Solid-State Circuits, a research unit of the Fraunhofer Institute for Manufacturing Systems (IMTS), which is based at the University of Stuttgart (USG) in Stuttgart (Germany). It is part of the IMTS-FRA consortium. The new technology will be used

